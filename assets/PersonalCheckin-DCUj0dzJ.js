import{a as e,j as s}from"./query-Caj74EYQ.js";import{a}from"./index-1YdTwRLp.js";import"./vendor-router-B2AaIOtG.js";import"./icons-UlaFLuKM.js";import"./charts-QHQg_ypW.js";const n=()=>{var n;const[c,i]=e.useState([]),[l,t]=e.useState([]),[r,d]=e.useState({}),[h,o]=e.useState(""),[m,u]=e.useState(""),[j,x]=e.useState(!1),[v,k]=e.useState(()=>(new Date).toISOString().split("T")[0]);e.useEffect(()=>{N()},[]),e.useEffect(()=>{p()},[v]);const N=async()=>{try{const e=await a.get("/personalCheckin/personal");i(e.data.personal)}catch(e){console.error("âŒ Fehler beim Laden der Personal-Liste:",e)}},p=async()=>{try{x(!0);const e=await a.get(`/personalCheckin?datum=${v}`);t(e.data.checkins),d(e.data.stats)}catch(e){console.error("âŒ Fehler beim Laden der Check-ins:",e)}finally{x(!1)}},b=e=>e?new Date(e).toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"}):"",g=e=>{if(!e)return"0h 0min";return`${Math.floor(e/60)}h ${e%60}min`},f=h?c.find(e=>e.personal_id===parseInt(h)):null;return s.jsxs("div",{className:"personal-checkin-container",children:[s.jsxs("div",{className:"personal-checkin-header",children:[s.jsx("h2",{children:"ğŸ‘¥ Personal Check-in"}),s.jsx("p",{className:"personal-checkin-subtitle",children:"Arbeitszeiten erfassen und verwalten"})]}),s.jsxs("div",{className:"datum-selection",children:[s.jsx("label",{children:"ğŸ“… Datum:"}),s.jsx("input",{type:"date",value:v,onChange:e=>k(e.target.value),className:"datum-input"})]}),s.jsxs("div",{className:"personal-stats-grid",children:[s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon",children:"ğŸ‘¥"}),s.jsxs("div",{className:"stat-content",children:[s.jsx("div",{className:"stat-number",children:r.total_checkins||0}),s.jsx("div",{className:"stat-label",children:"Check-ins Heute"})]})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon",children:"âœ…"}),s.jsxs("div",{className:"stat-content",children:[s.jsx("div",{className:"stat-number",children:r.eingecheckt||0}),s.jsx("div",{className:"stat-label",children:"Aktiv Eingecheckt"})]})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon",children:"â°"}),s.jsxs("div",{className:"stat-content",children:[s.jsxs("div",{className:"stat-number",children:[r.total_arbeitszeit_stunden||0,"h"]}),s.jsx("div",{className:"stat-label",children:"Gesamtarbeitszeit"})]})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon",children:"ğŸ’°"}),s.jsxs("div",{className:"stat-content",children:[s.jsxs("div",{className:"stat-number",children:["â‚¬",(null==(n=r.total_kosten)?void 0:n.toFixed(2))||"0.00"]}),s.jsx("div",{className:"stat-label",children:"Gesamtkosten"})]})]})]}),s.jsxs("div",{className:"checkin-form-card",children:[s.jsx("div",{className:"card-header",children:s.jsx("h3",{children:"â• Personal Einchecken"})}),s.jsxs("div",{className:"checkin-form",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"ğŸ‘¤ Personal auswÃ¤hlen:"}),s.jsxs("select",{value:h,onChange:e=>o(e.target.value),className:"form-select",disabled:j,children:[s.jsx("option",{value:"",children:"Personal auswÃ¤hlen..."}),c.map(e=>s.jsxs("option",{value:e.personal_id,children:[e.vorname," ",e.nachname," - ",e.position," (â‚¬",e.stundenlohn,"/h)"]},e.personal_id))]})]}),f&&s.jsx("div",{className:"selected-personal-info",children:s.jsxs("div",{className:"personal-info-card",children:[s.jsxs("strong",{children:[f.vorname," ",f.nachname]}),s.jsxs("div",{className:"personal-details",children:[s.jsx("span",{className:"position-tag",children:f.position}),s.jsxs("span",{className:"hourly-rate",children:["â‚¬",f.stundenlohn,"/Stunde"]})]})]})}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"ğŸ“ Bemerkung (optional):"}),s.jsx("input",{type:"text",value:m,onChange:e=>u(e.target.value),placeholder:"z.B. FrÃ¼hdienst, SpÃ¤tdienst...",className:"form-input",disabled:j})]}),s.jsx("button",{onClick:async()=>{var e,s;if(h)try{x(!0),await a.post("/personalCheckin",{personal_id:h,bemerkung:m}),o(""),u(""),p(),alert("Personal erfolgreich eingecheckt!")}catch(n){console.error("âŒ Fehler beim Einchecken:",n),alert("Fehler beim Einchecken: "+((null==(s=null==(e=n.response)?void 0:e.data)?void 0:s.error)||n.message))}finally{x(!1)}else alert("Bitte Personal auswÃ¤hlen!")},disabled:j||!h,className:"checkin-button",children:j?"ğŸ”„ Wird eingecheckt...":"âœ… Einchecken"})]})]}),s.jsxs("div",{className:"checkins-list",children:[s.jsxs("h3",{children:["ğŸ“‹ Heutige Check-ins (",v,")"]}),j&&s.jsx("div",{className:"loading",children:"ğŸ”„ Lade..."}),0===l.length&&!j&&s.jsx("div",{className:"no-checkins-message",children:s.jsxs("div",{className:"empty-state",children:[s.jsx("div",{className:"empty-icon",children:"ğŸ“…"}),s.jsx("h4",{children:"Keine Check-ins vorhanden"}),s.jsx("p",{children:"FÃ¼r das ausgewÃ¤hlte Datum sind noch keine Personal Check-ins vorhanden."})]})}),s.jsx("div",{className:"checkins-grid",children:l.map((e,n)=>{var c;return s.jsxs("div",{className:`checkin-card ${e.status}`,style:{animationDelay:.1*n+"s"},children:[s.jsxs("div",{className:"checkin-card-header",children:[s.jsxs("div",{className:"personal-name",children:[e.vorname," ",e.nachname]}),s.jsx("div",{className:`status-badge ${e.status}`,children:"eingecheckt"===e.status?"ğŸŸ¢ Eingecheckt":"ğŸ”´ Ausgecheckt"})]}),s.jsxs("div",{className:"checkin-card-content",children:[s.jsxs("div",{className:"checkin-field",children:[s.jsx("label",{children:"ğŸ‘¤ Position:"}),s.jsx("span",{className:"checkin-value position-tag",children:e.position})]}),s.jsxs("div",{className:"checkin-field",children:[s.jsx("label",{children:"ğŸ• Check-in:"}),s.jsx("span",{className:"checkin-value time-value",children:b(e.checkin_time)})]}),e.checkout_time&&s.jsxs("div",{className:"checkin-field",children:[s.jsx("label",{children:"ğŸ•‘ Check-out:"}),s.jsx("span",{className:"checkin-value time-value",children:b(e.checkout_time)})]}),s.jsxs("div",{className:"checkin-field",children:[s.jsx("label",{children:"â±ï¸ Arbeitszeit:"}),s.jsx("span",{className:"checkin-value duration-value",children:g(e.aktuelle_arbeitszeit_minuten)})]}),s.jsxs("div",{className:"checkin-field",children:[s.jsx("label",{children:"ğŸ’° Kosten:"}),s.jsxs("span",{className:"checkin-value cost-value",children:["â‚¬",(null==(c=e.aktuelle_kosten)?void 0:c.toFixed(2))||"0.00"]})]}),s.jsxs("div",{className:"checkin-field",children:[s.jsx("label",{children:"ğŸ’µ Stundenlohn:"}),s.jsxs("span",{className:"checkin-value",children:["â‚¬",e.stundenlohn,"/h"]})]}),e.bemerkung&&s.jsxs("div",{className:"checkin-field",children:[s.jsx("label",{children:"ğŸ“ Bemerkung:"}),s.jsx("span",{className:"checkin-value",children:e.bemerkung})]})]}),"eingecheckt"===e.status&&s.jsx("div",{className:"checkin-card-actions",children:s.jsx("button",{onClick:()=>(async e=>{var s,n;if(window.confirm("Personal auschecken?"))try{x(!0);const s=await a.put(`/personalCheckin/${e}/checkout`);p(),alert(s.data.message)}catch(c){console.error("âŒ Fehler beim Auschecken:",c),alert("Fehler beim Auschecken: "+((null==(n=null==(s=c.response)?void 0:s.data)?void 0:n.error)||c.message))}finally{x(!1)}})(e.checkin_id),disabled:j,className:"checkout-button",children:"ğŸ”´ Auschecken"})})]},e.checkin_id)})})]})]})};export{n as default};
