import{j as e}from"./animation-1wuIdCBS.js";import{r as s}from"./vendor-router-BhMXg4Z-.js";import{b as i,a as t}from"./index-DUnH23_2.js";import{c as n,v as l,F as r,aY as a,aU as o,E as d,j as c,R as p,N as x,g as u,k as f,bg as g}from"./icons-D7rg4pDH.js";import"./vendor-react-DtuzQOD1.js";import"./query-Bs1dTGah.js";const h=()=>{var u,f,g,h;const{activeDojo:m}=i(),[v,_]=s.useState(!0),[z,S]=s.useState(!1),[k,I]=s.useState(null),[T,B]=s.useState({}),[C,E]=s.useState({}),[R,w]=s.useState({paypal_client_id:"",paypal_client_secret:"",paypal_sandbox:!0,lexoffice_api_key:"",datev_consultant_number:"",datev_client_number:""}),D=(null==m?void 0:m.id)||m;s.useEffect(()=>{D&&"super-admin"!==D&&(L(),F())},[D]);const L=async()=>{try{_(!0);const e=await t.get(`/integrations/config?dojo_id=${D}`);e.data&&w(s=>({...s,...e.data}))}catch(e){console.error("Fehler beim Laden der Konfiguration:",e)}finally{_(!1)}},F=async()=>{try{const e=await t.get(`/integrations/status?dojo_id=${D}`);I(e.data)}catch(e){console.error("Fehler beim Laden des Status:",e)}},P=async e=>{try{E(s=>({...s,[e]:{loading:!0}}));const s=await t.post(`/integrations/${e}/test?dojo_id=${D}`);E(i=>({...i,[e]:{success:s.data.success,message:s.data.message}}))}catch(s){E(i=>{var t,n;return{...i,[e]:{success:!1,message:(null==(n=null==(t=s.response)?void 0:t.data)?void 0:n.error)||"Verbindung fehlgeschlagen"}}})}},A=e=>{B(s=>({...s,[e]:!s[e]}))};return v?e.jsx("div",{style:j.container,children:e.jsx("div",{style:j.loading,children:"Lade Einstellungen..."})}):e.jsxs("div",{style:j.container,children:[e.jsxs("div",{style:j.header,children:[e.jsx(n,{size:32,color:"#ffd700"}),e.jsxs("div",{children:[e.jsx("h2",{style:j.title,children:"Integration-Einstellungen"}),e.jsx("p",{style:j.subtitle,children:"Konfiguriere PayPal, LexOffice und DATEV"})]})]}),k&&e.jsxs("div",{style:j.statusGrid,children:[e.jsx(y,{title:"PayPal",icon:e.jsx(l,{size:24}),configured:null==(u=k.paypal)?void 0:u.configured,mode:(null==(f=k.paypal)?void 0:f.sandbox)?"Sandbox":"Live"}),e.jsx(y,{title:"LexOffice",icon:e.jsx(r,{size:24}),configured:null==(g=k.lexoffice)?void 0:g.configured}),e.jsx(y,{title:"DATEV",icon:e.jsx(a,{size:24}),configured:null==(h=k.datev)?void 0:h.configured})]}),e.jsxs("div",{style:j.section,children:[e.jsxs("div",{style:j.sectionHeader,children:[e.jsx(l,{size:24,color:"#0070ba"}),e.jsx("h3",{style:j.sectionTitle,children:"PayPal"}),e.jsxs("a",{href:"https://developer.paypal.com/dashboard/applications",target:"_blank",rel:"noopener noreferrer",style:j.helpLink,children:[e.jsx(o,{size:14})," Entwickler-Dashboard"]})]}),e.jsx("div",{style:j.infoBox,children:e.jsx("p",{children:"Um PayPal zu nutzen, erstelle eine App im PayPal Developer Dashboard und kopiere die Client ID und das Secret hierher."})}),e.jsx("div",{style:j.formRow,children:e.jsxs("div",{style:j.formGroup,children:[e.jsx("label",{style:j.label,children:"Client ID"}),e.jsx("input",{type:"text",value:R.paypal_client_id||"",onChange:e=>w({...R,paypal_client_id:e.target.value}),style:j.input,placeholder:"AV9b8ND..."})]})}),e.jsx("div",{style:j.formRow,children:e.jsxs("div",{style:j.formGroup,children:[e.jsx("label",{style:j.label,children:"Client Secret"}),e.jsxs("div",{style:j.secretInput,children:[e.jsx("input",{type:T.paypal?"text":"password",value:R.paypal_client_secret||"",onChange:e=>w({...R,paypal_client_secret:e.target.value}),style:{...j.input,flex:1},placeholder:"EK3qE9N..."}),e.jsx("button",{style:j.eyeButton,onClick:()=>A("paypal"),children:T.paypal?e.jsx(d,{size:18}):e.jsx(c,{size:18})})]})]})}),e.jsx("div",{style:j.formRow,children:e.jsxs("label",{style:j.checkboxLabel,children:[e.jsx("input",{type:"checkbox",checked:R.paypal_sandbox,onChange:e=>w({...R,paypal_sandbox:e.target.checked})}),e.jsx("span",{children:"Sandbox-Modus (Test-Umgebung)"})]})}),e.jsx(b,{service:"paypal",onTest:()=>P("paypal"),result:C.paypal,disabled:!R.paypal_client_id||!R.paypal_client_secret})]}),e.jsxs("div",{style:j.section,children:[e.jsxs("div",{style:j.sectionHeader,children:[e.jsx(r,{size:24,color:"#0066cc"}),e.jsx("h3",{style:j.sectionTitle,children:"LexOffice"}),e.jsxs("a",{href:"https://app.lexoffice.de/addons/public-api",target:"_blank",rel:"noopener noreferrer",style:j.helpLink,children:[e.jsx(o,{size:14})," API-Schlüssel generieren"]})]}),e.jsx("div",{style:j.infoBox,children:e.jsx("p",{children:"Der API-Schlüssel wird in LexOffice unter Einstellungen → Erweiterungen → Public API generiert."})}),e.jsx("div",{style:j.formRow,children:e.jsxs("div",{style:j.formGroup,children:[e.jsx("label",{style:j.label,children:"API-Schlüssel"}),e.jsxs("div",{style:j.secretInput,children:[e.jsx("input",{type:T.lexoffice?"text":"password",value:R.lexoffice_api_key||"",onChange:e=>w({...R,lexoffice_api_key:e.target.value}),style:{...j.input,flex:1},placeholder:"a1b2c3d4-e5f6-..."}),e.jsx("button",{style:j.eyeButton,onClick:()=>A("lexoffice"),children:T.lexoffice?e.jsx(d,{size:18}):e.jsx(c,{size:18})})]})]})}),e.jsx(b,{service:"lexoffice",onTest:()=>P("lexoffice"),result:C.lexoffice,disabled:!R.lexoffice_api_key})]}),e.jsxs("div",{style:j.section,children:[e.jsxs("div",{style:j.sectionHeader,children:[e.jsx(a,{size:24,color:"#006633"}),e.jsx("h3",{style:j.sectionTitle,children:"DATEV"})]}),e.jsx("div",{style:j.infoBox,children:e.jsx("p",{children:"Die Beraternummer und Mandantennummer werden vom Steuerberater bereitgestellt und sind für den DATEV-Export erforderlich."})}),e.jsxs("div",{style:j.formRow,children:[e.jsxs("div",{style:j.formGroup,children:[e.jsx("label",{style:j.label,children:"Beraternummer"}),e.jsx("input",{type:"text",value:R.datev_consultant_number||"",onChange:e=>w({...R,datev_consultant_number:e.target.value}),style:j.input,placeholder:"12345",maxLength:7})]}),e.jsxs("div",{style:j.formGroup,children:[e.jsx("label",{style:j.label,children:"Mandantennummer"}),e.jsx("input",{type:"text",value:R.datev_client_number||"",onChange:e=>w({...R,datev_client_number:e.target.value}),style:j.input,placeholder:"10001",maxLength:5})]})]}),e.jsxs("div",{style:j.datevInfo,children:[e.jsx("h4",{style:{color:"#ffd700",margin:"0 0 8px 0"},children:"DATEV-Export Formate:"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"20px",color:"#aaa"},children:[e.jsx("li",{children:"Buchungsstapel (Rechnungen) - EXTF Format"}),e.jsx("li",{children:"Zahlungen - EXTF Format"}),e.jsx("li",{children:"Debitoren-Stammdaten - ASCII Format"})]})]})]}),e.jsx("div",{style:j.footer,children:e.jsx("button",{style:j.saveButton,onClick:async()=>{var e,s;try{S(!0),await t.post(`/integrations/config?dojo_id=${D}`,R),alert("Einstellungen gespeichert!"),F()}catch(i){console.error("Fehler beim Speichern:",i),alert((null==(s=null==(e=i.response)?void 0:e.data)?void 0:s.error)||"Fehler beim Speichern")}finally{S(!1)}},disabled:z,children:z?e.jsxs(e.Fragment,{children:[e.jsx(p,{size:18,className:"spinning"})," Speichern..."]}):e.jsxs(e.Fragment,{children:[e.jsx(x,{size:18})," Einstellungen speichern"]})})})]})},y=({title:s,icon:i,configured:t,mode:n})=>e.jsxs("div",{style:{...j.statusCard,borderColor:t?"rgba(34, 197, 94, 0.5)":"rgba(255, 255, 255, 0.1)"},children:[e.jsx("div",{style:j.statusIcon,children:i}),e.jsxs("div",{style:j.statusInfo,children:[e.jsx("strong",{children:s}),e.jsxs("span",{style:{color:t?"#22c55e":"#ef4444",fontSize:"12px"},children:[t?"Konfiguriert":"Nicht konfiguriert",n&&t&&` (${n})`]})]}),t?e.jsx(u,{size:20,color:"#22c55e"}):e.jsx(f,{size:20,color:"#666"})]}),b=({service:s,onTest:i,result:t,disabled:n})=>e.jsxs("div",{style:j.testSection,children:[e.jsx("button",{style:{...j.testButton,opacity:n?.5:1},onClick:i,disabled:n||(null==t?void 0:t.loading),children:(null==t?void 0:t.loading)?e.jsxs(e.Fragment,{children:[e.jsx(p,{size:16,className:"spinning"})," Teste..."]}):e.jsxs(e.Fragment,{children:[e.jsx(g,{size:16})," Verbindung testen"]})}),t&&!t.loading&&e.jsxs("div",{style:{...j.testResult,background:t.success?"rgba(34, 197, 94, 0.1)":"rgba(239, 68, 68, 0.1)",borderColor:t.success?"#22c55e":"#ef4444"},children:[t.success?e.jsx(u,{size:16,color:"#22c55e"}):e.jsx(f,{size:16,color:"#ef4444"}),e.jsx("span",{children:t.message})]})]}),j={container:{padding:"24px",maxWidth:"900px",margin:"0 auto"},header:{display:"flex",alignItems:"center",gap:"16px",marginBottom:"32px"},title:{color:"#ffd700",margin:0,fontSize:"24px"},subtitle:{color:"#aaa",margin:"4px 0 0 0",fontSize:"14px"},statusGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",marginBottom:"32px"},statusCard:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid",borderRadius:"12px"},statusIcon:{color:"#ffd700"},statusInfo:{flex:1,display:"flex",flexDirection:"column",color:"#fff"},section:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 215, 0, 0.2)",borderRadius:"12px",padding:"24px",marginBottom:"20px"},sectionHeader:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px"},sectionTitle:{color:"#fff",margin:0,fontSize:"18px",flex:1},helpLink:{display:"flex",alignItems:"center",gap:"4px",color:"#ffd700",textDecoration:"none",fontSize:"13px"},infoBox:{background:"rgba(59, 130, 246, 0.1)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"8px",padding:"12px 16px",marginBottom:"20px",color:"#aaa",fontSize:"14px"},formRow:{display:"flex",gap:"16px",marginBottom:"16px"},formGroup:{flex:1},label:{display:"block",color:"#ffd700",marginBottom:"8px",fontSize:"14px"},input:{width:"100%",padding:"12px",background:"rgba(0, 0, 0, 0.3)",border:"1px solid rgba(255, 215, 0, 0.3)",borderRadius:"8px",color:"#fff",fontSize:"14px",boxSizing:"border-box"},secretInput:{display:"flex",gap:"8px"},eyeButton:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",padding:"12px",color:"#fff",cursor:"pointer"},checkboxLabel:{display:"flex",alignItems:"center",gap:"8px",color:"#fff",cursor:"pointer",fontSize:"14px"},testSection:{display:"flex",alignItems:"center",gap:"16px",marginTop:"16px",paddingTop:"16px",borderTop:"1px solid rgba(255, 255, 255, 0.1)"},testButton:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 16px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",color:"#fff",cursor:"pointer",fontSize:"14px"},testResult:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 16px",borderRadius:"8px",border:"1px solid",fontSize:"13px"},datevInfo:{background:"rgba(0, 102, 51, 0.1)",border:"1px solid rgba(0, 102, 51, 0.3)",borderRadius:"8px",padding:"16px",marginTop:"16px"},footer:{display:"flex",justifyContent:"flex-end",marginTop:"24px"},saveButton:{display:"flex",alignItems:"center",gap:"8px",padding:"14px 28px",background:"#ffd700",border:"none",borderRadius:"8px",color:"#1a1a2e",fontWeight:"bold",fontSize:"16px",cursor:"pointer"},loading:{textAlign:"center",padding:"60px",color:"#888"}};export{h as default};
