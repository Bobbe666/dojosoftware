import{j as e}from"./animation-1wuIdCBS.js";import{r as n}from"./vendor-router-BhMXg4Z-.js";import{k as s,c as a}from"./index-DUnH23_2.js";import"./vendor-react-DtuzQOD1.js";import"./query-Bs1dTGah.js";import"./icons-D7rg4pDH.js";const r=()=>{var r;const[i,t]=n.useState([]),[l,c]=n.useState(!0),[d,o]=n.useState(null),[u,h]=n.useState(!1),[p,m]=n.useState(null),[b,g]=n.useState(null),[x,j]=n.useState(""),[v,k]=n.useState("all"),[N,f]=n.useState({name:"",beschreibung:"",parent_id:null,sortierung:0,icon:"",farbe:"#4A90E2",aktiv:!0});n.useEffect(()=>{y()},[]);const y=async()=>{try{c(!0);const e=await s(`${a.apiBaseUrl}/artikelgruppen`),n=await e.json();if(n.success){if(t(n.data),o(null),b){const e=n.data.find(e=>e.id===b.id);g(e||null)}}else o(n.message||"Fehler beim Laden der Artikelgruppen")}catch(e){o("Verbindungsfehler beim Laden der Artikelgruppen"),console.error("Fehler beim Laden der Artikelgruppen:",e)}finally{c(!1)}},C=(e=null)=>{e&&e.id?(m(e),f({name:e.name,beschreibung:e.beschreibung||"",parent_id:e.parent_id,sortierung:e.sortierung,icon:e.icon||"",farbe:e.farbe||"#4A90E2",aktiv:e.aktiv})):e&&e.parent_id?(m(null),f({name:"",beschreibung:"",parent_id:e.parent_id,sortierung:0,icon:"",farbe:"#4A90E2",aktiv:!0})):(m(null),f({name:"",beschreibung:"",parent_id:null,sortierung:0,icon:"",farbe:"#4A90E2",aktiv:!0})),h(!0)},w=()=>{h(!1),m(null),f({name:"",beschreibung:"",parent_id:null,sortierung:0,icon:"",farbe:"#4A90E2",aktiv:!0})},_=e=>{const{name:n,value:s,type:a,checked:r}=e.target;f(e=>({...e,[n]:"checkbox"===a?r:s}))},A=async e=>{if(window.confirm(`MÃ¶chten Sie die Gruppe "${e.name}" wirklich lÃ¶schen?`))try{const n=await s(`${a.apiBaseUrl}/artikelgruppen/${e.id}`,{method:"DELETE"}),r=await n.json();r.success?await y():o(r.message||"Fehler beim LÃ¶schen")}catch(n){o("Verbindungsfehler beim LÃ¶schen"),console.error("Fehler beim LÃ¶schen:",n)}},S=e=>{g(e)},L=i.filter(e=>{var n;const s=e.name.toLowerCase().includes(x.toLowerCase())||(null==(n=e.beschreibung)?void 0:n.toLowerCase().includes(x.toLowerCase()));return"hauptkategorien"===v?s&&null===e.parent_id:"unterkategorien"===v?s&&null!==e.parent_id:s});return l?e.jsx("div",{className:"artikelgruppen-verwaltung",children:e.jsxs("div",{className:"loading-container",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Lade Artikelgruppen..."})]})}):e.jsxs("div",{className:"artikelgruppen-verwaltung",children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{className:"page-header-top",children:[e.jsxs("div",{className:"header-content",children:[e.jsx("h1",{children:"Artikelgruppen-Verwaltung"}),e.jsx("p",{children:"Kategorien und Unterkategorien verwalten"})]}),b&&e.jsx("button",{className:"btn-secondary",onClick:()=>{g(null)},children:"â† ZurÃ¼ck zur Ãœbersicht"})]}),!b&&e.jsxs("div",{className:"header-controls",children:[e.jsxs("div",{className:"search-box",children:[e.jsx("input",{type:"text",placeholder:"Gruppen suchen...",value:x,onChange:e=>j(e.target.value)}),e.jsx("span",{className:"search-icon",children:"ðŸ”"})]}),e.jsxs("select",{value:v,onChange:e=>k(e.target.value),className:"filter-select",children:[e.jsx("option",{value:"all",children:"Alle Gruppen"}),e.jsx("option",{value:"hauptkategorien",children:"Nur Hauptkategorien"}),e.jsx("option",{value:"unterkategorien",children:"Nur Unterkategorien"})]}),e.jsx("button",{className:"btn-primary",onClick:()=>C(),children:"+ Neue Gruppe"})]})]}),d&&e.jsxs("div",{className:"error-message",children:[e.jsx("span",{children:d}),e.jsx("button",{onClick:()=>o(null),children:"âœ•"})]}),b?e.jsxs("div",{className:"group-detail-view",children:[e.jsxs("div",{className:"detail-header",children:[e.jsxs("div",{className:"detail-header-content",children:[e.jsx("div",{className:"detail-icon",style:{color:b.farbe},children:b.icon||"ðŸ“"}),e.jsxs("div",{children:[e.jsx("h2",{children:b.name}),b.beschreibung&&e.jsx("p",{className:"detail-description",children:b.beschreibung}),e.jsxs("div",{className:"detail-stats",children:[e.jsxs("span",{className:"stat",children:["ðŸ‘¥ ",e.jsx("strong",{children:b.artikel_anzahl||0})," Artikel"]}),e.jsxs("span",{className:"stat",children:["ðŸ“‚ ",e.jsx("strong",{children:(null==(r=b.unterkategorien)?void 0:r.length)||0})," Unterkategorien"]})]})]})]}),e.jsxs("div",{className:"detail-actions sub-tabs",children:[e.jsx("button",{className:"sub-tab-btn",onClick:()=>C(b),title:"Gruppe bearbeiten",children:"âœï¸ Bearbeiten"}),e.jsx("button",{className:"sub-tab-btn",onClick:()=>C({parent_id:b.id}),title:"Unterkategorie hinzufÃ¼gen",children:"âž• Unterkategorie"})]})]}),e.jsxs("div",{className:"unterkategorien-section",children:[e.jsx("h3",{children:"Unterkategorien"}),b.unterkategorien&&b.unterkategorien.length>0?e.jsx("div",{className:"unterkategorien-grid",children:b.unterkategorien.map(n=>e.jsxs("div",{className:"unterkategorie-detail-card",children:[e.jsxs("div",{className:"unterkategorie-detail-header",children:[e.jsx("div",{className:"unterkategorie-icon",style:{color:n.farbe},children:n.icon||"ðŸ“‚"}),e.jsxs("div",{className:"unterkategorie-detail-info",children:[e.jsx("h4",{children:n.name}),n.beschreibung&&e.jsx("p",{children:n.beschreibung}),e.jsxs("div",{className:"unterkategorie-stat",children:[e.jsx("strong",{children:n.artikel_anzahl||0})," Artikel"]})]})]}),e.jsxs("div",{className:"unterkategorie-detail-actions sub-tabs",children:[e.jsx("button",{className:"sub-tab-btn details-btn",onClick:()=>S(n),title:"Details anzeigen",children:"ðŸ“‹ Details"}),e.jsx("button",{className:"sub-tab-btn edit-btn",onClick:()=>C(n),title:"Bearbeiten",children:"âœï¸ Bearbeiten"}),e.jsx("button",{className:"sub-tab-btn delete-btn",onClick:()=>A(n),title:"LÃ¶schen",children:"ðŸ—‘ï¸ LÃ¶schen"})]})]},n.id))}):e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"ðŸ“‚"}),e.jsx("h3",{children:"Noch keine Unterkategorien"}),e.jsx("p",{children:"FÃ¼gen Sie die erste Unterkategorie fÃ¼r diese Gruppe hinzu"}),e.jsx("button",{className:"sub-tab-btn",onClick:()=>C({parent_id:b.id}),children:"Erste Unterkategorie erstellen"})]})]})]}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"groups-container",children:0===L.length?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"ðŸ“"}),e.jsx("h3",{children:"Keine Gruppen gefunden"}),e.jsx("p",{children:x?`Keine Gruppen gefunden fÃ¼r "${x}"`:"Noch keine Artikelgruppen vorhanden"}),!x&&e.jsx("button",{className:"sub-tab-btn",onClick:()=>C(),children:"Erste Gruppe erstellen"})]}):e.jsx("div",{className:"groups-grid",children:L.map(n=>{const s=n.unterkategorien&&n.unterkategorien.length>0;return e.jsxs("div",{className:"group-card",children:[e.jsx("div",{className:"group-header",children:e.jsxs("div",{className:"group-info",children:[e.jsx("div",{className:"group-icon",style:{color:n.farbe},children:n.icon||"ðŸ“"}),e.jsxs("div",{className:"group-details",children:[e.jsx("h3",{className:"group-name",children:n.name}),n.beschreibung&&e.jsx("p",{className:"group-description",children:n.beschreibung}),e.jsxs("div",{className:"group-stats",children:[e.jsxs("span",{className:"stat",children:[e.jsx("strong",{children:n.artikel_anzahl||0})," Artikel"]}),s&&e.jsxs("span",{className:"stat",children:[e.jsx("strong",{children:n.unterkategorien.length})," Unterkategorien"]})]})]})]})}),e.jsxs("div",{className:"group-actions sub-tabs",children:[e.jsx("button",{className:"sub-tab-btn details-btn",onClick:()=>S(n),title:"Details anzeigen",children:"ðŸ“‹ Details"}),e.jsx("button",{className:"sub-tab-btn edit-btn",onClick:()=>C(n),title:"Bearbeiten","aria-label":`Gruppe ${n.name} bearbeiten`,children:"âœï¸ Bearbeiten"}),e.jsx("button",{className:"sub-tab-btn delete-btn",onClick:()=>A(n),title:"LÃ¶schen","aria-label":`Gruppe ${n.name} lÃ¶schen`,children:"ðŸ—‘ï¸ LÃ¶schen"})]})]},n.id)})})})}),u&&e.jsx("div",{className:"modal-overlay",onClick:e=>{e.target===e.currentTarget&&w()},children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:p?"Gruppe bearbeiten":"Neue Gruppe erstellen"}),e.jsx("button",{className:"close-btn",onClick:w,children:"âœ•"})]}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{const e=p?`${a.apiBaseUrl}/artikelgruppen/${p.id}`:`${a.apiBaseUrl}/artikelgruppen`,n=p?"PUT":"POST",r=await s(e,{method:n,headers:{"Content-Type":"application/json"},body:JSON.stringify(N)}),i=await r.json();i.success?(await y(),w()):o(i.message||"Fehler beim Speichern")}catch(n){o("Verbindungsfehler beim Speichern"),console.error("Fehler beim Speichern:",n)}},className:"group-form",children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"name",children:"Name *"}),e.jsx("input",{type:"text",id:"name",name:"name",value:N.name,onChange:_,required:!0,placeholder:"z.B. Bekleidung"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"sortierung",children:"Sortierung"}),e.jsx("input",{type:"number",id:"sortierung",name:"sortierung",value:N.sortierung,onChange:_,min:"0"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"beschreibung",children:"Beschreibung"}),e.jsx("textarea",{id:"beschreibung",name:"beschreibung",value:N.beschreibung,onChange:_,rows:"3",placeholder:"Beschreibung der Gruppe..."})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"parent_id",children:"Hauptkategorie"}),e.jsxs("select",{id:"parent_id",name:"parent_id",value:N.parent_id||"",onChange:_,children:[e.jsx("option",{value:"",children:"Hauptkategorie (keine)"}),i.filter(e=>null===e.parent_id).map(n=>e.jsx("option",{value:n.id,children:n.name},n.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"icon",children:"Icon (Emoji)"}),e.jsx("input",{type:"text",id:"icon",name:"icon",value:N.icon,onChange:_,placeholder:"ðŸ‘•",maxLength:"2"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"farbe",children:"Farbe"}),e.jsxs("div",{className:"color-input-group",children:[e.jsx("input",{type:"color",id:"farbe",name:"farbe",value:N.farbe,onChange:_}),e.jsx("input",{type:"text",name:"farbe",value:N.farbe,onChange:_,placeholder:"#4A90E2",className:"color-text-input"})]})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",name:"aktiv",checked:N.aktiv,onChange:_}),"Gruppe ist aktiv"]})}),e.jsxs("div",{className:"modal-footer sub-tabs",children:[e.jsx("button",{type:"button",className:"sub-tab-btn",onClick:w,children:"Abbrechen"}),e.jsx("button",{type:"submit",className:"sub-tab-btn",children:p?"Aktualisieren":"Erstellen"})]})]})]})})]})};export{r as default};
