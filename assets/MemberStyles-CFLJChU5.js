import{j as e}from"./animation-1wuIdCBS.js";import{r as s}from"./vendor-router-BhMXg4Z-.js";import{u as i,k as n,c as a}from"./index-DUnH23_2.js";import r from"./MemberHeader-B9i2VG32.js";import{a5 as d,n as l,A as t,C as c,q as u}from"./icons-D7rg4pDH.js";import"./vendor-react-DtuzQOD1.js";import"./query-Bs1dTGah.js";/* empty css                  */const o=()=>{const{user:o}=i(),[h,m]=s.useState([]),[g,j]=s.useState({}),[x,v]=s.useState([]),[N,p]=s.useState(!0),[f,b]=s.useState(0),[_,y]=s.useState({});s.useEffect(()=>{(null==o?void 0:o.email)&&k()},[null==o?void 0:o.email]);const k=async()=>{try{const e=await n(`/mitglieder/by-email/${encodeURIComponent(o.email)}`);if(!e.ok)return;const s=await e.json();await z(),await S(s.mitglied_id)}catch(e){console.error("Fehler beim Laden der Mitgliedsdaten:",e)}finally{p(!1)}},z=async()=>{try{const e=await n(`${a.apiBaseUrl}/stile`);if(e.ok){const s=await e.json();v(s)}}catch(e){console.error("Fehler beim Laden der Stile:",e)}},S=async e=>{try{const s=await n(`/mitglieder/${e}/stile`);if(s.ok){const i=await s.json();i.success&&i.stile&&(m(i.stile),i.stile.forEach(async s=>{await w(e,s.stil_id)}))}}catch(s){console.error("Fehler beim Laden der Mitglied-Stile:",s)}},w=async(e,s)=>{try{const i=await n(`/mitglieder/${e}/stil/${s}/data`);if(i.ok){const e=await i.json();j(i=>({...i,[s]:e.data})),L(s,e.data)}}catch(i){console.error(`Fehler beim Laden stilspezifischer Daten f√ºr Stil ${s}:`,i)}},L=(e,s)=>{const i=x.find(s=>s.stil_id===e);if(!(null==i?void 0:i.graduierungen)||!s)return;const n=s.current_graduierung_id,a=i.graduierungen.findIndex(e=>e.graduierung_id===n);if(-1===a||a>=i.graduierungen.length-1)return void y(s=>({...s,[e]:null}));const r=i.graduierungen[a+1],d=s.stunden_seit_letzter_pruefung||0,l=r.min_stunden||0,t=Math.max(0,l-d);y(s=>({...s,[e]:{hoursNeeded:t,hoursCompleted:d,requiredHours:l,nextGraduation:r.name,progress:Math.min(100,d/l*100)}}))},M=e=>e?new Date(e).toLocaleDateString("de-DE"):"Nicht angegeben";return N?e.jsxs("div",{className:"dashboard-container",children:[e.jsx(r,{}),e.jsx("div",{className:"dashboard-content",children:e.jsxs("div",{className:"member-styles-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Lade Stil & Gurt Daten..."})]})})]}):e.jsxs("div",{className:"dashboard-container",children:[e.jsx(r,{}),e.jsx("div",{className:"dashboard-content",children:e.jsxs("div",{className:"member-styles",children:[e.jsxs("div",{className:"styles-header",children:[e.jsxs("h1",{children:[e.jsx(d,{size:24}),"Meine Kampfkunst-Stile"]}),e.jsx("p",{children:"Verwalte deine Stile, Graduierungen und Pr√ºfungen"})]}),Object.values(_).some(e=>null!==e)&&e.jsxs("div",{className:"training-tracker-section",children:[e.jsxs("h2",{children:[e.jsx(l,{size:20}),"Trainingsstunden-Tracker"]}),e.jsx("div",{className:"tracker-grid",children:Object.entries(_).map(([s,i])=>{if(!i)return null;const n=h.find(e=>e.stil_id===parseInt(s));return n?e.jsxs("div",{className:"tracker-card",children:[e.jsxs("div",{className:"tracker-header",children:[e.jsx("h3",{children:n.name}),e.jsxs("div",{className:"tracker-badge",children:[e.jsx("span",{children:"üéØ"}),e.jsx("span",{children:i.nextGraduation})]})]}),e.jsxs("div",{className:"tracker-progress",children:[e.jsx("div",{className:"progress-bar",children:e.jsx("div",{className:"progress-fill",style:{width:`${i.progress}%`}})}),e.jsxs("div",{className:"progress-info",children:[e.jsxs("span",{className:"progress-text",children:[i.hoursCompleted,"h / ",i.requiredHours,"h"]}),e.jsxs("span",{className:"progress-percentage",children:[Math.round(i.progress),"%"]})]})]}),e.jsx("div",{className:"tracker-details",children:i.hoursNeeded>0?e.jsxs("div",{className:"hours-needed",children:[e.jsx("span",{className:"hours-label",children:"Noch ben√∂tigt:"}),e.jsxs("span",{className:"hours-value",children:[i.hoursNeeded," Stunden"]})]}):e.jsx("div",{className:"hours-ready",children:e.jsx("span",{children:"‚úÖ Bereit f√ºr Pr√ºfung!"})})})]},s):null})})]}),0===h.length?e.jsxs("div",{className:"no-styles",children:[e.jsx(d,{size:48}),e.jsx("h3",{children:"Noch keine Stile zugewiesen"}),e.jsx("p",{children:"Wende dich an deinen Trainer, um Stile zuzuweisen."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"style-tabs",children:h.map((s,i)=>{const n=x.find(e=>e.stil_id===s.stil_id);return e.jsxs("button",{className:"style-tab "+(f===i?"active":""),onClick:()=>b(i),children:[e.jsx(d,{size:16}),(null==n?void 0:n.name)||s.name]},s.stil_id)})}),h.map((s,i)=>{var n,a;if(f!==i)return null;const r=x.find(e=>e.stil_id===s.stil_id),l=g[s.stil_id],o=(null==l?void 0:l.current_graduierung_id)?null==(n=null==r?void 0:r.graduierungen)?void 0:n.find(e=>e.graduierung_id===l.current_graduierung_id):null==(a=null==r?void 0:r.graduierungen)?void 0:a[0];return e.jsxs("div",{className:"style-content",children:[e.jsxs("div",{className:"style-header",children:[e.jsxs("div",{className:"style-info",children:[e.jsxs("h2",{children:[e.jsx(d,{size:20}),(null==r?void 0:r.name)||s.name]}),e.jsx("p",{className:"style-description",children:(null==r?void 0:r.beschreibung)||"Kampfkunst-Stil"})]}),e.jsx("div",{className:"current-graduation",children:o&&e.jsxs("div",{className:"graduation-badge",children:[e.jsx(t,{size:16}),e.jsx("span",{children:o.name})]})})]}),(null==r?void 0:r.graduierungen)&&r.graduierungen.length>0&&e.jsxs("div",{className:"graduations-section",children:[e.jsxs("h3",{children:[e.jsx(t,{size:18}),"Graduierungen"]}),e.jsx("div",{className:"graduations-list",children:r.graduierungen.map((s,i)=>e.jsxs("div",{className:"graduation-item "+((null==o?void 0:o.graduierung_id)===s.graduierung_id?"current":""),children:[e.jsxs("div",{className:"graduation-rank",children:[i+1,"."]}),e.jsxs("div",{className:"graduation-info",children:[e.jsx("span",{className:"graduation-name",children:s.name}),s.beschreibung&&e.jsx("span",{className:"graduation-description",children:s.beschreibung})]}),(null==o?void 0:o.graduierung_id)===s.graduierung_id&&e.jsx("div",{className:"current-indicator",children:"Aktuell"})]},s.graduierung_id))})]}),e.jsxs("div",{className:"exam-section",children:[e.jsxs("h3",{children:[e.jsx(c,{size:18}),"Pr√ºfungsdaten"]}),e.jsxs("div",{className:"exam-details",children:[e.jsxs("div",{className:"exam-item",children:[e.jsx("label",{children:"Letzte Pr√ºfung:"}),e.jsx("span",{children:M(null==l?void 0:l.letzte_pruefung)})]}),e.jsxs("div",{className:"exam-item",children:[e.jsx("label",{children:"N√§chste Pr√ºfung:"}),e.jsx("span",{children:M(null==l?void 0:l.naechste_pruefung)})]}),(null==l?void 0:l.anmerkungen)&&e.jsxs("div",{className:"exam-item",children:[e.jsx("label",{children:"Anmerkungen:"}),e.jsx("span",{children:l.anmerkungen})]})]})]}),e.jsxs("div",{className:"training-section",children:[e.jsxs("h3",{children:[e.jsx(u,{size:18}),"Trainingsfortschritt"]}),e.jsxs("div",{className:"training-stats",children:[e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-label",children:"Trainingsstunden seit letzter Pr√ºfung:"}),e.jsx("span",{className:"stat-value",children:(null==l?void 0:l.stunden_seit_letzter_pruefung)||0})]}),e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-label",children:"Empfohlene Stunden bis n√§chster Graduierung:"}),e.jsx("span",{className:"stat-value",children:(null==o?void 0:o.min_stunden)||"Nicht definiert"})]})]})]})]},s.stil_id)})]})]})})]})};export{o as default};
