import{a as e,j as s}from"./query-Caj74EYQ.js";import{u as t,a as i}from"./index-1YdTwRLp.js";import{c as l,K as n,b8 as r,F as a,b6 as o,b2 as d,E as c,j as p,R as x,_ as u,g as h,k as y,bk as g}from"./icons-UlaFLuKM.js";import"./vendor-router-B2AaIOtG.js";import"./charts-QHQg_ypW.js";const f=()=>{var h,y,g,f,v,_,k;const{activeDojo:S}=t(),[z,C]=e.useState(!0),[I,w]=e.useState(!1),[B,A]=e.useState(null),[R,T]=e.useState({}),[D,E]=e.useState({}),[P,L]=e.useState({stripe_publishable_key:"",stripe_secret_key:"",paypal_client_id:"",paypal_client_secret:"",paypal_sandbox:!0,sumup_api_key:"",sumup_merchant_code:"",sumup_client_id:"",sumup_client_secret:"",sumup_aktiv:!1,lexoffice_api_key:"",datev_consultant_number:"",datev_client_number:""}),K=(null==S?void 0:S.id)||S;e.useEffect(()=>{K&&"super-admin"!==K&&(F(),G())},[K]);const F=async()=>{try{C(!0);const e=await i.get(`/integrations/config?dojo_id=${K}`);e.data&&L(s=>({...s,...e.data}))}catch(e){console.error("Fehler beim Laden der Konfiguration:",e)}finally{C(!1)}},G=async()=>{try{const e=await i.get(`/integrations/status?dojo_id=${K}`);A(e.data)}catch(e){console.error("Fehler beim Laden des Status:",e)}},O=async e=>{try{E(s=>({...s,[e]:{loading:!0}}));const s=await i.post(`/integrations/${e}/test?dojo_id=${K}`);E(t=>({...t,[e]:{success:s.data.success,message:s.data.message}}))}catch(s){E(t=>{var i,l;return{...t,[e]:{success:!1,message:(null==(l=null==(i=s.response)?void 0:i.data)?void 0:l.error)||"Verbindung fehlgeschlagen"}}})}},V=e=>{T(s=>({...s,[e]:!s[e]}))};return z?s.jsx("div",{style:b.container,children:s.jsx("div",{style:b.loading,children:"Lade Einstellungen..."})}):s.jsxs("div",{style:b.container,children:[s.jsxs("div",{style:b.header,children:[s.jsx(l,{size:32,color:"#ffd700"}),s.jsxs("div",{children:[s.jsx("h2",{style:b.title,children:"Integration-Einstellungen"}),s.jsx("p",{style:b.subtitle,children:"Konfiguriere PayPal, SumUp, LexOffice und DATEV"})]})]}),B&&s.jsxs("div",{style:b.statusGrid,children:[s.jsx(j,{title:"Stripe",icon:s.jsx(n,{size:24}),configured:null==(h=B.stripe)?void 0:h.configured,mode:"Kreditkarte & SEPA"}),s.jsx(j,{title:"PayPal",icon:s.jsx(n,{size:24}),configured:null==(y=B.paypal)?void 0:y.configured,mode:(null==(g=B.paypal)?void 0:g.sandbox)?"Sandbox":"Live"}),s.jsx(j,{title:"SumUp",icon:s.jsx(r,{size:24}),configured:null==(f=B.sumup)?void 0:f.configured,mode:(null==(v=B.sumup)?void 0:v.active)?"Aktiv":"Inaktiv"}),s.jsx(j,{title:"LexOffice",icon:s.jsx(a,{size:24}),configured:null==(_=B.lexoffice)?void 0:_.configured}),s.jsx(j,{title:"DATEV",icon:s.jsx(o,{size:24}),configured:null==(k=B.datev)?void 0:k.configured})]}),s.jsxs("div",{style:b.section,children:[s.jsxs("div",{style:b.sectionHeader,children:[s.jsx(n,{size:24,color:"#635bff"}),s.jsx("h3",{style:b.sectionTitle,children:"Stripe"}),s.jsxs("a",{href:"https://dashboard.stripe.com/apikeys",target:"_blank",rel:"noopener noreferrer",style:b.helpLink,children:[s.jsx(d,{size:14})," API-Keys Dashboard"]})]}),s.jsx("div",{style:b.infoBox,children:s.jsx("p",{children:"Stripe ermöglicht Kreditkarten- und SEPA-Lastschrift-Zahlungen. Die API-Keys findest du im Stripe Dashboard unter Developers → API Keys."})}),s.jsx("div",{style:b.formRow,children:s.jsxs("div",{style:b.formGroup,children:[s.jsx("label",{style:b.label,children:"Publishable Key (öffentlich)"}),s.jsx("input",{type:"text",value:P.stripe_publishable_key||"",onChange:e=>L({...P,stripe_publishable_key:e.target.value}),style:b.input,placeholder:"pk_live_... oder pk_test_..."})]})}),s.jsx("div",{style:b.formRow,children:s.jsxs("div",{style:b.formGroup,children:[s.jsx("label",{style:b.label,children:"Secret Key (geheim)"}),s.jsxs("div",{style:b.secretInput,children:[s.jsx("input",{type:R.stripe?"text":"password",value:P.stripe_secret_key||"",onChange:e=>L({...P,stripe_secret_key:e.target.value}),style:{...b.input,flex:1},placeholder:"sk_live_... oder sk_test_..."}),s.jsx("button",{style:b.eyeButton,onClick:()=>V("stripe"),children:R.stripe?s.jsx(c,{size:18}):s.jsx(p,{size:18})})]})]})}),s.jsx("div",{style:{...b.infoBox,background:"rgba(99, 91, 255, 0.1)",borderColor:"rgba(99, 91, 255, 0.3)"},children:s.jsxs("p",{style:{margin:0},children:[s.jsx("strong",{children:"Hinweis:"})," Verwende für Tests die Test-Keys (pk_test_... / sk_test_...). Für Live-Zahlungen benötigst du die Live-Keys (pk_live_... / sk_live_...)."]})})]}),s.jsxs("div",{style:b.section,children:[s.jsxs("div",{style:b.sectionHeader,children:[s.jsx(n,{size:24,color:"#0070ba"}),s.jsx("h3",{style:b.sectionTitle,children:"PayPal"}),s.jsxs("a",{href:"https://developer.paypal.com/dashboard/applications",target:"_blank",rel:"noopener noreferrer",style:b.helpLink,children:[s.jsx(d,{size:14})," Entwickler-Dashboard"]})]}),s.jsx("div",{style:b.infoBox,children:s.jsx("p",{children:"Um PayPal zu nutzen, erstelle eine App im PayPal Developer Dashboard und kopiere die Client ID und das Secret hierher."})}),s.jsx("div",{style:b.formRow,children:s.jsxs("div",{style:b.formGroup,children:[s.jsx("label",{style:b.label,children:"Client ID"}),s.jsx("input",{type:"text",value:P.paypal_client_id||"",onChange:e=>L({...P,paypal_client_id:e.target.value}),style:b.input,placeholder:"AV9b8ND..."})]})}),s.jsx("div",{style:b.formRow,children:s.jsxs("div",{style:b.formGroup,children:[s.jsx("label",{style:b.label,children:"Client Secret"}),s.jsxs("div",{style:b.secretInput,children:[s.jsx("input",{type:R.paypal?"text":"password",value:P.paypal_client_secret||"",onChange:e=>L({...P,paypal_client_secret:e.target.value}),style:{...b.input,flex:1},placeholder:"EK3qE9N..."}),s.jsx("button",{style:b.eyeButton,onClick:()=>V("paypal"),children:R.paypal?s.jsx(c,{size:18}):s.jsx(p,{size:18})})]})]})}),s.jsx("div",{style:b.formRow,children:s.jsxs("label",{style:b.checkboxLabel,children:[s.jsx("input",{type:"checkbox",checked:P.paypal_sandbox,onChange:e=>L({...P,paypal_sandbox:e.target.checked})}),s.jsx("span",{children:"Sandbox-Modus (Test-Umgebung)"})]})}),s.jsx(m,{service:"paypal",onTest:()=>O("paypal"),result:D.paypal,disabled:!P.paypal_client_id||!P.paypal_client_secret})]}),s.jsxs("div",{style:b.section,children:[s.jsxs("div",{style:b.sectionHeader,children:[s.jsx(r,{size:24,color:"#00b5ad"}),s.jsx("h3",{style:b.sectionTitle,children:"SumUp Kartenterminal"}),s.jsxs("a",{href:"https://developer.sumup.com/docs/api/getting-started/",target:"_blank",rel:"noopener noreferrer",style:b.helpLink,children:[s.jsx(d,{size:14})," Entwickler-Dokumentation"]})]}),s.jsx("div",{style:b.infoBox,children:s.jsx("p",{children:"SumUp ermöglicht Kartenzahlungen über das Kartenterminal (Solo, Air). Du kannst entweder einen API-Key oder OAuth-Credentials verwenden. Die Zugangsdaten findest du im SumUp Business-Portal unter Entwickleroptionen."})}),s.jsx("div",{style:b.formRow,children:s.jsxs("label",{style:b.checkboxLabel,children:[s.jsx("input",{type:"checkbox",checked:P.sumup_aktiv,onChange:e=>L({...P,sumup_aktiv:e.target.checked})}),s.jsx("span",{children:"SumUp aktivieren"})]})}),s.jsx("div",{style:b.formRow,children:s.jsxs("div",{style:b.formGroup,children:[s.jsx("label",{style:b.label,children:"Merchant Code"}),s.jsx("input",{type:"text",value:P.sumup_merchant_code||"",onChange:e=>L({...P,sumup_merchant_code:e.target.value}),style:b.input,placeholder:"MER1234..."})]})}),s.jsx("div",{style:b.formRow,children:s.jsxs("div",{style:b.formGroup,children:[s.jsx("label",{style:b.label,children:"API Key"}),s.jsxs("div",{style:b.secretInput,children:[s.jsx("input",{type:R.sumup_api?"text":"password",value:P.sumup_api_key||"",onChange:e=>L({...P,sumup_api_key:e.target.value}),style:{...b.input,flex:1},placeholder:"sup_sk_..."}),s.jsx("button",{style:b.eyeButton,onClick:()=>V("sumup_api"),children:R.sumup_api?s.jsx(c,{size:18}):s.jsx(p,{size:18})})]})]})}),s.jsx("div",{style:{...b.infoBox,background:"rgba(0, 181, 173, 0.1)",borderColor:"rgba(0, 181, 173, 0.3)"},children:s.jsxs("p",{style:{margin:"0 0 8px 0"},children:[s.jsx("strong",{children:"Optional: OAuth-Credentials"})," (nur wenn kein API-Key verwendet wird)"]})}),s.jsx("div",{style:b.formRow,children:s.jsxs("div",{style:b.formGroup,children:[s.jsx("label",{style:b.label,children:"Client ID (optional)"}),s.jsx("input",{type:"text",value:P.sumup_client_id||"",onChange:e=>L({...P,sumup_client_id:e.target.value}),style:b.input,placeholder:"OAuth Client ID..."})]})}),s.jsx("div",{style:b.formRow,children:s.jsxs("div",{style:b.formGroup,children:[s.jsx("label",{style:b.label,children:"Client Secret (optional)"}),s.jsxs("div",{style:b.secretInput,children:[s.jsx("input",{type:R.sumup_secret?"text":"password",value:P.sumup_client_secret||"",onChange:e=>L({...P,sumup_client_secret:e.target.value}),style:{...b.input,flex:1},placeholder:"OAuth Client Secret..."}),s.jsx("button",{style:b.eyeButton,onClick:()=>V("sumup_secret"),children:R.sumup_secret?s.jsx(c,{size:18}):s.jsx(p,{size:18})})]})]})}),s.jsx(m,{service:"sumup",onTest:()=>O("sumup"),result:D.sumup,disabled:!(P.sumup_api_key||P.sumup_client_id&&P.sumup_client_secret)})]}),s.jsxs("div",{style:b.section,children:[s.jsxs("div",{style:b.sectionHeader,children:[s.jsx(a,{size:24,color:"#0066cc"}),s.jsx("h3",{style:b.sectionTitle,children:"LexOffice"}),s.jsxs("a",{href:"https://app.lexoffice.de/addons/public-api",target:"_blank",rel:"noopener noreferrer",style:b.helpLink,children:[s.jsx(d,{size:14})," API-Schlüssel generieren"]})]}),s.jsx("div",{style:b.infoBox,children:s.jsx("p",{children:"Der API-Schlüssel wird in LexOffice unter Einstellungen → Erweiterungen → Public API generiert."})}),s.jsx("div",{style:b.formRow,children:s.jsxs("div",{style:b.formGroup,children:[s.jsx("label",{style:b.label,children:"API-Schlüssel"}),s.jsxs("div",{style:b.secretInput,children:[s.jsx("input",{type:R.lexoffice?"text":"password",value:P.lexoffice_api_key||"",onChange:e=>L({...P,lexoffice_api_key:e.target.value}),style:{...b.input,flex:1},placeholder:"a1b2c3d4-e5f6-..."}),s.jsx("button",{style:b.eyeButton,onClick:()=>V("lexoffice"),children:R.lexoffice?s.jsx(c,{size:18}):s.jsx(p,{size:18})})]})]})}),s.jsx(m,{service:"lexoffice",onTest:()=>O("lexoffice"),result:D.lexoffice,disabled:!P.lexoffice_api_key})]}),s.jsxs("div",{style:b.section,children:[s.jsxs("div",{style:b.sectionHeader,children:[s.jsx(o,{size:24,color:"#006633"}),s.jsx("h3",{style:b.sectionTitle,children:"DATEV"})]}),s.jsx("div",{style:b.infoBox,children:s.jsx("p",{children:"Die Beraternummer und Mandantennummer werden vom Steuerberater bereitgestellt und sind für den DATEV-Export erforderlich."})}),s.jsxs("div",{style:b.formRow,children:[s.jsxs("div",{style:b.formGroup,children:[s.jsx("label",{style:b.label,children:"Beraternummer"}),s.jsx("input",{type:"text",value:P.datev_consultant_number||"",onChange:e=>L({...P,datev_consultant_number:e.target.value}),style:b.input,placeholder:"12345",maxLength:7})]}),s.jsxs("div",{style:b.formGroup,children:[s.jsx("label",{style:b.label,children:"Mandantennummer"}),s.jsx("input",{type:"text",value:P.datev_client_number||"",onChange:e=>L({...P,datev_client_number:e.target.value}),style:b.input,placeholder:"10001",maxLength:5})]})]}),s.jsxs("div",{style:b.datevInfo,children:[s.jsx("h4",{style:{color:"#ffd700",margin:"0 0 8px 0"},children:"DATEV-Export Formate:"}),s.jsxs("ul",{style:{margin:0,paddingLeft:"20px",color:"#aaa"},children:[s.jsx("li",{children:"Buchungsstapel (Rechnungen) - EXTF Format"}),s.jsx("li",{children:"Zahlungen - EXTF Format"}),s.jsx("li",{children:"Debitoren-Stammdaten - ASCII Format"})]})]})]}),s.jsx("div",{style:b.footer,children:s.jsx("button",{style:b.saveButton,onClick:async()=>{var e,s;try{w(!0),await i.put("/integrations/config",{...P,dojo_id:K}),alert("Einstellungen gespeichert!"),G()}catch(t){console.error("Fehler beim Speichern:",t),alert((null==(s=null==(e=t.response)?void 0:e.data)?void 0:s.error)||"Fehler beim Speichern")}finally{w(!1)}},disabled:I,children:I?s.jsxs(s.Fragment,{children:[s.jsx(x,{size:18,className:"spinning"})," Speichern..."]}):s.jsxs(s.Fragment,{children:[s.jsx(u,{size:18})," Einstellungen speichern"]})})})]})},j=({title:e,icon:t,configured:i,mode:l})=>s.jsxs("div",{style:{...b.statusCard,borderColor:i?"rgba(34, 197, 94, 0.5)":"rgba(255, 255, 255, 0.1)"},children:[s.jsx("div",{style:b.statusIcon,children:t}),s.jsxs("div",{style:b.statusInfo,children:[s.jsx("strong",{children:e}),s.jsxs("span",{style:{color:i?"#22c55e":"#ef4444",fontSize:"12px"},children:[i?"Konfiguriert":"Nicht konfiguriert",l&&i&&` (${l})`]})]}),i?s.jsx(h,{size:20,color:"#22c55e"}):s.jsx(y,{size:20,color:"#666"})]}),m=({service:e,onTest:t,result:i,disabled:l})=>s.jsxs("div",{style:b.testSection,children:[s.jsx("button",{style:{...b.testButton,opacity:l?.5:1},onClick:t,disabled:l||(null==i?void 0:i.loading),children:(null==i?void 0:i.loading)?s.jsxs(s.Fragment,{children:[s.jsx(x,{size:16,className:"spinning"})," Teste..."]}):s.jsxs(s.Fragment,{children:[s.jsx(g,{size:16})," Verbindung testen"]})}),i&&!i.loading&&s.jsxs("div",{style:{...b.testResult,background:i.success?"rgba(34, 197, 94, 0.1)":"rgba(239, 68, 68, 0.1)",borderColor:i.success?"#22c55e":"#ef4444"},children:[i.success?s.jsx(h,{size:16,color:"#22c55e"}):s.jsx(y,{size:16,color:"#ef4444"}),s.jsx("span",{children:i.message})]})]}),b={container:{padding:"24px",maxWidth:"900px",margin:"0 auto"},header:{display:"flex",alignItems:"center",gap:"16px",marginBottom:"32px"},title:{color:"#ffd700",margin:0,fontSize:"24px"},subtitle:{color:"#aaa",margin:"4px 0 0 0",fontSize:"14px"},statusGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",marginBottom:"32px"},statusCard:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid",borderRadius:"12px"},statusIcon:{color:"#ffd700"},statusInfo:{flex:1,display:"flex",flexDirection:"column",color:"#fff"},section:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 215, 0, 0.2)",borderRadius:"12px",padding:"24px",marginBottom:"20px"},sectionHeader:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px"},sectionTitle:{color:"#fff",margin:0,fontSize:"18px",flex:1},helpLink:{display:"flex",alignItems:"center",gap:"4px",color:"#ffd700",textDecoration:"none",fontSize:"13px"},infoBox:{background:"rgba(59, 130, 246, 0.1)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"8px",padding:"12px 16px",marginBottom:"20px",color:"#aaa",fontSize:"14px"},formRow:{display:"flex",gap:"16px",marginBottom:"16px"},formGroup:{flex:1},label:{display:"block",color:"#ffd700",marginBottom:"8px",fontSize:"14px"},input:{width:"100%",padding:"12px",background:"rgba(0, 0, 0, 0.3)",border:"1px solid rgba(255, 215, 0, 0.3)",borderRadius:"8px",color:"#fff",fontSize:"14px",boxSizing:"border-box"},secretInput:{display:"flex",gap:"8px"},eyeButton:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",padding:"12px",color:"#fff",cursor:"pointer"},checkboxLabel:{display:"flex",alignItems:"center",gap:"8px",color:"#fff",cursor:"pointer",fontSize:"14px"},testSection:{display:"flex",alignItems:"center",gap:"16px",marginTop:"16px",paddingTop:"16px",borderTop:"1px solid rgba(255, 255, 255, 0.1)"},testButton:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 16px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",color:"#fff",cursor:"pointer",fontSize:"14px"},testResult:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 16px",borderRadius:"8px",border:"1px solid",fontSize:"13px"},datevInfo:{background:"rgba(0, 102, 51, 0.1)",border:"1px solid rgba(0, 102, 51, 0.3)",borderRadius:"8px",padding:"16px",marginTop:"16px"},footer:{display:"flex",justifyContent:"flex-end",marginTop:"24px"},saveButton:{display:"flex",alignItems:"center",gap:"8px",padding:"14px 28px",background:"#ffd700",border:"none",borderRadius:"8px",color:"#1a1a2e",fontWeight:"bold",fontSize:"16px",cursor:"pointer"},loading:{textAlign:"center",padding:"60px",color:"#888"}};export{f as default};
