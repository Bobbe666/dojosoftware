import{a as e,j as i}from"./query-Caj74EYQ.js";import{u as r,f as a,c as n}from"./index-lGWqIYMX.js";/* empty css                     */import{P as t,Q as s,k as d,o as l,M as g,K as c,F as o}from"./icons-C9nQ4cWf.js";import{f as h,u as m}from"./vendor-router-B2AaIOtG.js";import"./charts-QHQg_ypW.js";const b=()=>{const{filterType:b}=h(),u=m(),{getDojoFilterParam:p,activeDojo:x}=r(),[f,j]=e.useState(!0),[v,y]=e.useState([]),[w,k]=e.useState("all");e.useEffect(()=>{M()},[b,x,w]);const M=async()=>{try{j(!0);const e=p(),i=e?"&":"";let r="";switch(b){case"ohne-sepa":r=`/mitglieder/filter/ohne-sepa?${e}`;break;case"ohne-vertrag":r=`/mitglieder/filter/ohne-vertrag?${e}`;break;case"tarif-abweichung":r=`/mitglieder/filter/tarif-abweichung?${e}`;break;case"zahlungsweisen":r=`/mitglieder/filter/zahlungsweisen?payment_method=${w}${i}${e}`;break;default:r=`/mitglieder?${e}`}const t=await a(`${n.apiBaseUrl}${r}`);if(!t.ok)throw new Error("Fehler beim Laden der Mitglieder");const s=await t.json();y(s.data||s.mitglieder||[]),j(!1)}catch(e){console.error("Fehler beim Laden der Mitglieder:",e),y([]),j(!1)}};return i.jsxs("div",{style:{padding:"2rem",minHeight:"100vh"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem",flexWrap:"wrap",gap:"1rem"},children:[i.jsxs("button",{className:"btn btn-secondary",onClick:()=>u("/dashboard/finanzcockpit"),children:[i.jsx(t,{size:20}),"Zur√ºck zum Finanzcockpit"]}),i.jsxs("div",{children:[i.jsx("h1",{children:(()=>{switch(b){case"ohne-sepa":return"üö´ Mitglieder ohne SEPA-Mandat";case"ohne-vertrag":return"üìÑ Mitglieder ohne Vertrag";case"tarif-abweichung":return"‚ö†Ô∏è Mitglieder mit Tarif-Abweichungen";case"zahlungsweisen":return"üí≥ Mitglieder nach Zahlungsweise";default:return"üë• Mitglieder"}})()}),i.jsx("p",{children:(()=>{switch(b){case"ohne-sepa":return"Diese Mitglieder haben Lastschrift als Zahlungsmethode, aber kein aktives SEPA-Mandat hinterlegt.";case"ohne-vertrag":return"Diese Mitglieder haben aktuell keinen aktiven Vertrag.";case"tarif-abweichung":return"Diese Mitglieder zahlen einen abweichenden Beitrag vom Standard-Tarif.";case"zahlungsweisen":return"Mitglieder gefiltert nach ihrer Zahlungsmethode.";default:return""}})()})]}),i.jsx("div",{style:{display:"flex",gap:"0.5rem"},children:i.jsxs("button",{className:"btn btn-primary",onClick:()=>{const e=[["ID","Vorname","Nachname","Email","Zahlungsmethode","Monatsbeitrag","Status"],...v.map(e=>[e.mitglied_id,e.vorname,e.nachname,e.email,e.zahlungsmethode||"-",e.monatsbeitrag||"-",e.aktiv?"Aktiv":"Inaktiv"])].map(e=>e.map(e=>`"${e}"`).join(";")).join("\n"),i=new Blob(["\ufeff"+e],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a");r.href=URL.createObjectURL(i),r.download=`mitglieder_${b}_${(new Date).toISOString().split("T")[0]}.csv`,r.click()},disabled:0===v.length,children:[i.jsx(s,{size:20}),"CSV Export"]})})]}),"zahlungsweisen"===b&&i.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"12px",padding:"1.5rem",marginBottom:"2rem",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[i.jsx("h3",{style:{color:"#FFD700",marginBottom:"1rem"},children:"Zahlungsmethode w√§hlen"}),i.jsx("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:["all","Lastschrift","√úberweisung","Bar","Karte","PayPal"].map(e=>i.jsx("button",{className:"btn "+(w===e?"btn-primary":"btn-secondary"),onClick:()=>k(e),children:"all"===e?"üîç Alle":e},e))})]}),i.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"12px",padding:"1.5rem",marginBottom:"2rem",display:"flex",alignItems:"center",gap:"1rem"},children:[i.jsx(d,{size:32,color:"#3b82f6"}),i.jsxs("div",{children:[i.jsx("h3",{style:{margin:0,color:"#3b82f6"},children:f?"Laden...":`${v.length} Mitglied${1!==v.length?"er":""} gefunden`}),i.jsxs("p",{style:{margin:"0.5rem 0 0 0",color:"rgba(255, 255, 255, 0.7)",fontSize:"0.9rem"},children:["ohne-sepa"===b&&"Bitte SEPA-Mandate f√ºr diese Mitglieder hinterlegen.","ohne-vertrag"===b&&"Diese Mitglieder ben√∂tigen m√∂glicherweise einen neuen Vertrag.","tarif-abweichung"===b&&"Pr√ºfen Sie die Beitr√§ge dieser Mitglieder.","zahlungsweisen"===b&&"√úbersicht √ºber Zahlungsmethoden der Mitglieder."]})]})]}),f?i.jsx("div",{style:{textAlign:"center",padding:"3rem"},children:i.jsx("p",{children:"Lade Mitglieder..."})}):0===v.length?i.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"12px",padding:"3rem",textAlign:"center",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[i.jsx(l,{size:48,color:"#9ca3af",style:{marginBottom:"1rem"}}),i.jsx("h3",{style:{color:"#9ca3af"},children:"Keine Mitglieder gefunden"}),i.jsxs("p",{style:{color:"rgba(255, 255, 255, 0.5)"},children:["ohne-sepa"===b&&"Alle Mitglieder mit Lastschrift haben ein SEPA-Mandat. ‚úÖ","ohne-vertrag"===b&&"Alle aktiven Mitglieder haben einen Vertrag. ‚úÖ","tarif-abweichung"===b&&"Keine Tarif-Abweichungen gefunden. ‚úÖ","zahlungsweisen"===b&&"Keine Mitglieder mit dieser Zahlungsmethode."]})]}):i.jsx("div",{className:"mitglieder-grid",children:v.map(e=>{return i.jsxs("div",{className:"mitglied-card",onClick:()=>u(`/dashboard/mitglieder/${e.mitglied_id}`),style:{cursor:"pointer"},children:[i.jsxs("div",{className:"mitglied-card__header",children:[i.jsxs("div",{children:[i.jsxs("h3",{children:[e.vorname," ",e.nachname]}),i.jsxs("p",{children:["ID: ",e.mitglied_id]})]}),i.jsx("span",{className:"mitglied-card__badge "+(e.aktiv?"badge-success":"badge-danger"),children:e.aktiv?"‚úÖ Aktiv":"‚ùå Inaktiv"})]}),i.jsxs("div",{className:"mitglied-card__body",children:[i.jsxs("div",{className:"mitglied-card__info",children:[i.jsx(g,{size:16}),i.jsx("span",{children:e.email||"Keine Email"})]}),e.zahlungsmethode&&i.jsxs("div",{className:"mitglied-card__info",children:[i.jsx(c,{size:16}),i.jsx("span",{children:e.zahlungsmethode})]}),e.monatsbeitrag&&i.jsx("div",{className:"mitglied-card__info",children:i.jsxs("span",{style:{fontWeight:"600",color:"#4caf50"},children:[(r=e.monatsbeitrag,new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(r||0)),"/Monat"]})}),"ohne-sepa"===b&&i.jsxs("div",{style:{marginTop:"0.75rem",padding:"0.5rem",background:"rgba(239, 68, 68, 0.1)",borderRadius:"6px",fontSize:"0.85rem",color:"#ef4444",border:"1px solid rgba(239, 68, 68, 0.3)"},children:[i.jsx(d,{size:14,style:{display:"inline",marginRight:"0.5rem"}}),"Kein SEPA-Mandat"]}),"ohne-vertrag"===b&&i.jsxs("div",{style:{marginTop:"0.75rem",padding:"0.5rem",background:"rgba(245, 158, 11, 0.1)",borderRadius:"6px",fontSize:"0.85rem",color:"#f59e0b",border:"1px solid rgba(245, 158, 11, 0.3)"},children:[i.jsx(o,{size:14,style:{display:"inline",marginRight:"0.5rem"}}),"Kein aktiver Vertrag"]}),"tarif-abweichung"===b&&e.abweichung_grund&&i.jsx("div",{style:{marginTop:"0.75rem",padding:"0.5rem",background:"rgba(139, 92, 246, 0.1)",borderRadius:"6px",fontSize:"0.85rem",color:"#8b5cf6",border:"1px solid rgba(139, 92, 246, 0.3)"},children:e.abweichung_grund})]})]},e.mitglied_id);var r})})]})};export{b as default};
