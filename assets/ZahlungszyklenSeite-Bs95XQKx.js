import{a as e,j as s}from"./query-Caj74EYQ.js";import{c as a}from"./index-CREwepoQ.js";import{as as n,C as l,P as i,R as t,X as r,a9 as c,u as d,w as o,a2 as h,t as g}from"./icons-DiLw-1i5.js";import{u as m}from"./vendor-router-Co3o87Zc.js";import"./charts-C1Gv3M_c.js";const x=()=>{const h=m(),[g,x]=e.useState([]),[p,j]=e.useState(!0),[k,y]=e.useState(""),[v,f]=e.useState(""),[z,N]=e.useState(null),[S,w]=e.useState({name:"",intervall_tage:"",beschreibung:"",aktiv:!0}),[F,C]=e.useState(!1);e.useEffect(()=>{_()},[]);const _=async()=>{try{j(!0);const e=await fetch(`${a.apiBaseUrl}/zahlungszyklen`);if(!e.ok)throw new Error("Fehler beim Laden der Zahlungszyklen");const s=await e.json();x(s.data||s||[]),y("")}catch(e){console.error("Fehler beim Laden der Zahlungszyklen:",e),y("Fehler beim Laden der Zahlungszyklen: "+e.message)}finally{j(!1)}},Z=async e=>{try{const s=e.zyklus_id?"PUT":"POST",n=e.zyklus_id?`${a.apiBaseUrl}/zahlungszyklen/${e.zyklus_id}`:`${a.apiBaseUrl}/zahlungszyklen`;if(!(await fetch(n,{method:s,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok)throw new Error("Fehler beim Speichern des Zahlungszyklus");f(e.zyklus_id?"Zahlungszyklus aktualisiert!":"Zahlungszyklus erstellt!"),y(""),_(),N(null),C(!1),w({name:"",intervall_tage:"",beschreibung:"",aktiv:!0}),setTimeout(()=>f(""),3e3)}catch(s){console.error("Fehler beim Speichern:",s),y("Fehler beim Speichern: "+s.message)}},W=async e=>{if(confirm("Möchten Sie diesen Zahlungszyklus wirklich löschen?"))try{if(!(await fetch(`${a.apiBaseUrl}/zahlungszyklen/${e}`,{method:"DELETE"})).ok)throw new Error("Fehler beim Löschen des Zahlungszyklus");f("Zahlungszyklus gelöscht!"),y(""),_(),setTimeout(()=>f(""),3e3)}catch(s){console.error("Fehler beim Löschen:",s),y("Fehler beim Löschen: "+s.message)}},T=e=>{N(e.zyklus_id)},I=()=>{N(null)},B=(e,s)=>{const a=g.find(s=>s.zyklus_id===e);Z({...a,...s})},M=e=>1===e?"Täglich":7===e?"Wöchentlich":14===e?"14-tägig":30===e?"Monatlich":60===e?"Alle 2 Monate":90===e||91===e?"Vierteljährlich":180===e?"Halbjährlich":365===e?"Jährlich":`Alle ${e} Tage`;return s.jsxs("div",{className:"zahlungszyklen-seite",children:[s.jsxs("div",{className:"page-header",children:[s.jsxs("div",{className:"header-left",children:[s.jsxs("button",{className:"btn btn-secondary",onClick:()=>h("/dashboard/beitraege"),children:[s.jsx(n,{size:16}),"Zurück zur Beitragsverwaltung"]}),s.jsxs("div",{className:"header-title",children:[s.jsx(l,{size:32}),s.jsxs("div",{children:[s.jsx("h1",{children:"Zahlungszyklen Verwaltung"}),s.jsx("p",{children:"Verwalten Sie Zahlungsintervalle für Mitgliedsbeiträge"})]})]})]}),s.jsxs("div",{className:"header-actions",children:[s.jsxs("button",{className:"btn btn-primary",onClick:()=>C(!F),children:[s.jsx(i,{size:16}),"Neuer Zahlungszyklus"]}),s.jsxs("button",{className:"btn btn-secondary",onClick:_,disabled:p,children:[s.jsx(t,{size:16,className:p?"animate-spin":""}),"Aktualisieren"]})]})]}),k&&s.jsxs("div",{className:"error-message",children:[s.jsx(r,{size:20}),k]}),v&&s.jsxs("div",{className:"message success",children:[s.jsx(c,{size:20}),v]}),F&&s.jsxs("div",{className:"standard-card add-form-card",children:[s.jsxs("div",{className:"card-header",children:[s.jsx("h3",{children:"Neuen Zahlungszyklus hinzufügen"}),s.jsx("button",{className:"btn btn-ghost btn-small",onClick:()=>{C(!1),w({name:"",intervall_tage:"",beschreibung:"",aktiv:!0})},children:s.jsx(r,{size:16})})]}),s.jsxs("div",{className:"input-container",children:[s.jsxs("div",{className:"form-row",children:[s.jsxs("div",{className:"input-group",children:[s.jsx("label",{className:"input-label",children:"Name"}),s.jsx("input",{type:"text",className:"input-field",placeholder:"z.B. Monatlich",value:S.name,onChange:e=>w({...S,name:e.target.value})})]}),s.jsxs("div",{className:"input-group",children:[s.jsx("label",{className:"input-label",children:"Intervall (Tage)"}),s.jsx("input",{type:"number",className:"input-field",placeholder:"z.B. 30",value:S.intervall_tage,onChange:e=>w({...S,intervall_tage:parseInt(e.target.value)||""})})]})]}),s.jsxs("div",{className:"input-group",children:[s.jsx("label",{className:"input-label",children:"Beschreibung"}),s.jsx("input",{type:"text",className:"input-field",placeholder:"Beschreibung des Zahlungszyklus",value:S.beschreibung,onChange:e=>w({...S,beschreibung:e.target.value})})]}),s.jsx("div",{className:"input-group checkbox-group",children:s.jsxs("label",{className:"checkbox-label",children:[s.jsx("input",{type:"checkbox",checked:S.aktiv,onChange:e=>w({...S,aktiv:e.target.checked})}),s.jsx("span",{className:"checkmark"}),"Aktiv"]})}),s.jsxs("div",{className:"form-actions",children:[s.jsxs("button",{className:"btn btn-primary",onClick:()=>Z(S),disabled:!S.name||!S.intervall_tage,children:[s.jsx(d,{size:16}),"Speichern"]}),s.jsxs("button",{className:"btn btn-secondary",onClick:()=>{C(!1),w({name:"",intervall_tage:"",beschreibung:"",aktiv:!0})},children:[s.jsx(r,{size:16}),"Abbrechen"]})]})]})]}),s.jsx("div",{className:"zahlungszyklen-content",children:p?s.jsxs("div",{className:"loading-container",children:[s.jsx("div",{className:"loading-spinner-large"}),s.jsx("p",{children:"Lade Zahlungszyklen..."})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"0.625rem",marginBottom:"1.25rem"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.625rem",padding:"0.625rem",background:"rgba(255, 255, 255, 0.08)",backdropFilter:"blur(20px)",borderRadius:"10px",border:"1px solid rgba(255, 215, 0, 0.2)",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.2)"},children:[s.jsx("div",{style:{width:"36px",height:"36px",minWidth:"36px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(255, 215, 0, 0.15)",color:"#ffd700",padding:"0"},children:s.jsx(l,{size:18})}),s.jsxs("div",{style:{flex:1,minWidth:0},children:[s.jsx("h3",{style:{fontSize:"0.7rem",fontWeight:500,color:"rgba(255, 255, 255, 0.9)",margin:"0 0 0.15rem 0",textTransform:"uppercase",letterSpacing:"0.02em",textShadow:"none",WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale"},children:"Gesamt Zyklen"}),s.jsx("p",{style:{fontSize:"1.1rem",fontWeight:700,color:"#ffffff",margin:0,lineHeight:1,textShadow:"none",WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale"},children:g.length})]})]}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.625rem",padding:"0.625rem",background:"rgba(255, 255, 255, 0.08)",backdropFilter:"blur(20px)",borderRadius:"10px",border:"1px solid rgba(255, 215, 0, 0.2)",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.2)"},children:[s.jsx("div",{style:{width:"36px",height:"36px",minWidth:"36px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(255, 215, 0, 0.15)",color:"#ffd700",padding:"0"},children:s.jsx(c,{size:18})}),s.jsxs("div",{style:{flex:1,minWidth:0},children:[s.jsx("h3",{style:{fontSize:"0.7rem",fontWeight:500,color:"rgba(255, 255, 255, 0.9)",margin:"0 0 0.15rem 0",textTransform:"uppercase",letterSpacing:"0.02em",textShadow:"none",WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale"},children:"Aktive Zyklen"}),s.jsx("p",{style:{fontSize:"1.1rem",fontWeight:700,color:"#ffffff",margin:0,lineHeight:1,textShadow:"none",WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale"},children:g.filter(e=>e.aktiv).length})]})]}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.625rem",padding:"0.625rem",background:"rgba(255, 255, 255, 0.08)",backdropFilter:"blur(20px)",borderRadius:"10px",border:"1px solid rgba(255, 215, 0, 0.2)",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.2)"},children:[s.jsx("div",{style:{width:"36px",height:"36px",minWidth:"36px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(255, 215, 0, 0.15)",color:"#ffd700",padding:"0"},children:s.jsx(o,{size:18})}),s.jsxs("div",{style:{flex:1,minWidth:0},children:[s.jsx("h3",{style:{fontSize:"0.7rem",fontWeight:500,color:"rgba(255, 255, 255, 0.9)",margin:"0 0 0.15rem 0",textTransform:"uppercase",letterSpacing:"0.02em",textShadow:"none",WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale"},children:"Kürzester Zyklus"}),s.jsx("p",{style:{fontSize:"1.1rem",fontWeight:700,color:"#ffffff",margin:0,lineHeight:1,textShadow:"none",WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale"},children:g.length>0?`${Math.min(...g.map(e=>e.intervall_tage))} Tage`:"0 Tage"})]})]})]}),s.jsx("div",{className:"zahlungszyklen-grid",children:g.map(e=>s.jsx("div",{className:"zyklus-card "+(e.aktiv?"":"inactive"),children:z===e.zyklus_id?s.jsx(u,{zyklus:e,onSave:B,onCancel:I}):s.jsx(b,{zyklus:e,formatIntervall:M,onEdit:T,onDelete:W})},e.zyklus_id))}),0===g.length&&s.jsxs("div",{className:"empty-state",children:[s.jsx(o,{size:48}),s.jsx("h3",{children:"Keine Zahlungszyklen vorhanden"}),s.jsx("p",{children:"Erstellen Sie Ihren ersten Zahlungszyklus mit dem Button oben."}),s.jsxs("button",{className:"btn btn-primary",onClick:()=>C(!0),children:[s.jsx(i,{size:16}),"Ersten Zyklus erstellen"]})]})]})})]})},u=({zyklus:a,onSave:n,onCancel:l})=>{const[i,t]=e.useState({name:a.name,intervall_tage:a.intervall_tage,beschreibung:a.beschreibung,aktiv:a.aktiv});return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"card-header",children:s.jsx("h3",{children:"Bearbeiten"})}),s.jsx("div",{className:"edit-form",children:s.jsxs("div",{className:"input-container",children:[s.jsxs("div",{className:"form-row",children:[s.jsxs("div",{className:"input-group",children:[s.jsx("label",{className:"input-label",children:"Name"}),s.jsx("input",{type:"text",className:"input-field",value:i.name,onChange:e=>t({...i,name:e.target.value})})]}),s.jsxs("div",{className:"input-group",children:[s.jsx("label",{className:"input-label",children:"Intervall (Tage)"}),s.jsx("input",{type:"number",className:"input-field",value:i.intervall_tage,onChange:e=>t({...i,intervall_tage:parseInt(e.target.value)||""})})]})]}),s.jsxs("div",{className:"input-group",children:[s.jsx("label",{className:"input-label",children:"Beschreibung"}),s.jsx("input",{type:"text",className:"input-field",value:i.beschreibung,onChange:e=>t({...i,beschreibung:e.target.value})})]}),s.jsx("div",{className:"input-group checkbox-group",children:s.jsxs("label",{className:"checkbox-label",children:[s.jsx("input",{type:"checkbox",checked:i.aktiv,onChange:e=>t({...i,aktiv:e.target.checked})}),s.jsx("span",{className:"checkmark"}),"Aktiv"]})}),s.jsxs("div",{className:"card-actions",children:[s.jsxs("button",{className:"btn btn-primary btn-small",onClick:()=>{n(a.zyklus_id,i)},disabled:!i.name||!i.intervall_tage,children:[s.jsx(c,{size:16}),"Speichern"]}),s.jsxs("button",{className:"btn btn-secondary btn-small",onClick:l,children:[s.jsx(r,{size:16}),"Abbrechen"]})]})]})})]})},b=({zyklus:e,formatIntervall:a,onEdit:n,onDelete:i})=>s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"card-header",children:[s.jsx("h3",{children:e.name}),s.jsx("div",{className:"status-badge "+(e.aktiv?"active":"inactive"),children:e.aktiv?"Aktiv":"Inaktiv"})]}),s.jsx("div",{className:"card-content",children:s.jsxs("div",{className:"zyklus-info",children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",color:"rgba(255, 255, 255, 0.9)",padding:"0.5rem",background:"rgba(255, 255, 255, 0.03)",borderRadius:"6px",fontSize:"0.875rem"},children:[s.jsx(o,{size:16,style:{color:"#ffd700",flexShrink:0}}),s.jsx("span",{style:{color:"#ffd700",fontSize:"0.875rem",fontWeight:600,textShadow:"none",WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale"},children:a(e.intervall_tage)})]}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",color:"rgba(255, 255, 255, 0.9)",padding:"0.5rem",background:"rgba(255, 255, 255, 0.03)",borderRadius:"6px",fontSize:"0.875rem"},children:[s.jsx(l,{size:16,style:{color:"#ffd700",flexShrink:0}}),s.jsxs("span",{children:["Alle ",e.intervall_tage," Tage"]})]}),e.beschreibung&&s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",color:"rgba(255, 255, 255, 0.8)",padding:"0.5rem",background:"rgba(255, 255, 255, 0.03)",borderRadius:"6px",fontSize:"0.875rem",fontStyle:"italic"},children:s.jsx("span",{children:e.beschreibung})})]})}),s.jsxs("div",{className:"card-actions",children:[s.jsxs("button",{className:"btn btn-secondary btn-small",onClick:()=>n(e),children:[s.jsx(h,{size:16}),"Bearbeiten"]}),s.jsxs("button",{className:"btn btn-danger btn-small",onClick:()=>i(e.zyklus_id),children:[s.jsx(g,{size:16}),"Löschen"]})]})]});export{x as default};
