import{j as e}from"./animation-1wuIdCBS.js";import{r as s}from"./vendor-router-BhMXg4Z-.js";import{a}from"./index-DUnH23_2.js";import"./vendor-react-DtuzQOD1.js";import"./query-Bs1dTGah.js";import"./icons-D7rg4pDH.js";const n=()=>{var n;const[c,i]=s.useState([]),[l,t]=s.useState([]),[r,d]=s.useState({}),[h,o]=s.useState(""),[m,u]=s.useState(""),[j,v]=s.useState(!1),[x,k]=s.useState(()=>(new Date).toISOString().split("T")[0]);s.useEffect(()=>{N()},[]),s.useEffect(()=>{p()},[x]);const N=async()=>{try{const e=await a.get("/personalCheckin/personal");i(e.data.personal)}catch(e){console.error("âŒ Fehler beim Laden der Personal-Liste:",e)}},p=async()=>{try{v(!0);const e=await a.get(`/personalCheckin?datum=${x}`);t(e.data.checkins),d(e.data.stats)}catch(e){console.error("âŒ Fehler beim Laden der Check-ins:",e)}finally{v(!1)}},b=e=>e?new Date(e).toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"}):"",g=e=>{if(!e)return"0h 0min";return`${Math.floor(e/60)}h ${e%60}min`},f=h?c.find(e=>e.personal_id===parseInt(h)):null;return e.jsxs("div",{className:"personal-checkin-container",children:[e.jsxs("div",{className:"personal-checkin-header",children:[e.jsx("h2",{children:"ğŸ‘¥ Personal Check-in"}),e.jsx("p",{className:"personal-checkin-subtitle",children:"Arbeitszeiten erfassen und verwalten"})]}),e.jsxs("div",{className:"datum-selection",children:[e.jsx("label",{children:"ğŸ“… Datum:"}),e.jsx("input",{type:"date",value:x,onChange:e=>k(e.target.value),className:"datum-input"})]}),e.jsxs("div",{className:"personal-stats-grid",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"ğŸ‘¥"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-number",children:r.total_checkins||0}),e.jsx("div",{className:"stat-label",children:"Check-ins Heute"})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"âœ…"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-number",children:r.eingecheckt||0}),e.jsx("div",{className:"stat-label",children:"Aktiv Eingecheckt"})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"â°"}),e.jsxs("div",{className:"stat-content",children:[e.jsxs("div",{className:"stat-number",children:[r.total_arbeitszeit_stunden||0,"h"]}),e.jsx("div",{className:"stat-label",children:"Gesamtarbeitszeit"})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"ğŸ’°"}),e.jsxs("div",{className:"stat-content",children:[e.jsxs("div",{className:"stat-number",children:["â‚¬",(null==(n=r.total_kosten)?void 0:n.toFixed(2))||"0.00"]}),e.jsx("div",{className:"stat-label",children:"Gesamtkosten"})]})]})]}),e.jsxs("div",{className:"checkin-form-card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{children:"â• Personal Einchecken"})}),e.jsxs("div",{className:"checkin-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ğŸ‘¤ Personal auswÃ¤hlen:"}),e.jsxs("select",{value:h,onChange:e=>o(e.target.value),className:"form-select",disabled:j,children:[e.jsx("option",{value:"",children:"Personal auswÃ¤hlen..."}),c.map(s=>e.jsxs("option",{value:s.personal_id,children:[s.vorname," ",s.nachname," - ",s.position," (â‚¬",s.stundenlohn,"/h)"]},s.personal_id))]})]}),f&&e.jsx("div",{className:"selected-personal-info",children:e.jsxs("div",{className:"personal-info-card",children:[e.jsxs("strong",{children:[f.vorname," ",f.nachname]}),e.jsxs("div",{className:"personal-details",children:[e.jsx("span",{className:"position-tag",children:f.position}),e.jsxs("span",{className:"hourly-rate",children:["â‚¬",f.stundenlohn,"/Stunde"]})]})]})}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ğŸ“ Bemerkung (optional):"}),e.jsx("input",{type:"text",value:m,onChange:e=>u(e.target.value),placeholder:"z.B. FrÃ¼hdienst, SpÃ¤tdienst...",className:"form-input",disabled:j})]}),e.jsx("button",{onClick:async()=>{var e,s;if(h)try{v(!0),await a.post("/personalCheckin",{personal_id:h,bemerkung:m}),o(""),u(""),p(),alert("Personal erfolgreich eingecheckt!")}catch(n){console.error("âŒ Fehler beim Einchecken:",n),alert("Fehler beim Einchecken: "+((null==(s=null==(e=n.response)?void 0:e.data)?void 0:s.error)||n.message))}finally{v(!1)}else alert("Bitte Personal auswÃ¤hlen!")},disabled:j||!h,className:"checkin-button",children:j?"ğŸ”„ Wird eingecheckt...":"âœ… Einchecken"})]})]}),e.jsxs("div",{className:"checkins-list",children:[e.jsxs("h3",{children:["ğŸ“‹ Heutige Check-ins (",x,")"]}),j&&e.jsx("div",{className:"loading",children:"ğŸ”„ Lade..."}),0===l.length&&!j&&e.jsx("div",{className:"no-checkins-message",children:e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"ğŸ“…"}),e.jsx("h4",{children:"Keine Check-ins vorhanden"}),e.jsx("p",{children:"FÃ¼r das ausgewÃ¤hlte Datum sind noch keine Personal Check-ins vorhanden."})]})}),e.jsx("div",{className:"checkins-grid",children:l.map((s,n)=>{var c;return e.jsxs("div",{className:`checkin-card ${s.status}`,style:{animationDelay:.1*n+"s"},children:[e.jsxs("div",{className:"checkin-card-header",children:[e.jsxs("div",{className:"personal-name",children:[s.vorname," ",s.nachname]}),e.jsx("div",{className:`status-badge ${s.status}`,children:"eingecheckt"===s.status?"ğŸŸ¢ Eingecheckt":"ğŸ”´ Ausgecheckt"})]}),e.jsxs("div",{className:"checkin-card-content",children:[e.jsxs("div",{className:"checkin-field",children:[e.jsx("label",{children:"ğŸ‘¤ Position:"}),e.jsx("span",{className:"checkin-value position-tag",children:s.position})]}),e.jsxs("div",{className:"checkin-field",children:[e.jsx("label",{children:"ğŸ• Check-in:"}),e.jsx("span",{className:"checkin-value time-value",children:b(s.checkin_time)})]}),s.checkout_time&&e.jsxs("div",{className:"checkin-field",children:[e.jsx("label",{children:"ğŸ•‘ Check-out:"}),e.jsx("span",{className:"checkin-value time-value",children:b(s.checkout_time)})]}),e.jsxs("div",{className:"checkin-field",children:[e.jsx("label",{children:"â±ï¸ Arbeitszeit:"}),e.jsx("span",{className:"checkin-value duration-value",children:g(s.aktuelle_arbeitszeit_minuten)})]}),e.jsxs("div",{className:"checkin-field",children:[e.jsx("label",{children:"ğŸ’° Kosten:"}),e.jsxs("span",{className:"checkin-value cost-value",children:["â‚¬",(null==(c=s.aktuelle_kosten)?void 0:c.toFixed(2))||"0.00"]})]}),e.jsxs("div",{className:"checkin-field",children:[e.jsx("label",{children:"ğŸ’µ Stundenlohn:"}),e.jsxs("span",{className:"checkin-value",children:["â‚¬",s.stundenlohn,"/h"]})]}),s.bemerkung&&e.jsxs("div",{className:"checkin-field",children:[e.jsx("label",{children:"ğŸ“ Bemerkung:"}),e.jsx("span",{className:"checkin-value",children:s.bemerkung})]})]}),"eingecheckt"===s.status&&e.jsx("div",{className:"checkin-card-actions",children:e.jsx("button",{onClick:()=>(async e=>{var s,n;if(window.confirm("Personal auschecken?"))try{v(!0);const s=await a.put(`/personalCheckin/${e}/checkout`);p(),alert(s.data.message)}catch(c){console.error("âŒ Fehler beim Auschecken:",c),alert("Fehler beim Auschecken: "+((null==(n=null==(s=c.response)?void 0:s.data)?void 0:n.error)||c.message))}finally{v(!1)}})(s.checkin_id),disabled:j,className:"checkout-button",children:"ğŸ”´ Auschecken"})})]},s.checkin_id)})})]})]})};export{n as default};
