import{a as e,j as s}from"./query-Caj74EYQ.js";import{c as a}from"./index-D4wQygnO.js";import{e as n,p as r,af as i,o as t,k as l}from"./icons-eh0tbLFx.js";import"./vendor-router-B2AaIOtG.js";import"./charts-QHQg_ypW.js";const c=()=>{var c,d;const[o,m]=e.useState([]),[h,j]=e.useState(null),[u,x]=e.useState(!0),[v,g]=e.useState("recent"),[N,p]=e.useState("all");e.useEffect(()=>{(async()=>{try{const e=await fetch(`${a.apiBaseUrl}/admin/course-ratings`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(e.ok){const s=await e.json();m(s.ratings||[])}}catch(e){console.error("Fehler beim Laden der Bewertungen:",e)}})(),(async()=>{try{const e=await fetch(`${a.apiBaseUrl}/admin/rating-stats`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(e.ok){const s=await e.json();j(s)}}catch(e){console.error("Fehler beim Laden der Statistiken:",e)}})(),x(!1)},[]);const b=o.filter(e=>"all"===N||e.bewertung.toString()===N),f=e=>Array.from({length:5},(a,r)=>s.jsx(n,{size:16,className:r<e?"filled":"empty",style:{color:r<e?"#ffd700":"rgba(255, 255, 255, 0.3)",fill:r<e?"#ffd700":"none"}},r));return u?s.jsxs("div",{className:"course-rating-admin",children:[s.jsx("div",{className:"loading-spinner"}),s.jsx("span",{children:"Lade Bewertungen..."})]}):s.jsxs("div",{className:"course-rating-admin",children:[s.jsxs("div",{className:"admin-header",children:[s.jsxs("h1",{children:[s.jsx(n,{size:28}),"Kurs-Bewertungen - Admin"]}),s.jsx("p",{children:"Übersicht aller Kursbewertungen und Statistiken"})]}),h&&s.jsxs("div",{className:"stats-grid",children:[s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon",children:s.jsx(n,{size:24})}),s.jsxs("div",{className:"stat-content",children:[s.jsx("div",{className:"stat-number",children:h.overall.total_ratings}),s.jsx("div",{className:"stat-label",children:"Gesamtbewertungen"})]})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon",children:s.jsx(r,{size:24})}),s.jsxs("div",{className:"stat-content",children:[s.jsx("div",{className:"stat-number",children:(null==(c=h.overall.average_rating)?void 0:c.toFixed(1))||"0.0"}),s.jsx("div",{className:"stat-label",children:"Durchschnittsbewertung"})]})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon",children:s.jsx(i,{size:24})}),s.jsxs("div",{className:"stat-content",children:[s.jsx("div",{className:"stat-number",children:h.overall.with_comments}),s.jsx("div",{className:"stat-label",children:"Mit Kommentaren"})]})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-icon",children:s.jsx(t,{size:24})}),s.jsxs("div",{className:"stat-content",children:[s.jsx("div",{className:"stat-number",children:(null==(d=h.byCourse)?void 0:d.length)||0}),s.jsx("div",{className:"stat-label",children:"Bewertete Kurse"})]})]})]}),s.jsxs("div",{className:"admin-tabs",children:[s.jsx("button",{className:"tab "+("recent"===v?"active":""),onClick:()=>g("recent"),children:"Neueste Bewertungen"}),s.jsx("button",{className:"tab "+("courses"===v?"active":""),onClick:()=>g("courses"),children:"Nach Kursen"})]}),s.jsxs("div",{className:"filter-section",children:[s.jsx("label",{children:"Bewertung filtern:"}),s.jsxs("select",{value:N,onChange:e=>p(e.target.value),children:[s.jsx("option",{value:"all",children:"Alle Bewertungen"}),s.jsx("option",{value:"5",children:"5 Sterne"}),s.jsx("option",{value:"4",children:"4 Sterne"}),s.jsx("option",{value:"3",children:"3 Sterne"}),s.jsx("option",{value:"2",children:"2 Sterne"}),s.jsx("option",{value:"1",children:"1 Stern"})]})]}),"recent"===v&&s.jsxs("div",{className:"ratings-list",children:[s.jsx("h2",{children:"Neueste Bewertungen"}),b.length>0?s.jsx("div",{className:"ratings-grid",children:b.map(e=>{return s.jsxs("div",{className:"rating-card",children:[s.jsxs("div",{className:"rating-header",children:[s.jsxs("div",{className:"course-info",children:[s.jsx("h3",{children:e.kurs_name}),s.jsxs("span",{className:"course-time",children:[e.uhrzeit," • ",e.raum]})]}),s.jsx("div",{className:"rating-stars",children:f(e.bewertung)})]}),s.jsxs("div",{className:"rating-details",children:[s.jsxs("div",{className:"member-info",children:[s.jsxs("strong",{children:[e.mitglied_vorname," ",e.mitglied_nachname]}),s.jsx("span",{children:(a=e.erstellt_am,new Date(a).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}))})]}),s.jsx("div",{className:"trainer-info",children:s.jsxs("span",{children:["Trainer: ",e.trainer_vorname," ",e.trainer_nachname]})})]}),e.kommentar&&s.jsxs("div",{className:"rating-comment",children:[s.jsx(i,{size:16}),s.jsxs("p",{children:['"',e.kommentar,'"']})]})]},e.id);var a})}):s.jsxs("div",{className:"no-data",children:[s.jsx(l,{size:48}),s.jsx("p",{children:"Keine Bewertungen gefunden"})]})]}),"courses"===v&&h&&s.jsxs("div",{className:"courses-stats",children:[s.jsx("h2",{children:"Bewertungen nach Kursen"}),s.jsx("div",{className:"courses-grid",children:h.byCourse.map(e=>{var a;return s.jsxs("div",{className:"course-stat-card",children:[s.jsxs("div",{className:"course-header",children:[s.jsx("h3",{children:e.kurs_name}),s.jsxs("div",{className:"course-rating",children:[f(Math.round(e.average_rating)),s.jsx("span",{className:"rating-number",children:null==(a=e.average_rating)?void 0:a.toFixed(1)})]})]}),s.jsx("div",{className:"course-stats",children:s.jsxs("span",{children:[e.rating_count," Bewertung",1!==e.rating_count?"en":""]})})]},e.kurs_name)})})]})]})};export{c as default};
