import{a as e,j as n}from"./query-Caj74EYQ.js";import{b as t,u as i,a as r}from"./index-1YdTwRLp.js";import{Q as a}from"./index-wRQyZq66.js";import{O as s,a5 as o}from"./icons-UlaFLuKM.js";import"./vendor-router-B2AaIOtG.js";import"./charts-QHQg_ypW.js";const l=()=>{var l,d;const{token:c}=t(),{activeDojo:m,dojos:h,switchDojo:g}=i(),[b,u]=e.useState(!1),[p,x]=e.useState(!1),[f,j]=e.useState(null),[v,k]=e.useState([]),[_,z]=e.useState([]),[y,w]=e.useState(null),[N,S]=e.useState(!0),[B,C]=e.useState(null),[F,R]=e.useState({bank_name:"",iban:"",bic:"",kontoinhaber:""}),D=e=>{if(!e)return"";const n=new Date(e);return n.setDate(n.getDate()+7),n.toISOString().split("T")[0]},[T,I]=e.useState({rechnungsnummer:"Wird geladen...",kundennummer:"",belegdatum:(new Date).toISOString().split("T")[0],leistungsdatum:(new Date).toISOString().split("T")[0],zahlungsfrist:D((new Date).toISOString().split("T")[0]),rabatt_prozent:0,rabatt_auf_betrag:0,skonto_prozent:0,skonto_tage:0}),[$,A]=e.useState([]),[W,E]=e.useState({artikel_id:"",bezeichnung:"",artikelnummer:"",menge:1,einzelpreis:0,ust_prozent:19,ist_rabattfaehig:!1,rabatt_prozent:0}),[L,H]=e.useState(!1),[O,M]=e.useState(!1),[U,P]=e.useState(null),[q,K]=e.useState({groesse:"",farbe:"",material:"",preiskategorie:""});e.useEffect(()=>{(async()=>{try{S(!0),await Promise.all([Z(),G(),Y(T.belegdatum),V()]),C(null)}catch(e){console.error("Fehler beim Laden der Daten:",e),C("Fehler beim Laden der Daten: "+e.message)}finally{S(!1)}})()},[]),e.useEffect(()=>{!p&&h&&h.length>1&&"super-admin"!==m?u(!0):h&&h.length<=1&&x(!0)},[h,p]),e.useEffect(()=>{m&&"super-admin"!==m&&(console.log("üîÑ activeDojo ge√§ndert, lade Bankdaten und Logo neu..."),V(),Q())},[null==m?void 0:m.dojo_id,null==m?void 0:m.id]);const Q=async()=>{try{if(!(null==m?void 0:m.dojo_id)&&!(null==m?void 0:m.id))return void j(null);const e=m.dojo_id||m.id;console.log("üñºÔ∏è Lade Logo f√ºr Dojo:",e);const n=await r.get(`/dojos/${e}/logos`,{headers:{Authorization:`Bearer ${c}`}}),t=(n.data||[]).find(e=>"haupt"===e.logo_type);(null==t?void 0:t.url)?(console.log("‚úÖ Haupt-Logo gefunden:",t.url),j(t.url)):(console.log("‚ö†Ô∏è Kein Haupt-Logo vorhanden"),j(null))}catch(e){console.error("Fehler beim Laden des Logos:",e),j(null)}};e.useEffect(()=>{console.log("üìä bankDaten State ge√§ndert:",F)},[F]),e.useEffect(()=>{Y(T.belegdatum)},[T.belegdatum]),e.useEffect(()=>{if(T.belegdatum&&T.zahlungsfrist){const e=new Date(T.belegdatum),n=new Date(T.zahlungsfrist)-e,t=Math.ceil(n/864e5);t>0&&I(e=>({...e,skonto_tage:t}))}},[T.belegdatum,T.zahlungsfrist]);const Z=async()=>{try{const e=await r.get("/mitglieder",{headers:{Authorization:`Bearer ${c}`}});k(e.data||[])}catch(e){console.error("Fehler beim Laden der Mitglieder:",e)}},G=async()=>{try{const e=(null==m?void 0:m.dojo_id)||(null==m?void 0:m.id),n=e?`/artikel?dojo_id=${e}`:"/artikel",t=await r.get(n,{headers:{Authorization:`Bearer ${c}`}});z(t.data.data||[])}catch(e){console.error("Fehler beim Laden der Artikel:",e)}},V=async()=>{try{if(console.log("üîç loadBankDaten aufgerufen, activeDojo:",m),!(null==m?void 0:m.dojo_id)&&!(null==m?void 0:m.id))return void console.log("‚ö†Ô∏è Keine dojo_id gefunden");const n=m.dojo_id||m.id;console.log("üîç Lade Bankdaten f√ºr Dojo:",n);const t=await r.get(`/dojo-banken/${n}`,{headers:{Authorization:`Bearer ${c}`}});if(console.log("üîç Bankdaten-Response:",t.data),t.data&&t.data.length>0){const e=t.data.find(e=>e.ist_standard&&e.ist_aktiv&&"bank"===e.bank_typ)||t.data.find(e=>e.ist_aktiv&&"bank"===e.bank_typ);if(console.log("üîç Gefundene Standard-Bank:",e),e&&e.iban&&e.bic&&e.kontoinhaber){const n={bank_name:e.bank_name||"",iban:e.iban.replace(/\s/g,"").toUpperCase(),bic:e.bic.toUpperCase(),kontoinhaber:e.kontoinhaber};return console.log("‚úÖ Bankdaten gesetzt:",n),void R(n)}}console.log("üîç Pr√ºfe Dojo-Objekt f√ºr Bankdaten:",{dojo_id:n,bank_iban:m.bank_iban,iban:m.iban,bank_bic:m.bank_bic,bic:m.bic,bank_inhaber:m.bank_inhaber,inhaber:m.inhaber,dojoname:m.dojoname,allKeys:Object.keys(m)});const i=m.bank_iban||m.iban,a=m.bank_bic||m.bic,s=m.bank_inhaber||m.inhaber||m.dojoname,o=m.bank_name||"";if(console.log("üîç Extrahierte Werte:",{dojoIban:i,dojoBic:a,dojoInhaber:s,dojoBankName:o}),i&&a&&s){const e={bank_name:o,iban:i.replace(/\s/g,"").toUpperCase(),bic:a.toUpperCase(),kontoinhaber:s};console.log("‚úÖ Bankdaten aus Dojo-Objekt gesetzt:",e),R(e)}else{console.warn("‚ö†Ô∏è Keine Bankdaten gefunden. Verf√ºgbare Felder:",{bank_iban:m.bank_iban,iban:m.iban,bank_bic:m.bank_bic,bic:m.bic,bank_inhaber:m.bank_inhaber,inhaber:m.inhaber,dojoname:m.dojoname}),console.log("üîÑ Versuche automatische Migration der Bankdaten...");try{const e=await r.post("/dojo-banken/migrate",{},{headers:{Authorization:`Bearer ${c}`}});if(console.log("‚úÖ Migration-Ergebnis:",e.data),e.data.success){const e=await r.get(`/dojo-banken/${n}`,{headers:{Authorization:`Bearer ${c}`}});if(e.data&&e.data.length>0){const n=e.data.find(e=>e.ist_standard&&e.ist_aktiv&&"bank"===e.bank_typ)||e.data.find(e=>e.ist_aktiv&&"bank"===e.bank_typ);if(n&&n.iban&&n.bic&&n.kontoinhaber){const e={bank_name:n.bank_name||"",iban:n.iban.replace(/\s/g,"").toUpperCase(),bic:n.bic.toUpperCase(),kontoinhaber:n.kontoinhaber};return console.log("‚úÖ Bankdaten nach Migration gesetzt:",e),void R(e)}}}}catch(e){console.error("‚ùå Fehler bei der Migration:",e)}}}catch(n){console.error("‚ùå Fehler beim Laden der Bankdaten:",n);const e=(null==m?void 0:m.bank_iban)||(null==m?void 0:m.iban),t=(null==m?void 0:m.bank_bic)||(null==m?void 0:m.bic),i=(null==m?void 0:m.bank_inhaber)||(null==m?void 0:m.inhaber)||(null==m?void 0:m.dojoname),r=(null==m?void 0:m.bank_name)||"";if(e&&t&&i){const n={bank_name:r,iban:e.replace(/\s/g,"").toUpperCase(),bic:t.toUpperCase(),kontoinhaber:i};console.log("‚úÖ Bankdaten aus Dojo-Objekt (Fallback) gesetzt:",n),R(n)}}},Y=async e=>{try{const n=await r.get("/rechnungen/naechste-nummer",{params:{datum:e},headers:{Authorization:`Bearer ${c}`}});n.data.success&&I(e=>({...e,rechnungsnummer:n.data.rechnungsnummer}))}catch(n){console.error("Fehler beim Laden der Rechnungsnummer:",n),I(e=>({...e,rechnungsnummer:"Fehler beim Laden"}))}},X=()=>{if(!U)return;const e=U;let n=e.verkaufspreis_cent;e.hat_preiskategorien&&q.preiskategorie&&("kids"===q.preiskategorie&&e.preis_kids_cent?n=e.preis_kids_cent:"erwachsene"===q.preiskategorie&&e.preis_erwachsene_cent&&(n=e.preis_erwachsene_cent));const t=[q.groesse&&`Gr. ${q.groesse}`,q.farbe,q.material,q.preiskategorie&&("kids"===q.preiskategorie?"Kids":"Erwachsene")].filter(Boolean).join(", "),i=t?`${e.name} (${t})`:e.name,r=[q.groesse,q.farbe,q.material,q.preiskategorie].filter(Boolean).join("-"),a=`${e.artikel_id}-${r||"default"}`;E({...W,artikel_id:e.artikel_id,unique_variant_id:a,bezeichnung:i,artikelnummer:e.artikel_nummer||"",einzelpreis:Number(n)/100,ust_prozent:Number(e.mwst_prozent)||19,variante:{...q}}),M(!1),P(null)},J=()=>$.reduce((e,n)=>{const t=Number(n.einzelpreis)*Number(n.menge);return e+(t-(n.ist_rabattfaehig?t*Number(n.rabatt_prozent)/100:0))},0),ee=()=>{const e=J();if(T.rabatt_prozent>0){return(T.rabatt_auf_betrag||e)*T.rabatt_prozent/100}return 0},ne=()=>J()-ee(),te=()=>{const e=ne();return T.skonto_prozent>0&&T.skonto_tage>0?e*T.skonto_prozent/100:0},ie=()=>19*ne()/100,re=()=>ne()+ie(),ae=(e,n=0)=>{if(!e)return"";const t=new Date(e);n>0&&t.setDate(t.getDate()+n);return`${String(t.getDate()).padStart(2,"0")}.${String(t.getMonth()+1).padStart(2,"0")}.${t.getFullYear()}`},se=(e,n=!1)=>{console.log("üîç generateEPCQRCode aufgerufen:",{betrag:e,mitSkonto:n,bankDaten:F});const t=F.iban&&""!==F.iban.trim(),i=F.bic&&""!==F.bic.trim(),r=F.kontoinhaber&&""!==F.kontoinhaber.trim();if(!t||!i||!r)return console.warn("‚ö†Ô∏è Bankdaten unvollst√§ndig:",{iban:F.iban,bic:F.bic,kontoinhaber:F.kontoinhaber,hasIban:t,hasBic:i,hasKontoinhaber:r}),"";if(!e||isNaN(e)||e<=0)return console.warn("‚ö†Ô∏è Ung√ºltiger Betrag:",e),"";const a=`Rechnung ${T.rechnungsnummer||""}`.substring(0,140),s=T.rechnungsnummer||"",o=["BCD","002","1","SCT",F.bic.trim(),F.kontoinhaber.trim().substring(0,70),F.iban.trim(),`EUR${Number(e).toFixed(2)}`,"",a,s.substring(0,35),"",""].join("\n");return console.log("‚úÖ EPC QR-Code generiert (L√§nge:",o.length,"):",o.substring(0,150)+"..."),o};if(N)return n.jsx("div",{className:"rechnung-erstellen-container",children:n.jsx("div",{style:{textAlign:"center",padding:"3rem",color:"#ffffff"},children:"Lade Daten..."})});if(B)return n.jsx("div",{className:"rechnung-erstellen-container",children:n.jsxs("div",{style:{textAlign:"center",padding:"3rem",color:"#ef4444"},children:[n.jsx("h2",{children:"Fehler"}),n.jsx("p",{children:B}),n.jsx("button",{onClick:()=>window.location.reload(),style:{marginTop:"1rem",padding:"0.5rem 1rem"},children:"Seite neu laden"})]})});return n.jsxs("div",{className:"rechnung-erstellen-container",children:[n.jsxs("div",{className:"rechnung-editor",children:[n.jsxs("div",{className:"rechnung-form",children:[n.jsx("h2",{children:"Neue Rechnung erstellen"}),n.jsxs("div",{className:"form-section",children:[n.jsx("h3",{children:"Kunde"}),n.jsxs("select",{onChange:e=>(e=>{const n=v.find(n=>n.mitglied_id===parseInt(e));w(n),I({...T,kundennummer:(null==n?void 0:n.mitglied_id)||""})})(e.target.value),value:(null==y?void 0:y.mitglied_id)||"",children:[n.jsx("option",{value:"",children:"Bitte w√§hlen..."}),v.map(e=>n.jsxs("option",{value:e.mitglied_id,children:[e.vorname," ",e.nachname]},e.mitglied_id))]})]}),n.jsxs("div",{className:"form-section",style:{marginBottom:"0.4rem",paddingBottom:"0.4rem"},children:[n.jsx("h3",{style:{margin:"0 0 0.3rem 0",fontSize:"0.75rem"},children:"Rechnungsdaten"}),n.jsxs("div",{className:"form-grid",style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"0.5rem 0.6rem",marginBottom:"0",alignItems:"start"},children:[n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.1rem",minWidth:"0"},children:[n.jsx("label",{style:{marginBottom:"0",fontSize:"0.7rem",lineHeight:"1.2"},children:"Belegdatum"}),n.jsx("input",{type:"date",value:T.belegdatum,onChange:e=>{const n=e.target.value;I({...T,belegdatum:n,zahlungsfrist:D(n)})},style:{padding:"0.3rem 0.45rem",fontSize:"0.75rem",width:"100%",boxSizing:"border-box"}})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.1rem",minWidth:"0"},children:[n.jsx("label",{style:{marginBottom:"0",fontSize:"0.7rem",lineHeight:"1.2"},children:"Leistungsdatum"}),n.jsx("input",{type:"date",value:T.leistungsdatum,onChange:e=>I({...T,leistungsdatum:e.target.value}),style:{padding:"0.3rem 0.45rem",fontSize:"0.75rem",width:"100%",boxSizing:"border-box"}})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.1rem",minWidth:"0"},children:[n.jsx("label",{style:{marginBottom:"0",fontSize:"0.7rem",lineHeight:"1.2"},children:"Zahlungsfrist"}),n.jsx("input",{type:"date",value:T.zahlungsfrist,onChange:e=>I({...T,zahlungsfrist:e.target.value}),style:{padding:"0.3rem 0.45rem",fontSize:"0.75rem",width:"100%",boxSizing:"border-box"}})]})]})]}),n.jsxs("div",{className:"form-section",children:[n.jsx("h3",{children:"Position hinzuf√ºgen"}),n.jsxs("div",{className:"position-input",style:{display:"grid",gridTemplateColumns:"1fr 60px auto",gap:"0.5rem",alignItems:"end"},children:[n.jsxs("select",{onChange:e=>(e=>{const n=_.find(n=>n.artikel_id===parseInt(e));n&&(n.hat_varianten&&(n.varianten_groessen&&n.varianten_groessen.length>0||n.varianten_farben&&n.varianten_farben.length>0||n.varianten_material&&n.varianten_material.length>0||n.hat_preiskategorien)?(P(n),K({groesse:"",farbe:"",material:"",preiskategorie:""}),M(!0)):E({...W,artikel_id:n.artikel_id,bezeichnung:n.name,artikelnummer:n.artikel_nummer||"",einzelpreis:Number(n.verkaufspreis_cent)/100,ust_prozent:Number(n.mwst_prozent)||19}))})(e.target.value),value:W.artikel_id,style:{padding:"0.3rem 0.45rem",fontSize:"0.75rem",width:"100%",boxSizing:"border-box"},children:[n.jsx("option",{value:"",children:"Artikel w√§hlen..."}),_.map(e=>n.jsxs("option",{value:e.artikel_id,children:[e.name," - ",(e.verkaufspreis_cent/100).toFixed(2)," ‚Ç¨"]},e.artikel_id))]}),n.jsx("input",{type:"number",placeholder:"Menge",value:W.menge,onChange:e=>E({...W,menge:parseInt(e.target.value)}),min:"1",style:{padding:"0.3rem 0.35rem",fontSize:"0.75rem",width:"100%",boxSizing:"border-box"}}),n.jsx("button",{onClick:()=>{if(!W.bezeichnung||W.menge<=0)return;const e=$.findIndex(e=>W.unique_variant_id&&e.unique_variant_id?e.unique_variant_id===W.unique_variant_id:W.artikel_id&&e.artikel_id?e.artikel_id===W.artikel_id&&e.bezeichnung===W.bezeichnung&&Number(e.einzelpreis)===Number(W.einzelpreis):e.bezeichnung===W.bezeichnung&&Number(e.einzelpreis)===Number(W.einzelpreis));if(-1!==e){const n=[...$];n[e]={...n[e],menge:Number(n[e].menge)+Number(W.menge)},A(n)}else A([...$,{...W,pos:$.length+1,menge:Number(W.menge),einzelpreis:Number(W.einzelpreis),ust_prozent:Number(W.ust_prozent),ist_rabattfaehig:W.ist_rabattfaehig,rabatt_prozent:Number(W.rabatt_prozent)||0}]);E({artikel_id:"",bezeichnung:"",artikelnummer:"",menge:1,einzelpreis:0,ust_prozent:19,ist_rabattfaehig:!1,rabatt_prozent:0})},className:"btn-add",style:{whiteSpace:"nowrap"},children:"Hinzuf√ºgen"})]}),n.jsxs("div",{style:{marginTop:"0.75rem",display:"flex",alignItems:"center",gap:"1rem"},children:[n.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.4rem",cursor:"pointer"},children:[n.jsx("input",{type:"checkbox",checked:W.ist_rabattfaehig,onChange:e=>E({...W,ist_rabattfaehig:e.target.checked,rabatt_prozent:e.target.checked?W.rabatt_prozent:0}),style:{cursor:"pointer",width:"14px",height:"14px",flexShrink:0}}),n.jsx("span",{className:"checkbox-label",style:{fontSize:"0.85rem"},children:"Rabattf√§hig"})]}),W.ist_rabattfaehig&&n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[n.jsx("label",{className:"rabatt-label",children:"Rabatt %:"}),n.jsx("input",{type:"number",className:"rabatt-input",value:W.rabatt_prozent,onChange:e=>E({...W,rabatt_prozent:parseFloat(e.target.value)||0}),min:"0",max:"100",step:"0.01"})]})]}),$.length>0&&n.jsxs("div",{style:{marginTop:"1rem",maxHeight:"300px",overflowY:"auto"},children:[n.jsx("h4",{className:"positionen-liste-header",children:"Hinzugef√ºgte Positionen:"}),$.map((e,t)=>n.jsxs("div",{className:"position-item",style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[n.jsxs("div",{className:"position-item-text",style:{flex:1,paddingRight:"0.5rem"},children:[n.jsx("strong",{children:e.bezeichnung})," - ",e.menge,"x ",Number(e.einzelpreis).toFixed(2)," ‚Ç¨"]}),n.jsx("button",{onClick:()=>(e=>{const n=$.filter((n,t)=>t!==e);A(n.map((e,n)=>({...e,pos:n+1})))})(t),style:{background:"rgba(239, 68, 68, 0.2)",border:"1px solid rgba(239, 68, 68, 0.4)",borderRadius:"4px",color:"#ef4444",width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"1.1rem",fontWeight:"bold",padding:0,flexShrink:0,transition:"all 0.2s"},onMouseOver:e=>e.currentTarget.style.background="rgba(239, 68, 68, 0.3)",onMouseOut:e=>e.currentTarget.style.background="rgba(239, 68, 68, 0.2)",title:"Position entfernen",children:"√ó"})]}),n.jsxs("div",{className:"position-item-divider",style:{display:"flex",flexDirection:"column",gap:"0.5rem",paddingTop:"0.25rem",alignItems:"flex-start"},children:[n.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:"0.4rem",cursor:"pointer",width:"auto"},children:[n.jsx("input",{type:"checkbox",checked:e.ist_rabattfaehig||!1,onChange:e=>{const n=[...$];n[t]={...n[t],ist_rabattfaehig:e.target.checked,rabatt_prozent:e.target.checked?n[t].rabatt_prozent:0},A(n)},style:{cursor:"pointer",width:"12px",height:"12px",flexShrink:0}}),n.jsx("span",{className:"checkbox-label",style:{whiteSpace:"nowrap"},children:"Rabattf√§hig"})]}),e.ist_rabattfaehig&&n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",paddingLeft:"1.25rem"},children:[n.jsx("label",{className:"rabatt-label",style:{minWidth:"60px"},children:"Rabatt %:"}),n.jsx("input",{type:"number",className:"rabatt-input",value:e.rabatt_prozent||0,onChange:e=>{const n=[...$];n[t]={...n[t],rabatt_prozent:parseFloat(e.target.value)||0},A(n)},min:"0",max:"100",step:"0.01"})]})]})]},t))]})]}),n.jsxs("div",{className:"form-section",children:[n.jsx("h3",{children:"Rabatt & Skonto"}),n.jsxs("div",{className:"form-grid",style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"0.5rem 0.6rem",marginBottom:"0"},children:[n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.1rem",minWidth:"0",position:"relative",overflow:"visible"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.3rem",marginBottom:"0"},children:[n.jsx("label",{style:{marginBottom:"0",fontSize:"0.7rem",lineHeight:"1.2"},children:"Rabatt %"}),n.jsx("button",{type:"button",onClick:()=>H(!L),style:{background:"rgba(255, 215, 0, 0.2)",border:"1px solid rgba(255, 215, 0, 0.4)",borderRadius:"50%",color:"#ffd700",width:"14px",height:"14px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"0.65rem",fontWeight:"bold",padding:0,flexShrink:0},title:"Info anzeigen",children:"?"})]}),L&&n.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:9999,padding:"1rem",background:"rgba(255, 215, 0, 0.98)",border:"2px solid rgba(255, 215, 0, 1)",borderRadius:"8px",color:"#000000",fontSize:"0.85rem",lineHeight:"1.5",maxWidth:"320px",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.5)",whiteSpace:"normal"},children:[n.jsx("strong",{children:"Globaler Rabatt:"})," Dieser Rabatt wird auf die gesamte Rechnung angewendet.",n.jsx("br",{}),n.jsx("br",{}),"F√ºr ",n.jsx("strong",{children:"einzelne Positionen"})," k√∂nnen Sie den Rabatt oben in der Positionsliste festlegen.",n.jsx("button",{onClick:()=>H(!1),style:{marginTop:"0.75rem",padding:"0.4rem 0.75rem",background:"#000000",color:"#ffd700",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"0.75rem",fontWeight:"bold",width:"100%"},children:"Verstanden"})]}),L&&n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",zIndex:9998},onClick:()=>H(!1)}),n.jsx("input",{type:"number",value:T.rabatt_prozent,onChange:e=>I({...T,rabatt_prozent:parseFloat(e.target.value)||0}),min:"0",max:"100",step:"0.01",style:{padding:"0.3rem 0.45rem",fontSize:"0.75rem",width:"100%",boxSizing:"border-box"}})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.1rem",minWidth:"0"},children:[n.jsx("label",{style:{marginBottom:"0",fontSize:"0.7rem",lineHeight:"1.2"},children:"Skonto %"}),n.jsx("input",{type:"number",value:T.skonto_prozent,onChange:e=>I({...T,skonto_prozent:parseFloat(e.target.value)||0}),min:"0",max:"100",step:"0.01",style:{padding:"0.3rem 0.45rem",fontSize:"0.75rem",width:"100%",boxSizing:"border-box"}})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.1rem",minWidth:"0"},children:[n.jsx("label",{style:{marginBottom:"0",fontSize:"0.7rem",lineHeight:"1.2"},children:"Skonto Tage"}),n.jsx("input",{type:"number",value:T.skonto_tage,readOnly:!0,min:"0",placeholder:"Automatisch aus Zahlungsziel",style:{padding:"0.3rem 0.45rem",fontSize:"0.75rem",width:"100%",boxSizing:"border-box",backgroundColor:"rgba(255, 255, 255, 0.03)",cursor:"not-allowed"}})]})]})]}),n.jsx("button",{onClick:async()=>{if(!y||0===$.length)return void alert("Bitte w√§hlen Sie ein Mitglied und f√ºgen Sie mindestens eine Position hinzu.");const e=(()=>{const e=document.querySelector(".invoice-page");if(!e)return console.error("Vorschau-Element nicht gefunden"),null;const n=e.cloneNode(!0);return n.querySelectorAll("svg").forEach(e=>{try{const n=(new XMLSerializer).serializeToString(e),t=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(n)))}`,i=document.createElement("img");i.src=t,i.style.width="150px",i.style.height="150px",i.style.display="block",i.style.margin="0 auto",e.parentNode.replaceChild(i,e)}catch(n){console.error("Fehler bei QR-Code Konvertierung:",n)}}),`<!DOCTYPE html>\n<html lang="de">\n<head>\n  <meta charset="UTF-8">\n  <title>Rechnung ${T.rechnungsnummer}</title>\n  <style>\n      * { margin: 0; padding: 0; box-sizing: border-box; }\n\n      body {\n        font-family: Arial, sans-serif;\n        font-size: 10pt;\n        line-height: 1.4;\n        color: #000;\n        background: white;\n      }\n\n      .invoice-page {\n        background: white;\n        max-width: 210mm;\n        min-height: 297mm;\n        margin: 0 auto;\n        padding: 20mm;\n        padding-bottom: 50mm;\n        position: relative;\n        font-family: Arial, sans-serif;\n        font-size: 10pt;\n        line-height: 1.4;\n        color: #000000;\n      }\n\n      .invoice-header {\n        display: flex;\n        justify-content: space-between;\n        margin-bottom: 3rem;\n      }\n\n      .company-info {\n        flex: 1;\n      }\n\n      .company-small {\n        font-size: 8pt;\n        color: #666;\n        margin-bottom: 1rem;\n        padding-bottom: 0.5rem;\n        border-bottom: 1px solid #000;\n      }\n\n      .recipient-address {\n        margin-top: 1rem;\n        line-height: 1.6;\n      }\n\n      .invoice-meta {\n        text-align: right;\n        min-width: 250px;\n      }\n\n      .logo-placeholder {\n        width: 120px;\n        height: 120px;\n        border: 2px solid #000;\n        border-radius: 50%;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        margin-left: auto;\n        margin-bottom: 1rem;\n        font-weight: bold;\n        color: #666;\n      }\n\n      .invoice-numbers {\n        font-size: 9pt;\n        line-height: 1.8;\n      }\n\n      .invoice-title {\n        margin-bottom: 2rem;\n      }\n\n      .invoice-title h1 {\n        font-size: 18pt;\n        font-weight: bold;\n        margin: 0 0 0.5rem 0;\n        color: #000000;\n      }\n\n      .page-number {\n        text-align: right;\n        font-size: 9pt;\n        color: #666;\n      }\n\n      .invoice-table {\n        width: 100%;\n        border-collapse: collapse;\n        margin-bottom: 2rem;\n        font-size: 9pt;\n      }\n\n      .invoice-table thead {\n        background: #f3f4f6;\n        border-top: 1px solid #000;\n        border-bottom: 1px solid #000;\n      }\n\n      .invoice-table th {\n        padding: 0.5rem 0.25rem;\n        text-align: left;\n        font-weight: bold;\n        font-size: 8pt;\n      }\n\n      .invoice-table th:nth-child(3),\n      .invoice-table th:nth-child(4),\n      .invoice-table th:nth-child(6),\n      .invoice-table th:nth-child(7),\n      .invoice-table th:nth-child(8) {\n        text-align: right;\n      }\n\n      .invoice-table td {\n        padding: 0.5rem 0.25rem;\n        border-bottom: 1px solid #e5e7eb;\n      }\n\n      .invoice-table td:nth-child(3),\n      .invoice-table td:nth-child(4),\n      .invoice-table td:nth-child(6),\n      .invoice-table td:nth-child(7),\n      .invoice-table td:nth-child(8) {\n        text-align: right;\n      }\n\n      .invoice-totals {\n        margin-left: auto;\n        width: 50%;\n        font-size: 10pt;\n      }\n\n      .totals-row {\n        display: flex;\n        justify-content: space-between;\n        padding: 0.4rem 0;\n        border-bottom: 1px solid #e5e7eb;\n      }\n\n      .totals-row.total-final {\n        font-weight: bold;\n        font-size: 11pt;\n        border-top: 2px solid #000;\n        border-bottom: 2px solid #000;\n        margin-top: 0.5rem;\n        padding-top: 0.5rem;\n      }\n\n      .payment-terms {\n        margin-top: 2rem;\n        font-size: 9pt;\n      }\n\n      .payment-terms p {\n        margin: 0.25rem 0;\n      }\n\n      .qr-code-title {\n        color: #000000;\n        font-size: 0.85rem;\n        font-weight: bold;\n        text-transform: uppercase;\n        margin-bottom: 0.5rem;\n      }\n\n      .qr-codes-section {\n        display: flex;\n        gap: 2rem;\n        justify-content: center;\n        flex-wrap: nowrap;\n        align-items: flex-start;\n      }\n\n      .qr-codes-section > div {\n        flex: 1;\n        min-width: 200px;\n        text-align: center;\n      }\n\n      .rechnung-footer {\n        position: fixed;\n        bottom: 0;\n        left: 0;\n        right: 0;\n        padding: 0.75rem 20mm 0.5rem 20mm;\n        border-top: 1px solid rgba(0, 0, 0, 0.2);\n        font-size: 7pt;\n        color: #000000;\n        line-height: 1.6;\n        text-align: center;\n        background: white;\n      }\n\n      @page {\n        margin: 0;\n        size: A4 portrait;\n      }\n\n      @media print {\n        body {\n          margin: 0;\n          padding: 0;\n        }\n      }\n    </style>\n</head>\n<body>${n.outerHTML}</body>\n</html>`})();if(!e)return void alert("Fehler beim Erstellen der PDF-Vorschau");const n={mitglied_id:y.mitglied_id,datum:T.belegdatum,faelligkeitsdatum:T.zahlungsfrist,art:"sonstiges",beschreibung:"Rechnung",notizen:"",positionen:$.map(e=>{const n=Number(e.einzelpreis)*Number(e.menge),t=n-(e.ist_rabattfaehig?n*Number(e.rabatt_prozent)/100:0);return{bezeichnung:e.bezeichnung,menge:e.menge,einzelpreis:e.einzelpreis,gesamtpreis:t,mwst_satz:e.ust_prozent,ist_rabattfaehig:e.ist_rabattfaehig||!1,rabatt_prozent:e.rabatt_prozent||0}}),mwst_satz:19,pdfHtml:e};try{const e=await r.post("/rechnungen",n,{headers:{Authorization:`Bearer ${c}`}});if(e.data.success){alert(`Rechnung erfolgreich erstellt!\nRechnungsnummer: ${e.data.rechnungsnummer}`),w(null),A([]);const n=(new Date).toISOString().split("T")[0];I({rechnungsnummer:"Wird geladen...",kundennummer:"",belegdatum:n,leistungsdatum:n,zahlungsfrist:D(n),rabatt_prozent:0,rabatt_auf_betrag:0}),Y(n)}}catch(t){console.error("Fehler beim Speichern:",t),alert("Fehler beim Erstellen der Rechnung")}},className:"btn-save",style:{marginTop:"0.5rem",padding:"0.6rem",fontSize:"0.9rem"},children:"Rechnung speichern"})]}),n.jsx("div",{className:"rechnung-preview",children:n.jsxs("div",{className:"invoice-page",children:[n.jsxs("div",{className:"invoice-header",children:[n.jsxs("div",{className:"company-info",children:[n.jsxs("div",{className:"company-small",children:[null==m?void 0:m.dojoname," | ",null==m?void 0:m.strasse," ",null==m?void 0:m.hausnummer," | ",null==m?void 0:m.plz," ",null==m?void 0:m.ort]}),n.jsx("div",{className:"recipient-address",children:y?n.jsxs(n.Fragment,{children:[n.jsx("div",{children:"Herrn/Frau"}),n.jsxs("div",{children:[y.vorname," ",y.nachname]}),n.jsxs("div",{children:[y.adresse," ",y.hausnummer]}),n.jsxs("div",{children:[y.plz," ",y.ort]})]}):n.jsx("div",{style:{color:"#999"},children:"Bitte Kunde w√§hlen"})})]}),n.jsxs("div",{className:"invoice-meta",children:[f?n.jsx("img",{src:f,alt:(null==m?void 0:m.dojoname)||"Dojo Logo",className:"invoice-logo",style:{maxWidth:"200px",maxHeight:"100px",objectFit:"contain"}}):n.jsx("div",{className:"logo-placeholder",children:(null==(d=null==(l=null==m?void 0:m.dojoname)?void 0:l.substring(0,3))?void 0:d.toUpperCase())||"LOGO"}),n.jsxs("div",{className:"invoice-numbers",children:[n.jsxs("div",{children:["Rechnungs-Nr.: ",T.rechnungsnummer||"wird generiert"]}),n.jsxs("div",{children:["Kundennummer: ",T.kundennummer]}),n.jsxs("div",{children:["Belegdatum: ",T.belegdatum]}),n.jsxs("div",{children:["Liefer-/Leistungsdatum: ",T.leistungsdatum]})]})]})]}),n.jsxs("div",{className:"invoice-title",children:[n.jsx("h1",{style:{color:"#000000",fontWeight:"bold",textShadow:"none",boxShadow:"none"},children:"Rechnung"}),n.jsx("div",{className:"page-number",children:"Seite 1 von 1"})]}),n.jsxs("table",{className:"invoice-table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{children:"Pos."}),n.jsx("th",{children:"Bezeichnung"}),n.jsx("th",{children:"Artikelnummer"}),n.jsx("th",{children:"Menge"}),n.jsx("th",{children:"Einheit"}),n.jsx("th",{children:"Preis"}),n.jsx("th",{children:"Rabatt %"}),n.jsx("th",{children:"USt %"}),n.jsx("th",{children:"Betrag EUR"})]})}),n.jsx("tbody",{children:$.map((e,t)=>{const i=Number(e.einzelpreis)*Number(e.menge),r=i-(e.ist_rabattfaehig?i*Number(e.rabatt_prozent)/100:0);return n.jsxs("tr",{children:[n.jsx("td",{children:e.pos}),n.jsx("td",{children:e.bezeichnung}),n.jsx("td",{children:e.artikelnummer}),n.jsx("td",{children:e.menge}),n.jsx("td",{children:"Stk."}),n.jsx("td",{children:Number(e.einzelpreis).toFixed(2)}),n.jsx("td",{children:e.ist_rabattfaehig?`${Number(e.rabatt_prozent).toFixed(2)} %`:"-"}),n.jsxs("td",{children:[Number(e.ust_prozent).toFixed(2)," %"]}),n.jsx("td",{children:r.toFixed(2)})]},t)})})]}),n.jsxs("div",{className:"invoice-totals",children:[n.jsxs("div",{className:"totals-row",children:[n.jsx("span",{children:"Zwischensumme:"}),n.jsx("span",{children:J().toFixed(2)})]}),T.rabatt_prozent>0&&n.jsxs("div",{className:"totals-row",children:[n.jsxs("span",{children:[T.rabatt_prozent.toFixed(2)," % Rabatt auf EUR ",(T.rabatt_auf_betrag||J()).toFixed(2),":"]}),n.jsxs("span",{children:["-",ee().toFixed(2)]})]}),n.jsxs("div",{className:"totals-row",children:[n.jsx("span",{children:"Summe:"}),n.jsx("span",{children:ne().toFixed(2)})]}),n.jsxs("div",{className:"totals-row",children:[n.jsxs("span",{children:["19,00 % USt. auf EUR ",ne().toFixed(2),":"]}),n.jsx("span",{children:ie().toFixed(2)})]}),n.jsxs("div",{className:"totals-row total-final",children:[n.jsx("span",{children:"Endbetrag:"}),n.jsx("span",{children:re().toFixed(2)})]})]}),n.jsxs("div",{style:{display:"flex",gap:"2rem",marginTop:"2rem",alignItems:"flex-start"},children:[n.jsxs("div",{className:"payment-terms",style:{flex:"1",minWidth:"300px"},children:[n.jsx("p",{children:"Bitte beachten Sie unsere Zahlungsbedingung:"}),T.zahlungsfrist?n.jsx(n.Fragment,{children:Number(T.skonto_prozent)>0&&Number(T.skonto_tage)>0?n.jsxs("p",{children:[Number(T.skonto_prozent).toFixed(2)," % Skonto bei Zahlung innerhalb von ",T.skonto_tage," Tagen (bis zum ",ae(T.belegdatum,T.skonto_tage),").",n.jsx("br",{}),"Ohne Abzug bis zum ",ae(T.zahlungsfrist),".",n.jsx("br",{}),"Skonto-Betrag: ",te().toFixed(2)," ‚Ç¨",n.jsx("br",{}),"Zu √ºberweisender Betrag: ",(re()-te()).toFixed(2)," ‚Ç¨"]}):n.jsxs("p",{children:["Ohne Abzug bis zum ",ae(T.zahlungsfrist),"."]})}):n.jsx("p",{children:"Ohne Abzug bis zum ___________."})]}),(()=>{const e=F.iban&&""!==F.iban.trim(),n=F.bic&&""!==F.bic.trim(),t=F.kontoinhaber&&""!==F.kontoinhaber.trim(),i=e&&n&&t;return console.log("üîç QR-Code Anzeige-Check:",{hasBankData:i,hasIban:e,hasBic:n,hasKontoinhaber:t,iban:F.iban,bic:F.bic,kontoinhaber:F.kontoinhaber,bankDaten:F}),i||console.warn("‚ö†Ô∏è QR-Codes k√∂nnen nicht angezeigt werden - Bankdaten fehlen:",{iban:F.iban,bic:F.bic,kontoinhaber:F.kontoinhaber,ibanEmpty:!e,bicEmpty:!n,kontoinhaberEmpty:!t}),i})()?n.jsx("div",{className:"qr-codes-section",style:{flex:"0 0 auto",display:"flex",gap:"0.5rem",justifyContent:"center",flexWrap:"nowrap",alignItems:"flex-start",width:"180px",marginRight:"5mm"},children:Number(T.skonto_prozent)>0&&Number(T.skonto_tage)>0?n.jsxs(n.Fragment,{children:[(()=>{const e=re()-te(),t=se(e,!0);if(!t||""===t.trim())return console.warn("‚ö†Ô∏è QR-Code mit Skonto konnte nicht generiert werden"),null;const i=ae(T.belegdatum,Number(T.skonto_tage));return n.jsxs("div",{style:{textAlign:"center",flex:"0 0 auto",width:"90px"},children:[n.jsx("h4",{className:"qr-code-title",style:{marginBottom:"0.5rem",fontSize:"0.85rem",fontWeight:"bold",color:"#000000",textShadow:"none",boxShadow:"none",textTransform:"uppercase"},children:"Zahlung mit Skonto"}),n.jsx("div",{style:{padding:"0.3rem",background:"#fff",display:"inline-block",borderRadius:"4px"},children:n.jsx(a,{value:t,size:70,level:"M"})}),n.jsxs("p",{style:{marginTop:"0",fontSize:"0.75rem",color:"#000000",fontWeight:"600",lineHeight:"1.2"},children:["Betrag: ",e.toFixed(2)," ‚Ç¨"]}),n.jsxs("p",{style:{marginTop:"0",fontSize:"0.7rem",color:"#000000",fontWeight:"600",lineHeight:"1.2"},children:["bis zum ",i," zu zahlen"]})]})})(),(()=>{const e=re(),t=se(e,!1);if(!t||""===t.trim())return console.warn("‚ö†Ô∏è QR-Code ohne Skonto konnte nicht generiert werden"),null;const i=ae(T.zahlungsfrist);return n.jsxs("div",{style:{textAlign:"center",flex:"0 0 auto",width:"90px"},children:[n.jsx("h4",{className:"qr-code-title",style:{marginBottom:"0.5rem",fontSize:"0.85rem",fontWeight:"bold",color:"#000000",textShadow:"none",boxShadow:"none",textTransform:"uppercase"},children:"Zahlung ohne Skonto"}),n.jsx("div",{style:{padding:"0.3rem",background:"#fff",display:"inline-block",borderRadius:"4px"},children:n.jsx(a,{value:t,size:70,level:"M"})}),n.jsxs("p",{style:{marginTop:"0",fontSize:"0.75rem",color:"#000000",fontWeight:"600",lineHeight:"1.2"},children:["Betrag: ",e.toFixed(2)," ‚Ç¨"]}),n.jsxs("p",{style:{marginTop:"0",fontSize:"0.7rem",color:"#000000",fontWeight:"600",lineHeight:"1.2"},children:["ab ",i," zu zahlen"]})]})})()]}):(()=>{const e=re(),t=se(e,!1);if(!t||""===t.trim())return console.warn("‚ö†Ô∏è QR-Code konnte nicht generiert werden"),null;const i=ae(T.zahlungsfrist);return n.jsxs("div",{style:{textAlign:"center",flex:"0 0 auto",width:"90px"},children:[n.jsx("h4",{className:"qr-code-title",style:{marginBottom:"0.5rem",fontSize:"0.85rem",fontWeight:"bold",color:"#000000",textShadow:"none",boxShadow:"none",textTransform:"uppercase"},children:"QR-Code f√ºr √úberweisung"}),n.jsx("div",{style:{padding:"0.3rem",background:"#fff",display:"inline-block",borderRadius:"4px"},children:n.jsx(a,{value:t,size:70,level:"M"})}),n.jsxs("p",{style:{marginTop:"0",fontSize:"0.75rem",color:"#000000",fontWeight:"600",lineHeight:"1.2"},children:["Betrag: ",e.toFixed(2)," ‚Ç¨"]}),i&&n.jsxs("p",{style:{marginTop:"0",fontSize:"0.7rem",color:"#000000",fontWeight:"600",lineHeight:"1.2"},children:["bis zum ",i," zu zahlen"]})]})})()}):n.jsx("div",{style:{flex:"1",padding:"1rem",background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:"8px",textAlign:"center",minWidth:"400px"},children:n.jsx("p",{style:{color:"#ef4444",margin:0},children:"‚ö†Ô∏è QR-Codes k√∂nnen nicht angezeigt werden. Bitte stellen Sie sicher, dass Bankdaten (IBAN, BIC, Kontoinhaber) in den Dojo-Einstellungen hinterlegt sind."})})]}),n.jsxs("div",{className:"rechnung-footer",style:{position:"absolute",bottom:"0",left:"20mm",right:"20mm",paddingTop:"0.75rem",paddingBottom:"0.5rem",borderTop:"1px solid rgba(0, 0, 0, 0.2)",fontSize:"7pt",color:"#000000",lineHeight:"1.6",textAlign:"center"},children:[n.jsx("div",{style:{marginBottom:"0.3rem"},children:[null==m?void 0:m.dojoname,(null==m?void 0:m.strasse)&&(null==m?void 0:m.hausnummer)?`${m.strasse} ${m.hausnummer}`:null,(null==m?void 0:m.plz)&&(null==m?void 0:m.ort)?`${m.plz} ${m.ort}`:null,null==m?void 0:m.email,null==m?void 0:m.homepage,null==m?void 0:m.telefon].filter(Boolean).join(" | ")}),F.iban&&F.bic&&F.kontoinhaber&&n.jsx("div",{children:[F.bank_name,F.kontoinhaber,F.iban,F.bic].filter(Boolean).join(" | ")})]})]})})]}),(()=>{var e,t;if(!O||!U)return null;const i=U,r=i.varianten_groessen&&i.varianten_groessen.length>0,a=i.varianten_farben&&i.varianten_farben.length>0,s=i.varianten_material&&i.varianten_material.length>0,o=i.hat_preiskategorien;let l=i.varianten_groessen||[];o&&q.preiskategorie&&("kids"===q.preiskategorie&&(null==(e=i.groessen_kids)?void 0:e.length)>0?l=i.groessen_kids:"erwachsene"===q.preiskategorie&&(null==(t=i.groessen_erwachsene)?void 0:t.length)>0&&(l=i.groessen_erwachsene));const d=(!r||q.groesse)&&(!a||q.farbe)&&(!s||q.material)&&(!o||q.preiskategorie);let c=i.verkaufspreis_cent/100;return o&&"kids"===q.preiskategorie&&i.preis_kids_cent?c=i.preis_kids_cent/100:o&&"erwachsene"===q.preiskategorie&&i.preis_erwachsene_cent&&(c=i.preis_erwachsene_cent/100),n.jsx("div",{className:"varianten-modal-overlay",onClick:()=>M(!1),children:n.jsxs("div",{className:"varianten-modal",onClick:e=>e.stopPropagation(),children:[n.jsxs("div",{className:"varianten-modal-header",children:[n.jsx("h3",{children:i.name}),n.jsx("button",{className:"modal-close-btn",onClick:()=>M(!1),children:"√ó"})]}),n.jsxs("div",{className:"varianten-modal-content",children:[o&&n.jsxs("div",{className:"varianten-section",children:[n.jsx("label",{children:"Preiskategorie:"}),n.jsxs("div",{className:"varianten-options",children:[i.preis_kids_cent&&n.jsxs("button",{type:"button",className:"variante-btn "+("kids"===q.preiskategorie?"selected":""),onClick:()=>K(e=>({...e,preiskategorie:"kids",groesse:""})),children:["Kids - ",(i.preis_kids_cent/100).toFixed(2),"‚Ç¨"]}),i.preis_erwachsene_cent&&n.jsxs("button",{type:"button",className:"variante-btn "+("erwachsene"===q.preiskategorie?"selected":""),onClick:()=>K(e=>({...e,preiskategorie:"erwachsene",groesse:""})),children:["Erwachsene - ",(i.preis_erwachsene_cent/100).toFixed(2),"‚Ç¨"]})]})]}),r&&l.length>0&&n.jsxs("div",{className:"varianten-section",children:[n.jsx("label",{children:"Gr√∂√üe:"}),n.jsx("div",{className:"varianten-options groessen-grid",children:l.map(e=>n.jsx("button",{type:"button",className:"variante-btn "+(q.groesse===e?"selected":""),onClick:()=>K(n=>({...n,groesse:e})),children:e},e))})]}),a&&n.jsxs("div",{className:"varianten-section",children:[n.jsx("label",{children:"Farbe:"}),n.jsx("div",{className:"varianten-options",children:i.varianten_farben.map((e,t)=>{const i="object"==typeof e?e.name:e,r="object"==typeof e?e.hex:null;return n.jsx("button",{type:"button",className:"variante-btn "+(q.farbe===i?"selected":""),onClick:()=>K(e=>({...e,farbe:i})),style:r?{borderLeftColor:r,borderLeftWidth:"4px"}:{},children:i},i||t)})})]}),s&&n.jsxs("div",{className:"varianten-section",children:[n.jsx("label",{children:"Material:"}),n.jsx("div",{className:"varianten-options",children:i.varianten_material.map((e,t)=>{const i="object"==typeof e?e.name:e;return n.jsx("button",{type:"button",className:"variante-btn "+(q.material===i?"selected":""),onClick:()=>K(e=>({...e,material:i})),children:i},i||t)})})]}),n.jsxs("div",{className:"varianten-preis",children:[n.jsx("span",{children:"Preis:"}),n.jsxs("span",{className:"preis-wert",children:[c.toFixed(2),"‚Ç¨"]})]})]}),n.jsxs("div",{className:"varianten-modal-actions",children:[n.jsx("button",{className:"btn btn-secondary",onClick:()=>M(!1),children:"Abbrechen"}),n.jsx("button",{className:"btn btn-primary",onClick:X,disabled:!d,children:"Ausw√§hlen"})]})]})})})(),b&&n.jsx("div",{className:"modal-overlay",onClick:e=>{e.target===e.currentTarget&&p&&u(!1)},children:n.jsxs("div",{className:"modal-content dojo-selection-modal",children:[n.jsx("div",{className:"modal-header",children:n.jsxs("h2",{children:[n.jsx(s,{size:24})," Dojo ausw√§hlen"]})}),n.jsxs("div",{className:"modal-body",children:[n.jsx("p",{style:{marginBottom:"1rem",color:"rgba(255, 255, 255, 0.7)"},children:"F√ºr welches Dojo soll die Rechnung erstellt werden?"}),n.jsx("div",{className:"dojo-selection-grid",children:h.filter(e=>e&&e.id).map(e=>n.jsxs("div",{className:"dojo-selection-card "+((null==m?void 0:m.id)===e.id?"active":""),onClick:()=>(e=>{g(e),u(!1),x(!0)})(e),children:[n.jsxs("div",{className:"dojo-card-header",children:[n.jsx(s,{size:32}),(null==m?void 0:m.id)===e.id&&n.jsx(o,{size:20,className:"check-icon"})]}),n.jsx("h3",{children:e.dojoname}),n.jsxs("p",{className:"dojo-address",children:[e.strasse," ",e.hausnummer,n.jsx("br",{}),e.plz," ",e.ort]}),e.steuer_status&&n.jsx("span",{className:`steuer-badge ${e.steuer_status}`,children:"kleinunternehmer"===e.steuer_status?"Kleinunternehmer":"Regelbesteuert"})]},e.id))})]})]})})]})};export{l as default};
