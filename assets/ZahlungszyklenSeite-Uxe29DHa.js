import{j as e}from"./animation-1wuIdCBS.js";import{u as s,r as a}from"./vendor-router-BhMXg4Z-.js";import{c as n}from"./index-DUnH23_2.js";import{V as i,C as l,P as t,R as r,$ as c,Y as d,N as o,q as h,J as g,K as m}from"./icons-D7rg4pDH.js";import"./vendor-react-DtuzQOD1.js";import"./query-Bs1dTGah.js";const x=()=>{const g=s(),[m,x]=a.useState([]),[p,j]=a.useState(!0),[k,y]=a.useState(""),[v,f]=a.useState(""),[z,N]=a.useState(null),[S,w]=a.useState({name:"",intervall_tage:"",beschreibung:"",aktiv:!0}),[F,C]=a.useState(!1);a.useEffect(()=>{_()},[]);const _=async()=>{try{j(!0);const e=await fetch(`${n.apiBaseUrl}/zahlungszyklen`);if(!e.ok)throw new Error("Fehler beim Laden der Zahlungszyklen");const s=await e.json();x(s.data||s||[]),y("")}catch(e){console.error("Fehler beim Laden der Zahlungszyklen:",e),y("Fehler beim Laden der Zahlungszyklen: "+e.message)}finally{j(!1)}},Z=async e=>{try{const s=e.zyklus_id?"PUT":"POST",a=e.zyklus_id?`${n.apiBaseUrl}/zahlungszyklen/${e.zyklus_id}`:`${n.apiBaseUrl}/zahlungszyklen`;if(!(await fetch(a,{method:s,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok)throw new Error("Fehler beim Speichern des Zahlungszyklus");f(e.zyklus_id?"Zahlungszyklus aktualisiert!":"Zahlungszyklus erstellt!"),y(""),_(),N(null),C(!1),w({name:"",intervall_tage:"",beschreibung:"",aktiv:!0}),setTimeout(()=>f(""),3e3)}catch(s){console.error("Fehler beim Speichern:",s),y("Fehler beim Speichern: "+s.message)}},W=async e=>{if(confirm("Möchten Sie diesen Zahlungszyklus wirklich löschen?"))try{if(!(await fetch(`${n.apiBaseUrl}/zahlungszyklen/${e}`,{method:"DELETE"})).ok)throw new Error("Fehler beim Löschen des Zahlungszyklus");f("Zahlungszyklus gelöscht!"),y(""),_(),setTimeout(()=>f(""),3e3)}catch(s){console.error("Fehler beim Löschen:",s),y("Fehler beim Löschen: "+s.message)}},T=e=>{N(e.zyklus_id)},I=()=>{N(null)},B=(e,s)=>{const a=m.find(s=>s.zyklus_id===e);Z({...a,...s})},M=e=>1===e?"Täglich":7===e?"Wöchentlich":14===e?"14-tägig":30===e?"Monatlich":60===e?"Alle 2 Monate":90===e||91===e?"Vierteljährlich":180===e?"Halbjährlich":365===e?"Jährlich":`Alle ${e} Tage`;return e.jsxs("div",{className:"zahlungszyklen-seite",children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{className:"header-left",children:[e.jsxs("button",{className:"btn btn-secondary",onClick:()=>g("/dashboard/beitraege"),children:[e.jsx(i,{size:16}),"Zurück zur Beitragsverwaltung"]}),e.jsxs("div",{className:"header-title",children:[e.jsx(l,{size:32}),e.jsxs("div",{children:[e.jsx("h1",{children:"Zahlungszyklen Verwaltung"}),e.jsx("p",{children:"Verwalten Sie Zahlungsintervalle für Mitgliedsbeiträge"})]})]})]}),e.jsxs("div",{className:"header-actions",children:[e.jsxs("button",{className:"btn btn-primary",onClick:()=>C(!F),children:[e.jsx(t,{size:16}),"Neuer Zahlungszyklus"]}),e.jsxs("button",{className:"btn btn-secondary",onClick:_,disabled:p,children:[e.jsx(r,{size:16,className:p?"animate-spin":""}),"Aktualisieren"]})]})]}),k&&e.jsxs("div",{className:"error-message",children:[e.jsx(c,{size:20}),k]}),v&&e.jsxs("div",{className:"message success",children:[e.jsx(d,{size:20}),v]}),F&&e.jsxs("div",{className:"standard-card add-form-card",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{children:"Neuen Zahlungszyklus hinzufügen"}),e.jsx("button",{className:"btn btn-ghost btn-small",onClick:()=>{C(!1),w({name:"",intervall_tage:"",beschreibung:"",aktiv:!0})},children:e.jsx(c,{size:16})})]}),e.jsxs("div",{className:"input-container",children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"input-group",children:[e.jsx("label",{className:"input-label",children:"Name"}),e.jsx("input",{type:"text",className:"input-field",placeholder:"z.B. Monatlich",value:S.name,onChange:e=>w({...S,name:e.target.value})})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{className:"input-label",children:"Intervall (Tage)"}),e.jsx("input",{type:"number",className:"input-field",placeholder:"z.B. 30",value:S.intervall_tage,onChange:e=>w({...S,intervall_tage:parseInt(e.target.value)||""})})]})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{className:"input-label",children:"Beschreibung"}),e.jsx("input",{type:"text",className:"input-field",placeholder:"Beschreibung des Zahlungszyklus",value:S.beschreibung,onChange:e=>w({...S,beschreibung:e.target.value})})]}),e.jsx("div",{className:"input-group checkbox-group",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:S.aktiv,onChange:e=>w({...S,aktiv:e.target.checked})}),e.jsx("span",{className:"checkmark"}),"Aktiv"]})}),e.jsxs("div",{className:"form-actions",children:[e.jsxs("button",{className:"btn btn-primary",onClick:()=>Z(S),disabled:!S.name||!S.intervall_tage,children:[e.jsx(o,{size:16}),"Speichern"]}),e.jsxs("button",{className:"btn btn-secondary",onClick:()=>{C(!1),w({name:"",intervall_tage:"",beschreibung:"",aktiv:!0})},children:[e.jsx(c,{size:16}),"Abbrechen"]})]})]})]}),e.jsx("div",{className:"zahlungszyklen-content",children:p?e.jsxs("div",{className:"loading-container",children:[e.jsx("div",{className:"loading-spinner-large"}),e.jsx("p",{children:"Lade Zahlungszyklen..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"0.625rem",marginBottom:"1.25rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.625rem",padding:"0.625rem",background:"rgba(255, 255, 255, 0.08)",backdropFilter:"blur(20px)",borderRadius:"10px",border:"1px solid rgba(255, 215, 0, 0.2)",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.2)"},children:[e.jsx("div",{style:{width:"36px",height:"36px",minWidth:"36px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(255, 215, 0, 0.15)",color:"#ffd700",padding:"0"},children:e.jsx(l,{size:18})}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("h3",{style:{fontSize:"0.7rem",fontWeight:500,color:"rgba(255, 255, 255, 0.9)",margin:"0 0 0.15rem 0",textTransform:"uppercase",letterSpacing:"0.02em",textShadow:"none",WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale"},children:"Gesamt Zyklen"}),e.jsx("p",{style:{fontSize:"1.1rem",fontWeight:700,color:"#ffffff",margin:0,lineHeight:1,textShadow:"none",WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale"},children:m.length})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.625rem",padding:"0.625rem",background:"rgba(255, 255, 255, 0.08)",backdropFilter:"blur(20px)",borderRadius:"10px",border:"1px solid rgba(255, 215, 0, 0.2)",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.2)"},children:[e.jsx("div",{style:{width:"36px",height:"36px",minWidth:"36px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(255, 215, 0, 0.15)",color:"#ffd700",padding:"0"},children:e.jsx(d,{size:18})}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("h3",{style:{fontSize:"0.7rem",fontWeight:500,color:"rgba(255, 255, 255, 0.9)",margin:"0 0 0.15rem 0",textTransform:"uppercase",letterSpacing:"0.02em",textShadow:"none",WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale"},children:"Aktive Zyklen"}),e.jsx("p",{style:{fontSize:"1.1rem",fontWeight:700,color:"#ffffff",margin:0,lineHeight:1,textShadow:"none",WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale"},children:m.filter(e=>e.aktiv).length})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.625rem",padding:"0.625rem",background:"rgba(255, 255, 255, 0.08)",backdropFilter:"blur(20px)",borderRadius:"10px",border:"1px solid rgba(255, 215, 0, 0.2)",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.2)"},children:[e.jsx("div",{style:{width:"36px",height:"36px",minWidth:"36px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(255, 215, 0, 0.15)",color:"#ffd700",padding:"0"},children:e.jsx(h,{size:18})}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("h3",{style:{fontSize:"0.7rem",fontWeight:500,color:"rgba(255, 255, 255, 0.9)",margin:"0 0 0.15rem 0",textTransform:"uppercase",letterSpacing:"0.02em",textShadow:"none",WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale"},children:"Kürzester Zyklus"}),e.jsx("p",{style:{fontSize:"1.1rem",fontWeight:700,color:"#ffffff",margin:0,lineHeight:1,textShadow:"none",WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale"},children:m.length>0?`${Math.min(...m.map(e=>e.intervall_tage))} Tage`:"0 Tage"})]})]})]}),e.jsx("div",{className:"zahlungszyklen-grid",children:m.map(s=>e.jsx("div",{className:"zyklus-card "+(s.aktiv?"":"inactive"),children:z===s.zyklus_id?e.jsx(u,{zyklus:s,onSave:B,onCancel:I}):e.jsx(b,{zyklus:s,formatIntervall:M,onEdit:T,onDelete:W})},s.zyklus_id))}),0===m.length&&e.jsxs("div",{className:"empty-state",children:[e.jsx(h,{size:48}),e.jsx("h3",{children:"Keine Zahlungszyklen vorhanden"}),e.jsx("p",{children:"Erstellen Sie Ihren ersten Zahlungszyklus mit dem Button oben."}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>C(!0),children:[e.jsx(t,{size:16}),"Ersten Zyklus erstellen"]})]})]})})]})},u=({zyklus:s,onSave:n,onCancel:i})=>{const[l,t]=a.useState({name:s.name,intervall_tage:s.intervall_tage,beschreibung:s.beschreibung,aktiv:s.aktiv});return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{children:"Bearbeiten"})}),e.jsx("div",{className:"edit-form",children:e.jsxs("div",{className:"input-container",children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"input-group",children:[e.jsx("label",{className:"input-label",children:"Name"}),e.jsx("input",{type:"text",className:"input-field",value:l.name,onChange:e=>t({...l,name:e.target.value})})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{className:"input-label",children:"Intervall (Tage)"}),e.jsx("input",{type:"number",className:"input-field",value:l.intervall_tage,onChange:e=>t({...l,intervall_tage:parseInt(e.target.value)||""})})]})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{className:"input-label",children:"Beschreibung"}),e.jsx("input",{type:"text",className:"input-field",value:l.beschreibung,onChange:e=>t({...l,beschreibung:e.target.value})})]}),e.jsx("div",{className:"input-group checkbox-group",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:l.aktiv,onChange:e=>t({...l,aktiv:e.target.checked})}),e.jsx("span",{className:"checkmark"}),"Aktiv"]})}),e.jsxs("div",{className:"card-actions",children:[e.jsxs("button",{className:"btn btn-primary btn-small",onClick:()=>{n(s.zyklus_id,l)},disabled:!l.name||!l.intervall_tage,children:[e.jsx(d,{size:16}),"Speichern"]}),e.jsxs("button",{className:"btn btn-secondary btn-small",onClick:i,children:[e.jsx(c,{size:16}),"Abbrechen"]})]})]})})]})},b=({zyklus:s,formatIntervall:a,onEdit:n,onDelete:i})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{children:s.name}),e.jsx("div",{className:"status-badge "+(s.aktiv?"active":"inactive"),children:s.aktiv?"Aktiv":"Inaktiv"})]}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"zyklus-info",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",color:"rgba(255, 255, 255, 0.9)",padding:"0.5rem",background:"rgba(255, 255, 255, 0.03)",borderRadius:"6px",fontSize:"0.875rem"},children:[e.jsx(h,{size:16,style:{color:"#ffd700",flexShrink:0}}),e.jsx("span",{style:{color:"#ffd700",fontSize:"0.875rem",fontWeight:600,textShadow:"none",WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale"},children:a(s.intervall_tage)})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",color:"rgba(255, 255, 255, 0.9)",padding:"0.5rem",background:"rgba(255, 255, 255, 0.03)",borderRadius:"6px",fontSize:"0.875rem"},children:[e.jsx(l,{size:16,style:{color:"#ffd700",flexShrink:0}}),e.jsxs("span",{children:["Alle ",s.intervall_tage," Tage"]})]}),s.beschreibung&&e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",color:"rgba(255, 255, 255, 0.8)",padding:"0.5rem",background:"rgba(255, 255, 255, 0.03)",borderRadius:"6px",fontSize:"0.875rem",fontStyle:"italic"},children:e.jsx("span",{children:s.beschreibung})})]})}),e.jsxs("div",{className:"card-actions",children:[e.jsxs("button",{className:"btn btn-secondary btn-small",onClick:()=>n(s),children:[e.jsx(g,{size:16}),"Bearbeiten"]}),e.jsxs("button",{className:"btn btn-danger btn-small",onClick:()=>i(s.zyklus_id),children:[e.jsx(m,{size:16}),"Löschen"]})]})]});export{x as default};
