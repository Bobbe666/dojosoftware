import{j as e}from"./animation-1wuIdCBS.js";import{r as s}from"./vendor-router-BhMXg4Z-.js";import{a as i}from"./index-DUnH23_2.js";import"./vendor-react-DtuzQOD1.js";import"./query-Bs1dTGah.js";import"./icons-D7rg4pDH.js";const a=()=>{const[a,c]=s.useState([]),[t,n]=s.useState({total:0,today:0}),[l,r]=s.useState(!1),[d,m]=s.useState(new Date);s.useEffect(()=>{const e=async()=>{try{r(!0);const e=(new Date).toISOString().split("T")[0],s=(await i.get("/checkin/today",{params:{datum:e}})).data;if(s.success){const e=s.checkins||[];c(s=>{if(0===s.length)return e;const i=new Set(s.map(e=>`${e.mitglied_id}-${e.checkin_id||e.checkin_time}`)),a=new Set(e.map(e=>`${e.mitglied_id}-${e.checkin_id||e.checkin_time}`));return i.size===a.size&&[...i].every(e=>a.has(e))&&[...a].every(e=>i.has(e))?s:e}),n({total:e.length||0,today:e.filter(e=>"active"===e.status).length||0})}}catch(e){console.error("âŒ Fehler beim Laden der Check-ins:",e)}finally{r(!1)}};e();const s=setInterval(e,3e3),a=setInterval(()=>{m(new Date)},1e3);return()=>{clearInterval(s),clearInterval(a)}},[]);const o=a.filter(e=>"active"===e.status);return e.jsxs("div",{className:"public-checkin-display",children:[e.jsxs("div",{className:"public-header-compact",children:[e.jsx("div",{className:"header-left",children:e.jsxs("div",{className:"dojo-logo-compact",children:[e.jsx("h1",{children:"DOJO CHECK-IN"}),e.jsx("p",{className:"welcome-text",children:"Willkommen im Training!"})]})}),e.jsxs("div",{className:"header-right-section",children:[e.jsxs("div",{className:"current-time-compact",children:[e.jsx("div",{className:"time",children:d.toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit",second:"2-digit"})}),e.jsx("div",{className:"date",children:d.toLocaleDateString("de-DE",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),e.jsxs("div",{className:"public-stats-compact",children:[e.jsxs("div",{className:"stat-item-compact",children:[e.jsx("div",{className:"stat-icon",children:"ğŸ‘¥"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-number",children:t.today}),e.jsx("div",{className:"stat-label",children:"Heute Eingecheckt"})]})]}),e.jsxs("div",{className:"stat-item-compact",children:[e.jsx("div",{className:"stat-icon",children:"ğŸ“…"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-number",children:t.total}),e.jsx("div",{className:"stat-label",children:"Check-ins Gesamt"})]})]}),e.jsxs("div",{className:"stat-item-compact",children:[e.jsx("div",{className:"stat-icon",children:"ğŸ”„"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-number",children:"LIVE"}),e.jsx("div",{className:"stat-label",children:"Updates alle 3s"})]})]})]})]})]}),l&&e.jsxs("div",{className:"loading-indicator",children:[e.jsx("div",{className:"spinner"}),e.jsx("span",{children:"Aktualisiere..."})]}),e.jsx("div",{className:"checkins-section",children:0===o.length?e.jsxs("div",{className:"no-checkins",children:[e.jsx("div",{className:"no-checkins-icon",children:"ğŸ“…"}),e.jsx("h3",{children:"Noch keine Check-ins heute"}),e.jsx("p",{children:"Sobald sich Mitglieder einchecken, erscheinen sie hier automatisch."})]}):e.jsx("div",{className:"checkins-grid",children:o.map((s,i)=>{var a,c,t;return e.jsxs("div",{className:"checkin-item",style:{animationDelay:.1*i+"s"},children:[e.jsxs("div",{className:"checkin-avatar",children:[s.foto_pfad||s.profilbild?e.jsx("img",{src:`http://localhost:3000/${(s.foto_pfad||s.profilbild).startsWith("/")?(s.foto_pfad||s.profilbild).slice(1):s.foto_pfad||s.profilbild}`,alt:`${s.vorname} ${s.nachname}`,onError:e=>{e.currentTarget.style.display="none";const s=e.currentTarget.nextSibling;s&&(s.style.display="flex")},onLoad:e=>{const s=e.currentTarget.nextSibling;s&&(s.style.display="none")},style:{display:"block"}},`img-${s.mitglied_id}-${s.checkin_id||s.checkin_time}`):null,e.jsxs("div",{className:"avatar-placeholder",style:{display:s.foto_pfad||s.profilbild?"none":"flex"},children:[null==(a=s.vorname)?void 0:a.charAt(0),null==(c=s.nachname)?void 0:c.charAt(0)]})]}),e.jsxs("div",{className:"checkin-info",children:[e.jsxs("div",{className:"member-name",children:[s.vorname," ",s.nachname]}),e.jsxs("div",{className:"checkin-details",children:[e.jsxs("span",{className:"checkin-time",children:["ğŸ• ",(t=s.checkin_time,t?new Date(t).toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"}):"")]}),s.gurtfarbe&&"Unbekannt"!==s.gurtfarbe&&""!==s.gurtfarbe.trim()&&e.jsxs("span",{className:"belt-info",children:["ğŸ¥‹ ",s.gurtfarbe]})]}),s.kurse&&s.kurse.length>0&&e.jsxs("div",{className:"member-courses",children:[s.kurse.slice(0,2).map((s,i)=>e.jsx("span",{className:"course-tag",children:s},i)),s.kurse.length>2&&e.jsxs("span",{className:"course-tag more",children:["+",s.kurse.length-2]})]})]}),e.jsxs("div",{className:"checkin-status",children:[e.jsx("div",{className:"status-indicator active"}),e.jsx("span",{className:"status-text",children:"AKTIV"})]})]},`${s.mitglied_id}-${s.checkin_id||s.checkin_time}`)})})}),e.jsxs("div",{className:"public-footer",children:[e.jsx("p",{children:"ğŸ’¡ Diese Anzeige aktualisiert sich automatisch alle 3 Sekunden"}),e.jsx("p",{children:"ğŸ† Viel Erfolg beim Training!"})]})]})};export{a as default};
