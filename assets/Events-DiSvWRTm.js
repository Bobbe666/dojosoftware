import{a as e,j as n}from"./query-Caj74EYQ.js";import{b as a,a as s,u as r}from"./index-1YdTwRLp.js";/* empty css               *//* empty css                  */import"./vendor-router-B2AaIOtG.js";import"./icons-UlaFLuKM.js";import"./charts-QHQg_ypW.js";const l=()=>{const{token:r}=a(),[l,i]=e.useState([]),[t,d]=e.useState(!1),[c,o]=e.useState(""),[h,m]=e.useState("upcoming"),u=e.useCallback(async()=>{var e,n;d(!0),o("");try{const e=new URLSearchParams;"upcoming"===h&&e.append("upcoming","true");const n=await s.get(`/tda-turniere?${e.toString()}`,{headers:{Authorization:`Bearer ${r}`}});if(n.data.success){let e=n.data.turniere||[];"past"===h&&(e=e.filter(e=>e.ist_vergangen)),i(e)}else i([])}catch(a){console.error("Fehler beim Laden der TDA-Turniere:",a),o("Fehler beim Laden der Turniere: "+((null==(n=null==(e=a.response)?void 0:e.data)?void 0:n.error)||a.message)),i([])}finally{d(!1)}},[r,h]);e.useEffect(()=>{r&&u()},[r,u]);const g=e=>e?new Date(e).toLocaleDateString("de-DE",{weekday:"short",day:"2-digit",month:"2-digit",year:"numeric"}):"",x=e=>{if(!e.datum)return"";const n=new Date;n.setHours(0,0,0,0);const a=new Date(e.datum);a.setHours(0,0,0,0);const s=a-n,r=Math.ceil(s/864e5);return 0===r?"Heute!":1===r?"Morgen":r<0?`Vor ${Math.abs(r)} Tagen`:r<=7?`In ${r} Tagen`:r<=30?`In ${Math.ceil(r/7)} Wochen`:`In ${Math.ceil(r/30)} Monaten`};return n.jsxs("div",{className:"tda-turniere-container",children:[n.jsxs("div",{className:"tda-filter-bar",children:[n.jsxs("div",{className:"filter-buttons",children:[n.jsx("button",{className:"filter-btn "+("upcoming"===h?"active":""),onClick:()=>m("upcoming"),children:"Kommende"}),n.jsx("button",{className:"filter-btn "+("all"===h?"active":""),onClick:()=>m("all"),children:"Alle"}),n.jsx("button",{className:"filter-btn "+("past"===h?"active":""),onClick:()=>m("past"),children:"Vergangene"})]}),n.jsx("button",{className:"btn-refresh",onClick:u,disabled:t,title:"Aktualisieren",children:t?"...":""})]}),c&&n.jsx("div",{className:"tda-error-message",children:c}),t?n.jsxs("div",{className:"tda-loading",children:[n.jsx("div",{className:"loading-spinner"}),n.jsx("p",{children:"Lade Turniere..."})]}):0===l.length?n.jsxs("div",{className:"tda-empty-state",children:[n.jsx("div",{className:"empty-icon",children:n.jsx("span",{role:"img","aria-label":"trophy",children:"üèÜ"})}),n.jsx("h3",{children:"Keine Turniere gefunden"}),n.jsx("p",{children:"upcoming"===h?"Aktuell sind keine kommenden TDA-Turniere geplant.":"past"===h?"Keine vergangenen Turniere vorhanden.":"Es sind keine TDA-Turniere in der Datenbank."})]}):n.jsx("div",{className:"tda-turniere-grid",children:l.map(e=>{const a=(e=>e.ist_vergangen?{text:"Beendet",class:"badge-secondary"}:e.anmeldung_moeglich?{text:"Anmeldung offen",class:"badge-success"}:{text:"Anmeldung geschlossen",class:"badge-warning"})(e);return n.jsxs("div",{className:"tda-turnier-card "+(e.ist_vergangen?"vergangen":""),children:[n.jsxs("div",{className:"turnier-card-header",children:[n.jsxs("div",{className:"turnier-badges",children:[e.disziplin&&n.jsx("span",{className:"badge badge-disziplin",children:e.disziplin}),n.jsx("span",{className:`badge ${a.class}`,children:a.text})]}),n.jsx("div",{className:"turnier-tage",children:x(e)})]}),n.jsx("h3",{className:"turnier-titel",children:e.name}),n.jsxs("div",{className:"turnier-info",children:[n.jsxs("div",{className:"info-row",children:[n.jsx("span",{className:"info-icon",role:"img","aria-label":"kalender",children:"üìÖ"}),n.jsx("span",{children:g(e.datum)}),e.datum_ende&&e.datum_ende!==e.datum&&n.jsxs("span",{children:[" - ",g(e.datum_ende)]})]}),e.ort&&n.jsxs("div",{className:"info-row",children:[n.jsx("span",{className:"info-icon",role:"img","aria-label":"ort",children:"üìç"}),n.jsx("span",{children:e.ort})]}),e.adresse&&n.jsxs("div",{className:"info-row info-sub",children:[n.jsx("span",{className:"info-icon"}),n.jsx("span",{className:"text-muted",children:e.adresse})]}),e.anmeldeschluss&&n.jsxs("div",{className:"info-row",children:[n.jsx("span",{className:"info-icon",role:"img","aria-label":"uhr",children:"‚è∞"}),n.jsxs("span",{children:["Anmeldeschluss: ",g(e.anmeldeschluss)]})]}),e.teilnahmegebuehr>0&&n.jsxs("div",{className:"info-row",children:[n.jsx("span",{className:"info-icon",role:"img","aria-label":"geld",children:"üí∞"}),n.jsxs("span",{children:["Startgeb√ºhr: ",parseFloat(e.teilnahmegebuehr).toFixed(2)," EUR"]})]}),e.max_teilnehmer&&n.jsxs("div",{className:"info-row",children:[n.jsx("span",{className:"info-icon",role:"img","aria-label":"personen",children:"üë•"}),n.jsxs("span",{children:["Max. ",e.max_teilnehmer," Teilnehmer"]})]}),e.veranstalter&&n.jsxs("div",{className:"info-row",children:[n.jsx("span",{className:"info-icon",role:"img","aria-label":"organisation",children:"üè¢"}),n.jsx("span",{children:e.veranstalter})]})]}),e.beschreibung&&n.jsx("div",{className:"turnier-beschreibung",children:n.jsx("p",{children:e.beschreibung})}),n.jsx("div",{className:"turnier-card-footer",children:e.anmeldung_moeglich&&!e.ist_vergangen?n.jsxs("button",{className:"btn-anmelden",onClick:()=>(e=>{e.tda_registration_url?window.open(e.tda_registration_url,"_blank","noopener,noreferrer"):alert("Keine Anmelde-URL verf√ºgbar")})(e),children:[n.jsx("span",{role:"img","aria-label":"registrieren",className:"btn-icon",children:"‚úç"}),"Jetzt anmelden"]}):e.ist_vergangen?n.jsx("span",{className:"turnier-vergangen-text",children:"Turnier beendet"}):n.jsx("span",{className:"turnier-geschlossen-text",children:"Anmeldung geschlossen"})})]},e.id)})}),n.jsx("div",{className:"tda-info-box",children:n.jsxs("p",{children:[n.jsx("span",{role:"img","aria-label":"info",children:"‚ÑπÔ∏è"}),"Turniere werden automatisch von TDA International synchronisiert. Die Anmeldung erfolgt √ºber das TDA-Turniersystem."]})})]})},i=()=>{var i,t;const{token:d,isAdmin:c}=a(),{activeDojo:o}=r(),[h,m]=e.useState([]),[u,g]=e.useState([]),[x,v]=e.useState([]),[j,b]=e.useState(!1),[p,N]=e.useState(""),[f,y]=e.useState("aktuelle"),[_,k]=e.useState(!1),[z,A]=e.useState(!1),[C,w]=e.useState(!1),[T,S]=e.useState(null),[$,E]=e.useState(!1),[B,F]=e.useState(null),[D,L]=e.useState([]),[M,I]=e.useState(""),[P,R]=e.useState(""),[H,K]=e.useState(!1),[W,G]=e.useState({}),[O,V]=e.useState({titel:"",beschreibung:"",event_typ:"Sonstiges",datum:"",uhrzeit_beginn:"",uhrzeit_ende:"",ort:"",raum_id:"",max_teilnehmer:"",teilnahmegebuehr:"0.00",anmeldefrist:"",status:"geplant",trainer_ids:[],anforderungen:""}),U=e.useCallback(async()=>{b(!0),N("");try{const e=(null==o?void 0:o.id)?`?dojo_id=${o.id}`:"",n=await s.get(`/events${e}`,{headers:{Authorization:`Bearer ${d}`}});Array.isArray(n.data)?m(n.data):(console.error("Events API returned non-array:",n.data),m([]))}catch(e){console.error("Fehler beim Laden der Events:",e),N("Fehler beim Laden der Events: "+e.message),m([])}finally{b(!1)}},[d,o]),q=e.useCallback(async()=>{try{const e=await s.get("/raeume",{headers:{Authorization:`Bearer ${d}`}}),n=e.data.data||e.data||[];Array.isArray(n)?g(n):(console.error("Raeume API returned non-array:",n),g([]))}catch(e){console.error("Fehler beim Laden der R√§ume:",e),g([])}},[d]),J=e.useCallback(async()=>{try{const e=await s.get("/trainer",{headers:{Authorization:`Bearer ${d}`}});Array.isArray(e.data)?v(e.data):(console.error("Trainer API returned non-array:",e.data),v([]))}catch(e){console.error("Fehler beim Laden der Trainer:",e),v([])}},[d]);e.useEffect(()=>{d&&(U(),q(),J())},[d,U,q,J]);const Y=async e=>{var n,a;if(window.confirm("M√∂chten Sie dieses Event wirklich l√∂schen?")){N("");try{await s.delete(`/events/${e}`,{headers:{Authorization:`Bearer ${d}`}}),U()}catch(r){console.error("Fehler beim L√∂schen des Events:",r),N("Fehler beim L√∂schen: "+((null==(a=null==(n=r.response)?void 0:n.data)?void 0:a.error)||r.message))}}},Z=async e=>{S(e),w(!0);try{const n=await s.get(`/events/${e.event_id}/anmeldungen`,{headers:{Authorization:`Bearer ${d}`}});S({...e,anmeldungen:n.data})}catch(n){console.error("Fehler beim Laden der Anmeldungen:",n)}};e.useEffect(()=>{(async()=>{if(c)try{const e=await s.get("/mitglieder/all",{headers:{Authorization:`Bearer ${d}`}});L(e.data||[])}catch(e){console.error("Fehler beim Laden der Mitglieder:",e)}})()},[c,d]);const Q=async e=>{F(e),I(""),R(""),K(!1);try{const n=(await s.get(`/events/${e.event_id}/anmeldungen`,{headers:{Authorization:`Bearer ${d}`}})).data.map(e=>e.mitglied_id);G(a=>({...a,[e.event_id]:n}))}catch(n){console.error("Fehler beim Laden der Anmeldungen:",n)}E(!0)},X=e=>e?new Date(e).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"}):"",ee=e=>e?e.substring(0,5):"",ne=e=>({Turnier:"badge-danger",Lehrgang:"badge-info","Pr√ºfung":"badge-warning",Seminar:"badge-success",Workshop:"badge-primary",Feier:"badge-special",Sonstiges:"badge-secondary"}[e]||"badge-secondary"),ae=e=>({geplant:"badge-secondary",anmeldung_offen:"badge-success",ausgebucht:"badge-danger",abgeschlossen:"badge-info",abgesagt:"badge-dark"}[e]||"badge-secondary"),se=e=>({geplant:"Geplant",anmeldung_offen:"Anmeldung offen",ausgebucht:"Ausgebucht",abgeschlossen:"Abgeschlossen",abgesagt:"Abgesagt"}[e]||e),re=e=>{if(!e)return"Keine Trainer zugewiesen";const n=e.split(",").map(e=>parseInt(e.trim())).map(e=>{const n=x.find(n=>n.trainer_id===e);return n?`${n.vorname} ${n.nachname}`:null}).filter(Boolean);return n.length>0?n.join(", "):"Keine Trainer zugewiesen"},le=(()=>{const e=new Date;return e.setHours(0,0,0,0),h.filter(n=>{const a=new Date(n.datum);return a.setHours(0,0,0,0),"aktuelle"===f?a.getTime()===e.getTime():"geplante"===f?a.getTime()>e.getTime():"vergangene"!==f||a.getTime()<e.getTime()})})();return n.jsxs("div",{className:"events-container",children:[n.jsxs("div",{className:"events-layout",children:[n.jsxs("aside",{className:"events-sidebar",children:[n.jsxs("div",{className:"events-sidebar-header",children:[n.jsx("div",{className:"events-icon",children:"üìÖ"}),n.jsx("h2",{className:"events-sidebar-title",children:"Events"})]}),c&&n.jsxs("button",{className:"btn-create-event",onClick:()=>k(!0),children:[n.jsx("span",{children:"‚ûï"}),n.jsx("span",{children:"Neues Event erstellen"})]}),n.jsx("nav",{className:"tabs-vertical",children:[{key:"aktuelle",label:"Aktuelle",icon:"üìÖ"},{key:"geplante",label:"Geplante",icon:"üóìÔ∏è"},{key:"vergangene",label:"Vergangene",icon:"üìú"},{key:"tda-turniere",label:"TDA Turniere",icon:"üèÜ"}].map(e=>n.jsxs("button",{className:"tab-vertical-btn "+(f===e.key?"active":""),onClick:()=>y(e.key),children:[n.jsx("span",{className:"tab-icon",children:e.icon}),n.jsx("span",{className:"tab-label",children:e.label})]},e.key))})]}),n.jsxs("div",{className:"events-content",children:[p&&n.jsxs("div",{className:"error-message",style:{marginBottom:"1rem"},children:["‚ö†Ô∏è ",p]}),n.jsx("div",{className:"glass-card",children:n.jsx("div",{className:"card-body",children:"tda-turniere"===f?n.jsx(l,{}):j?n.jsx("div",{className:"loading-state",children:n.jsx("p",{children:"Lade Events..."})}):0===le.length?n.jsxs("div",{className:"empty-state",children:[n.jsx("div",{className:"empty-icon",children:"üìÖ"}),n.jsxs("h3",{children:["Keine ","aktuelle"===f?"aktuellen":"geplante"===f?"geplanten":"vergangenen"," Events"]}),n.jsx("p",{children:"aktuelle"===f?"Heute finden keine Events statt.":"geplante"===f?"Es sind noch keine Events geplant.":"Es gibt noch keine vergangenen Events."})]}):n.jsx("div",{className:"events-list",children:le.map(e=>n.jsx("div",{className:"event-card "+("vergangene"===f?"event-card-compact":""),onClick:"vergangene"===f?()=>Z(e):void 0,style:"vergangene"===f?{cursor:"pointer"}:{},children:"vergangene"===f?n.jsx(n.Fragment,{children:n.jsxs("div",{className:"event-card-header",children:[n.jsxs("div",{className:"event-title-section",children:[n.jsx("h3",{children:e.titel}),n.jsxs("div",{className:"event-info-row",style:{marginTop:"0.5rem"},children:[n.jsx("span",{className:"event-icon",children:"üìÖ"}),n.jsx("span",{children:X(e.datum)})]})]}),c&&n.jsxs("div",{className:"event-actions",onClick:e=>e.stopPropagation(),children:[n.jsx("button",{className:"btn-icon btn-success",onClick:()=>Q(e),title:"Teilnehmer hinzuf√ºgen",style:{background:"linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 215, 0, 0.1))",border:"1px solid rgba(255, 215, 0, 0.3)",fontSize:"0.85rem"},children:"üë§‚ûï"}),n.jsx("button",{className:"btn-icon",onClick:()=>{S(e),A(!0)},title:"Bearbeiten",children:"‚úèÔ∏è"}),n.jsx("button",{className:"btn-icon btn-danger",onClick:()=>Y(e.event_id),title:"L√∂schen",children:"üóëÔ∏è"})]})]})}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"event-card-header",children:[n.jsxs("div",{className:"event-title-section",children:[n.jsx("h3",{children:e.titel}),n.jsxs("div",{className:"event-badges",children:[n.jsx("span",{className:`badge ${ne(e.event_typ)}`,children:e.event_typ}),n.jsx("span",{className:`badge ${ae(e.status)}`,children:se(e.status)})]})]}),c&&n.jsxs("div",{className:"event-actions",children:[n.jsx("button",{className:"btn-icon",onClick:()=>Z(e),title:"Details anzeigen",children:"üëÅÔ∏è"}),n.jsx("button",{className:"btn-icon btn-success",onClick:()=>Q(e),title:"Teilnehmer hinzuf√ºgen",style:{background:"linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 215, 0, 0.1))",border:"1px solid rgba(255, 215, 0, 0.3)",fontSize:"0.85rem"},children:"üë§‚ûï"}),n.jsx("button",{className:"btn-icon",onClick:()=>{S(e),A(!0)},title:"Bearbeiten",children:"‚úèÔ∏è"}),n.jsx("button",{className:"btn-icon btn-danger",onClick:()=>Y(e.event_id),title:"L√∂schen",children:"üóëÔ∏è"})]})]}),n.jsxs("div",{className:"event-card-body",children:[n.jsxs("div",{className:"event-info-row",children:[n.jsx("span",{className:"event-icon",children:"üìÖ"}),n.jsx("span",{children:X(e.datum)}),e.uhrzeit_beginn&&n.jsxs("span",{children:[ee(e.uhrzeit_beginn),e.uhrzeit_ende&&` - ${ee(e.uhrzeit_ende)}`]})]}),e.ort&&n.jsxs("div",{className:"event-info-row",children:[n.jsx("span",{className:"event-icon",children:"üìç"}),n.jsx("span",{children:e.ort})]}),e.raum_name&&n.jsxs("div",{className:"event-info-row",children:[n.jsx("span",{className:"event-icon",children:"üö™"}),n.jsxs("span",{children:["Raum: ",e.raum_name]})]}),e.max_teilnehmer&&n.jsxs("div",{className:"event-info-row",children:[n.jsx("span",{className:"event-icon",children:"üë•"}),n.jsxs("span",{children:[e.anzahl_anmeldungen||0," / ",e.max_teilnehmer," Teilnehmer",null!==e.verfuegbare_plaetze&&n.jsxs("span",{className:0===e.verfuegbare_plaetze?"text-danger":"text-success",children:[" ","(",e.verfuegbare_plaetze," Pl√§tze frei)"]})]})]}),e.teilnahmegebuehr>0&&n.jsxs("div",{className:"event-info-row",children:[n.jsx("span",{className:"event-icon",children:"üí∞"}),n.jsxs("span",{children:[parseFloat(e.teilnahmegebuehr).toFixed(2)," ‚Ç¨"]})]}),e.beschreibung&&n.jsx("div",{className:"event-description",children:n.jsx("p",{children:e.beschreibung})}),n.jsxs("div",{className:"event-info-row",children:[n.jsx("span",{className:"event-icon",children:"üë®‚Äçüè´"}),n.jsx("span",{children:re(e.trainer_ids)})]}),e.anmeldefrist&&n.jsxs("div",{className:"event-info-row",children:[n.jsx("span",{className:"event-icon",children:"‚è∞"}),n.jsxs("span",{children:["Anmeldefrist: ",X(e.anmeldefrist)]})]})]}),!c&&n.jsx("div",{className:"event-card-footer",children:n.jsx("button",{className:"btn btn-primary",onClick:()=>Z(e),children:"Details anzeigen"})})]})},e.event_id))})})})]})]}),_&&c&&n.jsx("div",{className:"modal-overlay",onClick:()=>k(!1),children:n.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[n.jsxs("div",{className:"modal-header",children:[n.jsx("h2",{children:"Neues Event erstellen"}),n.jsx("button",{className:"modal-close",onClick:()=>k(!1),children:"‚úï"})]}),n.jsx("div",{className:"modal-body",children:n.jsxs("div",{className:"form-grid",children:[n.jsxs("div",{className:"form-group",children:[n.jsx("label",{children:"Titel *"}),n.jsx("input",{type:"text",value:O.titel,onChange:e=>V({...O,titel:e.target.value}),placeholder:"z.B. Sommerturnier 2025"})]}),n.jsxs("div",{className:"form-group",children:[n.jsx("label",{children:"Event-Typ"}),n.jsxs("select",{value:O.event_typ,onChange:e=>V({...O,event_typ:e.target.value}),children:[n.jsx("option",{value:"Turnier",children:"Turnier"}),n.jsx("option",{value:"Lehrgang",children:"Lehrgang"}),n.jsx("option",{value:"Pr√ºfung",children:"Pr√ºfung"}),n.jsx("option",{value:"Seminar",children:"Seminar"}),n.jsx("option",{value:"Workshop",children:"Workshop"}),n.jsx("option",{value:"Feier",children:"Feier"}),n.jsx("option",{value:"Sonstiges",children:"Sonstiges"})]})]}),n.jsxs("div",{className:"form-group",children:[n.jsx("label",{children:"Datum *"}),n.jsx("input",{type:"date",value:O.datum,onChange:e=>V({...O,datum:e.target.value})})]}),n.jsxs("div",{className:"form-group",children:[n.jsx("label",{children:"Beginn"}),n.jsx("input",{type:"time",value:O.uhrzeit_beginn,onChange:e=>V({...O,uhrzeit_beginn:e.target.value})})]}),n.jsxs("div",{className:"form-group",children:[n.jsx("label",{children:"Ende"}),n.jsx("input",{type:"time",value:O.uhrzeit_ende,onChange:e=>V({...O,uhrzeit_ende:e.target.value})})]}),n.jsxs("div",{className:"form-group",children:[n.jsx("label",{children:"Ort"}),n.jsx("input",{type:"text",value:O.ort,onChange:e=>V({...O,ort:e.target.value}),placeholder:"z.B. Haupthalle"})]}),n.jsxs("div",{className:"form-group",children:[n.jsx("label",{children:"Raum"}),n.jsxs("select",{value:O.raum_id,onChange:e=>V({...O,raum_id:e.target.value}),children:[n.jsx("option",{value:"",children:"Kein Raum"}),Array.isArray(u)&&u.map(e=>n.jsx("option",{value:e.raum_id||e.id,children:e.name},e.raum_id||e.id))]})]}),n.jsxs("div",{className:"form-group",children:[n.jsx("label",{children:"Max. Teilnehmer"}),n.jsx("input",{type:"number",value:O.max_teilnehmer,onChange:e=>V({...O,max_teilnehmer:e.target.value}),placeholder:"Leer = unbegrenzt",min:"1"})]}),n.jsxs("div",{className:"form-group",children:[n.jsx("label",{children:"Teilnahmegeb√ºhr (‚Ç¨)"}),n.jsx("input",{type:"number",step:"0.01",value:O.teilnahmegebuehr,onChange:e=>V({...O,teilnahmegebuehr:e.target.value})})]}),n.jsxs("div",{className:"form-group",children:[n.jsx("label",{children:"Anmeldefrist"}),n.jsx("input",{type:"date",value:O.anmeldefrist,onChange:e=>V({...O,anmeldefrist:e.target.value})})]}),n.jsxs("div",{className:"form-group",children:[n.jsx("label",{children:"Status"}),n.jsxs("select",{value:O.status,onChange:e=>V({...O,status:e.target.value}),children:[n.jsx("option",{value:"geplant",children:"Geplant"}),n.jsx("option",{value:"anmeldung_offen",children:"Anmeldung offen"}),n.jsx("option",{value:"ausgebucht",children:"Ausgebucht"}),n.jsx("option",{value:"abgeschlossen",children:"Abgeschlossen"}),n.jsx("option",{value:"abgesagt",children:"Abgesagt"})]})]}),n.jsxs("div",{className:"form-group full-width",children:[n.jsx("label",{children:"Beschreibung"}),n.jsx("textarea",{value:O.beschreibung,onChange:e=>V({...O,beschreibung:e.target.value}),rows:"3",placeholder:"Beschreiben Sie das Event..."})]}),n.jsxs("div",{className:"form-group full-width",children:[n.jsx("label",{children:"Anforderungen / Voraussetzungen"}),n.jsx("textarea",{value:O.anforderungen,onChange:e=>V({...O,anforderungen:e.target.value}),rows:"2",placeholder:"z.B. Mindestgraduierung, Ausr√ºstung, etc."})]}),n.jsxs("div",{className:"form-group full-width",children:[n.jsx("label",{children:"Trainer"}),n.jsx("div",{className:"trainer-multiselect",children:x.map(e=>n.jsxs("label",{className:"trainer-checkbox",children:[n.jsx("input",{type:"checkbox",checked:O.trainer_ids.includes(e.trainer_id),onChange:n=>{n.target.checked?V({...O,trainer_ids:[...O.trainer_ids,e.trainer_id]}):V({...O,trainer_ids:O.trainer_ids.filter(n=>n!==e.trainer_id)})}}),e.vorname," ",e.nachname]},e.trainer_id))})]})]})}),n.jsxs("div",{className:"modal-footer",children:[n.jsx("button",{className:"btn btn-secondary",onClick:()=>k(!1),children:"Abbrechen"}),n.jsx("button",{className:"btn btn-primary",onClick:async()=>{var e,n;N("");try{await s.post("/events",{...O,dojo_id:(null==o?void 0:o.id)||1,raum_id:O.raum_id||null,max_teilnehmer:O.max_teilnehmer?parseInt(O.max_teilnehmer):null},{headers:{Authorization:`Bearer ${d}`}}),k(!1),V({titel:"",beschreibung:"",event_typ:"Sonstiges",datum:"",uhrzeit_beginn:"",uhrzeit_ende:"",ort:"",raum_id:"",max_teilnehmer:"",teilnahmegebuehr:"0.00",anmeldefrist:"",status:"geplant",trainer_ids:[],anforderungen:""}),U()}catch(a){console.error("Fehler beim Erstellen des Events:",a),N("Fehler beim Erstellen des Events: "+((null==(n=null==(e=a.response)?void 0:e.data)?void 0:n.error)||a.message))}},children:"Event erstellen"})]})]})}),z&&T&&c&&n.jsx("div",{className:"modal-overlay",onClick:()=>A(!1),children:n.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[n.jsxs("div",{className:"modal-header",children:[n.jsx("h2",{children:"Event bearbeiten"}),n.jsx("button",{className:"modal-close",onClick:()=>A(!1),children:"‚úï"})]}),n.jsx("div",{className:"modal-body",children:n.jsxs("div",{className:"form-grid",children:[n.jsxs("div",{className:"form-group",children:[n.jsx("label",{children:"Titel *"}),n.jsx("input",{type:"text",value:T.titel,onChange:e=>S({...T,titel:e.target.value})})]}),n.jsxs("div",{className:"form-group",children:[n.jsx("label",{children:"Event-Typ"}),n.jsxs("select",{value:T.event_typ,onChange:e=>S({...T,event_typ:e.target.value}),children:[n.jsx("option",{value:"Turnier",children:"Turnier"}),n.jsx("option",{value:"Lehrgang",children:"Lehrgang"}),n.jsx("option",{value:"Pr√ºfung",children:"Pr√ºfung"}),n.jsx("option",{value:"Seminar",children:"Seminar"}),n.jsx("option",{value:"Workshop",children:"Workshop"}),n.jsx("option",{value:"Feier",children:"Feier"}),n.jsx("option",{value:"Sonstiges",children:"Sonstiges"})]})]}),n.jsxs("div",{className:"form-group",children:[n.jsx("label",{children:"Datum *"}),n.jsx("input",{type:"date",value:null==(i=T.datum)?void 0:i.substring(0,10),onChange:e=>S({...T,datum:e.target.value})})]}),n.jsxs("div",{className:"form-group",children:[n.jsx("label",{children:"Beginn"}),n.jsx("input",{type:"time",value:T.uhrzeit_beginn||"",onChange:e=>S({...T,uhrzeit_beginn:e.target.value})})]}),n.jsxs("div",{className:"form-group",children:[n.jsx("label",{children:"Ende"}),n.jsx("input",{type:"time",value:T.uhrzeit_ende||"",onChange:e=>S({...T,uhrzeit_ende:e.target.value})})]}),n.jsxs("div",{className:"form-group",children:[n.jsx("label",{children:"Ort"}),n.jsx("input",{type:"text",value:T.ort||"",onChange:e=>S({...T,ort:e.target.value})})]}),n.jsxs("div",{className:"form-group",children:[n.jsx("label",{children:"Raum"}),n.jsxs("select",{value:T.raum_id||"",onChange:e=>S({...T,raum_id:e.target.value}),children:[n.jsx("option",{value:"",children:"Kein Raum"}),Array.isArray(u)&&u.map(e=>n.jsx("option",{value:e.raum_id||e.id,children:e.name},e.raum_id||e.id))]})]}),n.jsxs("div",{className:"form-group",children:[n.jsx("label",{children:"Max. Teilnehmer"}),n.jsx("input",{type:"number",value:T.max_teilnehmer||"",onChange:e=>S({...T,max_teilnehmer:e.target.value}),min:"1"})]}),n.jsxs("div",{className:"form-group",children:[n.jsx("label",{children:"Teilnahmegeb√ºhr (‚Ç¨)"}),n.jsx("input",{type:"number",step:"0.01",value:T.teilnahmegebuehr,onChange:e=>S({...T,teilnahmegebuehr:e.target.value})})]}),n.jsxs("div",{className:"form-group",children:[n.jsx("label",{children:"Anmeldefrist"}),n.jsx("input",{type:"date",value:(null==(t=T.anmeldefrist)?void 0:t.substring(0,10))||"",onChange:e=>S({...T,anmeldefrist:e.target.value})})]}),n.jsxs("div",{className:"form-group",children:[n.jsx("label",{children:"Status"}),n.jsxs("select",{value:T.status,onChange:e=>S({...T,status:e.target.value}),children:[n.jsx("option",{value:"geplant",children:"Geplant"}),n.jsx("option",{value:"anmeldung_offen",children:"Anmeldung offen"}),n.jsx("option",{value:"ausgebucht",children:"Ausgebucht"}),n.jsx("option",{value:"abgeschlossen",children:"Abgeschlossen"}),n.jsx("option",{value:"abgesagt",children:"Abgesagt"})]})]}),n.jsxs("div",{className:"form-group full-width",children:[n.jsx("label",{children:"Beschreibung"}),n.jsx("textarea",{value:T.beschreibung||"",onChange:e=>S({...T,beschreibung:e.target.value}),rows:"3"})]}),n.jsxs("div",{className:"form-group full-width",children:[n.jsx("label",{children:"Anforderungen / Voraussetzungen"}),n.jsx("textarea",{value:T.anforderungen||"",onChange:e=>S({...T,anforderungen:e.target.value}),rows:"2"})]})]})}),n.jsxs("div",{className:"modal-footer",children:[n.jsx("button",{className:"btn btn-secondary",onClick:()=>A(!1),children:"Abbrechen"}),n.jsx("button",{className:"btn btn-primary",onClick:async()=>{var e,n;N("");try{await s.put(`/events/${T.event_id}`,{...T,raum_id:T.raum_id||null,max_teilnehmer:T.max_teilnehmer?parseInt(T.max_teilnehmer):null},{headers:{Authorization:`Bearer ${d}`}}),A(!1),S(null),U()}catch(a){console.error("Fehler beim Aktualisieren des Events:",a),N("Fehler beim Aktualisieren: "+((null==(n=null==(e=a.response)?void 0:e.data)?void 0:n.error)||a.message))}},children:"Speichern"})]})]})}),C&&T&&n.jsx("div",{className:"modal-overlay",onClick:()=>w(!1),children:n.jsxs("div",{className:"modal-content modal-large",onClick:e=>e.stopPropagation(),children:[n.jsxs("div",{className:"modal-header",children:[n.jsx("h2",{children:T.titel}),n.jsx("button",{className:"modal-close",onClick:()=>w(!1),children:"‚úï"})]}),n.jsx("div",{className:"modal-body",children:n.jsxs("div",{className:"event-details-grid",children:[n.jsxs("div",{className:"details-section",children:[n.jsx("h3",{children:"Event-Informationen"}),n.jsxs("div",{className:"details-info",children:[n.jsxs("div",{className:"info-row",children:[n.jsx("span",{className:"info-label",children:"Typ:"}),n.jsx("span",{className:`badge ${ne(T.event_typ)}`,children:T.event_typ})]}),n.jsxs("div",{className:"info-row",children:[n.jsx("span",{className:"info-label",children:"Status:"}),n.jsx("span",{className:`badge ${ae(T.status)}`,children:se(T.status)})]}),n.jsxs("div",{className:"info-row",children:[n.jsx("span",{className:"info-label",children:"Datum:"}),n.jsx("span",{children:X(T.datum)})]}),T.uhrzeit_beginn&&n.jsxs("div",{className:"info-row",children:[n.jsx("span",{className:"info-label",children:"Uhrzeit:"}),n.jsxs("span",{children:[ee(T.uhrzeit_beginn),T.uhrzeit_ende&&` - ${ee(T.uhrzeit_ende)}`]})]}),T.ort&&n.jsxs("div",{className:"info-row",children:[n.jsx("span",{className:"info-label",children:"Ort:"}),n.jsx("span",{children:T.ort})]}),T.raum_name&&n.jsxs("div",{className:"info-row",children:[n.jsx("span",{className:"info-label",children:"Raum:"}),n.jsx("span",{children:T.raum_name})]}),T.max_teilnehmer&&n.jsxs("div",{className:"info-row",children:[n.jsx("span",{className:"info-label",children:"Teilnehmer:"}),n.jsxs("span",{children:[T.anzahl_anmeldungen||0," / ",T.max_teilnehmer]})]}),T.teilnahmegebuehr>0&&n.jsxs("div",{className:"info-row",children:[n.jsx("span",{className:"info-label",children:"Geb√ºhr:"}),n.jsxs("span",{children:[parseFloat(T.teilnahmegebuehr).toFixed(2)," ‚Ç¨"]})]}),T.anmeldefrist&&n.jsxs("div",{className:"info-row",children:[n.jsx("span",{className:"info-label",children:"Anmeldefrist:"}),n.jsx("span",{children:X(T.anmeldefrist)})]}),n.jsxs("div",{className:"info-row",children:[n.jsx("span",{className:"info-label",children:"Trainer:"}),n.jsx("span",{children:re(T.trainer_ids)})]})]}),T.beschreibung&&n.jsxs("div",{className:"details-description",children:[n.jsx("h4",{children:"Beschreibung"}),n.jsx("p",{children:T.beschreibung})]}),T.anforderungen&&n.jsxs("div",{className:"details-description",children:[n.jsx("h4",{children:"Anforderungen"}),n.jsx("p",{children:T.anforderungen})]})]}),c&&T.anmeldungen&&n.jsxs("div",{className:"details-section",children:[n.jsxs("h3",{children:["Anmeldungen (",T.anmeldungen.length,")"]}),0===T.anmeldungen.length?n.jsx("p",{className:"text-muted",children:"Noch keine Anmeldungen"}):n.jsx("div",{className:"anmeldungen-liste",children:T.anmeldungen.map(e=>n.jsxs("div",{className:"anmeldung-card",children:[n.jsxs("div",{className:"anmeldung-header",children:[n.jsxs("strong",{children:[e.vorname," ",e.nachname]}),n.jsx("span",{className:`badge ${ae(e.status)}`,children:se(e.status)})]}),n.jsxs("div",{className:"anmeldung-info",children:[e.email&&n.jsxs("div",{children:["üìß ",e.email]}),e.telefon&&n.jsxs("div",{children:["üì± ",e.telefon]}),n.jsxs("div",{children:["Angemeldet: ",X(e.anmeldedatum)]}),e.bezahlt?n.jsx("div",{className:"text-success",children:"‚úÖ Bezahlt"}):n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[n.jsx("div",{className:"text-warning",children:"‚è≥ Nicht bezahlt"}),c&&n.jsx("button",{className:"btn btn-sm",onClick:()=>(async e=>{var n,a;if(confirm("Anmeldung als bezahlt markieren?"))try{const n=await s.put(`/events/anmeldung/${e}/bezahlt`,{},{headers:{Authorization:`Bearer ${d}`}});if(n.data.success&&(alert(n.data.message||"Anmeldung als bezahlt markiert"),T)){const e=await s.get(`/events/${T.event_id}`,{headers:{Authorization:`Bearer ${d}`}});S(e.data)}}catch(r){console.error("Fehler beim Markieren als bezahlt:",r),alert("Fehler: "+((null==(a=null==(n=r.response)?void 0:n.data)?void 0:a.error)||r.message))}})(e.anmeldung_id),style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem",background:"linear-gradient(135deg, rgba(255, 215, 0, 0.3), rgba(255, 215, 0, 0.1))",border:"1px solid rgba(255, 215, 0, 0.4)",borderRadius:"6px",cursor:"pointer",color:"rgba(255, 215, 0, 0.9)",fontWeight:"600"},children:"Bezahlt"})]}),e.bemerkung&&n.jsx("div",{className:"anmeldung-bemerkung",children:n.jsx("em",{children:e.bemerkung})})]})]},e.anmeldung_id))})]})]})}),n.jsx("div",{className:"modal-footer",children:n.jsx("button",{className:"btn btn-secondary",onClick:()=>w(!1),children:"Schlie√üen"})})]})}),$&&B&&c&&n.jsx("div",{className:"modal-overlay",onClick:()=>E(!1),children:n.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[n.jsxs("div",{className:"modal-header",children:[n.jsxs("h2",{children:['Teilnehmer zu "',B.titel,'" hinzuf√ºgen']}),n.jsx("button",{className:"btn-close",onClick:()=>E(!1),children:"‚úï"})]}),n.jsxs("div",{className:"modal-body",children:[n.jsxs("div",{className:"form-group",children:[n.jsx("label",{children:"Mitglied ausw√§hlen *"}),n.jsxs("select",{className:"form-control",value:M,onChange:e=>I(e.target.value),required:!0,children:[n.jsx("option",{value:"",children:"-- Mitglied w√§hlen --"}),D.filter(e=>!(W[B.event_id]||[]).includes(e.mitglied_id)).map(e=>n.jsxs("option",{value:e.mitglied_id,children:[e.vorname," ",e.nachname," (",e.email,")"]},e.mitglied_id))]})]}),n.jsxs("div",{className:"form-group",children:[n.jsx("label",{children:"Bemerkung (optional)"}),n.jsx("textarea",{className:"form-control",rows:"3",value:P,onChange:e=>R(e.target.value),placeholder:"Optionale Notiz zur Anmeldung..."})]}),n.jsxs("div",{className:"form-group",children:[n.jsx("label",{children:"Zahlungsstatus *"}),n.jsxs("div",{style:{display:"flex",gap:"1.5rem",marginTop:"0.5rem"},children:[n.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[n.jsx("input",{type:"radio",name:"bezahlt",checked:!0===H,onChange:()=>K(!0),style:{cursor:"pointer"}}),n.jsx("span",{children:"Bezahlt"})]}),n.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[n.jsx("input",{type:"radio",name:"bezahlt",checked:!1===H,onChange:()=>K(!1),style:{cursor:"pointer"}}),n.jsx("span",{children:"Offen"})]})]})]}),n.jsx("div",{className:"alert alert-info",style:{marginTop:"1rem",padding:"0.75rem",borderRadius:"8px",background:"rgba(255, 215, 0, 0.1)",border:"1px solid rgba(255, 215, 0, 0.3)"},children:"‚ÑπÔ∏è Das Mitglied erh√§lt eine Benachrichtigung √ºber die Anmeldung."})]}),n.jsxs("div",{className:"modal-footer",children:[n.jsx("button",{className:"btn btn-secondary",onClick:()=>E(!1),children:"Abbrechen"}),n.jsx("button",{className:"btn btn-primary",onClick:async()=>{var e,n;if(M){N("");try{const e=await s.post(`/events/${B.event_id}/admin-anmelden`,{mitglied_id:parseInt(M),bemerkung:P||void 0,bezahlt:H},{headers:{Authorization:`Bearer ${d}`}});e.data.success&&(alert(e.data.message||"Teilnehmer erfolgreich hinzugef√ºgt"),E(!1),U())}catch(a){console.error("Fehler beim Hinzuf√ºgen des Teilnehmers:",a),alert("Fehler: "+((null==(n=null==(e=a.response)?void 0:e.data)?void 0:n.error)||a.message))}}else alert("Bitte w√§hlen Sie ein Mitglied aus")},disabled:!M,style:{background:M?"linear-gradient(135deg, rgba(255, 215, 0, 0.3), rgba(255, 215, 0, 0.1))":void 0,border:M?"1px solid rgba(255, 215, 0, 0.4)":void 0},children:"‚úì Hinzuf√ºgen"})]})]})})]})};export{i as default};
