import{a as e,j as n}from"./query-Caj74EYQ.js";import{f as s,c as a}from"./index-Bcs73ipe.js";import"./vendor-router-Co3o87Zc.js";import"./icons-DiLw-1i5.js";import"./charts-C1Gv3M_c.js";const r=()=>{var r;const[i,t]=e.useState([]),[l,c]=e.useState(!0),[d,o]=e.useState(null),[u,h]=e.useState(!1),[p,b]=e.useState(null),[m,g]=e.useState(null),[x,j]=e.useState(""),[v,k]=e.useState("all"),[N,f]=e.useState({name:"",beschreibung:"",parent_id:null,sortierung:0,icon:"",farbe:"#4A90E2",aktiv:!0});e.useEffect(()=>{y()},[]);const y=async()=>{try{c(!0);const e=await s(`${a.apiBaseUrl}/artikelgruppen`),n=await e.json();if(n.success){if(t(n.data),o(null),m){const e=n.data.find(e=>e.id===m.id);g(e||null)}}else o(n.message||"Fehler beim Laden der Artikelgruppen")}catch(e){o("Verbindungsfehler beim Laden der Artikelgruppen"),console.error("Fehler beim Laden der Artikelgruppen:",e)}finally{c(!1)}},C=(e=null)=>{e&&e.id?(b(e),f({name:e.name,beschreibung:e.beschreibung||"",parent_id:e.parent_id,sortierung:e.sortierung,icon:e.icon||"",farbe:e.farbe||"#4A90E2",aktiv:e.aktiv})):e&&e.parent_id?(b(null),f({name:"",beschreibung:"",parent_id:e.parent_id,sortierung:0,icon:"",farbe:"#4A90E2",aktiv:!0})):(b(null),f({name:"",beschreibung:"",parent_id:null,sortierung:0,icon:"",farbe:"#4A90E2",aktiv:!0})),h(!0)},w=()=>{h(!1),b(null),f({name:"",beschreibung:"",parent_id:null,sortierung:0,icon:"",farbe:"#4A90E2",aktiv:!0})},_=e=>{const{name:n,value:s,type:a,checked:r}=e.target;f(e=>({...e,[n]:"checkbox"===a?r:s}))},A=async e=>{if(window.confirm(`MÃ¶chten Sie die Gruppe "${e.name}" wirklich lÃ¶schen?`))try{const n=await s(`${a.apiBaseUrl}/artikelgruppen/${e.id}`,{method:"DELETE"}),r=await n.json();r.success?await y():o(r.message||"Fehler beim LÃ¶schen")}catch(n){o("Verbindungsfehler beim LÃ¶schen"),console.error("Fehler beim LÃ¶schen:",n)}},S=e=>{g(e)},L=i.filter(e=>{var n;const s=e.name.toLowerCase().includes(x.toLowerCase())||(null==(n=e.beschreibung)?void 0:n.toLowerCase().includes(x.toLowerCase()));return"hauptkategorien"===v?s&&null===e.parent_id:"unterkategorien"===v?s&&null!==e.parent_id:s});return l?n.jsx("div",{className:"artikelgruppen-verwaltung",children:n.jsxs("div",{className:"loading-container",children:[n.jsx("div",{className:"loading-spinner"}),n.jsx("p",{children:"Lade Artikelgruppen..."})]})}):n.jsxs("div",{className:"artikelgruppen-verwaltung",children:[n.jsxs("div",{className:"page-header",children:[n.jsxs("div",{className:"page-header-top",children:[n.jsxs("div",{className:"header-content",children:[n.jsx("h1",{children:"Artikelgruppen-Verwaltung"}),n.jsx("p",{children:"Kategorien und Unterkategorien verwalten"})]}),m&&n.jsx("button",{className:"btn-secondary",onClick:()=>{g(null)},children:"â† ZurÃ¼ck zur Ãœbersicht"})]}),!m&&n.jsxs("div",{className:"header-controls",children:[n.jsxs("div",{className:"search-box",children:[n.jsx("input",{type:"text",placeholder:"Gruppen suchen...",value:x,onChange:e=>j(e.target.value)}),n.jsx("span",{className:"search-icon",children:"ðŸ”"})]}),n.jsxs("select",{value:v,onChange:e=>k(e.target.value),className:"filter-select",children:[n.jsx("option",{value:"all",children:"Alle Gruppen"}),n.jsx("option",{value:"hauptkategorien",children:"Nur Hauptkategorien"}),n.jsx("option",{value:"unterkategorien",children:"Nur Unterkategorien"})]}),n.jsx("button",{className:"btn-primary",onClick:()=>C(),children:"+ Neue Gruppe"})]})]}),d&&n.jsxs("div",{className:"error-message",children:[n.jsx("span",{children:d}),n.jsx("button",{onClick:()=>o(null),children:"âœ•"})]}),m?n.jsxs("div",{className:"group-detail-view",children:[n.jsxs("div",{className:"detail-header",children:[n.jsxs("div",{className:"detail-header-content",children:[n.jsx("div",{className:"detail-icon",style:{color:m.farbe},children:m.icon||"ðŸ“"}),n.jsxs("div",{children:[n.jsx("h2",{children:m.name}),m.beschreibung&&n.jsx("p",{className:"detail-description",children:m.beschreibung}),n.jsxs("div",{className:"detail-stats",children:[n.jsxs("span",{className:"stat",children:["ðŸ‘¥ ",n.jsx("strong",{children:m.artikel_anzahl||0})," Artikel"]}),n.jsxs("span",{className:"stat",children:["ðŸ“‚ ",n.jsx("strong",{children:(null==(r=m.unterkategorien)?void 0:r.length)||0})," Unterkategorien"]})]})]})]}),n.jsxs("div",{className:"detail-actions sub-tabs",children:[n.jsx("button",{className:"sub-tab-btn",onClick:()=>C(m),title:"Gruppe bearbeiten",children:"âœï¸ Bearbeiten"}),n.jsx("button",{className:"sub-tab-btn",onClick:()=>C({parent_id:m.id}),title:"Unterkategorie hinzufÃ¼gen",children:"âž• Unterkategorie"})]})]}),n.jsxs("div",{className:"unterkategorien-section",children:[n.jsx("h3",{children:"Unterkategorien"}),m.unterkategorien&&m.unterkategorien.length>0?n.jsx("div",{className:"unterkategorien-grid",children:m.unterkategorien.map(e=>n.jsxs("div",{className:"unterkategorie-detail-card",children:[n.jsxs("div",{className:"unterkategorie-detail-header",children:[n.jsx("div",{className:"unterkategorie-icon",style:{color:e.farbe},children:e.icon||"ðŸ“‚"}),n.jsxs("div",{className:"unterkategorie-detail-info",children:[n.jsx("h4",{children:e.name}),e.beschreibung&&n.jsx("p",{children:e.beschreibung}),n.jsxs("div",{className:"unterkategorie-stat",children:[n.jsx("strong",{children:e.artikel_anzahl||0})," Artikel"]})]})]}),n.jsxs("div",{className:"unterkategorie-detail-actions sub-tabs",children:[n.jsx("button",{className:"sub-tab-btn details-btn",onClick:()=>S(e),title:"Details anzeigen",children:"ðŸ“‹ Details"}),n.jsx("button",{className:"sub-tab-btn edit-btn",onClick:()=>C(e),title:"Bearbeiten",children:"âœï¸ Bearbeiten"}),n.jsx("button",{className:"sub-tab-btn delete-btn",onClick:()=>A(e),title:"LÃ¶schen",children:"ðŸ—‘ï¸ LÃ¶schen"})]})]},e.id))}):n.jsxs("div",{className:"empty-state",children:[n.jsx("div",{className:"empty-icon",children:"ðŸ“‚"}),n.jsx("h3",{children:"Noch keine Unterkategorien"}),n.jsx("p",{children:"FÃ¼gen Sie die erste Unterkategorie fÃ¼r diese Gruppe hinzu"}),n.jsx("button",{className:"sub-tab-btn",onClick:()=>C({parent_id:m.id}),children:"Erste Unterkategorie erstellen"})]})]})]}):n.jsx(n.Fragment,{children:n.jsx("div",{className:"groups-container",children:0===L.length?n.jsxs("div",{className:"empty-state",children:[n.jsx("div",{className:"empty-icon",children:"ðŸ“"}),n.jsx("h3",{children:"Keine Gruppen gefunden"}),n.jsx("p",{children:x?`Keine Gruppen gefunden fÃ¼r "${x}"`:"Noch keine Artikelgruppen vorhanden"}),!x&&n.jsx("button",{className:"sub-tab-btn",onClick:()=>C(),children:"Erste Gruppe erstellen"})]}):n.jsx("div",{className:"groups-grid",children:L.map(e=>{const s=e.unterkategorien&&e.unterkategorien.length>0;return n.jsxs("div",{className:"group-card",children:[n.jsx("div",{className:"group-header",children:n.jsxs("div",{className:"group-info",children:[n.jsx("div",{className:"group-icon",style:{color:e.farbe},children:e.icon||"ðŸ“"}),n.jsxs("div",{className:"group-details",children:[n.jsx("h3",{className:"group-name",children:e.name}),e.beschreibung&&n.jsx("p",{className:"group-description",children:e.beschreibung}),n.jsxs("div",{className:"group-stats",children:[n.jsxs("span",{className:"stat",children:[n.jsx("strong",{children:e.artikel_anzahl||0})," Artikel"]}),s&&n.jsxs("span",{className:"stat",children:[n.jsx("strong",{children:e.unterkategorien.length})," Unterkategorien"]})]})]})]})}),n.jsxs("div",{className:"group-actions sub-tabs",children:[n.jsx("button",{className:"sub-tab-btn details-btn",onClick:()=>S(e),title:"Details anzeigen",children:"ðŸ“‹ Details"}),n.jsx("button",{className:"sub-tab-btn edit-btn",onClick:()=>C(e),title:"Bearbeiten","aria-label":`Gruppe ${e.name} bearbeiten`,children:"âœï¸ Bearbeiten"}),n.jsx("button",{className:"sub-tab-btn delete-btn",onClick:()=>A(e),title:"LÃ¶schen","aria-label":`Gruppe ${e.name} lÃ¶schen`,children:"ðŸ—‘ï¸ LÃ¶schen"})]})]},e.id)})})})}),u&&n.jsx("div",{className:"modal-overlay",onClick:e=>{e.target===e.currentTarget&&w()},children:n.jsxs("div",{className:"modal-content",children:[n.jsxs("div",{className:"modal-header",children:[n.jsx("h2",{children:p?"Gruppe bearbeiten":"Neue Gruppe erstellen"}),n.jsx("button",{className:"close-btn",onClick:w,children:"âœ•"})]}),n.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{const e=p?`${a.apiBaseUrl}/artikelgruppen/${p.id}`:`${a.apiBaseUrl}/artikelgruppen`,n=p?"PUT":"POST",r=await s(e,{method:n,headers:{"Content-Type":"application/json"},body:JSON.stringify(N)}),i=await r.json();i.success?(await y(),w()):o(i.message||"Fehler beim Speichern")}catch(n){o("Verbindungsfehler beim Speichern"),console.error("Fehler beim Speichern:",n)}},className:"group-form",children:[n.jsxs("div",{className:"form-row",children:[n.jsxs("div",{className:"form-group",children:[n.jsx("label",{htmlFor:"name",children:"Name *"}),n.jsx("input",{type:"text",id:"name",name:"name",value:N.name,onChange:_,required:!0,placeholder:"z.B. Bekleidung"})]}),n.jsxs("div",{className:"form-group",children:[n.jsx("label",{htmlFor:"sortierung",children:"Sortierung"}),n.jsx("input",{type:"number",id:"sortierung",name:"sortierung",value:N.sortierung,onChange:_,min:"0"})]})]}),n.jsxs("div",{className:"form-group",children:[n.jsx("label",{htmlFor:"beschreibung",children:"Beschreibung"}),n.jsx("textarea",{id:"beschreibung",name:"beschreibung",value:N.beschreibung,onChange:_,rows:"3",placeholder:"Beschreibung der Gruppe..."})]}),n.jsxs("div",{className:"form-row",children:[n.jsxs("div",{className:"form-group",children:[n.jsx("label",{htmlFor:"parent_id",children:"Hauptkategorie"}),n.jsxs("select",{id:"parent_id",name:"parent_id",value:N.parent_id||"",onChange:_,children:[n.jsx("option",{value:"",children:"Hauptkategorie (keine)"}),i.filter(e=>null===e.parent_id).map(e=>n.jsx("option",{value:e.id,children:e.name},e.id))]})]}),n.jsxs("div",{className:"form-group",children:[n.jsx("label",{htmlFor:"icon",children:"Icon (Emoji)"}),n.jsx("input",{type:"text",id:"icon",name:"icon",value:N.icon,onChange:_,placeholder:"ðŸ‘•",maxLength:"2"})]})]}),n.jsxs("div",{className:"form-group",children:[n.jsx("label",{htmlFor:"farbe",children:"Farbe"}),n.jsxs("div",{className:"color-input-group",children:[n.jsx("input",{type:"color",id:"farbe",name:"farbe",value:N.farbe,onChange:_}),n.jsx("input",{type:"text",name:"farbe",value:N.farbe,onChange:_,placeholder:"#4A90E2",className:"color-text-input"})]})]}),n.jsx("div",{className:"form-group",children:n.jsxs("label",{className:"checkbox-label",children:[n.jsx("input",{type:"checkbox",name:"aktiv",checked:N.aktiv,onChange:_}),"Gruppe ist aktiv"]})}),n.jsxs("div",{className:"modal-footer sub-tabs",children:[n.jsx("button",{type:"button",className:"sub-tab-btn",onClick:w,children:"Abbrechen"}),n.jsx("button",{type:"submit",className:"sub-tab-btn",children:p?"Aktualisieren":"Erstellen"})]})]})]})})]})};export{r as default};
