import{a as e,j as s}from"./query-Caj74EYQ.js";import{a as i}from"./index-DJzZu8AC.js";import"./vendor-router-Co3o87Zc.js";import"./icons-DiLw-1i5.js";import"./charts-C1Gv3M_c.js";const a=()=>{const[a,c]=e.useState([]),[t,n]=e.useState({total:0,today:0}),[l,r]=e.useState(!1),[d,m]=e.useState(new Date);e.useEffect(()=>{const e=async()=>{try{r(!0);const e=(new Date).toISOString().split("T")[0],s=(await i.get("/checkin/today",{params:{datum:e}})).data;if(s.success){const e=s.checkins||[];c(s=>{if(0===s.length)return e;const i=new Set(s.map(e=>`${e.mitglied_id}-${e.checkin_id||e.checkin_time}`)),a=new Set(e.map(e=>`${e.mitglied_id}-${e.checkin_id||e.checkin_time}`));return i.size===a.size&&[...i].every(e=>a.has(e))&&[...a].every(e=>i.has(e))?s:e}),n({total:e.length||0,today:e.filter(e=>"active"===e.status).length||0})}}catch(e){console.error("âŒ Fehler beim Laden der Check-ins:",e)}finally{r(!1)}};e();const s=setInterval(e,3e3),a=setInterval(()=>{m(new Date)},1e3);return()=>{clearInterval(s),clearInterval(a)}},[]);const o=a.filter(e=>"active"===e.status);return s.jsxs("div",{className:"public-checkin-display",children:[s.jsxs("div",{className:"public-header-compact",children:[s.jsx("div",{className:"header-left",children:s.jsxs("div",{className:"dojo-logo-compact",children:[s.jsx("h1",{children:"DOJO CHECK-IN"}),s.jsx("p",{className:"welcome-text",children:"Willkommen im Training!"})]})}),s.jsxs("div",{className:"header-right-section",children:[s.jsxs("div",{className:"current-time-compact",children:[s.jsx("div",{className:"time",children:d.toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit",second:"2-digit"})}),s.jsx("div",{className:"date",children:d.toLocaleDateString("de-DE",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),s.jsxs("div",{className:"public-stats-compact",children:[s.jsxs("div",{className:"stat-item-compact",children:[s.jsx("div",{className:"stat-icon",children:"ğŸ‘¥"}),s.jsxs("div",{className:"stat-content",children:[s.jsx("div",{className:"stat-number",children:t.today}),s.jsx("div",{className:"stat-label",children:"Heute Eingecheckt"})]})]}),s.jsxs("div",{className:"stat-item-compact",children:[s.jsx("div",{className:"stat-icon",children:"ğŸ“…"}),s.jsxs("div",{className:"stat-content",children:[s.jsx("div",{className:"stat-number",children:t.total}),s.jsx("div",{className:"stat-label",children:"Check-ins Gesamt"})]})]}),s.jsxs("div",{className:"stat-item-compact",children:[s.jsx("div",{className:"stat-icon",children:"ğŸ”„"}),s.jsxs("div",{className:"stat-content",children:[s.jsx("div",{className:"stat-number",children:"LIVE"}),s.jsx("div",{className:"stat-label",children:"Updates alle 3s"})]})]})]})]})]}),l&&s.jsxs("div",{className:"loading-indicator",children:[s.jsx("div",{className:"spinner"}),s.jsx("span",{children:"Aktualisiere..."})]}),s.jsx("div",{className:"checkins-section",children:0===o.length?s.jsxs("div",{className:"no-checkins",children:[s.jsx("div",{className:"no-checkins-icon",children:"ğŸ“…"}),s.jsx("h3",{children:"Noch keine Check-ins heute"}),s.jsx("p",{children:"Sobald sich Mitglieder einchecken, erscheinen sie hier automatisch."})]}):s.jsx("div",{className:"checkins-grid",children:o.map((e,i)=>{var a,c,t;return s.jsxs("div",{className:"checkin-item",style:{animationDelay:.1*i+"s"},children:[s.jsxs("div",{className:"checkin-avatar",children:[e.foto_pfad||e.profilbild?s.jsx("img",{src:`http://localhost:3000/${(e.foto_pfad||e.profilbild).startsWith("/")?(e.foto_pfad||e.profilbild).slice(1):e.foto_pfad||e.profilbild}`,alt:`${e.vorname} ${e.nachname}`,onError:e=>{e.currentTarget.style.display="none";const s=e.currentTarget.nextSibling;s&&(s.style.display="flex")},onLoad:e=>{const s=e.currentTarget.nextSibling;s&&(s.style.display="none")},style:{display:"block"}},`img-${e.mitglied_id}-${e.checkin_id||e.checkin_time}`):null,s.jsxs("div",{className:"avatar-placeholder",style:{display:e.foto_pfad||e.profilbild?"none":"flex"},children:[null==(a=e.vorname)?void 0:a.charAt(0),null==(c=e.nachname)?void 0:c.charAt(0)]})]}),s.jsxs("div",{className:"checkin-info",children:[s.jsxs("div",{className:"member-name",children:[e.vorname," ",e.nachname]}),s.jsxs("div",{className:"checkin-details",children:[s.jsxs("span",{className:"checkin-time",children:["ğŸ• ",(t=e.checkin_time,t?new Date(t).toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"}):"")]}),e.gurtfarbe&&"Unbekannt"!==e.gurtfarbe&&""!==e.gurtfarbe.trim()&&s.jsxs("span",{className:"belt-info",children:["ğŸ¥‹ ",e.gurtfarbe]})]}),e.kurse&&e.kurse.length>0&&s.jsxs("div",{className:"member-courses",children:[e.kurse.slice(0,2).map((e,i)=>s.jsx("span",{className:"course-tag",children:e},i)),e.kurse.length>2&&s.jsxs("span",{className:"course-tag more",children:["+",e.kurse.length-2]})]})]}),s.jsxs("div",{className:"checkin-status",children:[s.jsx("div",{className:"status-indicator active"}),s.jsx("span",{className:"status-text",children:"AKTIV"})]})]},`${e.mitglied_id}-${e.checkin_id||e.checkin_time}`)})})}),s.jsxs("div",{className:"public-footer",children:[s.jsx("p",{children:"ğŸ’¡ Diese Anzeige aktualisiert sich automatisch alle 3 Sekunden"}),s.jsx("p",{children:"ğŸ† Viel Erfolg beim Training!"})]})]})};export{a as default};
