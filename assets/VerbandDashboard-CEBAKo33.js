import{a as e,j as s}from"./query-Caj74EYQ.js";import{u as t,a as n,l as i}from"./index-Bcs73ipe.js";import{R as a,A as l,P as r,r as d,U as o,$ as c,T as h,aP as u,c as p,aQ as x,X as g,a9 as m,a2 as j,t as b,C as v,a0 as f,F as y,u as k,s as z,b as N,aR as _,aS as C,M as S,ab as w,aa as B,v as I,aI as T,d as D,aT as F,w as A,q as M,k as R,ax as L,aN as E,e as G,aU as V,aV as P,aW as W,ae as $,aX as K,af as O,aY as H,aq as U,G as J,y as Z,o as q,n as X,a3 as Y,ag as Q,g as ee,l as se,V as te,Q as ne}from"./icons-DiLw-1i5.js";import{Z as ie}from"./ZieleEntwicklung-kvsWw6ht.js";import ae from"./SupportTickets-DD3UnBi1.js";import{u as le}from"./vendor-router-Co3o87Zc.js";const re=()=>{var M,R,L,E;const{token:G,user:V}=t(),P="admin"===(null==V?void 0:V.rolle)||"admin"===(null==V?void 0:V.role),[W,$]=e.useState("dojos"),[K,O]=e.useState([]),[H,U]=e.useState([]),[J,Z]=e.useState({}),[q,X]=e.useState(!0),[Y,Q]=e.useState(""),[ee,se]=e.useState(""),[te,ne]=e.useState(""),[ie,ae]=e.useState([]),[le,re]=e.useState(!1),[oe,ce]=e.useState("typen"),[he,ue]=e.useState({}),[pe,xe]=e.useState(!1),[ge,me]=e.useState({}),[je,be]=e.useState([]),[ve,fe]=e.useState(!1),[ye,ke]=e.useState(null),[ze,Ne]=e.useState(!1),[_e,Ce]=e.useState({code:"",name:"",beschreibung:"",kategorie:"person",preis_netto:0,steuersatz:19,laufzeit_monate:12,kuendigungsfrist_monate:3,auto_verlaengerung:!0,ist_standard:!1,aktiv:!0,sortierung:0}),[Se,we]=e.useState(null),[Be,Ie]=e.useState(!1),[Te,De]=e.useState({titel:"",beschreibung:"",gilt_fuer:"beide",rabatt_typ:"prozent",rabatt_wert:0,kategorie:"sonstige",aktiv:!0}),[Fe,Ae]=e.useState(!1),[Me,Re]=e.useState(!1),[Le,Ee]=e.useState(!1),[Ge,Ve]=e.useState(!1),[Pe,We]=e.useState(!1),[$e,Ke]=e.useState(null),[Oe,He]=e.useState([]),[Ue,Je]=e.useState("info"),[Ze,qe]=e.useState({iban:"",bic:"",kontoinhaber:""}),[Xe,Ye]=e.useState([]),[Qe,es]=e.useState([]),[ss,ts]=e.useState(null),ns=e.useRef(null),[is,as]=e.useState(!1),[ls,rs]=e.useState(null),[ds,os]=e.useState({agb:!1,dsgvo:!1,widerruf:!1}),[cs,hs]=e.useState({typ:"dojo",dojo_id:"",neues_dojo:!1,neues_dojo_name:"",neues_dojo_inhaber:"",neues_dojo_email:"",neues_dojo_strasse:"",neues_dojo_plz:"",neues_dojo_ort:"",neues_dojo_land:"Deutschland",person_vorname:"",person_nachname:"",person_email:"",person_telefon:"",person_strasse:"",person_plz:"",person_ort:"",person_land:"Deutschland",person_geburtsdatum:"",zahlungsart:"rechnung",notizen:"",beitragsfrei:!1}),us=n.create({baseURL:"/api",headers:{Authorization:`Bearer ${G}`}}),ps=async()=>{X(!0),Q("");try{const[e,s,t]=await Promise.all([us.get("/verbandsmitgliedschaften"),us.get("/verbandsmitgliedschaften/stats"),us.get("/verbandsmitgliedschaften/vorteile/liste")]),n=e.data.mitgliedschaften||e.data;O(Array.isArray(n)?n:[]);const i=s.data.stats||s.data;Z(i),U(t.data)}catch(e){console.error("Fehler beim Laden:",e),Q("Fehler beim Laden der Daten")}finally{X(!1)}},xs=async()=>{re(!0);try{const e=await us.get("/verbandsmitgliedschaften/einstellungen/alle");ae(e.data),ue({})}catch(e){console.error("Fehler beim Laden der Einstellungen:",e)}finally{re(!1)}},gs=async()=>{try{const e=await us.get("/verbandsmitgliedschaften/einstellungen-config");me(e.data)}catch(e){console.error("Fehler beim Laden der Konfiguration:",e)}},ms=(e,s)=>{ue(t=>({...t,[e]:s}))},js=e=>{if(he.hasOwnProperty(e))return he[e];const s=ie.find(s=>s.einstellung_key===e);return(null==s?void 0:s.einstellung_value)??""},bs=async()=>{fe(!0);try{const e=await us.get("/verbandsmitgliedschaften/mitgliedschaftstypen");be(e.data)}catch(e){console.error("Fehler beim Laden der Mitgliedschaftstypen:",e)}finally{fe(!1)}},vs=(e=null)=>{e?(ke(e),Ce({code:e.code,name:e.name,beschreibung:e.beschreibung||"",kategorie:e.kategorie,preis_netto:e.preis_netto,steuersatz:e.steuersatz,laufzeit_monate:e.laufzeit_monate,kuendigungsfrist_monate:e.kuendigungsfrist_monate,auto_verlaengerung:e.auto_verlaengerung,ist_standard:e.ist_standard,aktiv:e.aktiv,sortierung:e.sortierung})):(ke(null),Ce({code:"",name:"",beschreibung:"",kategorie:"person",preis_netto:0,steuersatz:19,laufzeit_monate:12,kuendigungsfrist_monate:3,auto_verlaengerung:!0,ist_standard:!1,aktiv:!0,sortierung:0})),Ne(!0)},fs=async()=>{try{const e=await us.get("/verbandsmitgliedschaften/vorteile");U(e.data)}catch(e){console.error("Fehler beim Laden der Vorteile:",e)}},ys=(e=null)=>{e?(we(e),De({titel:e.titel,beschreibung:e.beschreibung||"",gilt_fuer:e.gilt_fuer,rabatt_typ:e.rabatt_typ,rabatt_wert:e.rabatt_wert,kategorie:e.kategorie,aktiv:e.aktiv})):(we(null),De({titel:"",beschreibung:"",gilt_fuer:"beide",rabatt_typ:"prozent",rabatt_wert:0,kategorie:"sonstige",aktiv:!0})),Ie(!0)};e.useEffect(()=>{ps(),gs()},[]),e.useEffect(()=>{Fe&&"dojo"===cs.typ&&(async()=>{try{const e=await us.get("/verbandsmitgliedschaften/dojos-ohne-mitgliedschaft");He(e.data)}catch(e){console.error("Fehler beim Laden der Dojos:",e)}})()},[Fe,cs.typ]),e.useEffect(()=>{(Le||Pe)&&setTimeout(()=>_s(),100)},[Le,Pe]),e.useEffect(()=>{"einstellungen"===W&&("typen"===oe?bs():xs())},[W,oe]);const ks=()=>{hs({typ:"dojo",dojo_id:"",neues_dojo:!1,neues_dojo_name:"",neues_dojo_inhaber:"",neues_dojo_email:"",neues_dojo_strasse:"",neues_dojo_plz:"",neues_dojo_ort:"",neues_dojo_land:"Deutschland",person_vorname:"",person_nachname:"",person_email:"",person_telefon:"",person_strasse:"",person_plz:"",person_ort:"",person_land:"Deutschland",person_geburtsdatum:"",zahlungsart:"rechnung",notizen:"",beitragsfrei:!1})},zs=async e=>{try{const s=await us.get(`/verbandsmitgliedschaften/${e}/sepa`);Ye(s.data)}catch(s){console.error("Fehler beim Laden der SEPA-Mandate:",s)}},Ns=async e=>{try{const s=await us.get(`/verbandsmitgliedschaften/dokumente/${e}`);ts(s.data),Ve(!0)}catch(s){alert("Dokument nicht gefunden")}},_s=()=>{const e=ns.current;if(!e)return;const s=e.getContext("2d");s.fillStyle="#fff",s.fillRect(0,0,e.width,e.height),s.strokeStyle="#000",s.lineWidth=2,s.lineCap="round"},Cs=e=>{var s,t,n,i;const a=ns.current,l=a.getContext("2d"),r=a.getBoundingClientRect(),d=(e.clientX||(null==(t=null==(s=e.touches)?void 0:s[0])?void 0:t.clientX))-r.left,o=(e.clientY||(null==(i=null==(n=e.touches)?void 0:n[0])?void 0:i.clientY))-r.top;l.beginPath(),l.moveTo(d,o),as(!0)},Ss=e=>{var s,t,n,i;if(!is)return;const a=ns.current,l=a.getContext("2d"),r=a.getBoundingClientRect(),d=(e.clientX||(null==(t=null==(s=e.touches)?void 0:s[0])?void 0:t.clientX))-r.left,o=(e.clientY||(null==(i=null==(n=e.touches)?void 0:n[0])?void 0:i.clientY))-r.top;l.lineTo(d,o),l.stroke()},ws=()=>{if(is){as(!1);const e=ns.current;rs(e.toDataURL("image/png"))}},Bs=()=>{_s(),rs(null)},Is=async e=>{try{const[s,t]=await Promise.all([us.get(`/verbandsmitgliedschaften/${e.id}`),us.get(`/verbandsmitgliedschaften/${e.id}/zahlungen`)]);Ke({...s.data,zahlungen:t.data}),Je("info"),zs(e.id),(async()=>{try{const e=await us.get("/verbandsmitgliedschaften/dokumente/liste");es(e.data)}catch(e){console.error("Fehler beim Laden der Dokumente:",e)}})(),Re(!0)}catch(s){alert("Fehler beim Laden der Details")}},Ts=K.filter(e=>{var s;if("dojos"===W&&"dojo"!==e.typ)return!1;if("einzelpersonen"===W&&"einzelperson"!==e.typ)return!1;if(te&&e.status!==te)return!1;if(ee){const t=ee.toLowerCase();if(!("dojo"===e.typ?e.dojo_name||"":`${e.person_vorname||""} ${e.person_nachname||""}`).toLowerCase().includes(t)&&!(null==(s=e.mitgliedsnummer)?void 0:s.toLowerCase().includes(t)))return!1}return!0}),Ds=e=>{const t={aktiv:{color:"#10b981",bg:"rgba(16, 185, 129, 0.15)",icon:m,label:"Aktiv"},ausstehend:{color:"#f59e0b",bg:"rgba(245, 158, 11, 0.15)",icon:A,label:"Ausstehend"},abgelaufen:{color:"#ef4444",bg:"rgba(239, 68, 68, 0.15)",icon:h,label:"Abgelaufen"},gekuendigt:{color:"#6b7280",bg:"rgba(107, 114, 128, 0.15)",icon:g,label:"GekÃ¼ndigt"},vertragsfrei:{color:"#8b5cf6",bg:"rgba(139, 92, 246, 0.15)",icon:D,label:"Vertragsfrei"}},n=t[e]||t.ausstehend,i=n.icon;return s.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"4px",padding:"4px 10px",borderRadius:"6px",background:n.bg,color:n.color,fontSize:"0.8rem",fontWeight:"600"},children:[s.jsx(i,{size:14}),n.label]})},Fs=e=>e?new Date(e).toLocaleDateString("de-DE"):"-",As=e=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(e);return q?s.jsx("div",{style:de.container,children:s.jsxs("div",{style:de.loading,children:[s.jsx(a,{size:32,className:"spin"}),s.jsx("span",{children:"Lade Verbandsmitglieder..."})]})}):s.jsxs("div",{style:de.container,children:[s.jsxs("div",{style:de.header,children:[s.jsxs("div",{children:[s.jsxs("h1",{style:de.title,children:[s.jsx(l,{size:28,color:"#ffd700"}),"TDA Verbandsmitglieder"]}),s.jsx("p",{style:de.subtitle,children:"Dojo- und Einzelmitgliedschaften verwalten"})]}),s.jsxs("button",{style:de.primaryButton,onClick:()=>Ae(!0),children:[s.jsx(r,{size:18}),"Neue Mitgliedschaft"]})]}),s.jsxs("div",{style:de.statsGrid,children:[s.jsxs("div",{style:de.statCard,children:[s.jsx(d,{size:24,color:"#3b82f6"}),s.jsxs("div",{children:[s.jsx("div",{style:de.statValue,children:J.dojos||0}),s.jsx("div",{style:de.statLabel,children:"Dojo-Mitglieder"})]})]}),s.jsxs("div",{style:de.statCard,children:[s.jsx(o,{size:24,color:"#10b981"}),s.jsxs("div",{children:[s.jsx("div",{style:de.statValue,children:J.einzelpersonen||0}),s.jsx("div",{style:de.statLabel,children:"Einzelmitglieder"})]})]}),s.jsxs("div",{style:de.statCard,children:[s.jsx(c,{size:24,color:"#ffd700"}),s.jsxs("div",{children:[s.jsx("div",{style:de.statValue,children:As(J.jahresumsatz||0)}),s.jsx("div",{style:de.statLabel,children:"Jahresumsatz"})]})]}),s.jsxs("div",{style:de.statCard,children:[s.jsx(h,{size:24,color:"#f59e0b"}),s.jsxs("div",{children:[s.jsx("div",{style:de.statValue,children:J.auslaufend||0}),s.jsx("div",{style:de.statLabel,children:"Laufen aus (30 Tage)"})]})]})]}),s.jsxs("div",{style:de.tabs,children:[s.jsxs("button",{style:{...de.tab,..."dojos"===W?de.tabActive:{}},onClick:()=>$("dojos"),children:[s.jsx(d,{size:16}),"Dojos (",K.filter(e=>"dojo"===e.typ).length,")"]}),s.jsxs("button",{style:{...de.tab,..."einzelpersonen"===W?de.tabActive:{}},onClick:()=>$("einzelpersonen"),children:[s.jsx(o,{size:16}),"Einzelpersonen (",K.filter(e=>"einzelperson"===e.typ).length,")"]}),s.jsxs("button",{style:{...de.tab,..."vorteile"===W?de.tabActive:{}},onClick:()=>$("vorteile"),children:[s.jsx(u,{size:16}),"Vorteile & Rabatte"]}),s.jsxs("button",{style:{...de.tab,..."einstellungen"===W?de.tabActive:{}},onClick:()=>$("einstellungen"),children:[s.jsx(p,{size:16}),"Einstellungen"]})]}),"vorteile"===W&&s.jsxs("div",{style:de.vorteileContainer,children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[s.jsx("h3",{style:{...de.sectionTitle,margin:0},children:"Mitgliedschaftsvorteile & Rabatte"}),s.jsxs("button",{onClick:()=>ys(),style:de.submitButton,children:[s.jsx(r,{size:16})," Neuer Vorteil"]})]}),s.jsxs("div",{style:de.vorteileGrid,children:[H.map(e=>s.jsxs("div",{style:{...de.vorteilCard,opacity:e.aktiv?1:.5},children:[s.jsxs("div",{style:de.vorteilHeader,children:[s.jsx(x,{size:20,color:"#ffd700"}),s.jsx("span",{style:de.vorteilTitel,children:e.titel}),!e.aktiv&&s.jsx("span",{style:{background:"#ef4444",color:"#fff",padding:"2px 6px",borderRadius:"4px",fontSize:"10px",marginLeft:"8px"},children:"INAKTIV"})]}),s.jsx("p",{style:de.vorteilBeschreibung,children:e.beschreibung}),s.jsxs("div",{style:de.vorteilMeta,children:[s.jsxs("span",{style:de.vorteilRabatt,children:["prozent"===e.rabatt_typ?`${e.rabatt_wert}%`:`${e.rabatt_wert}â‚¬`," Rabatt"]}),s.jsx("span",{style:de.vorteilKategorie,children:e.kategorie}),s.jsx("span",{style:{...de.vorteilGilt,background:"dojo"===e.gilt_fuer?"rgba(59, 130, 246, 0.2)":"einzelperson"===e.gilt_fuer?"rgba(16, 185, 129, 0.2)":"rgba(255, 215, 0, 0.2)"},children:"beide"===e.gilt_fuer?"Alle":"dojo"===e.gilt_fuer?"Dojos":"Einzelpersonen"})]}),s.jsxs("div",{style:{display:"flex",gap:"8px",marginTop:"12px",borderTop:"1px solid rgba(255,255,255,0.1)",paddingTop:"12px"},children:[s.jsx("button",{onClick:()=>(async e=>{try{await us.post(`/verbandsmitgliedschaften/vorteile/${e}/toggle-aktiv`),fs()}catch(s){alert("Fehler beim Umschalten")}})(e.id),style:{...de.iconButton,background:e.aktiv?"rgba(239,68,68,0.2)":"rgba(16,185,129,0.2)",color:e.aktiv?"#ef4444":"#10b981",flex:1},children:e.aktiv?s.jsxs(s.Fragment,{children:[s.jsx(g,{size:14})," Deaktivieren"]}):s.jsxs(s.Fragment,{children:[s.jsx(m,{size:14})," Aktivieren"]})}),s.jsxs("button",{onClick:()=>ys(e),style:{...de.iconButton,flex:1},children:[s.jsx(j,{size:14})," Bearbeiten"]}),s.jsx("button",{onClick:()=>(async e=>{var s,t;if(confirm("Vorteil wirklich lÃ¶schen?"))try{await us.delete(`/verbandsmitgliedschaften/vorteile/${e}`),alert("GelÃ¶scht!"),fs()}catch(n){alert((null==(t=null==(s=n.response)?void 0:s.data)?void 0:t.error)||"Fehler beim LÃ¶schen")}})(e.id),style:{...de.iconButton,color:"#ef4444"},children:s.jsx(b,{size:14})})]})]},e.id)),0===H.length&&s.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#888",gridColumn:"1 / -1"},children:"Keine Vorteile vorhanden. Erstellen Sie einen neuen Vorteil."})]})]}),"einstellungen"===W&&s.jsxs("div",{style:de.einstellungenContainer,children:[s.jsx("div",{style:de.einstellungenTabs,children:[{key:"typen",label:"Mitgliedschaftstypen",icon:p},{key:"preise",label:"Preise",icon:c},{key:"laufzeiten",label:"Laufzeiten",icon:v},{key:"zahlungen",label:"Zahlungen",icon:f},{key:"nummern",label:"Nummern",icon:y},{key:"verband",label:"Verband",icon:d}].map(({key:e,label:t,icon:n})=>s.jsxs("button",{style:{...de.einstellungenTab,...oe===e?de.einstellungenTabActive:{}},onClick:()=>ce(e),children:[s.jsx(n,{size:16}),t]},e))}),"typen"===oe&&s.jsxs("div",{style:{marginTop:"20px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[s.jsx("h3",{style:{margin:0,color:"#fff"},children:"Mitgliedschaftstypen verwalten"}),s.jsxs("button",{onClick:()=>vs(),style:de.submitButton,children:[s.jsx(r,{size:16})," Neuer Typ"]})]}),ve?s.jsxs("div",{style:de.loading,children:[s.jsx(a,{size:24,className:"spin"}),s.jsx("span",{children:"Lade Typen..."})]}):s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[je.map(e=>{var t;return s.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"8px",padding:"16px",display:"grid",gridTemplateColumns:"1fr auto",gap:"16px",alignItems:"center",opacity:e.aktiv?1:.6},children:[s.jsxs("div",{children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[s.jsx("span",{style:{background:"dojo"===e.kategorie?"rgba(59,130,246,0.2)":"rgba(16,185,129,0.2)",color:"dojo"===e.kategorie?"#60a5fa":"#34d399",padding:"2px 8px",borderRadius:"4px",fontSize:"11px",textTransform:"uppercase"},children:e.kategorie}),s.jsx("strong",{style:{color:"#fff",fontSize:"16px"},children:e.name}),s.jsxs("code",{style:{color:"#888",fontSize:"12px"},children:["(",e.code,")"]}),e.ist_standard&&s.jsx("span",{style:{background:"#fbbf24",color:"#000",padding:"2px 6px",borderRadius:"4px",fontSize:"10px"},children:"STANDARD"}),!e.aktiv&&s.jsx("span",{style:{background:"#ef4444",color:"#fff",padding:"2px 6px",borderRadius:"4px",fontSize:"10px"},children:"INAKTIV"})]}),s.jsx("p",{style:{color:"#aaa",margin:"4px 0 8px",fontSize:"13px"},children:e.beschreibung||"-"}),s.jsxs("div",{style:{display:"flex",gap:"16px",flexWrap:"wrap",fontSize:"13px",color:"#ccc"},children:[s.jsxs("span",{children:[s.jsx(c,{size:14,style:{marginRight:"4px"}}),s.jsxs("strong",{children:[null==(t=e.preis_brutto)?void 0:t.toFixed(2),"â‚¬"]})," brutto (",e.preis_netto,"â‚¬ netto)"]}),s.jsxs("span",{children:[s.jsx(x,{size:14,style:{marginRight:"4px"}}),e.steuersatz,"% MwSt"]}),s.jsxs("span",{children:[s.jsx(v,{size:14,style:{marginRight:"4px"}}),e.laufzeit_monate," Monate Laufzeit"]}),s.jsx("span",{children:e.auto_verlaengerung?"ğŸ”„ Auto-VerlÃ¤ngerung":"ğŸ“… Einmalig"})]})]}),s.jsxs("div",{style:{display:"flex",gap:"8px"},children:[s.jsx("button",{onClick:()=>(async e=>{try{await us.post(`/verbandsmitgliedschaften/mitgliedschaftstypen/${e}/toggle-aktiv`),bs()}catch(s){alert("Fehler beim Umschalten")}})(e.id),style:{...de.iconButton,background:e.aktiv?"rgba(239,68,68,0.2)":"rgba(16,185,129,0.2)",color:e.aktiv?"#ef4444":"#10b981"},title:e.aktiv?"Deaktivieren":"Aktivieren",children:e.aktiv?s.jsx(g,{size:16}):s.jsx(m,{size:16})}),s.jsx("button",{onClick:()=>vs(e),style:de.iconButton,title:"Bearbeiten",children:s.jsx(j,{size:16})}),s.jsx("button",{onClick:()=>(async e=>{var s,t;if(confirm("Mitgliedschaftstyp wirklich lÃ¶schen?"))try{await us.delete(`/verbandsmitgliedschaften/mitgliedschaftstypen/${e}`),alert("GelÃ¶scht!"),bs()}catch(n){alert((null==(t=null==(s=n.response)?void 0:s.data)?void 0:t.error)||"Fehler beim LÃ¶schen")}})(e.id),style:{...de.iconButton,color:"#ef4444"},title:"LÃ¶schen",children:s.jsx(b,{size:16})})]})]},e.id)}),0===je.length&&s.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#888"},children:"Keine Mitgliedschaftstypen vorhanden. Erstellen Sie einen neuen Typ."})]})]}),"typen"!==oe&&le?s.jsxs("div",{style:de.loading,children:[s.jsx(a,{size:24,className:"spin"}),s.jsx("span",{children:"Lade Einstellungen..."})]}):"typen"!==oe&&s.jsxs(s.Fragment,{children:[s.jsx("div",{style:de.einstellungenGrid,children:ie.filter(e=>e.kategorie===oe).map(e=>s.jsxs("div",{style:de.einstellungItem,children:[s.jsxs("label",{style:de.einstellungLabel,children:[e.label,e.beschreibung&&s.jsx("span",{style:de.einstellungHint,children:e.beschreibung})]}),"boolean"===e.einstellung_typ?s.jsxs("label",{style:de.toggleLabel,children:[s.jsx("input",{type:"checkbox",checked:!0===js(e.einstellung_key),onChange:s=>ms(e.einstellung_key,s.target.checked),style:de.toggleInput}),s.jsx("span",{style:{...de.toggleSwitch,background:js(e.einstellung_key)?"#10b981":"#ef4444"},children:s.jsx("span",{style:{position:"absolute",top:"2px",left:"2px",width:"20px",height:"20px",background:"#fff",borderRadius:"50%",transition:"transform 0.2s",transform:js(e.einstellung_key)?"translateX(24px)":"translateX(0)"}})}),s.jsx("span",{style:{...de.toggleText,color:js(e.einstellung_key)?"#10b981":"#ef4444",fontWeight:"600"},children:js(e.einstellung_key)?"Aktiv":"Inaktiv"})]}):"number"===e.einstellung_typ?s.jsx("input",{type:"number",value:js(e.einstellung_key),onChange:s=>ms(e.einstellung_key,parseFloat(s.target.value)||0),style:de.einstellungInput,step:e.einstellung_key.includes("preis")||e.einstellung_key.includes("mwst")?"0.01":"1"}):"json"===e.einstellung_typ?s.jsx("textarea",{value:"object"==typeof js(e.einstellung_key)?JSON.stringify(js(e.einstellung_key),null,2):js(e.einstellung_key),onChange:s=>{try{ms(e.einstellung_key,JSON.parse(s.target.value))}catch{}},style:{...de.einstellungInput,minHeight:"80px",fontFamily:"monospace"}}):s.jsx("input",{type:"text",value:js(e.einstellung_key),onChange:s=>ms(e.einstellung_key,s.target.value),style:de.einstellungInput}),he.hasOwnProperty(e.einstellung_key)&&s.jsx("span",{style:de.changedBadge,children:"GeÃ¤ndert"})]},e.einstellung_key))}),Object.keys(he).length>0&&s.jsxs("div",{style:de.einstellungenFooter,children:[s.jsxs("span",{style:de.changesCount,children:[Object.keys(he).length," Ã„nderung(en)"]}),s.jsx("button",{style:de.cancelButton,onClick:()=>{ue({}),xs()},children:"Verwerfen"}),s.jsx("button",{style:de.submitButton,onClick:async()=>{xe(!0);try{const e=Object.entries(he).map(([e,s])=>({key:e,value:s}));if(0===e.length)return void alert("Keine Ã„nderungen vorhanden");await us.put("/verbandsmitgliedschaften/einstellungen",{einstellungen:e}),alert("Einstellungen gespeichert!"),ue({}),xs(),gs()}catch(e){alert("Fehler beim Speichern")}finally{xe(!1)}},disabled:pe,children:pe?s.jsxs(s.Fragment,{children:[s.jsx(a,{size:16,className:"spin"})," Speichern..."]}):s.jsxs(s.Fragment,{children:[s.jsx(k,{size:16})," Speichern"]})})]})]})]}),"vorteile"!==W&&"einstellungen"!==W&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{style:de.filterBar,children:[s.jsxs("div",{style:de.searchBox,children:[s.jsx(z,{size:18,color:"#888"}),s.jsx("input",{type:"text",placeholder:"Suchen...",value:ee,onChange:e=>se(e.target.value),style:de.searchInput})]}),s.jsxs("select",{value:te,onChange:e=>ne(e.target.value),style:de.select,children:[s.jsx("option",{value:"",children:"Alle Status"}),s.jsx("option",{value:"aktiv",children:"Aktiv"}),s.jsx("option",{value:"ausstehend",children:"Ausstehend"}),s.jsx("option",{value:"abgelaufen",children:"Abgelaufen"}),s.jsx("option",{value:"gekuendigt",children:"GekÃ¼ndigt"})]}),s.jsx("button",{style:de.iconButton,onClick:ps,children:s.jsx(a,{size:18})})]}),s.jsx("div",{style:de.list,children:0===Ts.length?s.jsxs("div",{style:de.emptyState,children:[s.jsx(d,{size:48,color:"#666"}),s.jsx("p",{children:"Keine Mitgliedschaften gefunden"})]}):Ts.map(e=>s.jsxs("div",{style:de.listItem,onClick:()=>Is(e),children:[s.jsx("div",{style:de.listItemIcon,children:"dojo"===e.typ?s.jsx(d,{size:24,color:"#3b82f6"}):s.jsx(o,{size:24,color:"#10b981"})}),s.jsxs("div",{style:de.listItemContent,children:[s.jsxs("div",{style:de.listItemHeader,children:[s.jsx("span",{style:de.listItemName,children:"dojo"===e.typ?e.dojo_name:`${e.person_vorname} ${e.person_nachname}`}),Ds(e.status)]}),s.jsxs("div",{style:de.listItemMeta,children:[s.jsxs("span",{children:[s.jsx(y,{size:12})," ",e.mitgliedsnummer]}),s.jsxs("span",{children:[s.jsx(v,{size:12})," Bis: ",Fs(e.gueltig_bis)]}),s.jsxs("span",{children:[s.jsx(c,{size:12})," ",As(e.jahresbeitrag),"/Jahr"]})]})]}),s.jsx(N,{size:20,color:"#888"})]},e.id))})]}),Fe&&s.jsx("div",{style:de.modalOverlay,onClick:()=>Ae(!1),children:s.jsxs("div",{style:de.modal,onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{style:de.modalHeader,children:[s.jsx("h2",{style:de.modalTitle,children:"Neue Mitgliedschaft"}),s.jsx("button",{style:de.closeButton,onClick:()=>Ae(!1),children:s.jsx(g,{size:20})})]}),s.jsxs("form",{onSubmit:async e=>{var s,t,n;if(e.preventDefault(),"dojo"===cs.typ){if(!cs.neues_dojo&&!cs.dojo_id)return void alert("Bitte wÃ¤hle ein Dojo aus oder lege ein neues an.");if(cs.neues_dojo&&(!cs.neues_dojo_name||!cs.neues_dojo_email))return void alert("Bitte Dojo-Name und E-Mail ausfÃ¼llen.")}if("einzelperson"!==cs.typ||cs.person_vorname&&cs.person_nachname&&cs.person_email)try{let e={...cs};if("dojo"===cs.typ&&cs.neues_dojo){const t=await us.post("/admin/dojos",{dojoname:cs.neues_dojo_name,inhaber:cs.neues_dojo_inhaber,email:cs.neues_dojo_email,strasse:cs.neues_dojo_strasse,plz:cs.neues_dojo_plz,ort:cs.neues_dojo_ort,land:cs.neues_dojo_land});e.dojo_id=t.data.dojo_id||t.data.id||(null==(s=t.data.dojo)?void 0:s.id),e.neues_dojo=!1}await us.post("/verbandsmitgliedschaften",e),Ae(!1),ks(),ps()}catch(i){alert((null==(n=null==(t=i.response)?void 0:t.data)?void 0:n.error)||"Fehler beim Anlegen")}else alert("Bitte Vorname, Nachname und E-Mail ausfÃ¼llen.")},children:[s.jsxs("div",{style:de.typSelector,children:[s.jsxs("button",{type:"button",style:{...de.typButton,..."dojo"===cs.typ?de.typButtonActive:{}},onClick:()=>hs({...cs,typ:"dojo"}),children:[s.jsx(d,{size:24}),s.jsx("span",{children:"Dojo"}),s.jsxs("span",{style:de.typPrice,children:[As(ge.preis_dojo_mitgliedschaft||99),"/Jahr"]})]}),s.jsxs("button",{type:"button",style:{...de.typButton,..."einzelperson"===cs.typ?de.typButtonActiveGreen:{}},onClick:()=>hs({...cs,typ:"einzelperson"}),children:[s.jsx(o,{size:24}),s.jsx("span",{children:"Einzelperson"}),s.jsxs("span",{style:de.typPrice,children:[As(ge.preis_einzel_mitgliedschaft||49),"/Jahr"]})]})]}),"dojo"===cs.typ&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:cs.neues_dojo?"Modus: Neues Dojo anlegen":"Dojo *"}),cs.neues_dojo?s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[s.jsx("span",{style:{padding:"10px 15px",background:"rgba(255, 215, 0, 0.2)",borderRadius:"8px",color:"#ffd700",fontWeight:"600",flex:1},children:"â• Neues Dojo wird angelegt"}),s.jsx("button",{type:"button",onClick:()=>hs({...cs,neues_dojo:!1,dojo_id:""}),style:{padding:"10px 15px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",color:"#fff",cursor:"pointer"},children:"Abbrechen"})]}):s.jsxs("select",{value:cs.dojo_id,onChange:e=>{"neu"===e.target.value?hs({...cs,neues_dojo:!0,dojo_id:""}):hs({...cs,neues_dojo:!1,dojo_id:e.target.value})},style:de.input,children:[s.jsx("option",{value:"",children:"-- Dojo wÃ¤hlen --"}),Oe.map(e=>s.jsxs("option",{value:e.id,children:[e.name," ",e.ort?`(${e.ort})`:""]},e.id)),s.jsx("option",{value:"neu",style:{fontWeight:"bold",borderTop:"1px solid #ccc"},children:"â• Neues Dojo anlegen..."})]})]}),P&&s.jsx("div",{style:{...de.formGroup,marginTop:"0.5rem"},children:s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"10px",cursor:"pointer",padding:"10px 15px",background:cs.beitragsfrei?"rgba(34, 197, 94, 0.15)":"rgba(255, 255, 255, 0.05)",borderRadius:"8px",border:cs.beitragsfrei?"1px solid rgba(34, 197, 94, 0.3)":"1px solid rgba(255, 255, 255, 0.1)"},children:[s.jsx("input",{type:"checkbox",checked:cs.beitragsfrei,onChange:e=>hs({...cs,beitragsfrei:e.target.checked}),style:{width:"18px",height:"18px",cursor:"pointer"}}),s.jsx("span",{style:{color:cs.beitragsfrei?"#22c55e":"rgba(255, 255, 255, 0.8)"},children:"ğŸ Beitragsfrei stellen (keine GebÃ¼hren)"})]})}),cs.neues_dojo&&s.jsxs("div",{style:{...de.card,background:"rgba(255, 215, 0, 0.1)",marginBottom:"1rem"},children:[s.jsx("h4",{style:{margin:"0 0 1rem 0",color:"#ffd700"},children:"Neues Dojo anlegen"}),s.jsxs("div",{style:de.formRow,children:[s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"Dojo-Name *"}),s.jsx("input",{type:"text",value:cs.neues_dojo_name,onChange:e=>hs({...cs,neues_dojo_name:e.target.value}),style:de.input,placeholder:"z.B. Kampfsportschule Muster"})]}),s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"Inhaber *"}),s.jsx("input",{type:"text",value:cs.neues_dojo_inhaber,onChange:e=>hs({...cs,neues_dojo_inhaber:e.target.value}),style:de.input,placeholder:"Vor- und Nachname"})]})]}),s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"E-Mail *"}),s.jsx("input",{type:"email",value:cs.neues_dojo_email,onChange:e=>hs({...cs,neues_dojo_email:e.target.value}),style:de.input,placeholder:"info@dojo.de"})]}),s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"StraÃŸe"}),s.jsx("input",{type:"text",value:cs.neues_dojo_strasse,onChange:e=>hs({...cs,neues_dojo_strasse:e.target.value}),style:de.input,placeholder:"MusterstraÃŸe 123"})]}),s.jsxs("div",{style:de.formRow,children:[s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"PLZ"}),s.jsx("input",{type:"text",value:cs.neues_dojo_plz,onChange:e=>hs({...cs,neues_dojo_plz:e.target.value}),style:de.input,placeholder:"12345"})]}),s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"Ort"}),s.jsx("input",{type:"text",value:cs.neues_dojo_ort,onChange:e=>hs({...cs,neues_dojo_ort:e.target.value}),style:de.input,placeholder:"Musterstadt"})]}),s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"Land"}),s.jsx("input",{type:"text",value:cs.neues_dojo_land,onChange:e=>hs({...cs,neues_dojo_land:e.target.value}),style:de.input})]})]})]})]}),"einzelperson"===cs.typ&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{style:de.formRow,children:[s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"Vorname *"}),s.jsx("input",{type:"text",value:cs.person_vorname,onChange:e=>hs({...cs,person_vorname:e.target.value}),style:de.input})]}),s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"Nachname *"}),s.jsx("input",{type:"text",value:cs.person_nachname,onChange:e=>hs({...cs,person_nachname:e.target.value}),style:de.input})]})]}),s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"E-Mail *"}),s.jsx("input",{type:"email",value:cs.person_email,onChange:e=>hs({...cs,person_email:e.target.value}),style:de.input})]}),s.jsxs("div",{style:de.formRow,children:[s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"Telefon"}),s.jsx("input",{type:"tel",value:cs.person_telefon,onChange:e=>hs({...cs,person_telefon:e.target.value}),style:de.input})]}),s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"Geburtsdatum"}),s.jsx("input",{type:"date",value:cs.person_geburtsdatum,onChange:e=>hs({...cs,person_geburtsdatum:e.target.value}),style:de.input})]})]}),s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"StraÃŸe"}),s.jsx("input",{type:"text",value:cs.person_strasse,onChange:e=>hs({...cs,person_strasse:e.target.value}),style:de.input})]}),s.jsxs("div",{style:de.formRow,children:[s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"PLZ"}),s.jsx("input",{type:"text",value:cs.person_plz,onChange:e=>hs({...cs,person_plz:e.target.value}),style:de.input})]}),s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"Ort"}),s.jsx("input",{type:"text",value:cs.person_ort,onChange:e=>hs({...cs,person_ort:e.target.value}),style:de.input})]})]})]}),s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"Zahlungsart"}),s.jsxs("select",{value:cs.zahlungsart,onChange:e=>hs({...cs,zahlungsart:e.target.value}),style:de.input,children:[s.jsx("option",{value:"rechnung",children:"Rechnung"}),s.jsx("option",{value:"lastschrift",children:"SEPA-Lastschrift"}),s.jsx("option",{value:"paypal",children:"PayPal"}),s.jsx("option",{value:"ueberweisung",children:"Ãœberweisung"})]})]}),s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"Notizen"}),s.jsx("textarea",{value:cs.notizen,onChange:e=>hs({...cs,notizen:e.target.value}),style:{...de.input,minHeight:"80px"}})]}),s.jsxs("div",{style:de.modalFooter,children:[s.jsx("button",{type:"button",style:de.cancelButton,onClick:()=>Ae(!1),children:"Abbrechen"}),s.jsxs("button",{type:"submit",style:de.submitButton,children:[s.jsx(m,{size:18}),"Mitgliedschaft anlegen"]})]})]})]})}),Me&&$e&&s.jsx("div",{style:de.modalOverlay,onClick:()=>Re(!1),children:s.jsxs("div",{style:{...de.modal,maxWidth:"800px"},onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{style:de.modalHeader,children:[s.jsx("h2",{style:de.modalTitle,children:"dojo"===$e.typ?s.jsxs(s.Fragment,{children:[s.jsx(d,{size:24,color:"#3b82f6"})," ",$e.dojo_name]}):s.jsxs(s.Fragment,{children:[s.jsx(o,{size:24,color:"#10b981"})," ",$e.person_vorname," ",$e.person_nachname]})}),s.jsx("button",{style:de.closeButton,onClick:()=>Re(!1),children:s.jsx(g,{size:20})})]}),s.jsxs("div",{style:de.detailTabs,children:[s.jsxs("button",{style:{...de.detailTab,..."info"===Ue?de.detailTabActive:{}},onClick:()=>Je("info"),children:[s.jsx(o,{size:16})," Info"]}),s.jsxs("button",{style:{...de.detailTab,..."vertrag"===Ue?de.detailTabActive:{}},onClick:()=>Je("vertrag"),children:[s.jsx(y,{size:16})," Vertrag"]}),s.jsxs("button",{style:{...de.detailTab,..."sepa"===Ue?de.detailTabActive:{}},onClick:()=>Je("sepa"),children:[s.jsx(_,{size:16})," SEPA"]}),s.jsxs("button",{style:{...de.detailTab,..."historie"===Ue?de.detailTabActive:{}},onClick:()=>Je("historie"),children:[s.jsx(C,{size:16})," Historie"]})]}),s.jsxs("div",{style:de.detailContent,children:["info"===Ue&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{style:de.detailRow,children:[s.jsxs("div",{style:de.detailItem,children:[s.jsx("span",{style:de.detailLabel,children:"Mitgliedsnummer"}),s.jsx("span",{style:de.detailValue,children:$e.mitgliedsnummer})]}),s.jsxs("div",{style:de.detailItem,children:[s.jsx("span",{style:de.detailLabel,children:"Status"}),s.jsxs("select",{value:$e.status,onChange:e=>(async(e,s)=>{var t,n;try{if(await us.put(`/verbandsmitgliedschaften/${e}/status`,{status:s}),ps(),$e){const e=await us.get(`/verbandsmitgliedschaften/${$e.id}`);Ke(e.data)}}catch(i){alert((null==(n=null==(t=i.response)?void 0:t.data)?void 0:n.error)||"Fehler beim Status Ã¤ndern")}})($e.id,e.target.value),style:{padding:"6px 12px",borderRadius:"6px",border:"1px solid rgba(255,255,255,0.2)",background:"aktiv"===$e.status?"rgba(16, 185, 129, 0.2)":"ausstehend"===$e.status?"rgba(245, 158, 11, 0.2)":"vertragsfrei"===$e.status?"rgba(107, 114, 128, 0.2)":"rgba(239, 68, 68, 0.2)",color:"aktiv"===$e.status?"#10b981":"ausstehend"===$e.status?"#f59e0b":"vertragsfrei"===$e.status?"#6b7280":"#ef4444",fontWeight:"600",cursor:"pointer"},children:[s.jsx("option",{value:"ausstehend",children:"Ausstehend"}),s.jsx("option",{value:"aktiv",children:"Aktiv"}),s.jsx("option",{value:"gekuendigt",children:"GekÃ¼ndigt"}),s.jsx("option",{value:"abgelaufen",children:"Abgelaufen"}),s.jsx("option",{value:"vertragsfrei",children:"Vertragsfrei"})]})]}),s.jsxs("div",{style:de.detailItem,children:[s.jsx("span",{style:de.detailLabel,children:"Vertrag"}),$e.unterschrift_digital?s.jsxs("span",{style:{color:"#10b981",display:"flex",alignItems:"center",gap:"4px"},children:[s.jsx(m,{size:14})," Unterschrieben"]}):s.jsxs("span",{style:{color:"#f59e0b",display:"flex",alignItems:"center",gap:"4px"},children:[s.jsx(h,{size:14})," Ausstehend"]})]})]}),s.jsxs("div",{style:de.detailRow,children:[s.jsxs("div",{style:de.detailItem,children:[s.jsx("span",{style:de.detailLabel,children:"GÃ¼ltig von"}),s.jsx("span",{style:de.detailValue,children:Fs($e.gueltig_von)})]}),s.jsxs("div",{style:de.detailItem,children:[s.jsx("span",{style:de.detailLabel,children:"GÃ¼ltig bis"}),s.jsx("span",{style:de.detailValue,children:Fs($e.gueltig_bis)})]}),s.jsxs("div",{style:de.detailItem,children:[s.jsx("span",{style:de.detailLabel,children:"Jahresbeitrag"}),s.jsx("span",{style:de.detailValue,children:As($e.jahresbeitrag)})]})]}),P&&s.jsxs("div",{style:{padding:"12px 16px",background:$e.beitragsfrei?"rgba(34, 197, 94, 0.15)":"rgba(255, 255, 255, 0.05)",borderRadius:"8px",border:$e.beitragsfrei?"1px solid rgba(34, 197, 94, 0.3)":"1px solid rgba(255, 255, 255, 0.1)",marginBottom:"1rem"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[s.jsx(u,{size:18,color:$e.beitragsfrei?"#22c55e":"#6b7280"}),s.jsx("span",{style:{color:$e.beitragsfrei?"#22c55e":"rgba(255, 255, 255, 0.8)"},children:$e.beitragsfrei?"Beitragsfrei":"RegulÃ¤rer Beitrag"})]}),s.jsx("button",{type:"button",onClick:async()=>{var e,s;const t=!$e.beitragsfrei;if(confirm(t?"Mitgliedschaft auf beitragsfrei setzen? Offene Zahlungen werden storniert.":"Beitragsfrei aufheben? Der normale Jahresbeitrag wird wieder berechnet."))try{const e=await us.post(`/verbandsmitgliedschaften/${$e.id}/beitragsfrei`,{beitragsfrei:t});alert(e.data.message),ps();const s=await us.get(`/verbandsmitgliedschaften/${$e.id}`);Ke(s.data)}catch(n){alert((null==(s=null==(e=n.response)?void 0:e.data)?void 0:s.error)||"Fehler beim Umstellen")}},style:{padding:"6px 12px",background:$e.beitragsfrei?"rgba(239, 68, 68, 0.2)":"rgba(34, 197, 94, 0.2)",border:$e.beitragsfrei?"1px solid rgba(239, 68, 68, 0.3)":"1px solid rgba(34, 197, 94, 0.3)",borderRadius:"6px",color:$e.beitragsfrei?"#ef4444":"#22c55e",cursor:"pointer",fontSize:"0.85rem",fontWeight:"500"},children:$e.beitragsfrei?"Beitragsfrei aufheben":"Beitragsfrei stellen"})]}),$e.beitragsfrei&&s.jsx("p",{style:{margin:"8px 0 0 0",fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.6)"},children:"Diese Mitgliedschaft ist von BeitrÃ¤gen befreit. Bei VerlÃ¤ngerung werden keine Zahlungen erstellt."})]}),"einzelperson"===$e.typ&&s.jsxs("div",{style:de.detailSection,children:[s.jsx("h4",{style:de.detailSectionTitle,children:"Kontaktdaten"}),s.jsxs("div",{style:de.detailRow,children:[s.jsxs("div",{style:de.detailItem,children:[s.jsx(S,{size:14}),s.jsx("span",{children:$e.person_email||"-"})]}),s.jsxs("div",{style:de.detailItem,children:[s.jsx(w,{size:14}),s.jsx("span",{children:$e.person_telefon||"-"})]})]}),$e.person_strasse&&s.jsxs("div",{style:de.detailItem,children:[s.jsx(B,{size:14}),s.jsxs("span",{children:[$e.person_strasse,", ",$e.person_plz," ",$e.person_ort]})]})]}),"vertragsfrei"!==$e.status&&s.jsxs("div",{style:de.detailSection,children:[s.jsx("h4",{style:de.detailSectionTitle,children:"Zahlungen"}),0===(null==(M=$e.zahlungen)?void 0:M.length)?s.jsx("p",{style:de.hint,children:"Keine Zahlungen vorhanden"}):s.jsx("div",{style:de.zahlungenList,children:null==(R=$e.zahlungen)?void 0:R.map(e=>s.jsxs("div",{style:de.zahlungItem,children:[s.jsxs("div",{style:de.zahlungMain,children:[s.jsx("span",{style:de.zahlungNummer,children:e.rechnungsnummer}),s.jsx("span",{style:de.zahlungBetrag,children:As(e.betrag_brutto)}),s.jsx("span",{style:{...de.zahlungStatus,color:"bezahlt"===e.status?"#10b981":"offen"===e.status?"#f59e0b":"#ef4444"},children:"bezahlt"===e.status?"Bezahlt":"offen"===e.status?"Offen":e.status})]}),s.jsxs("div",{style:de.zahlungMeta,children:[s.jsxs("span",{children:["FÃ¤llig: ",Fs(e.faellig_am)]}),e.bezahlt_am&&s.jsxs("span",{children:["Bezahlt: ",Fs(e.bezahlt_am)]})]}),s.jsxs("div",{style:{display:"flex",gap:"8px",marginTop:"8px"},children:["offen"===e.status&&s.jsxs("button",{style:de.smallButton,onClick:()=>(async e=>{try{if(await us.post(`/verbandsmitgliedschaften/zahlungen/${e}/bezahlt`),ps(),$e){const e=await us.get(`/verbandsmitgliedschaften/${$e.id}`);Ke(e.data)}}catch(s){alert("Fehler beim Markieren als bezahlt")}})(e.id),children:[s.jsx(m,{size:14})," Als bezahlt markieren"]}),("offen"===e.status||"bezahlt"===e.status)&&s.jsxs("button",{style:{...de.smallButton,backgroundColor:"#ef4444",color:"#fff"},onClick:()=>(async e=>{if(window.confirm("MÃ¶chten Sie diese Zahlung wirklich stornieren?"))try{if(await us.post(`/verbandsmitgliedschaften/zahlungen/${e}/stornieren`,{grund:"Manuelle Stornierung"}),ps(),$e){const e=await us.get(`/verbandsmitgliedschaften/${$e.id}`);Ke(e.data)}}catch(s){alert("Fehler beim Stornieren der Zahlung")}})(e.id),children:[s.jsx(g,{size:14})," Stornieren"]}),s.jsxs("button",{style:{...de.smallButton,backgroundColor:"#3b82f6",color:"#fff"},onClick:()=>(async(e,s)=>{try{const t=(await n.get(`/verbandsmitgliedschaften/zahlungen/${e}/pdf`,{responseType:"blob"})).data,i=window.URL.createObjectURL(t),a=document.createElement("a");a.href=i,a.download=`Rechnung_${s||e}.pdf`,document.body.appendChild(a),a.click(),a.remove(),window.URL.revokeObjectURL(i)}catch(t){console.error("PDF Download Fehler:",t),alert("Fehler beim Download der Rechnung")}})(e.id,e.rechnungsnummer),children:[s.jsx(I,{size:14})," Rechnung PDF"]})]})]},e.id))})]}),$e.notizen&&s.jsxs("div",{style:de.detailSection,children:[s.jsx("h4",{style:de.detailSectionTitle,children:"Notizen"}),s.jsx("p",{style:de.notizen,children:$e.notizen})]})]}),"vertrag"===Ue&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{style:de.vertragActions,children:[s.jsxs("button",{style:de.actionButton,onClick:()=>(async e=>{try{window.open(`/api/verbandsmitgliedschaften/${e}/pdf`,"_blank")}catch(s){alert("Fehler beim Download")}})($e.id),children:[s.jsx(I,{size:18}),"Vertrag als PDF"]}),!$e.unterschrift_digital&&s.jsxs("button",{style:{...de.actionButton,...de.actionButtonPrimary},onClick:()=>We(!0),children:[s.jsx(T,{size:18}),"Jetzt unterschreiben"]})]}),s.jsxs("div",{style:de.vertragInfo,children:[s.jsx("h4",{style:de.detailSectionTitle,children:"Vertragsstatus"}),s.jsxs("div",{style:de.vertragStatusGrid,children:[s.jsxs("div",{style:de.vertragStatusItem,children:[s.jsx(D,{size:20,color:$e.agb_akzeptiert?"#10b981":"#666"}),s.jsx("span",{children:"AGB akzeptiert"}),$e.agb_akzeptiert?s.jsx(m,{size:16,color:"#10b981"}):s.jsx(g,{size:16,color:"#666"})]}),s.jsxs("div",{style:de.vertragStatusItem,children:[s.jsx(F,{size:20,color:$e.dsgvo_akzeptiert?"#10b981":"#666"}),s.jsx("span",{children:"DSGVO akzeptiert"}),$e.dsgvo_akzeptiert?s.jsx(m,{size:16,color:"#10b981"}):s.jsx(g,{size:16,color:"#666"})]}),s.jsxs("div",{style:de.vertragStatusItem,children:[s.jsx(y,{size:20,color:$e.widerrufsrecht_akzeptiert?"#10b981":"#666"}),s.jsx("span",{children:"Widerrufsbelehrung"}),$e.widerrufsrecht_akzeptiert?s.jsx(m,{size:16,color:"#10b981"}):s.jsx(g,{size:16,color:"#666"})]}),s.jsxs("div",{style:de.vertragStatusItem,children:[s.jsx(T,{size:20,color:$e.unterschrift_digital?"#10b981":"#666"}),s.jsx("span",{children:"Unterschrieben"}),$e.unterschrift_digital?s.jsx(m,{size:16,color:"#10b981"}):s.jsx(g,{size:16,color:"#666"})]})]}),$e.unterschrift_datum&&s.jsxs("p",{style:de.hint,children:["Unterschrieben am: ",Fs($e.unterschrift_datum)]})]}),s.jsxs("div",{style:de.detailSection,children:[s.jsx("h4",{style:de.detailSectionTitle,children:"Rechtliche Dokumente"}),s.jsxs("div",{style:de.dokumenteListe,children:[s.jsxs("button",{style:de.dokumentButton,onClick:()=>Ns("agb"),children:[s.jsx(D,{size:16})," AGB ansehen"]}),s.jsxs("button",{style:de.dokumentButton,onClick:()=>Ns("dsgvo"),children:[s.jsx(F,{size:16})," DSGVO ansehen"]}),s.jsxs("button",{style:de.dokumentButton,onClick:()=>Ns("widerrufsbelehrung"),children:[s.jsx(y,{size:16})," Widerrufsbelehrung"]}),s.jsxs("button",{style:de.dokumentButton,onClick:()=>Ns("beitragsordnung"),children:[s.jsx(c,{size:16})," Beitragsordnung"]})]})]})]}),"sepa"===Ue&&s.jsxs(s.Fragment,{children:[s.jsx("div",{style:de.vertragActions,children:s.jsxs("button",{style:{...de.actionButton,...de.actionButtonPrimary},onClick:()=>Ee(!0),children:[s.jsx(r,{size:18}),"Neues SEPA-Mandat"]})}),0===Xe.length?s.jsxs("div",{style:de.emptyState,children:[s.jsx(_,{size:48,color:"#666"}),s.jsx("p",{children:"Kein SEPA-Mandat vorhanden"}),s.jsx("p",{style:de.hint,children:"Mit einem SEPA-Mandat kÃ¶nnen BeitrÃ¤ge automatisch eingezogen werden."})]}):s.jsx("div",{style:de.sepaListe,children:Xe.map(e=>s.jsxs("div",{style:de.sepaItem,children:[s.jsxs("div",{style:de.sepaHeader,children:[s.jsx("span",{style:de.sepaMandatsref,children:e.mandatsreferenz}),s.jsx("span",{style:{...de.sepaStatus,background:"aktiv"===e.status?"rgba(16, 185, 129, 0.2)":"rgba(239, 68, 68, 0.2)",color:"aktiv"===e.status?"#10b981":"#ef4444"},children:"aktiv"===e.status?"Aktiv":"Inaktiv"})]}),s.jsxs("div",{style:de.sepaDetails,children:[s.jsxs("div",{children:[s.jsx("strong",{children:"IBAN:"})," ",e.iban]}),e.bic&&s.jsxs("div",{children:[s.jsx("strong",{children:"BIC:"})," ",e.bic]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Kontoinhaber:"})," ",e.kontoinhaber]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Erstellt:"})," ",Fs(e.erstellt_am)]})]}),e.unterschrift_digital&&s.jsxs("div",{style:de.sepaSignedBadge,children:[s.jsx(m,{size:14})," Digital unterschrieben"]})]},e.id))})]}),"historie"===Ue&&s.jsx(s.Fragment,{children:s.jsxs("div",{style:de.detailSection,children:[s.jsx("h4",{style:de.detailSectionTitle,children:"Vertragshistorie"}),s.jsx("div",{style:de.historieListe,children:(null==(L=$e.historie)?void 0:L.length)>0?$e.historie.map((e,t)=>s.jsxs("div",{style:de.historieItem,children:[s.jsx("div",{style:de.historieDatum,children:new Date(e.created_at).toLocaleString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}),s.jsx("div",{style:de.historieText,children:e.beschreibung})]},e.id||t)):s.jsx("p",{style:de.hint,children:"Noch keine Historie-EintrÃ¤ge vorhanden."})})]})})]}),s.jsxs("div",{style:de.modalFooter,children:[P&&"vertragsfrei"!==$e.status&&s.jsxs("button",{style:{...de.dangerButton,backgroundColor:"#7f1d1d"},onClick:()=>(async e=>{var s,t;if(confirm('Mitgliedschaft auf "vertragsfrei" setzen?'))try{await us.delete(`/verbandsmitgliedschaften/${e}/vertragsfrei`),ps();const s=await us.get(`/verbandsmitgliedschaften/${e}`);Ke(s.data)}catch(n){alert((null==(t=null==(s=n.response)?void 0:s.data)?void 0:t.error)||"Fehler beim LÃ¶schen")}})($e.id),children:[s.jsx(b,{size:16})," Vertragsfrei"]}),"gekuendigt"!==$e.status&&"vertragsfrei"!==$e.status&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{style:de.dangerButton,onClick:()=>(async e=>{var s,t;if(confirm("Mitgliedschaft wirklich kÃ¼ndigen?"))try{await us.delete(`/verbandsmitgliedschaften/${e}`),ps(),Re(!1)}catch(n){alert((null==(t=null==(s=n.response)?void 0:s.data)?void 0:t.error)||"Fehler beim KÃ¼ndigen")}})($e.id),children:[s.jsx(b,{size:16})," KÃ¼ndigen"]}),s.jsxs("button",{style:de.submitButton,onClick:()=>(async e=>{var s,t;if(confirm("Mitgliedschaft um ein Jahr verlÃ¤ngern?"))try{await us.post(`/verbandsmitgliedschaften/${e}/verlaengern`),ps(),Re(!1)}catch(n){alert((null==(t=null==(s=n.response)?void 0:s.data)?void 0:t.error)||"Fehler bei VerlÃ¤ngerung")}})($e.id),children:[s.jsx(a,{size:16})," VerlÃ¤ngern"]})]})]})]})}),ze&&s.jsx("div",{style:de.modalOverlay,onClick:()=>Ne(!1),children:s.jsxs("div",{style:{...de.modal,maxWidth:"600px"},onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{style:de.modalHeader,children:[s.jsxs("h2",{style:de.modalTitle,children:[s.jsx(p,{size:24,color:"#ffd700"}),ye?"Mitgliedschaftstyp bearbeiten":"Neuer Mitgliedschaftstyp"]}),s.jsx("button",{style:de.closeButton,onClick:()=>Ne(!1),children:s.jsx(g,{size:20})})]}),s.jsxs("div",{style:{padding:"1.5rem",maxHeight:"70vh",overflowY:"auto"},children:[s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"Code (technisch) *"}),s.jsx("input",{type:"text",value:_e.code,onChange:e=>Ce({..._e,code:e.target.value.toLowerCase().replace(/[^a-z0-9_]/g,"")}),style:de.input,placeholder:"z.B. premium_dojo",disabled:!!ye})]}),s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"Name *"}),s.jsx("input",{type:"text",value:_e.name,onChange:e=>Ce({..._e,name:e.target.value}),style:de.input,placeholder:"z.B. Premium Dojo-Mitgliedschaft"})]})]}),s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"Beschreibung"}),s.jsx("textarea",{value:_e.beschreibung,onChange:e=>Ce({..._e,beschreibung:e.target.value}),style:{...de.input,minHeight:"80px"},placeholder:"Beschreibung fÃ¼r Kunden..."})]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"16px"},children:[s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"Kategorie"}),s.jsxs("select",{value:_e.kategorie,onChange:e=>Ce({..._e,kategorie:e.target.value}),style:de.input,children:[s.jsx("option",{value:"dojo",children:"Dojo"}),s.jsx("option",{value:"person",children:"Person"}),s.jsx("option",{value:"sonstige",children:"Sonstige"})]})]}),s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"Preis (Netto) â‚¬"}),s.jsx("input",{type:"number",value:_e.preis_netto,onChange:e=>Ce({..._e,preis_netto:parseFloat(e.target.value)||0}),style:de.input,step:"0.01",min:"0"})]}),s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"Steuersatz %"}),s.jsx("input",{type:"number",value:_e.steuersatz,onChange:e=>Ce({..._e,steuersatz:parseFloat(e.target.value)||0}),style:de.input,step:"0.01",min:"0",max:"100"})]})]}),s.jsxs("div",{style:{background:"rgba(255,215,0,0.1)",border:"1px solid rgba(255,215,0,0.3)",borderRadius:"8px",padding:"12px",marginBottom:"16px",textAlign:"center"},children:[s.jsx("span",{style:{color:"#888"},children:"Bruttopreis: "}),s.jsxs("strong",{style:{color:"#ffd700",fontSize:"18px"},children:[(_e.preis_netto*(1+_e.steuersatz/100)).toFixed(2),"â‚¬"]}),s.jsxs("span",{style:{color:"#888",marginLeft:"8px"},children:["(inkl. ",(_e.preis_netto*_e.steuersatz/100).toFixed(2),"â‚¬ MwSt)"]})]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"Laufzeit (Monate)"}),s.jsx("input",{type:"number",value:_e.laufzeit_monate,onChange:e=>Ce({..._e,laufzeit_monate:parseInt(e.target.value)||12}),style:de.input,min:"1"})]}),s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"KÃ¼ndigungsfrist (Monate)"}),s.jsx("input",{type:"number",value:_e.kuendigungsfrist_monate,onChange:e=>Ce({..._e,kuendigungsfrist_monate:parseInt(e.target.value)||0}),style:de.input,min:"0"})]})]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"16px",marginTop:"16px"},children:[s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer"},children:[s.jsx("input",{type:"checkbox",checked:_e.auto_verlaengerung,onChange:e=>Ce({..._e,auto_verlaengerung:e.target.checked})}),s.jsx("span",{style:{color:"#ccc"},children:"Auto-VerlÃ¤ngerung"})]}),s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer"},children:[s.jsx("input",{type:"checkbox",checked:_e.ist_standard,onChange:e=>Ce({..._e,ist_standard:e.target.checked})}),s.jsx("span",{style:{color:"#ccc"},children:"Standard-Typ"})]}),s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer"},children:[s.jsx("input",{type:"checkbox",checked:_e.aktiv,onChange:e=>Ce({..._e,aktiv:e.target.checked})}),s.jsx("span",{style:{color:"#ccc"},children:"Aktiv"})]})]}),s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"Sortierung"}),s.jsx("input",{type:"number",value:_e.sortierung,onChange:e=>Ce({..._e,sortierung:parseInt(e.target.value)||0}),style:{...de.input,maxWidth:"120px"},min:"0"})]})]}),s.jsxs("div",{style:{padding:"1rem 1.5rem",borderTop:"1px solid rgba(255,255,255,0.1)",display:"flex",gap:"12px",justifyContent:"flex-end"},children:[s.jsx("button",{onClick:()=>Ne(!1),style:de.cancelButton,children:"Abbrechen"}),s.jsxs("button",{onClick:async()=>{var e,s;try{ye?(await us.put(`/verbandsmitgliedschaften/mitgliedschaftstypen/${ye.id}`,_e),alert("Mitgliedschaftstyp aktualisiert!")):(await us.post("/verbandsmitgliedschaften/mitgliedschaftstypen",_e),alert("Mitgliedschaftstyp erstellt!")),Ne(!1),bs()}catch(t){alert((null==(s=null==(e=t.response)?void 0:e.data)?void 0:s.error)||"Fehler beim Speichern")}},style:de.submitButton,children:[s.jsx(k,{size:16})," ",ye?"Speichern":"Erstellen"]})]})]})}),Be&&s.jsx("div",{style:de.modalOverlay,onClick:()=>Ie(!1),children:s.jsxs("div",{style:{...de.modal,maxWidth:"550px"},onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{style:de.modalHeader,children:[s.jsxs("h2",{style:de.modalTitle,children:[s.jsx(x,{size:24,color:"#ffd700"}),Se?"Vorteil bearbeiten":"Neuer Vorteil"]}),s.jsx("button",{style:de.closeButton,onClick:()=>Ie(!1),children:s.jsx(g,{size:20})})]}),s.jsxs("div",{style:{padding:"1.5rem"},children:[s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"Titel *"}),s.jsx("input",{type:"text",value:Te.titel,onChange:e=>De({...Te,titel:e.target.value}),style:de.input,placeholder:"z.B. Seminar-Rabatt"})]}),s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"Beschreibung"}),s.jsx("textarea",{value:Te.beschreibung,onChange:e=>De({...Te,beschreibung:e.target.value}),style:{...de.input,minHeight:"80px"},placeholder:"Beschreibung des Vorteils..."})]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"Gilt fÃ¼r"}),s.jsxs("select",{value:Te.gilt_fuer,onChange:e=>De({...Te,gilt_fuer:e.target.value}),style:de.input,children:[s.jsx("option",{value:"beide",children:"Alle Mitglieder"}),s.jsx("option",{value:"dojo",children:"Nur Dojos"}),s.jsx("option",{value:"einzelperson",children:"Nur Einzelpersonen"})]})]}),s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"Kategorie"}),s.jsx("input",{type:"text",value:Te.kategorie,onChange:e=>De({...Te,kategorie:e.target.value}),style:de.input,placeholder:"z.B. seminar, turnier, shop"})]})]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"Rabatt-Typ"}),s.jsxs("select",{value:Te.rabatt_typ,onChange:e=>De({...Te,rabatt_typ:e.target.value}),style:de.input,children:[s.jsx("option",{value:"prozent",children:"Prozent (%)"}),s.jsx("option",{value:"festbetrag",children:"Festbetrag (â‚¬)"})]})]}),s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"Rabatt-Wert"}),s.jsx("input",{type:"number",value:Te.rabatt_wert,onChange:e=>De({...Te,rabatt_wert:parseFloat(e.target.value)||0}),style:de.input,step:"0.01",min:"0"})]})]}),s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",marginTop:"16px"},children:[s.jsx("input",{type:"checkbox",checked:Te.aktiv,onChange:e=>De({...Te,aktiv:e.target.checked})}),s.jsx("span",{style:{color:"#ccc"},children:"Aktiv"})]})]}),s.jsxs("div",{style:{padding:"1rem 1.5rem",borderTop:"1px solid rgba(255,255,255,0.1)",display:"flex",gap:"12px",justifyContent:"flex-end"},children:[s.jsx("button",{onClick:()=>Ie(!1),style:de.cancelButton,children:"Abbrechen"}),s.jsxs("button",{onClick:async()=>{var e,s;try{Se?(await us.put(`/verbandsmitgliedschaften/vorteile/${Se.id}`,Te),alert("Vorteil aktualisiert!")):(await us.post("/verbandsmitgliedschaften/vorteile",Te),alert("Vorteil erstellt!")),Ie(!1),fs()}catch(t){alert((null==(s=null==(e=t.response)?void 0:e.data)?void 0:s.error)||"Fehler beim Speichern")}},style:de.submitButton,children:[s.jsx(k,{size:16})," ",Se?"Speichern":"Erstellen"]})]})]})}),Le&&$e&&s.jsx("div",{style:de.modalOverlay,onClick:()=>Ee(!1),children:s.jsxs("div",{style:{...de.modal,maxWidth:"550px"},onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{style:de.modalHeader,children:[s.jsxs("h2",{style:de.modalTitle,children:[s.jsx(_,{size:24,color:"#ffd700"})," SEPA-Mandat erstellen"]}),s.jsx("button",{style:de.closeButton,onClick:()=>Ee(!1),children:s.jsx(g,{size:20})})]}),s.jsxs("div",{style:{padding:"1.5rem"},children:[s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"IBAN *"}),s.jsx("input",{type:"text",value:Ze.iban,onChange:e=>qe({...Ze,iban:e.target.value.toUpperCase()}),style:de.input,placeholder:"DE89 3704 0044 0532 0130 00"})]}),s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"BIC (optional)"}),s.jsx("input",{type:"text",value:Ze.bic,onChange:e=>qe({...Ze,bic:e.target.value.toUpperCase()}),style:de.input,placeholder:"COBADEFFXXX"})]}),s.jsxs("div",{style:de.formGroup,children:[s.jsx("label",{style:de.label,children:"Kontoinhaber *"}),s.jsx("input",{type:"text",value:Ze.kontoinhaber,onChange:e=>qe({...Ze,kontoinhaber:e.target.value}),style:de.input,placeholder:"Max Mustermann"})]}),s.jsxs("div",{style:de.signatureSection,children:[s.jsx("label",{style:de.label,children:"Digitale Unterschrift"}),s.jsx("canvas",{ref:ns,width:460,height:120,style:de.signatureCanvas,onMouseDown:Cs,onMouseMove:Ss,onMouseUp:ws,onMouseLeave:ws,onTouchStart:Cs,onTouchMove:Ss,onTouchEnd:ws}),s.jsx("button",{type:"button",style:de.clearSignatureButton,onClick:Bs,children:"Unterschrift lÃ¶schen"})]}),s.jsxs("div",{style:de.sepaHinweis,children:[s.jsx(D,{size:16,color:"#ffd700"}),s.jsx("p",{children:"Mit dem SEPA-Lastschriftmandat ermÃ¤chtigen Sie uns, den Jahresbeitrag von Ihrem Konto einzuziehen."})]})]}),s.jsxs("div",{style:de.modalFooter,children:[s.jsx("button",{style:de.cancelButton,onClick:()=>Ee(!1),children:"Abbrechen"}),s.jsxs("button",{style:de.submitButton,onClick:async()=>{var e,s;if(Ze.iban&&Ze.kontoinhaber)try{await us.post(`/verbandsmitgliedschaften/${$e.id}/sepa`,{...Ze,unterschrift_digital:ls}),Ee(!1),qe({iban:"",bic:"",kontoinhaber:""}),rs(null),zs($e.id),ps(),alert("SEPA-Mandat erfolgreich angelegt")}catch(t){alert((null==(s=null==(e=t.response)?void 0:e.data)?void 0:s.error)||"Fehler beim Anlegen")}else alert("IBAN und Kontoinhaber sind erforderlich")},children:[s.jsx(m,{size:18})," Mandat erstellen"]})]})]})}),Ge&&ss&&s.jsx("div",{style:de.modalOverlay,onClick:()=>Ve(!1),children:s.jsxs("div",{style:{...de.modal,maxWidth:"700px"},onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{style:de.modalHeader,children:[s.jsxs("h2",{style:de.modalTitle,children:[s.jsx(F,{size:24,color:"#ffd700"})," ",ss.titel]}),s.jsx("button",{style:de.closeButton,onClick:()=>Ve(!1),children:s.jsx(g,{size:20})})]}),s.jsxs("div",{style:de.dokumentContent,children:[s.jsxs("div",{style:de.dokumentMeta,children:[s.jsxs("span",{children:["Version: ",ss.version]}),s.jsxs("span",{children:["GÃ¼ltig ab: ",Fs(ss.gueltig_ab)]})]}),s.jsx("div",{style:de.dokumentText,dangerouslySetInnerHTML:i((null==(E=ss.inhalt)?void 0:E.replace(/\n/g,"<br/>"))||"")})]}),s.jsx("div",{style:de.modalFooter,children:s.jsx("button",{style:de.submitButton,onClick:()=>Ve(!1),children:"SchlieÃŸen"})})]})}),Pe&&$e&&s.jsx("div",{style:de.modalOverlay,onClick:()=>We(!1),children:s.jsxs("div",{style:{...de.modal,maxWidth:"600px"},onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{style:de.modalHeader,children:[s.jsxs("h2",{style:de.modalTitle,children:[s.jsx(T,{size:24,color:"#ffd700"})," Vertrag unterschreiben"]}),s.jsx("button",{style:de.closeButton,onClick:()=>We(!1),children:s.jsx(g,{size:20})})]}),s.jsxs("div",{style:{padding:"1.5rem"},children:[s.jsxs("p",{style:de.signatureIntro,children:["Mit Ihrer Unterschrift bestÃ¤tigen Sie den Mitgliedsvertrag fÃ¼r die TDA Verbandsmitgliedschaft zum Jahresbeitrag von ",As($e.jahresbeitrag),"."]}),s.jsxs("div",{style:de.akzeptanzSection,children:[s.jsxs("label",{style:de.checkbox,children:[s.jsx("input",{type:"checkbox",checked:ds.agb,onChange:e=>os({...ds,agb:e.target.checked})}),s.jsxs("span",{children:["Ich akzeptiere die ",s.jsx("a",{href:"#",onClick:e=>{e.preventDefault(),Ns("agb")},children:"AGB"})," *"]})]}),s.jsxs("label",{style:de.checkbox,children:[s.jsx("input",{type:"checkbox",checked:ds.dsgvo,onChange:e=>os({...ds,dsgvo:e.target.checked})}),s.jsxs("span",{children:["Ich akzeptiere die ",s.jsx("a",{href:"#",onClick:e=>{e.preventDefault(),Ns("dsgvo")},children:"DatenschutzerklÃ¤rung"})," *"]})]}),s.jsxs("label",{style:de.checkbox,children:[s.jsx("input",{type:"checkbox",checked:ds.widerruf,onChange:e=>os({...ds,widerruf:e.target.checked})}),s.jsxs("span",{children:["Ich habe die ",s.jsx("a",{href:"#",onClick:e=>{e.preventDefault(),Ns("widerrufsbelehrung")},children:"Widerrufsbelehrung"})," zur Kenntnis genommen *"]})]})]}),s.jsxs("div",{style:de.signatureSection,children:[s.jsx("label",{style:de.label,children:"Ihre Unterschrift *"}),s.jsx("canvas",{ref:ns,width:520,height:150,style:de.signatureCanvas,onMouseDown:Cs,onMouseMove:Ss,onMouseUp:ws,onMouseLeave:ws,onTouchStart:Cs,onTouchMove:Ss,onTouchEnd:ws}),s.jsx("button",{type:"button",style:de.clearSignatureButton,onClick:Bs,children:"Unterschrift lÃ¶schen"})]})]}),s.jsxs("div",{style:de.modalFooter,children:[s.jsx("button",{style:de.cancelButton,onClick:()=>We(!1),children:"Abbrechen"}),s.jsxs("button",{style:de.submitButton,onClick:async()=>{var e,s;if(ls)if(ds.agb&&ds.dsgvo&&ds.widerruf)try{await us.post(`/verbandsmitgliedschaften/${$e.id}/unterschreiben`,{unterschrift_digital:ls,agb_akzeptiert:ds.agb,dsgvo_akzeptiert:ds.dsgvo,widerrufsrecht_akzeptiert:ds.widerruf}),We(!1),rs(null),os({agb:!1,dsgvo:!1,widerruf:!1}),ps(),alert("Vertrag erfolgreich unterschrieben")}catch(t){alert((null==(s=null==(e=t.response)?void 0:e.data)?void 0:s.error)||"Fehler beim Unterschreiben")}else alert("Bitte akzeptieren Sie alle Bedingungen");else alert("Bitte unterschreiben Sie im Unterschriftsfeld")},children:[s.jsx(T,{size:18})," Verbindlich unterschreiben"]})]})]})})]})},de={container:{padding:"2rem",maxWidth:"1400px",margin:"0 auto"},loading:{display:"flex",flexDirection:"column",alignItems:"center",gap:"1rem",padding:"4rem",color:"#888"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem",flexWrap:"wrap",gap:"1rem"},title:{display:"flex",alignItems:"center",gap:"12px",color:"#fff",margin:0,fontSize:"1.8rem"},subtitle:{color:"#888",margin:"4px 0 0 40px",fontSize:"0.9rem"},primaryButton:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 20px",background:"linear-gradient(135deg, #ffd700, #ffaa00)",border:"none",borderRadius:"10px",color:"#000",fontWeight:"600",cursor:"pointer",transition:"transform 0.2s"},statsGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"2rem"},statCard:{display:"flex",alignItems:"center",gap:"16px",padding:"1.5rem",background:"rgba(255, 255, 255, 0.05)",borderRadius:"12px",border:"1px solid rgba(255, 255, 255, 0.1)"},statValue:{fontSize:"1.5rem",fontWeight:"700",color:"#fff"},statLabel:{fontSize:"0.85rem",color:"#888"},tabs:{display:"flex",gap:"8px",marginBottom:"1.5rem",borderBottom:"1px solid rgba(255, 255, 255, 0.1)",paddingBottom:"8px"},tab:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 16px",background:"transparent",border:"none",borderRadius:"8px",color:"#888",cursor:"pointer",transition:"all 0.2s"},tabActive:{background:"rgba(255, 215, 0, 0.15)",color:"#ffd700"},filterBar:{display:"flex",gap:"12px",marginBottom:"1.5rem",flexWrap:"wrap"},searchBox:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 14px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",flex:"1",minWidth:"200px"},searchInput:{background:"transparent",border:"none",outline:"none",color:"#fff",width:"100%",fontSize:"0.9rem"},select:{padding:"10px 14px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",color:"#fff",fontSize:"0.9rem",cursor:"pointer"},iconButton:{padding:"10px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",color:"#888",cursor:"pointer"},list:{display:"flex",flexDirection:"column",gap:"8px"},listItem:{display:"flex",alignItems:"center",gap:"16px",padding:"16px",background:"rgba(255, 255, 255, 0.03)",border:"1px solid rgba(255, 255, 255, 0.08)",borderRadius:"12px",cursor:"pointer",transition:"all 0.2s"},listItemIcon:{width:"48px",height:"48px",display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(255, 255, 255, 0.05)",borderRadius:"10px"},listItemContent:{flex:1},listItemHeader:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"6px"},listItemName:{color:"#fff",fontWeight:"600",fontSize:"1rem"},listItemMeta:{display:"flex",gap:"16px",color:"#888",fontSize:"0.8rem"},emptyState:{display:"flex",flexDirection:"column",alignItems:"center",gap:"16px",padding:"4rem",color:"#666"},vorteileContainer:{marginTop:"1rem"},sectionTitle:{color:"#ffd700",marginBottom:"1rem",fontSize:"1.1rem"},vorteileGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"1rem"},vorteilCard:{padding:"1.5rem",background:"rgba(255, 255, 255, 0.03)",border:"1px solid rgba(255, 215, 0, 0.2)",borderRadius:"12px"},vorteilHeader:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"10px"},vorteilTitel:{color:"#fff",fontWeight:"600"},vorteilBeschreibung:{color:"#aaa",fontSize:"0.85rem",marginBottom:"12px"},vorteilMeta:{display:"flex",gap:"8px",flexWrap:"wrap"},vorteilRabatt:{padding:"4px 10px",background:"rgba(255, 215, 0, 0.2)",color:"#ffd700",borderRadius:"6px",fontSize:"0.8rem",fontWeight:"600"},vorteilKategorie:{padding:"4px 10px",background:"rgba(255, 255, 255, 0.1)",color:"#888",borderRadius:"6px",fontSize:"0.8rem",textTransform:"capitalize"},vorteilGilt:{padding:"4px 10px",borderRadius:"6px",fontSize:"0.8rem",color:"#fff"},modalOverlay:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},modal:{background:"#1a1a2e",borderRadius:"16px",width:"100%",maxWidth:"550px",maxHeight:"90vh",overflow:"auto",border:"1px solid rgba(255, 215, 0, 0.2)"},modalHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"1.5rem",borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},modalTitle:{display:"flex",alignItems:"center",gap:"10px",color:"#fff",margin:0,fontSize:"1.2rem"},closeButton:{background:"transparent",border:"none",color:"#888",cursor:"pointer",padding:"8px"},typSelector:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",padding:"1.5rem"},typButton:{display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",padding:"20px",background:"rgba(255, 255, 255, 0.05)",border:"2px solid transparent",borderRadius:"12px",color:"#888",cursor:"pointer",transition:"all 0.2s"},typButtonActive:{borderColor:"#3b82f6",background:"rgba(59, 130, 246, 0.15)",color:"#3b82f6"},typButtonActiveGreen:{borderColor:"#10b981",background:"rgba(16, 185, 129, 0.15)",color:"#10b981"},typPrice:{fontSize:"0.85rem",opacity:.7},formGroup:{padding:"0 1.5rem",marginBottom:"1rem"},formRow:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",padding:"0 1.5rem",marginBottom:"1rem"},label:{display:"block",color:"#888",fontSize:"0.85rem",marginBottom:"6px"},input:{width:"100%",padding:"10px 12px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.15)",borderRadius:"8px",color:"#fff",fontSize:"0.9rem",outline:"none"},hint:{color:"#666",fontSize:"0.8rem",marginTop:"6px"},modalFooter:{display:"flex",justifyContent:"flex-end",gap:"12px",padding:"1.5rem",borderTop:"1px solid rgba(255, 255, 255, 0.1)"},cancelButton:{padding:"10px 20px",background:"rgba(255, 255, 255, 0.1)",border:"none",borderRadius:"8px",color:"#888",cursor:"pointer"},submitButton:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 20px",background:"linear-gradient(135deg, #ffd700, #ffaa00)",border:"none",borderRadius:"8px",color:"#000",fontWeight:"600",cursor:"pointer"},dangerButton:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 20px",background:"rgba(239, 68, 68, 0.2)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:"8px",color:"#ef4444",cursor:"pointer"},detailContent:{padding:"1.5rem"},detailRow:{display:"flex",gap:"24px",marginBottom:"16px",flexWrap:"wrap"},detailItem:{display:"flex",flexDirection:"column",gap:"4px"},detailLabel:{color:"#666",fontSize:"0.75rem",textTransform:"uppercase"},detailValue:{color:"#fff",fontSize:"0.95rem"},detailSection:{marginTop:"20px",paddingTop:"16px",borderTop:"1px solid rgba(255, 255, 255, 0.1)"},detailSectionTitle:{color:"#ffd700",fontSize:"0.9rem",marginBottom:"12px"},zahlungenList:{display:"flex",flexDirection:"column",gap:"10px"},zahlungItem:{padding:"12px",background:"rgba(255, 255, 255, 0.03)",borderRadius:"8px"},zahlungMain:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},zahlungNummer:{color:"#fff",fontWeight:"500"},zahlungBetrag:{color:"#ffd700",fontWeight:"600"},zahlungStatus:{fontWeight:"600",fontSize:"0.85rem"},zahlungMeta:{display:"flex",gap:"16px",color:"#666",fontSize:"0.8rem"},smallButton:{display:"flex",alignItems:"center",gap:"6px",marginTop:"8px",padding:"6px 12px",background:"rgba(16, 185, 129, 0.2)",border:"1px solid rgba(16, 185, 129, 0.3)",borderRadius:"6px",color:"#10b981",fontSize:"0.8rem",cursor:"pointer"},notizen:{color:"#aaa",fontSize:"0.9rem",whiteSpace:"pre-wrap"},detailTabs:{display:"flex",gap:"4px",padding:"0 1.5rem",borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},detailTab:{display:"flex",alignItems:"center",gap:"6px",padding:"12px 16px",background:"transparent",border:"none",borderBottom:"2px solid transparent",color:"#888",cursor:"pointer",transition:"all 0.2s"},detailTabActive:{color:"#ffd700",borderBottomColor:"#ffd700"},vertragActions:{display:"flex",gap:"12px",marginBottom:"1.5rem",flexWrap:"wrap"},actionButton:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 20px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"10px",color:"#fff",cursor:"pointer",transition:"all 0.2s"},actionButtonPrimary:{background:"linear-gradient(135deg, #ffd700, #ffaa00)",border:"none",color:"#000",fontWeight:"600"},vertragInfo:{marginBottom:"1.5rem"},vertragStatusGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"12px",marginTop:"12px"},vertragStatusItem:{display:"flex",alignItems:"center",gap:"10px",padding:"12px",background:"rgba(255, 255, 255, 0.03)",borderRadius:"8px",color:"#fff",fontSize:"0.9rem"},dokumenteListe:{display:"flex",flexWrap:"wrap",gap:"10px",marginTop:"12px"},dokumentButton:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 16px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.15)",borderRadius:"8px",color:"#aaa",cursor:"pointer",transition:"all 0.2s"},sepaListe:{display:"flex",flexDirection:"column",gap:"12px"},sepaItem:{padding:"16px",background:"rgba(255, 255, 255, 0.03)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"12px"},sepaHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},sepaMandatsref:{color:"#fff",fontWeight:"600",fontFamily:"monospace"},sepaStatus:{padding:"4px 10px",borderRadius:"6px",fontSize:"0.8rem",fontWeight:"600"},sepaDetails:{display:"flex",flexDirection:"column",gap:"6px",color:"#aaa",fontSize:"0.9rem"},sepaSignedBadge:{display:"inline-flex",alignItems:"center",gap:"6px",marginTop:"12px",padding:"6px 12px",background:"rgba(16, 185, 129, 0.15)",color:"#10b981",borderRadius:"6px",fontSize:"0.85rem"},sepaHinweis:{display:"flex",alignItems:"flex-start",gap:"12px",padding:"16px",background:"rgba(255, 215, 0, 0.1)",border:"1px solid rgba(255, 215, 0, 0.3)",borderRadius:"10px",marginTop:"1.5rem"},historieListe:{display:"flex",flexDirection:"column",gap:"12px",marginTop:"16px"},historieItem:{display:"flex",alignItems:"center",gap:"16px",padding:"12px",background:"rgba(255, 255, 255, 0.03)",borderRadius:"8px",borderLeft:"3px solid #ffd700"},historieDatum:{color:"#888",fontSize:"0.8rem",minWidth:"100px"},historieText:{color:"#fff",fontSize:"0.9rem"},signatureSection:{marginTop:"1.5rem"},signatureCanvas:{width:"100%",background:"#fff",borderRadius:"8px",cursor:"crosshair",touchAction:"none"},clearSignatureButton:{marginTop:"8px",padding:"8px 16px",background:"transparent",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"6px",color:"#888",cursor:"pointer",fontSize:"0.85rem"},signatureIntro:{color:"#aaa",fontSize:"0.95rem",lineHeight:1.6,marginBottom:"1.5rem"},akzeptanzSection:{display:"flex",flexDirection:"column",gap:"12px",marginBottom:"1.5rem"},checkbox:{display:"flex",alignItems:"center",gap:"10px",color:"#fff",cursor:"pointer"},dokumentContent:{padding:"1.5rem",maxHeight:"60vh",overflow:"auto"},dokumentMeta:{display:"flex",gap:"20px",marginBottom:"1rem",color:"#888",fontSize:"0.85rem"},dokumentText:{color:"#ccc",fontSize:"0.9rem",lineHeight:1.7,whiteSpace:"pre-wrap"},einstellungenContainer:{marginTop:"1rem"},einstellungenTabs:{display:"flex",gap:"8px",marginBottom:"1.5rem",flexWrap:"wrap"},einstellungenTab:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 16px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",color:"#888",cursor:"pointer",transition:"all 0.2s"},einstellungenTabActive:{background:"rgba(255, 215, 0, 0.15)",borderColor:"rgba(255, 215, 0, 0.3)",color:"#ffd700"},einstellungenGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},einstellungItem:{position:"relative",padding:"1rem",background:"rgba(255, 255, 255, 0.03)",borderRadius:"12px",border:"1px solid rgba(255, 255, 255, 0.08)"},einstellungLabel:{display:"block",color:"#fff",fontWeight:"500",marginBottom:"8px",fontSize:"0.95rem"},einstellungHint:{display:"block",color:"#666",fontSize:"0.8rem",fontWeight:"400",marginTop:"4px"},einstellungInput:{width:"100%",padding:"10px 14px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.15)",borderRadius:"8px",color:"#fff",fontSize:"0.95rem",outline:"none"},toggleLabel:{display:"flex",alignItems:"center",gap:"12px",cursor:"pointer"},toggleInput:{display:"none"},toggleSwitch:{position:"relative",width:"48px",height:"24px",background:"rgba(255, 255, 255, 0.2)",borderRadius:"12px",transition:"background 0.2s"},toggleText:{color:"#888",fontSize:"0.9rem"},changedBadge:{position:"absolute",top:"8px",right:"8px",padding:"2px 8px",background:"rgba(255, 215, 0, 0.2)",color:"#ffd700",borderRadius:"4px",fontSize:"0.7rem",fontWeight:"600"},einstellungenFooter:{display:"flex",alignItems:"center",gap:"12px",marginTop:"2rem",padding:"1rem",background:"rgba(255, 215, 0, 0.1)",borderRadius:"12px",border:"1px solid rgba(255, 215, 0, 0.2)"},changesCount:{flex:1,color:"#ffd700",fontWeight:"500"}},oe={BadgeCheck:K,Award:l,Medal:$,ScrollText:F,Package:E,FileText:y,BookOpen:W,Star:G,Tag:P},ce=()=>{var i;const{token:a,user:l}=t(),[d,o]=e.useState([]),[h,u]=e.useState([]),[x,j]=e.useState("alle"),[v,_]=e.useState(""),[C,S]=e.useState([]),[w,B]=e.useState(!1),[I,T]=e.useState(!1),[F,P]=e.useState(null),[W,$]=e.useState({}),[K,J]=e.useState(!1),[Z,q]=e.useState(!1),[X,Y]=e.useState(!0),[Q,ee]=e.useState(null),se="admin"===(null==l?void 0:l.role),[te,ne]=e.useState(!1),[ie,ae]=e.useState(null),[le,re]=e.useState(!1),[de,ce]=e.useState(null),[he,ue]=e.useState([]),[pe,xe]=e.useState({vorname:(null==l?void 0:l.vorname)||"",nachname:(null==l?void 0:l.nachname)||"",email:(null==l?void 0:l.email)||"",strasse:"",plz:"",ort:"",land:"Deutschland",telefon:"",anmerkungen:"",zahlungsart:"rechnung"});e.useEffect(()=>{(async()=>{try{Y(!0),ee(null);const[e,s]=await Promise.all([n.get("/shop/kategorien"),n.get("/shop/produkte")]),t=[];e.data.forEach(e=>{e.parent_id||(t.push({id:e.slug,dbId:e.id,name:e.name,icon:oe[e.icon]||E,color:e.farbe,isParent:!0}),e.children&&e.children.length>0&&e.children.forEach(s=>{const n=oe[s.icon]||E;t.push({id:s.slug,dbId:s.id,name:s.name,icon:n,color:s.farbe,parentDbId:e.id,parentSlug:e.slug,isChild:!0})}))}),u(t);const i=[];e.data.forEach(e=>{i.push({id:e.id,name:e.name,slug:e.slug,parent_id:null}),e.children&&e.children.forEach(s=>{i.push({id:s.id,name:`${e.name} â†’ ${s.name}`,slug:s.slug,parent_id:e.id})})}),ue(i);const a=s.data.map(s=>{var t;return{id:s.id,dbId:s.id,kategorie_id:s.kategorie_id,kategorie:s.kategorie_slug,parentKategorie:s.parent_kategorie_id?null==(t=e.data.find(e=>e.id===s.parent_kategorie_id))?void 0:t.slug:null,sku:s.sku,name:s.name,beschreibung:s.beschreibung,preis:parseFloat(s.preis),bild:s.bild_url,details:s.details||[],optionen:s.optionen||null,lieferzeit:s.lieferzeit,featured:1===s.featured,aktiv:s.aktiv}});o(a)}catch(e){console.error("Fehler beim Laden der Shop-Daten:",e),ee("Shop-Daten konnten nicht geladen werden")}finally{Y(!1)}})()},[]),e.useEffect(()=>{const e=localStorage.getItem("tda_shop_warenkorb");if(e)try{S(JSON.parse(e))}catch(s){console.error("Fehler beim Laden des Warenkorbs:",s)}},[]),e.useEffect(()=>{localStorage.setItem("tda_shop_warenkorb",JSON.stringify(C))},[C]);const ge=d.filter(e=>{const s="alle"===x||e.kategorie===x||e.parentKategorie===x,t=""===v||e.name.toLowerCase().includes(v.toLowerCase())||e.beschreibung.toLowerCase().includes(v.toLowerCase());return s&&t}),me=d.filter(e=>e.featured),je=(e,s={})=>{const t={id:`${e.id}-${Date.now()}`,produktId:e.id,name:e.name,preis:e.preis,menge:1,optionen:s,bild:e.bild};S(e=>[...e,t]),P(null),$({})},be=(e,s)=>{s<1?ve(e):S(t=>t.map(t=>t.id===e?{...t,menge:s}:t))},ve=e=>{S(s=>s.filter(s=>s.id!==e))},fe=C.reduce((e,s)=>e+s.preis*s.menge,0),ye=C.reduce((e,s)=>e+s.menge,0),ke=fe>=50?0:4.95,ze=fe+ke,Ne=async()=>{q(!0);try{const e={positionen:C.map(e=>({produkt_id:e.produktId,menge:e.menge,optionen:e.optionen})),lieferadresse:{vorname:pe.vorname,nachname:pe.nachname,strasse:pe.strasse,plz:pe.plz,ort:pe.ort,land:pe.land,telefon:pe.telefon},rechnungsadresse:{vorname:pe.vorname,nachname:pe.nachname,email:pe.email,strasse:pe.strasse,plz:pe.plz,ort:pe.ort,land:pe.land},anmerkungen:pe.anmerkungen};await n.post("/shop/bestellungen",e,{headers:{Authorization:`Bearer ${a}`}}),J(!0),S([]),T(!1)}catch(e){console.error("Bestellfehler:",e),alert("Fehler bei der Bestellung. Bitte versuchen Sie es erneut.")}finally{q(!1)}},_e=async()=>{if(ie.name&&ie.sku){re(!0);try{const e={...ie,details:ie.details||[],optionen:ie.optionen||null};ie.id?await n.put(`/shop/admin/produkte/${ie.id}`,e,{headers:{Authorization:`Bearer ${a}`}}):await n.post("/shop/admin/produkte",e,{headers:{Authorization:`Bearer ${a}`}});const s=await n.get("/shop/produkte"),t=await n.get("/shop/kategorien"),i=s.data.map(e=>{var s;return{id:e.id,dbId:e.id,kategorie_id:e.kategorie_id,kategorie:e.kategorie_slug,parentKategorie:e.parent_kategorie_id?null==(s=t.data.find(s=>s.id===e.parent_kategorie_id))?void 0:s.slug:null,sku:e.sku,name:e.name,beschreibung:e.beschreibung,preis:parseFloat(e.preis),bild:e.bild_url,details:e.details||[],optionen:e.optionen||null,lieferzeit:e.lieferzeit,featured:1===e.featured,aktiv:e.aktiv}});o(i),ne(!1),ae(null)}catch(e){console.error("Fehler beim Speichern:",e),alert("Fehler beim Speichern des Produkts")}finally{re(!1)}}else alert("Name und SKU sind erforderlich")},Ce=()=>{ae(e=>({...e,details:[...e.details||[],""]}))},Se=({kategorie:e,size:t=20})=>{const n=h.find(s=>s.id===e);if(!n)return s.jsx(E,{size:t});const i=n.icon;return s.jsx(i,{size:t,style:{color:n.color}})},we=({produkt:e})=>{var t;return s.jsxs("div",{className:"shop-produkt-karte "+(e.featured?"featured":""),onClick:()=>P(e),children:[e.featured&&s.jsxs("div",{className:"featured-badge",children:[s.jsx(G,{size:12})," Beliebt"]}),se&&s.jsxs("div",{className:"admin-buttons",children:[s.jsx("button",{className:"btn-admin-edit",onClick:s=>{s.stopPropagation(),(e=>{ae({id:e.dbId||e.id,sku:e.sku||"",name:e.name,beschreibung:e.beschreibung,preis:e.preis,kategorie_id:e.kategorie_id,details:e.details||[],optionen:e.optionen,lieferzeit:e.lieferzeit||"3-5 Werktage",featured:e.featured,aktiv:!1!==e.aktiv}),ne(!0)})(e)},title:"Bearbeiten",children:s.jsx(O,{size:14})}),s.jsx("button",{className:"btn-admin-delete",onClick:s=>{s.stopPropagation(),(async e=>{if(confirm("Produkt wirklich lÃ¶schen?"))try{await n.delete(`/shop/admin/produkte/${e}`,{headers:{Authorization:`Bearer ${a}`}}),o(s=>s.filter(s=>s.id!==e&&s.dbId!==e))}catch(s){console.error("Fehler beim LÃ¶schen:",s),alert("Fehler beim LÃ¶schen des Produkts")}})(e.dbId||e.id)},title:"LÃ¶schen",children:s.jsx(b,{size:14})})]}),s.jsx("div",{className:"produkt-bild",children:s.jsx(Se,{kategorie:e.kategorie,size:48})}),s.jsxs("div",{className:"produkt-info",children:[s.jsx("span",{className:"produkt-kategorie",children:null==(t=h.find(s=>s.id===e.kategorie))?void 0:t.name}),s.jsx("h3",{className:"produkt-name",children:e.name}),s.jsx("p",{className:"produkt-beschreibung",children:e.beschreibung}),s.jsxs("div",{className:"produkt-footer",children:[s.jsxs("span",{className:"produkt-preis",children:[e.preis.toFixed(2)," â‚¬"]}),s.jsx("button",{className:"btn-add-cart",onClick:s=>{s.stopPropagation(),e.optionen?P(e):je(e)},children:s.jsx(L,{size:16})})]})]})]})},Be=({produkt:e})=>{var t;return s.jsx("div",{className:"modal-overlay",onClick:()=>P(null),children:s.jsxs("div",{className:"modal-content produkt-detail-modal",onClick:e=>e.stopPropagation(),children:[s.jsx("button",{className:"modal-close",onClick:()=>P(null),children:s.jsx(g,{size:24})}),s.jsxs("div",{className:"produkt-detail-grid",children:[s.jsx("div",{className:"produkt-detail-bild",children:s.jsx(Se,{kategorie:e.kategorie,size:120})}),s.jsxs("div",{className:"produkt-detail-info",children:[s.jsx("span",{className:"produkt-kategorie-badge",children:null==(t=h.find(s=>s.id===e.kategorie))?void 0:t.name}),s.jsx("h2",{children:e.name}),s.jsx("p",{className:"produkt-detail-beschreibung",children:e.beschreibung}),e.details&&s.jsx("ul",{className:"produkt-details-liste",children:e.details.map((e,t)=>s.jsxs("li",{children:[s.jsx(m,{size:14})," ",e]},t))}),e.optionen&&s.jsx("div",{className:"produkt-optionen",children:e.optionen.map((e,t)=>s.jsxs("div",{className:"option-gruppe",children:[s.jsx("label",{children:e.name}),s.jsxs("select",{value:W[e.name]||"",onChange:s=>$(t=>({...t,[e.name]:s.target.value})),children:[s.jsx("option",{value:"",children:"Bitte wÃ¤hlen..."}),e.werte.map((e,t)=>s.jsx("option",{value:e,children:e},t))]})]},t))}),s.jsxs("div",{className:"produkt-detail-footer",children:[s.jsx("div",{className:"produkt-meta",children:s.jsxs("span",{className:"lieferzeit",children:[s.jsx(V,{size:14})," ",e.lieferzeit]})}),s.jsxs("div",{className:"produkt-kaufen",children:[s.jsxs("span",{className:"preis-gross",children:[e.preis.toFixed(2)," â‚¬"]}),s.jsxs("button",{className:"btn-kaufen",onClick:()=>{if(e.optionen){if(!e.optionen.every(e=>W[e.name]))return void alert("Bitte alle Optionen auswÃ¤hlen")}je(e,W)},children:[s.jsx(L,{size:18})," In den Warenkorb"]})]})]})]})]})]})})},Ie=()=>s.jsxs("div",{className:"warenkorb-sidebar "+(w?"open":""),children:[s.jsxs("div",{className:"warenkorb-header",children:[s.jsxs("h3",{children:[s.jsx(L,{size:20})," Warenkorb"]}),s.jsx("button",{className:"btn-close",onClick:()=>B(!1),children:s.jsx(g,{size:20})})]}),0===C.length?s.jsxs("div",{className:"warenkorb-leer",children:[s.jsx(L,{size:48}),s.jsx("p",{children:"Ihr Warenkorb ist leer"})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"warenkorb-items",children:C.map(e=>s.jsxs("div",{className:"warenkorb-item",children:[s.jsxs("div",{className:"item-info",children:[s.jsx("span",{className:"item-name",children:e.name}),Object.keys(e.optionen).length>0&&s.jsx("span",{className:"item-optionen",children:Object.entries(e.optionen).map(([e,s])=>`${e}: ${s}`).join(", ")}),s.jsxs("span",{className:"item-preis",children:[e.preis.toFixed(2)," â‚¬"]})]}),s.jsxs("div",{className:"item-actions",children:[s.jsxs("div",{className:"menge-control",children:[s.jsx("button",{onClick:()=>be(e.id,e.menge-1),children:s.jsx(H,{size:14})}),s.jsx("span",{children:e.menge}),s.jsx("button",{onClick:()=>be(e.id,e.menge+1),children:s.jsx(r,{size:14})})]}),s.jsx("button",{className:"btn-remove",onClick:()=>ve(e.id),children:s.jsx(b,{size:16})})]})]},e.id))}),s.jsxs("div",{className:"warenkorb-summe",children:[s.jsxs("div",{className:"summe-zeile",children:[s.jsx("span",{children:"Zwischensumme"}),s.jsxs("span",{children:[fe.toFixed(2)," â‚¬"]})]}),s.jsxs("div",{className:"summe-zeile",children:[s.jsx("span",{children:"Versand"}),s.jsx("span",{children:0===ke?"Kostenlos":`${ke.toFixed(2)} â‚¬`})]}),fe<50&&s.jsxs("div",{className:"versand-hinweis",children:[s.jsx(V,{size:14})," Noch ",(50-fe).toFixed(2)," â‚¬ bis zum kostenlosen Versand"]}),s.jsxs("div",{className:"summe-zeile total",children:[s.jsx("span",{children:"Gesamt"}),s.jsxs("span",{children:[ze.toFixed(2)," â‚¬"]})]})]}),s.jsx("div",{className:"warenkorb-actions",children:s.jsxs("button",{className:"btn-checkout",onClick:()=>{B(!1),T(!0)},children:["Zur Kasse ",s.jsx(U,{size:18})]})})]})]}),Te=()=>s.jsx("div",{className:"modal-overlay",onClick:()=>T(!1),children:s.jsxs("div",{className:"modal-content checkout-modal",onClick:e=>e.stopPropagation(),children:[s.jsx("button",{className:"modal-close",onClick:()=>T(!1),children:s.jsx(g,{size:24})}),s.jsxs("h2",{children:[s.jsx(f,{size:24})," Bestellung abschlieÃŸen"]}),s.jsxs("div",{className:"checkout-grid",children:[s.jsxs("div",{className:"checkout-section",children:[s.jsxs("h3",{children:[s.jsx(V,{size:18})," Lieferadresse"]}),s.jsxs("div",{className:"form-grid",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Vorname *"}),s.jsx("input",{type:"text",value:pe.vorname,onChange:e=>xe(s=>({...s,vorname:e.target.value})),required:!0})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Nachname *"}),s.jsx("input",{type:"text",value:pe.nachname,onChange:e=>xe(s=>({...s,nachname:e.target.value})),required:!0})]}),s.jsxs("div",{className:"form-group full",children:[s.jsx("label",{children:"E-Mail *"}),s.jsx("input",{type:"email",value:pe.email,onChange:e=>xe(s=>({...s,email:e.target.value})),required:!0})]}),s.jsxs("div",{className:"form-group full",children:[s.jsx("label",{children:"StraÃŸe & Hausnummer *"}),s.jsx("input",{type:"text",value:pe.strasse,onChange:e=>xe(s=>({...s,strasse:e.target.value})),required:!0})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"PLZ *"}),s.jsx("input",{type:"text",value:pe.plz,onChange:e=>xe(s=>({...s,plz:e.target.value})),required:!0})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Ort *"}),s.jsx("input",{type:"text",value:pe.ort,onChange:e=>xe(s=>({...s,ort:e.target.value})),required:!0})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Land"}),s.jsxs("select",{value:pe.land,onChange:e=>xe(s=>({...s,land:e.target.value})),children:[s.jsx("option",{value:"Deutschland",children:"Deutschland"}),s.jsx("option",{value:"Ã–sterreich",children:"Ã–sterreich"}),s.jsx("option",{value:"Schweiz",children:"Schweiz"})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Telefon"}),s.jsx("input",{type:"tel",value:pe.telefon,onChange:e=>xe(s=>({...s,telefon:e.target.value}))})]})]})]}),s.jsxs("div",{className:"checkout-section",children:[s.jsxs("h3",{children:[s.jsx(f,{size:18})," Zahlungsart"]}),s.jsxs("div",{className:"zahlungsarten",children:[s.jsxs("label",{className:"zahlungsart "+("rechnung"===pe.zahlungsart?"selected":""),children:[s.jsx("input",{type:"radio",name:"zahlungsart",value:"rechnung",checked:"rechnung"===pe.zahlungsart,onChange:e=>xe(s=>({...s,zahlungsart:e.target.value}))}),s.jsx(y,{size:20}),s.jsxs("div",{children:[s.jsx("span",{className:"za-name",children:"Rechnung"}),s.jsx("span",{className:"za-info",children:"Zahlung nach Erhalt der Ware"})]})]}),s.jsxs("label",{className:"zahlungsart "+("vorkasse"===pe.zahlungsart?"selected":""),children:[s.jsx("input",{type:"radio",name:"zahlungsart",value:"vorkasse",checked:"vorkasse"===pe.zahlungsart,onChange:e=>xe(s=>({...s,zahlungsart:e.target.value}))}),s.jsx(c,{size:20}),s.jsxs("div",{children:[s.jsx("span",{className:"za-name",children:"Vorkasse"}),s.jsx("span",{className:"za-info",children:"Ãœberweisung vor Versand"})]})]})]})]}),s.jsxs("div",{className:"checkout-section bestellung-uebersicht",children:[s.jsxs("h3",{children:[s.jsx(E,{size:18})," Ihre Bestellung"]}),s.jsx("div",{className:"bestellung-items",children:C.map(e=>s.jsxs("div",{className:"bestellung-item",children:[s.jsxs("span",{className:"item-menge",children:[e.menge,"x"]}),s.jsx("span",{className:"item-name",children:e.name}),s.jsxs("span",{className:"item-preis",children:[(e.preis*e.menge).toFixed(2)," â‚¬"]})]},e.id))}),s.jsxs("div",{className:"bestellung-summen",children:[s.jsxs("div",{className:"summe-zeile",children:[s.jsx("span",{children:"Zwischensumme"}),s.jsxs("span",{children:[fe.toFixed(2)," â‚¬"]})]}),s.jsxs("div",{className:"summe-zeile",children:[s.jsx("span",{children:"Versand"}),s.jsx("span",{children:0===ke?"Kostenlos":`${ke.toFixed(2)} â‚¬`})]}),s.jsxs("div",{className:"summe-zeile total",children:[s.jsx("span",{children:"Gesamtsumme"}),s.jsxs("span",{children:[ze.toFixed(2)," â‚¬"]})]})]})]}),s.jsxs("div",{className:"checkout-section full",children:[s.jsx("label",{children:"Anmerkungen zur Bestellung"}),s.jsx("textarea",{value:pe.anmerkungen,onChange:e=>xe(s=>({...s,anmerkungen:e.target.value})),placeholder:"Besondere WÃ¼nsche oder Hinweise...",rows:3})]})]}),s.jsxs("div",{className:"checkout-footer",children:[s.jsxs("p",{className:"agb-hinweis",children:[s.jsx(D,{size:14})," Mit der Bestellung akzeptieren Sie unsere AGB und DatenschutzerklÃ¤rung."]}),s.jsx("button",{className:"btn-bestellen",onClick:Ne,disabled:Z||!pe.vorname||!pe.nachname||!pe.email||!pe.strasse||!pe.plz||!pe.ort,children:Z?s.jsxs(s.Fragment,{children:[s.jsx(M,{size:18,className:"spin"})," Wird verarbeitet..."]}):s.jsxs(s.Fragment,{children:["Kostenpflichtig bestellen (",ze.toFixed(2)," â‚¬)"]})})]})]})}),De=()=>s.jsx("div",{className:"modal-overlay",children:s.jsxs("div",{className:"modal-content erfolg-modal",children:[s.jsx("div",{className:"erfolg-icon",children:s.jsx(m,{size:48})}),s.jsx("h2",{children:"Bestellung erfolgreich!"}),s.jsx("p",{children:"Vielen Dank fÃ¼r Ihre Bestellung. Sie erhalten in KÃ¼rze eine BestÃ¤tigung per E-Mail."}),s.jsxs("div",{className:"erfolg-info",children:[s.jsxs("div",{className:"info-item",children:[s.jsx(A,{size:18}),s.jsx("span",{children:"Bearbeitung: 1-2 Werktage"})]}),s.jsxs("div",{className:"info-item",children:[s.jsx(V,{size:18}),s.jsx("span",{children:"Lieferung: 3-7 Werktage"})]})]}),s.jsx("button",{className:"btn-primary",onClick:()=>J(!1),children:"Weiter einkaufen"})]})}),Fe=()=>s.jsx("div",{className:"modal-overlay",onClick:()=>ne(!1),children:s.jsxs("div",{className:"modal-content produkt-editor-modal",onClick:e=>e.stopPropagation(),children:[s.jsx("button",{className:"modal-close",onClick:()=>ne(!1),children:s.jsx(g,{size:24})}),s.jsxs("h2",{children:[s.jsx(p,{size:24}),(null==ie?void 0:ie.id)?"Produkt bearbeiten":"Neues Produkt"]}),s.jsxs("div",{className:"editor-form",children:[s.jsxs("div",{className:"form-row",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Artikelnummer (SKU) *"}),s.jsx("input",{type:"text",value:(null==ie?void 0:ie.sku)||"",onChange:e=>ae(s=>({...s,sku:e.target.value})),placeholder:"z.B. URK-KAR-001"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Kategorie *"}),s.jsx("select",{value:(null==ie?void 0:ie.kategorie_id)||"",onChange:e=>ae(s=>({...s,kategorie_id:parseInt(e.target.value)})),children:he.map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Produktname *"}),s.jsx("input",{type:"text",value:(null==ie?void 0:ie.name)||"",onChange:e=>ae(s=>({...s,name:e.target.value})),placeholder:"z.B. Karate Kyu-Urkunde"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Beschreibung"}),s.jsx("textarea",{value:(null==ie?void 0:ie.beschreibung)||"",onChange:e=>ae(s=>({...s,beschreibung:e.target.value})),rows:3,placeholder:"Produktbeschreibung..."})]}),s.jsxs("div",{className:"form-row",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Preis (â‚¬) *"}),s.jsx("input",{type:"number",step:"0.01",min:"0",value:(null==ie?void 0:ie.preis)||0,onChange:e=>ae(s=>({...s,preis:parseFloat(e.target.value)||0}))})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Lieferzeit"}),s.jsx("input",{type:"text",value:(null==ie?void 0:ie.lieferzeit)||"",onChange:e=>ae(s=>({...s,lieferzeit:e.target.value})),placeholder:"z.B. 3-5 Werktage"})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Details (AufzÃ¤hlungspunkte)"}),s.jsxs("div",{className:"details-list",children:[((null==ie?void 0:ie.details)||[]).map((e,t)=>s.jsxs("div",{className:"detail-item",children:[s.jsx("input",{type:"text",value:e,onChange:e=>((e,s)=>{const t=[...ie.details||[]];t[e]=s,ae(e=>({...e,details:t}))})(t,e.target.value),placeholder:"z.B. DIN A4 Format"}),s.jsx("button",{type:"button",onClick:()=>(e=>{ae(s=>({...s,details:s.details.filter((s,t)=>t!==e)}))})(t),className:"btn-remove-detail",children:s.jsx(g,{size:16})})]},t)),s.jsxs("button",{type:"button",onClick:Ce,className:"btn-add-detail",children:[s.jsx(r,{size:16})," Detail hinzufÃ¼gen"]})]})]}),s.jsxs("div",{className:"form-row checkboxes",children:[s.jsxs("label",{className:"checkbox-label",children:[s.jsx("input",{type:"checkbox",checked:(null==ie?void 0:ie.featured)||!1,onChange:e=>ae(s=>({...s,featured:e.target.checked}))}),s.jsx("span",{children:"Hervorgehoben (Featured)"})]}),s.jsxs("label",{className:"checkbox-label",children:[s.jsx("input",{type:"checkbox",checked:!1!==(null==ie?void 0:ie.aktiv),onChange:e=>ae(s=>({...s,aktiv:e.target.checked}))}),s.jsx("span",{children:"Aktiv (sichtbar im Shop)"})]})]})]}),s.jsxs("div",{className:"editor-footer",children:[s.jsx("button",{className:"btn-cancel",onClick:()=>ne(!1),children:"Abbrechen"}),s.jsx("button",{className:"btn-save",onClick:_e,disabled:le,children:le?s.jsxs(s.Fragment,{children:[s.jsx(M,{size:18,className:"spin"})," Speichern..."]}):s.jsxs(s.Fragment,{children:[s.jsx(k,{size:18})," Speichern"]})})]})]})});return X?s.jsx("div",{className:"verband-shop",children:s.jsxs("div",{className:"shop-loading",children:[s.jsx(M,{size:48,className:"spin"}),s.jsx("p",{children:"Shop wird geladen..."})]})}):Q?s.jsx("div",{className:"verband-shop",children:s.jsxs("div",{className:"shop-error",children:[s.jsx(R,{size:48}),s.jsx("p",{children:Q}),s.jsx("button",{onClick:()=>window.location.reload(),children:"Erneut versuchen"})]})}):s.jsxs("div",{className:"verband-shop",children:[s.jsxs("div",{className:"shop-header",children:[s.jsxs("div",{className:"shop-search",children:[s.jsx(z,{size:18}),s.jsx("input",{type:"text",placeholder:"Produkte suchen...",value:v,onChange:e=>_(e.target.value)})]}),s.jsxs("button",{className:"btn-warenkorb",onClick:()=>B(!0),children:[s.jsx(L,{size:20}),ye>0&&s.jsx("span",{className:"warenkorb-badge",children:ye})]})]}),s.jsxs("div",{className:"shop-kategorien",children:[s.jsxs("button",{className:"kategorie-btn "+("alle"===x?"active":""),onClick:()=>j("alle"),children:[s.jsx(E,{size:18}),s.jsx("span",{children:"Alle"})]}),h.filter(e=>e.isParent).map(e=>{const t=h.filter(s=>s.parentDbId===e.dbId),n=t.length>0;return s.jsx("div",{className:"kategorie-gruppe",children:n?s.jsxs("div",{className:"kategorie-dropdown",children:[s.jsxs("button",{className:"kategorie-btn parent has-dropdown "+(x===e.id||t.some(e=>e.id===x)?"active":""),onClick:()=>ce(de===e.id?null:e.id),style:{"--kat-color":e.color},children:[s.jsx(e.icon,{size:18}),s.jsx("span",{children:e.name}),s.jsx(N,{size:14,className:"dropdown-arrow "+(de===e.id?"open":"")})]}),de===e.id&&s.jsxs("div",{className:"dropdown-menu",children:[s.jsxs("button",{className:"dropdown-item "+(x===e.id?"active":""),onClick:()=>{j(e.id),ce(null)},children:["Alle ",e.name]}),t.map(e=>{const t=e.icon;return s.jsxs("button",{className:"dropdown-item "+(x===e.id?"active":""),onClick:()=>{j(e.id),ce(null)},style:{"--kat-color":e.color},children:[s.jsx(t,{size:14}),e.name]},e.id)})]})]}):s.jsxs("button",{className:"kategorie-btn "+(x===e.id?"active":""),onClick:()=>j(e.id),style:{"--kat-color":e.color},children:[s.jsx(e.icon,{size:18}),s.jsx("span",{children:e.name})]})},e.id)}),se&&s.jsxs("button",{className:"kategorie-btn admin-btn",onClick:()=>{var e;ae({id:null,sku:"",name:"",beschreibung:"",preis:0,kategorie_id:(null==(e=he[0])?void 0:e.id)||1,details:[],optionen:null,lieferzeit:"3-5 Werktage",featured:!1,aktiv:!0}),ne(!0)},children:[s.jsx(r,{size:18}),s.jsx("span",{children:"Neu"})]})]}),"alle"===x&&""===v&&s.jsxs("div",{className:"shop-featured",children:[s.jsxs("h2",{children:[s.jsx(G,{size:20})," Beliebte Produkte"]}),s.jsx("div",{className:"featured-grid",children:me.map(e=>s.jsx(we,{produkt:e},e.id))})]}),s.jsxs("div",{className:"shop-produkte",children:["alle"!==x&&s.jsxs("h2",{children:[s.jsx(Se,{kategorie:x,size:24}),null==(i=h.find(e=>e.id===x))?void 0:i.name]}),v&&s.jsxs("p",{className:"search-results",children:[ge.length,' Ergebnis(se) fÃ¼r "',v,'"']}),s.jsx("div",{className:"produkte-grid",children:ge.map(e=>s.jsx(we,{produkt:e},e.id))}),0===ge.length&&s.jsxs("div",{className:"keine-produkte",children:[s.jsx(E,{size:48}),s.jsx("p",{children:"Keine Produkte gefunden"})]})]}),s.jsxs("div",{className:"shop-versand-info",children:[s.jsxs("div",{className:"info-item",children:[s.jsx(V,{size:24}),s.jsxs("div",{children:[s.jsx("strong",{children:"Kostenloser Versand"}),s.jsx("span",{children:"ab 50 â‚¬ Bestellwert"})]})]}),s.jsxs("div",{className:"info-item",children:[s.jsx(D,{size:24}),s.jsxs("div",{children:[s.jsx("strong",{children:"Sichere Zahlung"}),s.jsx("span",{children:"Rechnung oder Vorkasse"})]})]}),s.jsxs("div",{className:"info-item",children:[s.jsx(A,{size:24}),s.jsxs("div",{children:[s.jsx("strong",{children:"Schnelle Lieferung"}),s.jsx("span",{children:"3-7 Werktage"})]})]})]}),F&&s.jsx(Be,{produkt:F}),s.jsx(Ie,{}),I&&s.jsx(Te,{}),K&&s.jsx(De,{}),te&&s.jsx(Fe,{}),w&&s.jsx("div",{className:"sidebar-overlay",onClick:()=>B(!1)})]})},he=()=>{const{token:i}=t();le();const[l,r]=e.useState(!0),[o,u]=e.useState(""),[p,x]=e.useState("overview"),[g,m]=e.useState({mitgliedsschulen:0,einzelmitglieder:0,aktiveMitgliedschaften:0,pendingMitgliedschaften:0,turniere:0,events:0,jahresbeitraege:0,offeneBeitraege:0}),[j,b]=e.useState([]),[k,z]=e.useState([]),[N,_]=e.useState([]);e.useEffect(()=>{C()},[]);const C=async()=>{r(!0),u("");try{const[e,s,t]=await Promise.all([n.get("/verbandsmitgliedschaften/stats",{headers:{Authorization:`Bearer ${i}`}}).catch(()=>({data:{success:!1}})),n.get("/verbandsmitgliedschaften?limit=10",{headers:{Authorization:`Bearer ${i}`}}).catch(()=>({data:{success:!1,mitgliedschaften:[]}})),n.get("/events?public=true&limit=5",{headers:{Authorization:`Bearer ${i}`}}).catch(()=>({data:{success:!1,events:[]}}))]);if(e.data.success){const s=e.data.stats||{};m({mitgliedsschulen:s.dojos||0,einzelmitglieder:s.einzelpersonen||0,aktiveMitgliedschaften:s.aktiv||0,pendingMitgliedschaften:s.pending||0,turniere:s.turniere||0,events:s.events||0,jahresbeitraege:s.jahresbeitraege||0,offeneBeitraege:s.offene_beitraege||0})}s.data.success&&b(s.data.mitgliedschaften||[]),t.data.success&&z(t.data.events||[])}catch(e){console.error("Fehler beim Laden der Verbandsdaten:",e),u("Fehler beim Laden der Verbandsdaten")}finally{r(!1)}},S=[{id:"overview",label:"Ãœbersicht",icon:Z},{id:"mitglieder",label:"Mitglieder",icon:q},{id:"shop",label:"Shop",icon:L},{id:"entwicklung",label:"Entwicklung",icon:X},{id:"support",label:"Support",icon:Y},{id:"turniere",label:"Turniere",icon:Q},{id:"events",label:"Events",icon:v},{id:"finanzen",label:"Finanzen",icon:c}],w=({status:e})=>{const t={aktiv:{color:"#22c55e",bg:"rgba(34, 197, 94, 0.2)",label:"Aktiv"},pending:{color:"#f59e0b",bg:"rgba(245, 158, 11, 0.2)",label:"Ausstehend"},inaktiv:{color:"#6b7280",bg:"rgba(107, 114, 128, 0.2)",label:"Inaktiv"},gekuendigt:{color:"#ef4444",bg:"rgba(239, 68, 68, 0.2)",label:"GekÃ¼ndigt"}},n=t[e]||t.pending;return s.jsx("span",{style:{display:"inline-flex",alignItems:"center",padding:"4px 10px",borderRadius:"12px",fontSize:"0.75rem",fontWeight:600,color:n.color,background:n.bg},children:n.label})},B=()=>s.jsxs("div",{className:"verband-overview",children:[s.jsxs("div",{className:"verband-stats-grid",children:[s.jsxs("div",{className:"verband-stat-card primary",children:[s.jsx("div",{className:"stat-icon",children:s.jsx(d,{size:24})}),s.jsxs("div",{className:"stat-content",children:[s.jsx("span",{className:"stat-value",children:g.mitgliedsschulen}),s.jsx("span",{className:"stat-label",children:"Mitgliedsschulen"})]}),s.jsx("div",{className:"stat-badge",children:s.jsx("span",{className:"badge-text",children:"99â‚¬/Jahr"})})]}),s.jsxs("div",{className:"verband-stat-card secondary",children:[s.jsx("div",{className:"stat-icon",children:s.jsx(q,{size:24})}),s.jsxs("div",{className:"stat-content",children:[s.jsx("span",{className:"stat-value",children:g.einzelmitglieder}),s.jsx("span",{className:"stat-label",children:"Einzelmitglieder"})]}),s.jsx("div",{className:"stat-badge",children:s.jsx("span",{className:"badge-text",children:"49â‚¬/Jahr"})})]}),s.jsxs("div",{className:"verband-stat-card success",children:[s.jsx("div",{className:"stat-icon",children:s.jsx(ee,{size:24})}),s.jsxs("div",{className:"stat-content",children:[s.jsx("span",{className:"stat-value",children:g.aktiveMitgliedschaften}),s.jsx("span",{className:"stat-label",children:"Aktive Mitgliedschaften"})]})]}),s.jsxs("div",{className:"verband-stat-card warning",children:[s.jsx("div",{className:"stat-icon",children:s.jsx(A,{size:24})}),s.jsxs("div",{className:"stat-content",children:[s.jsx("span",{className:"stat-value",children:g.pendingMitgliedschaften}),s.jsx("span",{className:"stat-label",children:"Ausstehend"})]})]}),s.jsxs("div",{className:"verband-stat-card gold",children:[s.jsx("div",{className:"stat-icon",children:s.jsx(Q,{size:24})}),s.jsxs("div",{className:"stat-content",children:[s.jsx("span",{className:"stat-value",children:g.turniere}),s.jsx("span",{className:"stat-label",children:"Turniere"})]})]}),s.jsxs("div",{className:"verband-stat-card info",children:[s.jsx("div",{className:"stat-icon",children:s.jsx(c,{size:24})}),s.jsxs("div",{className:"stat-content",children:[s.jsxs("span",{className:"stat-value",children:[g.jahresbeitraege.toLocaleString("de-DE"),"â‚¬"]}),s.jsx("span",{className:"stat-label",children:"JahresbeitrÃ¤ge"})]})]})]}),s.jsxs("div",{className:"verband-content-grid",children:[s.jsxs("div",{className:"verband-panel",children:[s.jsxs("div",{className:"panel-header",children:[s.jsxs("h3",{children:[s.jsx(q,{size:18})," Neueste Mitgliedschaften"]}),s.jsxs("button",{className:"btn-link",onClick:()=>x("mitglieder"),children:["Alle anzeigen ",s.jsx(U,{size:14})]})]}),s.jsx("div",{className:"panel-content",children:j.length>0?s.jsx("div",{className:"mitgliedschaft-list",children:j.map(e=>s.jsxs("div",{className:"mitgliedschaft-item",children:[s.jsx("div",{className:"mitgliedschaft-icon",children:"dojo"===e.typ?s.jsx(d,{size:20}):s.jsx(q,{size:20})}),s.jsxs("div",{className:"mitgliedschaft-info",children:[s.jsx("span",{className:"mitgliedschaft-name",children:"dojo"===e.typ?e.dojo_name:`${e.person_vorname} ${e.person_nachname}`}),s.jsxs("span",{className:"mitgliedschaft-meta",children:[e.mitgliedsnummer," â€¢ seit ",new Date(e.beitritt_datum).toLocaleDateString("de-DE")]})]}),s.jsx(w,{status:e.status})]},e.id))}):s.jsxs("div",{className:"empty-state",children:[s.jsx(q,{size:32}),s.jsx("p",{children:"Keine Mitgliedschaften vorhanden"})]})})]}),s.jsxs("div",{className:"verband-panel",children:[s.jsxs("div",{className:"panel-header",children:[s.jsxs("h3",{children:[s.jsx(v,{size:18})," Kommende Events"]}),s.jsxs("button",{className:"btn-link",onClick:()=>x("events"),children:["Alle anzeigen ",s.jsx(U,{size:14})]})]}),s.jsx("div",{className:"panel-content",children:k.length>0?s.jsx("div",{className:"event-list",children:k.map(e=>s.jsxs("div",{className:"event-item",children:[s.jsxs("div",{className:"event-date",children:[s.jsx("span",{className:"date-day",children:new Date(e.datum).getDate()}),s.jsx("span",{className:"date-month",children:new Date(e.datum).toLocaleDateString("de-DE",{month:"short"})})]}),s.jsxs("div",{className:"event-info",children:[s.jsx("span",{className:"event-title",children:e.titel}),s.jsx("span",{className:"event-location",children:e.ort||"Online"})]})]},e.id))}):s.jsxs("div",{className:"empty-state",children:[s.jsx(v,{size:32}),s.jsx("p",{children:"Keine kommenden Events"})]})})]})]}),s.jsxs("div",{className:"verband-quick-actions",children:[s.jsx("h3",{children:"Schnellzugriff"}),s.jsxs("div",{className:"quick-action-grid",children:[s.jsxs("button",{className:"quick-action-btn",onClick:()=>x("mitglieder"),children:[s.jsx(se,{size:24}),s.jsx("span",{children:"Neues Mitglied"})]}),s.jsxs("button",{className:"quick-action-btn",onClick:()=>window.open("https://events.tda-intl.org","_blank"),children:[s.jsx(Q,{size:24}),s.jsx("span",{children:"Turnier erstellen"})]}),s.jsxs("button",{className:"quick-action-btn",onClick:()=>x("finanzen"),children:[s.jsx(y,{size:24}),s.jsx("span",{children:"BeitrÃ¤ge verwalten"})]}),s.jsxs("button",{className:"quick-action-btn",onClick:()=>window.open("https://www.tda-intl.com","_blank"),children:[s.jsx(J,{size:24}),s.jsx("span",{children:"Verbandswebsite"})]})]})]})]}),I=()=>s.jsxs("div",{className:"verband-turniere",children:[s.jsxs("div",{className:"info-banner",children:[s.jsx(Q,{size:24}),s.jsxs("div",{children:[s.jsx("h4",{children:"Turnierverwaltung"}),s.jsx("p",{children:"Die Turniere werden Ã¼ber die separate Turniersoftware verwaltet."}),s.jsxs("a",{href:"https://events.tda-intl.org",target:"_blank",rel:"noopener noreferrer",className:"btn-primary",children:["Zur Turniersoftware ",s.jsx(U,{size:16})]})]})]}),s.jsx("div",{className:"verband-stats-grid",style:{marginTop:"2rem"},children:s.jsxs("div",{className:"verband-stat-card gold",children:[s.jsx("div",{className:"stat-icon",children:s.jsx(Q,{size:24})}),s.jsxs("div",{className:"stat-content",children:[s.jsx("span",{className:"stat-value",children:g.turniere}),s.jsx("span",{className:"stat-label",children:"Turniere gesamt"})]})]})})]}),T=()=>s.jsxs("div",{className:"verband-events",children:[s.jsxs("div",{className:"panel-header",children:[s.jsxs("h3",{children:[s.jsx(v,{size:20})," Verbands-Events"]}),s.jsxs("button",{className:"btn-secondary",children:[s.jsx(te,{size:16})," Event erstellen"]})]}),k.length>0?s.jsx("div",{className:"events-list-full",children:k.map(e=>s.jsxs("div",{className:"event-card",children:[s.jsxs("div",{className:"event-card-date",children:[s.jsx("span",{className:"date-day",children:new Date(e.datum).getDate()}),s.jsx("span",{className:"date-month",children:new Date(e.datum).toLocaleDateString("de-DE",{month:"long"})}),s.jsx("span",{className:"date-year",children:new Date(e.datum).getFullYear()})]}),s.jsxs("div",{className:"event-card-content",children:[s.jsx("h4",{children:e.titel}),s.jsx("p",{children:e.beschreibung}),s.jsx("div",{className:"event-meta",children:s.jsxs("span",{children:[s.jsx(v,{size:14})," ",e.ort||"Online"]})})]})]},e.id))}):s.jsxs("div",{className:"empty-state large",children:[s.jsx(v,{size:48}),s.jsx("h4",{children:"Keine Events geplant"}),s.jsx("p",{children:"Erstellen Sie neue Events fÃ¼r den Verband."})]})]}),D=()=>s.jsxs("div",{className:"verband-finanzen",children:[s.jsxs("div",{className:"verband-stats-grid",children:[s.jsxs("div",{className:"verband-stat-card success",children:[s.jsx("div",{className:"stat-icon",children:s.jsx(c,{size:24})}),s.jsxs("div",{className:"stat-content",children:[s.jsxs("span",{className:"stat-value",children:[g.jahresbeitraege.toLocaleString("de-DE"),"â‚¬"]}),s.jsx("span",{className:"stat-label",children:"Eingegangene BeitrÃ¤ge"})]})]}),s.jsxs("div",{className:"verband-stat-card warning",children:[s.jsx("div",{className:"stat-icon",children:s.jsx(h,{size:24})}),s.jsxs("div",{className:"stat-content",children:[s.jsxs("span",{className:"stat-value",children:[g.offeneBeitraege.toLocaleString("de-DE"),"â‚¬"]}),s.jsx("span",{className:"stat-label",children:"Offene BeitrÃ¤ge"})]})]}),s.jsxs("div",{className:"verband-stat-card info",children:[s.jsx("div",{className:"stat-icon",children:s.jsx(f,{size:24})}),s.jsxs("div",{className:"stat-content",children:[s.jsxs("span",{className:"stat-value",children:[99*g.mitgliedsschulen+49*g.einzelmitglieder,"â‚¬"]}),s.jsx("span",{className:"stat-label",children:"Erwartete JahresbeitrÃ¤ge"})]})]})]}),s.jsxs("div",{className:"info-banner",style:{marginTop:"2rem"},children:[s.jsx(ne,{size:24}),s.jsxs("div",{children:[s.jsx("h4",{children:"Beitragsstruktur"}),s.jsxs("p",{children:[s.jsx("strong",{children:"Mitgliedsschulen (Dojos):"})," 99â‚¬ pro Jahr",s.jsx("br",{}),s.jsx("strong",{children:"Einzelmitglieder:"})," 49â‚¬ pro Jahr"]})]})]})]});return l?s.jsx("div",{className:"verband-dashboard loading",children:s.jsxs("div",{className:"loading-spinner",children:[s.jsx(M,{size:40,className:"spin"}),s.jsx("p",{children:"Lade Verbandsdaten..."})]})}):s.jsxs("div",{className:"verband-dashboard",children:[s.jsxs("div",{className:"verband-subheader",children:[s.jsxs("div",{className:"subheader-left",children:[s.jsx(J,{size:20,className:"subheader-icon"}),s.jsx("span",{children:"Verbandsverwaltung"})]}),s.jsxs("button",{className:"btn-refresh-small",onClick:C,children:[s.jsx(a,{size:14})," Aktualisieren"]})]}),o&&s.jsxs("div",{className:"error-banner",children:[s.jsx(h,{size:20}),s.jsx("span",{children:o})]}),s.jsx("div",{className:"verband-tabs",children:S.map(e=>s.jsxs("button",{className:"verband-tab "+(p===e.id?"active":""),onClick:()=>x(e.id),children:[s.jsx(e.icon,{size:18}),s.jsx("span",{children:e.label})]},e.id))}),s.jsxs("div",{className:"verband-tab-content",children:["overview"===p&&s.jsx(B,{}),"mitglieder"===p&&s.jsx(re,{}),"shop"===p&&s.jsx(ce,{}),"entwicklung"===p&&s.jsx(ie,{bereich:"verband"}),"support"===p&&s.jsx(ae,{bereich:"verband"}),"turniere"===p&&s.jsx(I,{}),"events"===p&&s.jsx(T,{}),"finanzen"===p&&s.jsx(D,{})]})]})},ue=Object.freeze(Object.defineProperty({__proto__:null,default:he},Symbol.toStringTag,{value:"Module"}));export{re as V,he as a,ue as b};
