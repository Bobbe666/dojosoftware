import{a as e,j as s}from"./query-Caj74EYQ.js";import{b as n,a,c as i}from"./index-B0gO-Ppw.js";import{j as r}from"./index-CkXcCt97.js";/* empty css               */import"./vendor-router-B2AaIOtG.js";import"./icons-eh0tbLFx.js";import"./charts-QHQg_ypW.js";const l=()=>{const{token:l}=n(),[d,t]=e.useState([]),[c,o]=e.useState([]),[m,h]=e.useState(!1),[x,v]=e.useState(""),[g,j]=e.useState(""),[u,b]=e.useState(null),[p,N]=e.useState(!1),[f,y]=e.useState(null),[_,w]=e.useState(!1),[z,k]=e.useState("");e.useEffect(()=>{if(l)try{const e=r(l);e.mitglied_id&&b(e.mitglied_id)}catch(e){console.error("Fehler beim Dekodieren des Tokens:",e)}},[l]);const A=e.useCallback(async()=>{if(l){h(!0),v("");try{const e=await a.get(`${i.apiBaseUrl}/events?upcoming=true&status=anmeldung_offen`,{headers:{Authorization:`Bearer ${l}`}});t(e.data)}catch(e){console.error("Fehler beim Laden der Events:",e),v("Fehler beim Laden der Events: "+e.message)}finally{h(!1)}}},[l]),$=e.useCallback(async()=>{if(l&&u)try{const e=await a.get(`${i.apiBaseUrl}/events/mitglied/${u}`,{headers:{Authorization:`Bearer ${l}`}});o(e.data)}catch(e){console.error("Fehler beim Laden meiner Events:",e)}},[l,u]);e.useEffect(()=>{l&&u&&(A(),$())},[l,u,A,$]);const B=e=>{y(e),N(!0)},C=e=>e?new Date(e).toLocaleDateString("de-DE",{weekday:"long",day:"2-digit",month:"long",year:"numeric"}):"",E=e=>e?e.substring(0,5):"",F=e=>({Turnier:"badge-danger",Lehrgang:"badge-info","PrÃ¼fung":"badge-warning",Seminar:"badge-success",Workshop:"badge-primary",Feier:"badge-special",Sonstiges:"badge-secondary"}[e]||"badge-secondary"),S=e=>({angemeldet:"Angemeldet",bestaetigt:"BestÃ¤tigt",abgesagt:"Abgesagt",teilgenommen:"Teilgenommen",nicht_erschienen:"Nicht erschienen"}[e]||e);return s.jsxs("div",{className:"events-container",children:[s.jsxs("div",{className:"page-header",children:[s.jsx("h1",{className:"page-title",children:"Meine Events"}),s.jsx("p",{className:"page-subtitle",children:"Veranstaltungen und Anmeldungen"})]}),s.jsxs("div",{className:"events-content",children:[x&&s.jsxs("div",{className:"error-message",style:{marginBottom:"1rem"},children:["âš ï¸ ",x]}),g&&s.jsxs("div",{className:"success-message",style:{marginBottom:"1rem",background:"rgba(25, 135, 84, 0.1)",border:"1px solid rgba(25, 135, 84, 0.3)",borderRadius:"8px",padding:"1rem",color:"#75d175",display:"flex",alignItems:"center",gap:"0.5rem"},children:["âœ… ",g]}),s.jsxs("div",{className:"glass-card",style:{marginBottom:"2rem"},children:[s.jsx("div",{className:"card-header",children:s.jsx("h2",{children:"Meine Anmeldungen"})}),s.jsx("div",{className:"card-body",children:0===c.length?s.jsxs("div",{className:"empty-state",children:[s.jsx("div",{className:"empty-icon",children:"ğŸ“…"}),s.jsx("h3",{children:"Keine Anmeldungen"}),s.jsx("p",{children:"Sie sind momentan fÃ¼r keine Events angemeldet."})]}):s.jsx("div",{className:"events-list",children:c.map(e=>{return s.jsxs("div",{className:"event-card",children:[s.jsx("div",{className:"event-card-header",children:s.jsxs("div",{className:"event-title-section",children:[s.jsx("h3",{children:e.titel}),s.jsxs("div",{className:"event-badges",children:[s.jsx("span",{className:`badge ${F(e.event_typ)}`,children:e.event_typ}),s.jsx("span",{className:`badge ${n=e.anmeldung_status,{angemeldet:"badge-success",bestaetigt:"badge-info",abgesagt:"badge-danger",teilgenommen:"badge-success",nicht_erschienen:"badge-dark"}[n]||"badge-secondary"}`,children:S(e.anmeldung_status)}),e.bezahlt&&s.jsx("span",{className:"badge badge-success",children:"âœ… Bezahlt"})]})]})}),s.jsxs("div",{className:"event-card-body",children:[s.jsxs("div",{className:"event-info-row",children:[s.jsx("span",{className:"event-icon",children:"ğŸ“…"}),s.jsx("span",{children:C(e.datum)})]}),e.uhrzeit_beginn&&s.jsxs("div",{className:"event-info-row",children:[s.jsx("span",{className:"event-icon",children:"ğŸ•"}),s.jsxs("span",{children:[E(e.uhrzeit_beginn),e.uhrzeit_ende&&` - ${E(e.uhrzeit_ende)}`]})]}),e.ort&&s.jsxs("div",{className:"event-info-row",children:[s.jsx("span",{className:"event-icon",children:"ğŸ“"}),s.jsx("span",{children:e.ort})]}),e.raum_name&&s.jsxs("div",{className:"event-info-row",children:[s.jsx("span",{className:"event-icon",children:"ğŸšª"}),s.jsxs("span",{children:["Raum: ",e.raum_name]})]}),e.teilnahmegebuehr>0&&s.jsxs("div",{className:"event-info-row",children:[s.jsx("span",{className:"event-icon",children:"ğŸ’°"}),s.jsxs("span",{children:[parseFloat(e.teilnahmegebuehr).toFixed(2)," â‚¬"]})]}),s.jsxs("div",{className:"event-info-row",children:[s.jsx("span",{className:"event-icon",children:"ğŸ“"}),s.jsxs("span",{children:["Angemeldet am: ",C(e.anmeldedatum)]})]})]}),s.jsxs("div",{className:"event-card-footer",style:{justifyContent:"space-between"},children:[s.jsx("button",{className:"btn btn-secondary",onClick:()=>B(e),children:"Details anzeigen"}),["angemeldet","bestaetigt"].includes(e.anmeldung_status)&&s.jsx("button",{className:"btn btn-secondary",onClick:()=>(async e=>{var s,n;if(window.confirm("MÃ¶chten Sie sich wirklich von diesem Event abmelden?")){v(""),j("");try{await a.post(`${i.apiBaseUrl}/events/${e}/abmelden`,{mitglied_id:u},{headers:{Authorization:`Bearer ${l}`}}),j("Sie wurden erfolgreich abgemeldet!"),A(),$(),setTimeout(()=>j(""),5e3)}catch(r){console.error("Fehler bei der Abmeldung:",r),v((null==(n=null==(s=r.response)?void 0:s.data)?void 0:n.error)||"Fehler bei der Abmeldung")}}})(e.event_id),style:{background:"rgba(220, 53, 69, 0.2)",borderColor:"rgba(220, 53, 69, 0.3)",color:"#ea868f"},children:"Abmelden"})]})]},e.event_id);var n})})})]}),s.jsxs("div",{className:"glass-card",children:[s.jsx("div",{className:"card-header",children:s.jsx("h2",{children:"VerfÃ¼gbare Events"})}),s.jsx("div",{className:"card-body",children:m?s.jsx("div",{className:"loading-state",children:s.jsx("p",{children:"Lade Events..."})}):0===d.length?s.jsxs("div",{className:"empty-state",children:[s.jsx("div",{className:"empty-icon",children:"ğŸ“…"}),s.jsx("h3",{children:"Keine Events verfÃ¼gbar"}),s.jsx("p",{children:"Momentan sind keine Events zur Anmeldung verfÃ¼gbar."})]}):s.jsx("div",{className:"events-list",children:d.map(e=>{const n=(a=e.event_id,c.some(e=>e.event_id===a&&["angemeldet","bestaetigt"].includes(e.anmeldung_status)));var a;const i=!!(r=e.anmeldefrist)&&new Date(r)<new Date;var r;const l=e.ist_ausgebucht;return s.jsxs("div",{className:"event-card",children:[s.jsx("div",{className:"event-card-header",children:s.jsxs("div",{className:"event-title-section",children:[s.jsx("h3",{children:e.titel}),s.jsxs("div",{className:"event-badges",children:[s.jsx("span",{className:`badge ${F(e.event_typ)}`,children:e.event_typ}),l&&s.jsx("span",{className:"badge badge-danger",children:"Ausgebucht"}),n&&s.jsx("span",{className:"badge badge-success",children:"âœ“ Angemeldet"})]})]})}),s.jsxs("div",{className:"event-card-body",children:[s.jsxs("div",{className:"event-info-row",children:[s.jsx("span",{className:"event-icon",children:"ğŸ“…"}),s.jsx("span",{children:C(e.datum)})]}),e.uhrzeit_beginn&&s.jsxs("div",{className:"event-info-row",children:[s.jsx("span",{className:"event-icon",children:"ğŸ•"}),s.jsxs("span",{children:[E(e.uhrzeit_beginn),e.uhrzeit_ende&&` - ${E(e.uhrzeit_ende)}`]})]}),e.ort&&s.jsxs("div",{className:"event-info-row",children:[s.jsx("span",{className:"event-icon",children:"ğŸ“"}),s.jsx("span",{children:e.ort})]}),e.max_teilnehmer&&s.jsxs("div",{className:"event-info-row",children:[s.jsx("span",{className:"event-icon",children:"ğŸ‘¥"}),s.jsxs("span",{children:[e.anzahl_anmeldungen||0," / ",e.max_teilnehmer," Teilnehmer",null!==e.verfuegbare_plaetze&&s.jsxs("span",{className:0===e.verfuegbare_plaetze?"text-danger":"text-success",children:[" ","(",e.verfuegbare_plaetze," PlÃ¤tze frei)"]})]})]}),e.teilnahmegebuehr>0&&s.jsxs("div",{className:"event-info-row",children:[s.jsx("span",{className:"event-icon",children:"ğŸ’°"}),s.jsxs("span",{children:[parseFloat(e.teilnahmegebuehr).toFixed(2)," â‚¬"]})]}),e.anmeldefrist&&s.jsxs("div",{className:"event-info-row",children:[s.jsx("span",{className:"event-icon",children:"â°"}),s.jsxs("span",{className:i?"text-danger":"",children:["Anmeldefrist: ",C(e.anmeldefrist),i&&" (abgelaufen)"]})]}),e.beschreibung&&s.jsx("div",{className:"event-description",children:s.jsx("p",{children:e.beschreibung})})]}),s.jsxs("div",{className:"event-card-footer",style:{justifyContent:"space-between"},children:[s.jsx("button",{className:"btn btn-secondary",onClick:()=>B(e),children:"Details anzeigen"}),!n&&!l&&!i&&s.jsx("button",{className:"btn btn-primary",onClick:()=>(e=>{y(e),k(""),w(!0)})(e),children:"Jetzt anmelden"})]})]},e.event_id)})})})]})]}),_&&f&&s.jsx("div",{className:"modal-overlay",onClick:()=>w(!1),children:s.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Event-Anmeldung"}),s.jsx("button",{className:"modal-close",onClick:()=>w(!1),children:"âœ•"})]}),s.jsxs("div",{className:"modal-body",children:[s.jsxs("div",{style:{marginBottom:"2rem"},children:[s.jsx("h3",{style:{color:"var(--farbe-hauptfarbe)",marginBottom:"1rem"},children:f.titel}),s.jsxs("div",{className:"event-info-row",children:[s.jsx("span",{className:"event-icon",children:"ğŸ“…"}),s.jsx("span",{children:C(f.datum)})]}),f.uhrzeit_beginn&&s.jsxs("div",{className:"event-info-row",children:[s.jsx("span",{className:"event-icon",children:"ğŸ•"}),s.jsxs("span",{children:[E(f.uhrzeit_beginn),f.uhrzeit_ende&&` - ${E(f.uhrzeit_ende)}`]})]}),f.teilnahmegebuehr>0&&s.jsxs("div",{className:"event-info-row",children:[s.jsx("span",{className:"event-icon",children:"ğŸ’°"}),s.jsxs("span",{children:[parseFloat(f.teilnahmegebuehr).toFixed(2)," â‚¬"]})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Bemerkung (optional)"}),s.jsx("textarea",{value:z,onChange:e=>k(e.target.value),rows:"3",placeholder:"z.B. Besondere Anforderungen, ErnÃ¤hrungshinweise, etc.",style:{background:"rgba(0, 0, 0, 0.3)",border:"1px solid rgba(255, 215, 0, 0.2)",borderRadius:"8px",padding:"0.75rem",color:"var(--farbe-text)",width:"100%",resize:"vertical",fontFamily:"inherit"}})]})]}),s.jsxs("div",{className:"modal-footer",children:[s.jsx("button",{className:"btn btn-secondary",onClick:()=>w(!1),children:"Abbrechen"}),s.jsx("button",{className:"btn btn-primary",onClick:async()=>{var e,s;if(u&&f){v(""),j("");try{await a.post(`${i.apiBaseUrl}/events/${f.event_id}/anmelden`,{mitglied_id:u,bemerkung:z},{headers:{Authorization:`Bearer ${l}`}}),j("Sie wurden erfolgreich fÃ¼r das Event angemeldet!"),w(!1),k(""),A(),$(),setTimeout(()=>j(""),5e3)}catch(n){console.error("Fehler bei der Anmeldung:",n),v((null==(s=null==(e=n.response)?void 0:e.data)?void 0:s.error)||"Fehler bei der Anmeldung")}}},children:"Verbindlich anmelden"})]})]})}),p&&f&&s.jsx("div",{className:"modal-overlay",onClick:()=>N(!1),children:s.jsxs("div",{className:"modal-content modal-large",onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:f.titel}),s.jsx("button",{className:"modal-close",onClick:()=>N(!1),children:"âœ•"})]}),s.jsx("div",{className:"modal-body",children:s.jsxs("div",{className:"details-section",children:[s.jsx("h3",{children:"Event-Informationen"}),s.jsxs("div",{className:"details-info",children:[s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:"Typ:"}),s.jsx("span",{className:`badge ${F(f.event_typ)}`,children:f.event_typ})]}),s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:"Datum:"}),s.jsx("span",{children:C(f.datum)})]}),f.uhrzeit_beginn&&s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:"Uhrzeit:"}),s.jsxs("span",{children:[E(f.uhrzeit_beginn),f.uhrzeit_ende&&` - ${E(f.uhrzeit_ende)}`]})]}),f.ort&&s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:"Ort:"}),s.jsx("span",{children:f.ort})]}),f.raum_name&&s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:"Raum:"}),s.jsx("span",{children:f.raum_name})]}),f.max_teilnehmer&&s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:"Teilnehmer:"}),s.jsxs("span",{children:[f.anzahl_anmeldungen||0," / ",f.max_teilnehmer,null!==f.verfuegbare_plaetze&&s.jsxs("span",{className:0===f.verfuegbare_plaetze?"text-danger":"text-success",children:[" ","(",f.verfuegbare_plaetze," PlÃ¤tze frei)"]})]})]}),f.teilnahmegebuehr>0&&s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:"GebÃ¼hr:"}),s.jsxs("span",{children:[parseFloat(f.teilnahmegebuehr).toFixed(2)," â‚¬"]})]}),f.anmeldefrist&&s.jsxs("div",{className:"info-row",children:[s.jsx("span",{className:"info-label",children:"Anmeldefrist:"}),s.jsx("span",{children:C(f.anmeldefrist)})]})]}),f.beschreibung&&s.jsxs("div",{className:"details-description",children:[s.jsx("h4",{children:"Beschreibung"}),s.jsx("p",{children:f.beschreibung})]}),f.anforderungen&&s.jsxs("div",{className:"details-description",children:[s.jsx("h4",{children:"Anforderungen / Voraussetzungen"}),s.jsx("p",{children:f.anforderungen})]})]})}),s.jsx("div",{className:"modal-footer",children:s.jsx("button",{className:"btn btn-secondary",onClick:()=>N(!1),children:"SchlieÃŸen"})})]})})]})};export{l as default};
