import{j as e}from"./animation-1wuIdCBS.js";import{r as s,u as n}from"./vendor-router-BhMXg4Z-.js";import{u as t,a,c as i}from"./index-DUnH23_2.js";import{R as l,A as r,P as d,x as o,U as c,u as h,T as u,aJ as p,c as x,aK as g,C as m,v as j,F as b,N as v,ay as f,b as y,$ as k,Y as z,aL as N,aM as _,M as S,a0 as C,_ as w,w as B,aC as I,d as T,aN as D,K as F,q as A,aO as L,k as M,ap as R,aH as E,e as P,aP as W,aQ as G,aR as V,a3 as $,aS as K,a4 as O,aT as H,an as U,G as J,z as Z,o as q,n as X,O as Y,a5 as Q,g as ee,l as se,r as ne,ak as te}from"./icons-D7rg4pDH.js";import{Z as ae}from"./ZieleEntwicklung-BfEKqiTa.js";import ie from"./SupportTickets-HJX-q22-.js";import"./vendor-react-DtuzQOD1.js";import"./query-Bs1dTGah.js";/* empty css                         *//* empty css                       */const le=()=>{var n,i,L,M;const{token:R,user:E}=t(),P="admin"===(null==E?void 0:E.rolle)||"admin"===(null==E?void 0:E.role),[W,G]=s.useState("dojos"),[V,$]=s.useState([]),[K,O]=s.useState([]),[H,U]=s.useState({}),[J,Z]=s.useState(!0),[q,X]=s.useState(""),[Y,Q]=s.useState(""),[ee,se]=s.useState(""),[ne,te]=s.useState([]),[ae,ie]=s.useState(!1),[le,de]=s.useState("preise"),[oe,ce]=s.useState({}),[he,ue]=s.useState(!1),[pe,xe]=s.useState({}),[ge,me]=s.useState(!1),[je,be]=s.useState(!1),[ve,fe]=s.useState(!1),[ye,ke]=s.useState(!1),[ze,Ne]=s.useState(!1),[_e,Se]=s.useState(null),[Ce,we]=s.useState([]),[Be,Ie]=s.useState("info"),[Te,De]=s.useState({iban:"",bic:"",kontoinhaber:""}),[Fe,Ae]=s.useState([]),[Le,Me]=s.useState([]),[Re,Ee]=s.useState(null),Pe=s.useRef(null),[We,Ge]=s.useState(!1),[Ve,$e]=s.useState(null),[Ke,Oe]=s.useState({agb:!1,dsgvo:!1,widerruf:!1}),[He,Ue]=s.useState({typ:"dojo",dojo_id:"",neues_dojo:!1,neues_dojo_name:"",neues_dojo_inhaber:"",neues_dojo_email:"",neues_dojo_strasse:"",neues_dojo_plz:"",neues_dojo_ort:"",neues_dojo_land:"Deutschland",person_vorname:"",person_nachname:"",person_email:"",person_telefon:"",person_strasse:"",person_plz:"",person_ort:"",person_land:"Deutschland",person_geburtsdatum:"",zahlungsart:"rechnung",notizen:""}),Je=a.create({baseURL:"/api",headers:{Authorization:`Bearer ${R}`}}),Ze=async()=>{Z(!0),X("");try{const[e,s,n]=await Promise.all([Je.get("/verbandsmitgliedschaften"),Je.get("/verbandsmitgliedschaften/stats"),Je.get("/verbandsmitgliedschaften/vorteile/liste")]);$(e.data),U(s.data),O(n.data)}catch(e){console.error("Fehler beim Laden:",e),X("Fehler beim Laden der Daten")}finally{Z(!1)}},qe=async()=>{ie(!0);try{const e=await Je.get("/verbandsmitgliedschaften/einstellungen/alle");te(e.data),ce({})}catch(e){console.error("Fehler beim Laden der Einstellungen:",e)}finally{ie(!1)}},Xe=async()=>{try{const e=await Je.get("/verbandsmitgliedschaften/einstellungen-config");xe(e.data)}catch(e){console.error("Fehler beim Laden der Konfiguration:",e)}},Ye=(e,s)=>{ce(n=>({...n,[e]:s}))},Qe=e=>{if(oe.hasOwnProperty(e))return oe[e];const s=ne.find(s=>s.einstellung_key===e);return(null==s?void 0:s.einstellung_value)??""};s.useEffect(()=>{Ze(),Xe()},[]),s.useEffect(()=>{ge&&"dojo"===He.typ&&(async()=>{try{const e=await Je.get("/verbandsmitgliedschaften/dojos-ohne-mitgliedschaft");we(e.data)}catch(e){console.error("Fehler beim Laden der Dojos:",e)}})()},[ge,He.typ]),s.useEffect(()=>{(ve||ze)&&setTimeout(()=>ts(),100)},[ve,ze]),s.useEffect(()=>{"einstellungen"===W&&qe()},[W]);const es=()=>{Ue({typ:"dojo",dojo_id:"",neues_dojo:!1,neues_dojo_name:"",neues_dojo_inhaber:"",neues_dojo_email:"",neues_dojo_strasse:"",neues_dojo_plz:"",neues_dojo_ort:"",neues_dojo_land:"Deutschland",person_vorname:"",person_nachname:"",person_email:"",person_telefon:"",person_strasse:"",person_plz:"",person_ort:"",person_land:"Deutschland",person_geburtsdatum:"",zahlungsart:"rechnung",notizen:""})},ss=async e=>{try{const s=await Je.get(`/verbandsmitgliedschaften/${e}/sepa`);Ae(s.data)}catch(s){console.error("Fehler beim Laden der SEPA-Mandate:",s)}},ns=async e=>{try{const s=await Je.get(`/verbandsmitgliedschaften/dokumente/${e}`);Ee(s.data),ke(!0)}catch(s){alert("Dokument nicht gefunden")}},ts=()=>{const e=Pe.current;if(!e)return;const s=e.getContext("2d");s.fillStyle="#fff",s.fillRect(0,0,e.width,e.height),s.strokeStyle="#000",s.lineWidth=2,s.lineCap="round"},as=e=>{var s,n,t,a;const i=Pe.current,l=i.getContext("2d"),r=i.getBoundingClientRect(),d=(e.clientX||(null==(n=null==(s=e.touches)?void 0:s[0])?void 0:n.clientX))-r.left,o=(e.clientY||(null==(a=null==(t=e.touches)?void 0:t[0])?void 0:a.clientY))-r.top;l.beginPath(),l.moveTo(d,o),Ge(!0)},is=e=>{var s,n,t,a;if(!We)return;const i=Pe.current,l=i.getContext("2d"),r=i.getBoundingClientRect(),d=(e.clientX||(null==(n=null==(s=e.touches)?void 0:s[0])?void 0:n.clientX))-r.left,o=(e.clientY||(null==(a=null==(t=e.touches)?void 0:t[0])?void 0:a.clientY))-r.top;l.lineTo(d,o),l.stroke()},ls=()=>{if(We){Ge(!1);const e=Pe.current;$e(e.toDataURL("image/png"))}},rs=()=>{ts(),$e(null)},ds=async e=>{try{const[s,n]=await Promise.all([Je.get(`/verbandsmitgliedschaften/${e.id}`),Je.get(`/verbandsmitgliedschaften/${e.id}/zahlungen`)]);Se({...s.data,zahlungen:n.data}),Ie("info"),ss(e.id),(async()=>{try{const e=await Je.get("/verbandsmitgliedschaften/dokumente/liste");Me(e.data)}catch(e){console.error("Fehler beim Laden der Dokumente:",e)}})(),be(!0)}catch(s){alert("Fehler beim Laden der Details")}},os=V.filter(e=>{var s;if("dojos"===W&&"dojo"!==e.typ)return!1;if("einzelpersonen"===W&&"einzelperson"!==e.typ)return!1;if(ee&&e.status!==ee)return!1;if(Y){const n=Y.toLowerCase();if(!("dojo"===e.typ?e.dojo_name||"":`${e.person_vorname||""} ${e.person_nachname||""}`).toLowerCase().includes(n)&&!(null==(s=e.mitgliedsnummer)?void 0:s.toLowerCase().includes(n)))return!1}return!0}),cs=s=>{const n={aktiv:{color:"#10b981",bg:"rgba(16, 185, 129, 0.15)",icon:z,label:"Aktiv"},ausstehend:{color:"#f59e0b",bg:"rgba(245, 158, 11, 0.15)",icon:A,label:"Ausstehend"},abgelaufen:{color:"#ef4444",bg:"rgba(239, 68, 68, 0.15)",icon:u,label:"Abgelaufen"},gekuendigt:{color:"#6b7280",bg:"rgba(107, 114, 128, 0.15)",icon:k,label:"Gekündigt"},vertragsfrei:{color:"#8b5cf6",bg:"rgba(139, 92, 246, 0.15)",icon:T,label:"Vertragsfrei"}},t=n[s]||n.ausstehend,a=t.icon;return e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"4px",padding:"4px 10px",borderRadius:"6px",background:t.bg,color:t.color,fontSize:"0.8rem",fontWeight:"600"},children:[e.jsx(a,{size:14}),t.label]})},hs=e=>e?new Date(e).toLocaleDateString("de-DE"):"-",us=e=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(e);return J?e.jsx("div",{style:re.container,children:e.jsxs("div",{style:re.loading,children:[e.jsx(l,{size:32,className:"spin"}),e.jsx("span",{children:"Lade Verbandsmitglieder..."})]})}):e.jsxs("div",{style:re.container,children:[e.jsxs("div",{style:re.header,children:[e.jsxs("div",{children:[e.jsxs("h1",{style:re.title,children:[e.jsx(r,{size:28,color:"#ffd700"}),"TDA Verbandsmitglieder"]}),e.jsx("p",{style:re.subtitle,children:"Dojo- und Einzelmitgliedschaften verwalten"})]}),e.jsxs("button",{style:re.primaryButton,onClick:()=>me(!0),children:[e.jsx(d,{size:18}),"Neue Mitgliedschaft"]})]}),e.jsxs("div",{style:re.statsGrid,children:[e.jsxs("div",{style:re.statCard,children:[e.jsx(o,{size:24,color:"#3b82f6"}),e.jsxs("div",{children:[e.jsx("div",{style:re.statValue,children:H.dojos||0}),e.jsx("div",{style:re.statLabel,children:"Dojo-Mitglieder"})]})]}),e.jsxs("div",{style:re.statCard,children:[e.jsx(c,{size:24,color:"#10b981"}),e.jsxs("div",{children:[e.jsx("div",{style:re.statValue,children:H.einzelpersonen||0}),e.jsx("div",{style:re.statLabel,children:"Einzelmitglieder"})]})]}),e.jsxs("div",{style:re.statCard,children:[e.jsx(h,{size:24,color:"#ffd700"}),e.jsxs("div",{children:[e.jsx("div",{style:re.statValue,children:us(H.jahresumsatz||0)}),e.jsx("div",{style:re.statLabel,children:"Jahresumsatz"})]})]}),e.jsxs("div",{style:re.statCard,children:[e.jsx(u,{size:24,color:"#f59e0b"}),e.jsxs("div",{children:[e.jsx("div",{style:re.statValue,children:H.auslaufend||0}),e.jsx("div",{style:re.statLabel,children:"Laufen aus (30 Tage)"})]})]})]}),e.jsxs("div",{style:re.tabs,children:[e.jsxs("button",{style:{...re.tab,..."dojos"===W?re.tabActive:{}},onClick:()=>G("dojos"),children:[e.jsx(o,{size:16}),"Dojos (",V.filter(e=>"dojo"===e.typ).length,")"]}),e.jsxs("button",{style:{...re.tab,..."einzelpersonen"===W?re.tabActive:{}},onClick:()=>G("einzelpersonen"),children:[e.jsx(c,{size:16}),"Einzelpersonen (",V.filter(e=>"einzelperson"===e.typ).length,")"]}),e.jsxs("button",{style:{...re.tab,..."vorteile"===W?re.tabActive:{}},onClick:()=>G("vorteile"),children:[e.jsx(p,{size:16}),"Vorteile & Rabatte"]}),e.jsxs("button",{style:{...re.tab,..."einstellungen"===W?re.tabActive:{}},onClick:()=>G("einstellungen"),children:[e.jsx(x,{size:16}),"Einstellungen"]})]}),"vorteile"===W&&e.jsxs("div",{style:re.vorteileContainer,children:[e.jsx("h3",{style:re.sectionTitle,children:"Mitgliedschaftsvorteile"}),e.jsx("div",{style:re.vorteileGrid,children:K.map(s=>e.jsxs("div",{style:re.vorteilCard,children:[e.jsxs("div",{style:re.vorteilHeader,children:[e.jsx(g,{size:20,color:"#ffd700"}),e.jsx("span",{style:re.vorteilTitel,children:s.titel})]}),e.jsx("p",{style:re.vorteilBeschreibung,children:s.beschreibung}),e.jsxs("div",{style:re.vorteilMeta,children:[e.jsxs("span",{style:re.vorteilRabatt,children:["prozent"===s.rabatt_typ?`${s.rabatt_wert}%`:us(s.rabatt_wert)," Rabatt"]}),e.jsx("span",{style:re.vorteilKategorie,children:s.kategorie}),e.jsx("span",{style:{...re.vorteilGilt,background:"dojo"===s.gilt_fuer?"rgba(59, 130, 246, 0.2)":"einzelperson"===s.gilt_fuer?"rgba(16, 185, 129, 0.2)":"rgba(255, 215, 0, 0.2)"},children:"beide"===s.gilt_fuer?"Alle":"dojo"===s.gilt_fuer?"Dojos":"Einzelpersonen"})]})]},s.id))})]}),"einstellungen"===W&&e.jsxs("div",{style:re.einstellungenContainer,children:[e.jsx("div",{style:re.einstellungenTabs,children:[{key:"preise",label:"Preise",icon:h},{key:"laufzeiten",label:"Laufzeiten",icon:m},{key:"zahlungen",label:"Zahlungen",icon:j},{key:"nummern",label:"Nummern",icon:b},{key:"verband",label:"Verband",icon:o}].map(({key:s,label:n,icon:t})=>e.jsxs("button",{style:{...re.einstellungenTab,...le===s?re.einstellungenTabActive:{}},onClick:()=>de(s),children:[e.jsx(t,{size:16}),n]},s))}),ae?e.jsxs("div",{style:re.loading,children:[e.jsx(l,{size:24,className:"spin"}),e.jsx("span",{children:"Lade Einstellungen..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{style:re.einstellungenGrid,children:ne.filter(e=>e.kategorie===le).map(s=>e.jsxs("div",{style:re.einstellungItem,children:[e.jsxs("label",{style:re.einstellungLabel,children:[s.label,s.beschreibung&&e.jsx("span",{style:re.einstellungHint,children:s.beschreibung})]}),"boolean"===s.einstellung_typ?e.jsxs("label",{style:re.toggleLabel,children:[e.jsx("input",{type:"checkbox",checked:!0===Qe(s.einstellung_key),onChange:e=>Ye(s.einstellung_key,e.target.checked),style:re.toggleInput}),e.jsx("span",{style:{...re.toggleSwitch,background:Qe(s.einstellung_key)?"#10b981":"#ef4444"},children:e.jsx("span",{style:{position:"absolute",top:"2px",left:"2px",width:"20px",height:"20px",background:"#fff",borderRadius:"50%",transition:"transform 0.2s",transform:Qe(s.einstellung_key)?"translateX(24px)":"translateX(0)"}})}),e.jsx("span",{style:{...re.toggleText,color:Qe(s.einstellung_key)?"#10b981":"#ef4444",fontWeight:"600"},children:Qe(s.einstellung_key)?"Aktiv":"Inaktiv"})]}):"number"===s.einstellung_typ?e.jsx("input",{type:"number",value:Qe(s.einstellung_key),onChange:e=>Ye(s.einstellung_key,parseFloat(e.target.value)||0),style:re.einstellungInput,step:s.einstellung_key.includes("preis")||s.einstellung_key.includes("mwst")?"0.01":"1"}):"json"===s.einstellung_typ?e.jsx("textarea",{value:"object"==typeof Qe(s.einstellung_key)?JSON.stringify(Qe(s.einstellung_key),null,2):Qe(s.einstellung_key),onChange:e=>{try{Ye(s.einstellung_key,JSON.parse(e.target.value))}catch{}},style:{...re.einstellungInput,minHeight:"80px",fontFamily:"monospace"}}):e.jsx("input",{type:"text",value:Qe(s.einstellung_key),onChange:e=>Ye(s.einstellung_key,e.target.value),style:re.einstellungInput}),oe.hasOwnProperty(s.einstellung_key)&&e.jsx("span",{style:re.changedBadge,children:"Geändert"})]},s.einstellung_key))}),Object.keys(oe).length>0&&e.jsxs("div",{style:re.einstellungenFooter,children:[e.jsxs("span",{style:re.changesCount,children:[Object.keys(oe).length," Änderung(en)"]}),e.jsx("button",{style:re.cancelButton,onClick:()=>{ce({}),qe()},children:"Verwerfen"}),e.jsx("button",{style:re.submitButton,onClick:async()=>{ue(!0);try{const e=Object.entries(oe).map(([e,s])=>({key:e,value:s}));if(0===e.length)return void alert("Keine Änderungen vorhanden");await Je.put("/verbandsmitgliedschaften/einstellungen",{einstellungen:e}),alert("Einstellungen gespeichert!"),ce({}),qe(),Xe()}catch(e){alert("Fehler beim Speichern")}finally{ue(!1)}},disabled:he,children:he?e.jsxs(e.Fragment,{children:[e.jsx(l,{size:16,className:"spin"})," Speichern..."]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{size:16})," Speichern"]})})]})]})]}),"vorteile"!==W&&"einstellungen"!==W&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:re.filterBar,children:[e.jsxs("div",{style:re.searchBox,children:[e.jsx(f,{size:18,color:"#888"}),e.jsx("input",{type:"text",placeholder:"Suchen...",value:Y,onChange:e=>Q(e.target.value),style:re.searchInput})]}),e.jsxs("select",{value:ee,onChange:e=>se(e.target.value),style:re.select,children:[e.jsx("option",{value:"",children:"Alle Status"}),e.jsx("option",{value:"aktiv",children:"Aktiv"}),e.jsx("option",{value:"ausstehend",children:"Ausstehend"}),e.jsx("option",{value:"abgelaufen",children:"Abgelaufen"}),e.jsx("option",{value:"gekuendigt",children:"Gekündigt"})]}),e.jsx("button",{style:re.iconButton,onClick:Ze,children:e.jsx(l,{size:18})})]}),e.jsx("div",{style:re.list,children:0===os.length?e.jsxs("div",{style:re.emptyState,children:[e.jsx(o,{size:48,color:"#666"}),e.jsx("p",{children:"Keine Mitgliedschaften gefunden"})]}):os.map(s=>e.jsxs("div",{style:re.listItem,onClick:()=>ds(s),children:[e.jsx("div",{style:re.listItemIcon,children:"dojo"===s.typ?e.jsx(o,{size:24,color:"#3b82f6"}):e.jsx(c,{size:24,color:"#10b981"})}),e.jsxs("div",{style:re.listItemContent,children:[e.jsxs("div",{style:re.listItemHeader,children:[e.jsx("span",{style:re.listItemName,children:"dojo"===s.typ?s.dojo_name:`${s.person_vorname} ${s.person_nachname}`}),cs(s.status)]}),e.jsxs("div",{style:re.listItemMeta,children:[e.jsxs("span",{children:[e.jsx(b,{size:12})," ",s.mitgliedsnummer]}),e.jsxs("span",{children:[e.jsx(m,{size:12})," Bis: ",hs(s.gueltig_bis)]}),e.jsxs("span",{children:[e.jsx(h,{size:12})," ",us(s.jahresbeitrag),"/Jahr"]})]})]}),e.jsx(y,{size:20,color:"#888"})]},s.id))})]}),ge&&e.jsx("div",{style:re.modalOverlay,onClick:()=>me(!1),children:e.jsxs("div",{style:re.modal,onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{style:re.modalHeader,children:[e.jsx("h2",{style:re.modalTitle,children:"Neue Mitgliedschaft"}),e.jsx("button",{style:re.closeButton,onClick:()=>me(!1),children:e.jsx(k,{size:20})})]}),e.jsxs("form",{onSubmit:async e=>{var s,n,t;if(e.preventDefault(),"dojo"===He.typ){if(!He.neues_dojo&&!He.dojo_id)return void alert("Bitte wähle ein Dojo aus oder lege ein neues an.");if(He.neues_dojo&&(!He.neues_dojo_name||!He.neues_dojo_email))return void alert("Bitte Dojo-Name und E-Mail ausfüllen.")}if("einzelperson"!==He.typ||He.person_vorname&&He.person_nachname&&He.person_email)try{let e={...He};if("dojo"===He.typ&&He.neues_dojo){const n=await Je.post("/admin/dojos",{dojoname:He.neues_dojo_name,inhaber:He.neues_dojo_inhaber,email:He.neues_dojo_email,strasse:He.neues_dojo_strasse,plz:He.neues_dojo_plz,ort:He.neues_dojo_ort,land:He.neues_dojo_land});e.dojo_id=n.data.id||(null==(s=n.data.dojo)?void 0:s.id),e.neues_dojo=!1}await Je.post("/verbandsmitgliedschaften",e),me(!1),es(),Ze()}catch(a){alert((null==(t=null==(n=a.response)?void 0:n.data)?void 0:t.error)||"Fehler beim Anlegen")}else alert("Bitte Vorname, Nachname und E-Mail ausfüllen.")},children:[e.jsxs("div",{style:re.typSelector,children:[e.jsxs("button",{type:"button",style:{...re.typButton,..."dojo"===He.typ?re.typButtonActive:{}},onClick:()=>Ue({...He,typ:"dojo"}),children:[e.jsx(o,{size:24}),e.jsx("span",{children:"Dojo"}),e.jsxs("span",{style:re.typPrice,children:[us(pe.preis_dojo_mitgliedschaft||99),"/Jahr"]})]}),e.jsxs("button",{type:"button",style:{...re.typButton,..."einzelperson"===He.typ?re.typButtonActiveGreen:{}},onClick:()=>Ue({...He,typ:"einzelperson"}),children:[e.jsx(c,{size:24}),e.jsx("span",{children:"Einzelperson"}),e.jsxs("span",{style:re.typPrice,children:[us(pe.preis_einzel_mitgliedschaft||49),"/Jahr"]})]})]}),"dojo"===He.typ&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:re.formGroup,children:[e.jsx("label",{style:re.label,children:"Dojo *"}),e.jsxs("select",{value:He.neues_dojo?"neu":He.dojo_id,onChange:e=>{"neu"===e.target.value?Ue({...He,neues_dojo:!0,dojo_id:""}):Ue({...He,neues_dojo:!1,dojo_id:e.target.value})},style:re.input,children:[e.jsx("option",{value:"",children:"-- Dojo wählen --"}),Ce.map(s=>e.jsxs("option",{value:s.id,children:[s.name," ",s.ort?`(${s.ort})`:""]},s.id)),e.jsx("option",{value:"neu",style:{fontWeight:"bold",borderTop:"1px solid #ccc"},children:"➕ Neues Dojo anlegen..."})]})]}),He.neues_dojo&&e.jsxs("div",{style:{...re.card,background:"rgba(255, 215, 0, 0.1)",marginBottom:"1rem"},children:[e.jsx("h4",{style:{margin:"0 0 1rem 0",color:"#ffd700"},children:"Neues Dojo anlegen"}),e.jsxs("div",{style:re.formRow,children:[e.jsxs("div",{style:re.formGroup,children:[e.jsx("label",{style:re.label,children:"Dojo-Name *"}),e.jsx("input",{type:"text",value:He.neues_dojo_name,onChange:e=>Ue({...He,neues_dojo_name:e.target.value}),style:re.input,placeholder:"z.B. Kampfsportschule Muster"})]}),e.jsxs("div",{style:re.formGroup,children:[e.jsx("label",{style:re.label,children:"Inhaber *"}),e.jsx("input",{type:"text",value:He.neues_dojo_inhaber,onChange:e=>Ue({...He,neues_dojo_inhaber:e.target.value}),style:re.input,placeholder:"Vor- und Nachname"})]})]}),e.jsxs("div",{style:re.formGroup,children:[e.jsx("label",{style:re.label,children:"E-Mail *"}),e.jsx("input",{type:"email",value:He.neues_dojo_email,onChange:e=>Ue({...He,neues_dojo_email:e.target.value}),style:re.input,placeholder:"info@dojo.de"})]}),e.jsxs("div",{style:re.formGroup,children:[e.jsx("label",{style:re.label,children:"Straße"}),e.jsx("input",{type:"text",value:He.neues_dojo_strasse,onChange:e=>Ue({...He,neues_dojo_strasse:e.target.value}),style:re.input,placeholder:"Musterstraße 123"})]}),e.jsxs("div",{style:re.formRow,children:[e.jsxs("div",{style:re.formGroup,children:[e.jsx("label",{style:re.label,children:"PLZ"}),e.jsx("input",{type:"text",value:He.neues_dojo_plz,onChange:e=>Ue({...He,neues_dojo_plz:e.target.value}),style:re.input,placeholder:"12345"})]}),e.jsxs("div",{style:re.formGroup,children:[e.jsx("label",{style:re.label,children:"Ort"}),e.jsx("input",{type:"text",value:He.neues_dojo_ort,onChange:e=>Ue({...He,neues_dojo_ort:e.target.value}),style:re.input,placeholder:"Musterstadt"})]}),e.jsxs("div",{style:re.formGroup,children:[e.jsx("label",{style:re.label,children:"Land"}),e.jsx("input",{type:"text",value:He.neues_dojo_land,onChange:e=>Ue({...He,neues_dojo_land:e.target.value}),style:re.input})]})]})]})]}),"einzelperson"===He.typ&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:re.formRow,children:[e.jsxs("div",{style:re.formGroup,children:[e.jsx("label",{style:re.label,children:"Vorname *"}),e.jsx("input",{type:"text",value:He.person_vorname,onChange:e=>Ue({...He,person_vorname:e.target.value}),style:re.input})]}),e.jsxs("div",{style:re.formGroup,children:[e.jsx("label",{style:re.label,children:"Nachname *"}),e.jsx("input",{type:"text",value:He.person_nachname,onChange:e=>Ue({...He,person_nachname:e.target.value}),style:re.input})]})]}),e.jsxs("div",{style:re.formGroup,children:[e.jsx("label",{style:re.label,children:"E-Mail *"}),e.jsx("input",{type:"email",value:He.person_email,onChange:e=>Ue({...He,person_email:e.target.value}),style:re.input})]}),e.jsxs("div",{style:re.formRow,children:[e.jsxs("div",{style:re.formGroup,children:[e.jsx("label",{style:re.label,children:"Telefon"}),e.jsx("input",{type:"tel",value:He.person_telefon,onChange:e=>Ue({...He,person_telefon:e.target.value}),style:re.input})]}),e.jsxs("div",{style:re.formGroup,children:[e.jsx("label",{style:re.label,children:"Geburtsdatum"}),e.jsx("input",{type:"date",value:He.person_geburtsdatum,onChange:e=>Ue({...He,person_geburtsdatum:e.target.value}),style:re.input})]})]}),e.jsxs("div",{style:re.formGroup,children:[e.jsx("label",{style:re.label,children:"Straße"}),e.jsx("input",{type:"text",value:He.person_strasse,onChange:e=>Ue({...He,person_strasse:e.target.value}),style:re.input})]}),e.jsxs("div",{style:re.formRow,children:[e.jsxs("div",{style:re.formGroup,children:[e.jsx("label",{style:re.label,children:"PLZ"}),e.jsx("input",{type:"text",value:He.person_plz,onChange:e=>Ue({...He,person_plz:e.target.value}),style:re.input})]}),e.jsxs("div",{style:re.formGroup,children:[e.jsx("label",{style:re.label,children:"Ort"}),e.jsx("input",{type:"text",value:He.person_ort,onChange:e=>Ue({...He,person_ort:e.target.value}),style:re.input})]})]})]}),e.jsxs("div",{style:re.formGroup,children:[e.jsx("label",{style:re.label,children:"Zahlungsart"}),e.jsxs("select",{value:He.zahlungsart,onChange:e=>Ue({...He,zahlungsart:e.target.value}),style:re.input,children:[e.jsx("option",{value:"rechnung",children:"Rechnung"}),e.jsx("option",{value:"lastschrift",children:"SEPA-Lastschrift"}),e.jsx("option",{value:"paypal",children:"PayPal"}),e.jsx("option",{value:"ueberweisung",children:"Überweisung"})]})]}),e.jsxs("div",{style:re.formGroup,children:[e.jsx("label",{style:re.label,children:"Notizen"}),e.jsx("textarea",{value:He.notizen,onChange:e=>Ue({...He,notizen:e.target.value}),style:{...re.input,minHeight:"80px"}})]}),e.jsxs("div",{style:re.modalFooter,children:[e.jsx("button",{type:"button",style:re.cancelButton,onClick:()=>me(!1),children:"Abbrechen"}),e.jsxs("button",{type:"submit",style:re.submitButton,children:[e.jsx(z,{size:18}),"Mitgliedschaft anlegen"]})]})]})]})}),je&&_e&&e.jsx("div",{style:re.modalOverlay,onClick:()=>be(!1),children:e.jsxs("div",{style:{...re.modal,maxWidth:"800px"},onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{style:re.modalHeader,children:[e.jsx("h2",{style:re.modalTitle,children:"dojo"===_e.typ?e.jsxs(e.Fragment,{children:[e.jsx(o,{size:24,color:"#3b82f6"})," ",_e.dojo_name]}):e.jsxs(e.Fragment,{children:[e.jsx(c,{size:24,color:"#10b981"})," ",_e.person_vorname," ",_e.person_nachname]})}),e.jsx("button",{style:re.closeButton,onClick:()=>be(!1),children:e.jsx(k,{size:20})})]}),e.jsxs("div",{style:re.detailTabs,children:[e.jsxs("button",{style:{...re.detailTab,..."info"===Be?re.detailTabActive:{}},onClick:()=>Ie("info"),children:[e.jsx(c,{size:16})," Info"]}),e.jsxs("button",{style:{...re.detailTab,..."vertrag"===Be?re.detailTabActive:{}},onClick:()=>Ie("vertrag"),children:[e.jsx(b,{size:16})," Vertrag"]}),e.jsxs("button",{style:{...re.detailTab,..."sepa"===Be?re.detailTabActive:{}},onClick:()=>Ie("sepa"),children:[e.jsx(N,{size:16})," SEPA"]}),e.jsxs("button",{style:{...re.detailTab,..."historie"===Be?re.detailTabActive:{}},onClick:()=>Ie("historie"),children:[e.jsx(_,{size:16})," Historie"]})]}),e.jsxs("div",{style:re.detailContent,children:["info"===Be&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:re.detailRow,children:[e.jsxs("div",{style:re.detailItem,children:[e.jsx("span",{style:re.detailLabel,children:"Mitgliedsnummer"}),e.jsx("span",{style:re.detailValue,children:_e.mitgliedsnummer})]}),e.jsxs("div",{style:re.detailItem,children:[e.jsx("span",{style:re.detailLabel,children:"Status"}),e.jsxs("select",{value:_e.status,onChange:e=>(async(e,s)=>{var n,t;try{if(await Je.put(`/verbandsmitgliedschaften/${e}/status`,{status:s}),Ze(),_e){const e=await Je.get(`/verbandsmitgliedschaften/${_e.id}`);Se(e.data)}}catch(a){alert((null==(t=null==(n=a.response)?void 0:n.data)?void 0:t.error)||"Fehler beim Status ändern")}})(_e.id,e.target.value),style:{padding:"6px 12px",borderRadius:"6px",border:"1px solid rgba(255,255,255,0.2)",background:"aktiv"===_e.status?"rgba(16, 185, 129, 0.2)":"ausstehend"===_e.status?"rgba(245, 158, 11, 0.2)":"vertragsfrei"===_e.status?"rgba(107, 114, 128, 0.2)":"rgba(239, 68, 68, 0.2)",color:"aktiv"===_e.status?"#10b981":"ausstehend"===_e.status?"#f59e0b":"vertragsfrei"===_e.status?"#6b7280":"#ef4444",fontWeight:"600",cursor:"pointer"},children:[e.jsx("option",{value:"ausstehend",children:"Ausstehend"}),e.jsx("option",{value:"aktiv",children:"Aktiv"}),e.jsx("option",{value:"gekuendigt",children:"Gekündigt"}),e.jsx("option",{value:"abgelaufen",children:"Abgelaufen"}),e.jsx("option",{value:"vertragsfrei",children:"Vertragsfrei"})]})]}),e.jsxs("div",{style:re.detailItem,children:[e.jsx("span",{style:re.detailLabel,children:"Vertrag"}),_e.unterschrift_digital?e.jsxs("span",{style:{color:"#10b981",display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(z,{size:14})," Unterschrieben"]}):e.jsxs("span",{style:{color:"#f59e0b",display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(u,{size:14})," Ausstehend"]})]})]}),e.jsxs("div",{style:re.detailRow,children:[e.jsxs("div",{style:re.detailItem,children:[e.jsx("span",{style:re.detailLabel,children:"Gültig von"}),e.jsx("span",{style:re.detailValue,children:hs(_e.gueltig_von)})]}),e.jsxs("div",{style:re.detailItem,children:[e.jsx("span",{style:re.detailLabel,children:"Gültig bis"}),e.jsx("span",{style:re.detailValue,children:hs(_e.gueltig_bis)})]}),e.jsxs("div",{style:re.detailItem,children:[e.jsx("span",{style:re.detailLabel,children:"Jahresbeitrag"}),e.jsx("span",{style:re.detailValue,children:us(_e.jahresbeitrag)})]})]}),"einzelperson"===_e.typ&&e.jsxs("div",{style:re.detailSection,children:[e.jsx("h4",{style:re.detailSectionTitle,children:"Kontaktdaten"}),e.jsxs("div",{style:re.detailRow,children:[e.jsxs("div",{style:re.detailItem,children:[e.jsx(S,{size:14}),e.jsx("span",{children:_e.person_email||"-"})]}),e.jsxs("div",{style:re.detailItem,children:[e.jsx(C,{size:14}),e.jsx("span",{children:_e.person_telefon||"-"})]})]}),_e.person_strasse&&e.jsxs("div",{style:re.detailItem,children:[e.jsx(w,{size:14}),e.jsxs("span",{children:[_e.person_strasse,", ",_e.person_plz," ",_e.person_ort]})]})]}),"vertragsfrei"!==_e.status&&e.jsxs("div",{style:re.detailSection,children:[e.jsx("h4",{style:re.detailSectionTitle,children:"Zahlungen"}),0===(null==(n=_e.zahlungen)?void 0:n.length)?e.jsx("p",{style:re.hint,children:"Keine Zahlungen vorhanden"}):e.jsx("div",{style:re.zahlungenList,children:null==(i=_e.zahlungen)?void 0:i.map(s=>e.jsxs("div",{style:re.zahlungItem,children:[e.jsxs("div",{style:re.zahlungMain,children:[e.jsx("span",{style:re.zahlungNummer,children:s.rechnungsnummer}),e.jsx("span",{style:re.zahlungBetrag,children:us(s.betrag_brutto)}),e.jsx("span",{style:{...re.zahlungStatus,color:"bezahlt"===s.status?"#10b981":"offen"===s.status?"#f59e0b":"#ef4444"},children:"bezahlt"===s.status?"Bezahlt":"offen"===s.status?"Offen":s.status})]}),e.jsxs("div",{style:re.zahlungMeta,children:[e.jsxs("span",{children:["Fällig: ",hs(s.faellig_am)]}),s.bezahlt_am&&e.jsxs("span",{children:["Bezahlt: ",hs(s.bezahlt_am)]})]}),e.jsxs("div",{style:{display:"flex",gap:"8px",marginTop:"8px"},children:["offen"===s.status&&e.jsxs("button",{style:re.smallButton,onClick:()=>(async e=>{try{if(await Je.post(`/verbandsmitgliedschaften/zahlungen/${e}/bezahlt`),Ze(),_e){const e=await Je.get(`/verbandsmitgliedschaften/${_e.id}`);Se(e.data)}}catch(s){alert("Fehler beim Markieren als bezahlt")}})(s.id),children:[e.jsx(z,{size:14})," Als bezahlt markieren"]}),("offen"===s.status||"bezahlt"===s.status)&&e.jsxs("button",{style:{...re.smallButton,backgroundColor:"#ef4444",color:"#fff"},onClick:()=>(async e=>{if(window.confirm("Möchten Sie diese Zahlung wirklich stornieren?"))try{if(await Je.post(`/verbandsmitgliedschaften/zahlungen/${e}/stornieren`,{grund:"Manuelle Stornierung"}),Ze(),_e){const e=await Je.get(`/verbandsmitgliedschaften/${_e.id}`);Se(e.data)}}catch(s){alert("Fehler beim Stornieren der Zahlung")}})(s.id),children:[e.jsx(k,{size:14})," Stornieren"]}),e.jsxs("button",{style:{...re.smallButton,backgroundColor:"#3b82f6",color:"#fff"},onClick:()=>(async(e,s)=>{try{const n=(await a.get(`/verbandsmitgliedschaften/zahlungen/${e}/pdf`,{responseType:"blob"})).data,t=window.URL.createObjectURL(n),i=document.createElement("a");i.href=t,i.download=`Rechnung_${s||e}.pdf`,document.body.appendChild(i),i.click(),i.remove(),window.URL.revokeObjectURL(t)}catch(n){console.error("PDF Download Fehler:",n),alert("Fehler beim Download der Rechnung")}})(s.id,s.rechnungsnummer),children:[e.jsx(B,{size:14})," Rechnung PDF"]})]})]},s.id))})]}),_e.notizen&&e.jsxs("div",{style:re.detailSection,children:[e.jsx("h4",{style:re.detailSectionTitle,children:"Notizen"}),e.jsx("p",{style:re.notizen,children:_e.notizen})]})]}),"vertrag"===Be&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:re.vertragActions,children:[e.jsxs("button",{style:re.actionButton,onClick:()=>(async e=>{try{window.open(`/api/verbandsmitgliedschaften/${e}/pdf`,"_blank")}catch(s){alert("Fehler beim Download")}})(_e.id),children:[e.jsx(B,{size:18}),"Vertrag als PDF"]}),!_e.unterschrift_digital&&e.jsxs("button",{style:{...re.actionButton,...re.actionButtonPrimary},onClick:()=>Ne(!0),children:[e.jsx(I,{size:18}),"Jetzt unterschreiben"]})]}),e.jsxs("div",{style:re.vertragInfo,children:[e.jsx("h4",{style:re.detailSectionTitle,children:"Vertragsstatus"}),e.jsxs("div",{style:re.vertragStatusGrid,children:[e.jsxs("div",{style:re.vertragStatusItem,children:[e.jsx(T,{size:20,color:_e.agb_akzeptiert?"#10b981":"#666"}),e.jsx("span",{children:"AGB akzeptiert"}),_e.agb_akzeptiert?e.jsx(z,{size:16,color:"#10b981"}):e.jsx(k,{size:16,color:"#666"})]}),e.jsxs("div",{style:re.vertragStatusItem,children:[e.jsx(D,{size:20,color:_e.dsgvo_akzeptiert?"#10b981":"#666"}),e.jsx("span",{children:"DSGVO akzeptiert"}),_e.dsgvo_akzeptiert?e.jsx(z,{size:16,color:"#10b981"}):e.jsx(k,{size:16,color:"#666"})]}),e.jsxs("div",{style:re.vertragStatusItem,children:[e.jsx(b,{size:20,color:_e.widerrufsrecht_akzeptiert?"#10b981":"#666"}),e.jsx("span",{children:"Widerrufsbelehrung"}),_e.widerrufsrecht_akzeptiert?e.jsx(z,{size:16,color:"#10b981"}):e.jsx(k,{size:16,color:"#666"})]}),e.jsxs("div",{style:re.vertragStatusItem,children:[e.jsx(I,{size:20,color:_e.unterschrift_digital?"#10b981":"#666"}),e.jsx("span",{children:"Unterschrieben"}),_e.unterschrift_digital?e.jsx(z,{size:16,color:"#10b981"}):e.jsx(k,{size:16,color:"#666"})]})]}),_e.unterschrift_datum&&e.jsxs("p",{style:re.hint,children:["Unterschrieben am: ",hs(_e.unterschrift_datum)]})]}),e.jsxs("div",{style:re.detailSection,children:[e.jsx("h4",{style:re.detailSectionTitle,children:"Rechtliche Dokumente"}),e.jsxs("div",{style:re.dokumenteListe,children:[e.jsxs("button",{style:re.dokumentButton,onClick:()=>ns("agb"),children:[e.jsx(T,{size:16})," AGB ansehen"]}),e.jsxs("button",{style:re.dokumentButton,onClick:()=>ns("dsgvo"),children:[e.jsx(D,{size:16})," DSGVO ansehen"]}),e.jsxs("button",{style:re.dokumentButton,onClick:()=>ns("widerrufsbelehrung"),children:[e.jsx(b,{size:16})," Widerrufsbelehrung"]}),e.jsxs("button",{style:re.dokumentButton,onClick:()=>ns("beitragsordnung"),children:[e.jsx(h,{size:16})," Beitragsordnung"]})]})]})]}),"sepa"===Be&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:re.vertragActions,children:e.jsxs("button",{style:{...re.actionButton,...re.actionButtonPrimary},onClick:()=>fe(!0),children:[e.jsx(d,{size:18}),"Neues SEPA-Mandat"]})}),0===Fe.length?e.jsxs("div",{style:re.emptyState,children:[e.jsx(N,{size:48,color:"#666"}),e.jsx("p",{children:"Kein SEPA-Mandat vorhanden"}),e.jsx("p",{style:re.hint,children:"Mit einem SEPA-Mandat können Beiträge automatisch eingezogen werden."})]}):e.jsx("div",{style:re.sepaListe,children:Fe.map(s=>e.jsxs("div",{style:re.sepaItem,children:[e.jsxs("div",{style:re.sepaHeader,children:[e.jsx("span",{style:re.sepaMandatsref,children:s.mandatsreferenz}),e.jsx("span",{style:{...re.sepaStatus,background:"aktiv"===s.status?"rgba(16, 185, 129, 0.2)":"rgba(239, 68, 68, 0.2)",color:"aktiv"===s.status?"#10b981":"#ef4444"},children:"aktiv"===s.status?"Aktiv":"Inaktiv"})]}),e.jsxs("div",{style:re.sepaDetails,children:[e.jsxs("div",{children:[e.jsx("strong",{children:"IBAN:"})," ",s.iban]}),s.bic&&e.jsxs("div",{children:[e.jsx("strong",{children:"BIC:"})," ",s.bic]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Kontoinhaber:"})," ",s.kontoinhaber]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Erstellt:"})," ",hs(s.erstellt_am)]})]}),s.unterschrift_digital&&e.jsxs("div",{style:re.sepaSignedBadge,children:[e.jsx(z,{size:14})," Digital unterschrieben"]})]},s.id))})]}),"historie"===Be&&e.jsx(e.Fragment,{children:e.jsxs("div",{style:re.detailSection,children:[e.jsx("h4",{style:re.detailSectionTitle,children:"Vertragshistorie"}),e.jsx("div",{style:re.historieListe,children:(null==(L=_e.historie)?void 0:L.length)>0?_e.historie.map((s,n)=>e.jsxs("div",{style:re.historieItem,children:[e.jsx("div",{style:re.historieDatum,children:new Date(s.created_at).toLocaleString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}),e.jsx("div",{style:re.historieText,children:s.beschreibung})]},s.id||n)):e.jsx("p",{style:re.hint,children:"Noch keine Historie-Einträge vorhanden."})})]})})]}),e.jsxs("div",{style:re.modalFooter,children:[P&&"vertragsfrei"!==_e.status&&e.jsxs("button",{style:{...re.dangerButton,backgroundColor:"#7f1d1d"},onClick:()=>(async e=>{var s,n;if(confirm('Mitgliedschaft auf "vertragsfrei" setzen?'))try{await Je.delete(`/verbandsmitgliedschaften/${e}/vertragsfrei`),Ze();const s=await Je.get(`/verbandsmitgliedschaften/${e}`);Se(s.data)}catch(t){alert((null==(n=null==(s=t.response)?void 0:s.data)?void 0:n.error)||"Fehler beim Löschen")}})(_e.id),children:[e.jsx(F,{size:16})," Vertragsfrei"]}),"gekuendigt"!==_e.status&&"vertragsfrei"!==_e.status&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{style:re.dangerButton,onClick:()=>(async e=>{var s,n;if(confirm("Mitgliedschaft wirklich kündigen?"))try{await Je.delete(`/verbandsmitgliedschaften/${e}`),Ze(),be(!1)}catch(t){alert((null==(n=null==(s=t.response)?void 0:s.data)?void 0:n.error)||"Fehler beim Kündigen")}})(_e.id),children:[e.jsx(F,{size:16})," Kündigen"]}),e.jsxs("button",{style:re.submitButton,onClick:()=>(async e=>{var s,n;if(confirm("Mitgliedschaft um ein Jahr verlängern?"))try{await Je.post(`/verbandsmitgliedschaften/${e}/verlaengern`),Ze(),be(!1)}catch(t){alert((null==(n=null==(s=t.response)?void 0:s.data)?void 0:n.error)||"Fehler bei Verlängerung")}})(_e.id),children:[e.jsx(l,{size:16})," Verlängern"]})]})]})]})}),ve&&_e&&e.jsx("div",{style:re.modalOverlay,onClick:()=>fe(!1),children:e.jsxs("div",{style:{...re.modal,maxWidth:"550px"},onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{style:re.modalHeader,children:[e.jsxs("h2",{style:re.modalTitle,children:[e.jsx(N,{size:24,color:"#ffd700"})," SEPA-Mandat erstellen"]}),e.jsx("button",{style:re.closeButton,onClick:()=>fe(!1),children:e.jsx(k,{size:20})})]}),e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsxs("div",{style:re.formGroup,children:[e.jsx("label",{style:re.label,children:"IBAN *"}),e.jsx("input",{type:"text",value:Te.iban,onChange:e=>De({...Te,iban:e.target.value.toUpperCase()}),style:re.input,placeholder:"DE89 3704 0044 0532 0130 00"})]}),e.jsxs("div",{style:re.formGroup,children:[e.jsx("label",{style:re.label,children:"BIC (optional)"}),e.jsx("input",{type:"text",value:Te.bic,onChange:e=>De({...Te,bic:e.target.value.toUpperCase()}),style:re.input,placeholder:"COBADEFFXXX"})]}),e.jsxs("div",{style:re.formGroup,children:[e.jsx("label",{style:re.label,children:"Kontoinhaber *"}),e.jsx("input",{type:"text",value:Te.kontoinhaber,onChange:e=>De({...Te,kontoinhaber:e.target.value}),style:re.input,placeholder:"Max Mustermann"})]}),e.jsxs("div",{style:re.signatureSection,children:[e.jsx("label",{style:re.label,children:"Digitale Unterschrift"}),e.jsx("canvas",{ref:Pe,width:460,height:120,style:re.signatureCanvas,onMouseDown:as,onMouseMove:is,onMouseUp:ls,onMouseLeave:ls,onTouchStart:as,onTouchMove:is,onTouchEnd:ls}),e.jsx("button",{type:"button",style:re.clearSignatureButton,onClick:rs,children:"Unterschrift löschen"})]}),e.jsxs("div",{style:re.sepaHinweis,children:[e.jsx(T,{size:16,color:"#ffd700"}),e.jsx("p",{children:"Mit dem SEPA-Lastschriftmandat ermächtigen Sie uns, den Jahresbeitrag von Ihrem Konto einzuziehen."})]})]}),e.jsxs("div",{style:re.modalFooter,children:[e.jsx("button",{style:re.cancelButton,onClick:()=>fe(!1),children:"Abbrechen"}),e.jsxs("button",{style:re.submitButton,onClick:async()=>{var e,s;if(Te.iban&&Te.kontoinhaber)try{await Je.post(`/verbandsmitgliedschaften/${_e.id}/sepa`,{...Te,unterschrift_digital:Ve}),fe(!1),De({iban:"",bic:"",kontoinhaber:""}),$e(null),ss(_e.id),Ze(),alert("SEPA-Mandat erfolgreich angelegt")}catch(n){alert((null==(s=null==(e=n.response)?void 0:e.data)?void 0:s.error)||"Fehler beim Anlegen")}else alert("IBAN und Kontoinhaber sind erforderlich")},children:[e.jsx(z,{size:18})," Mandat erstellen"]})]})]})}),ye&&Re&&e.jsx("div",{style:re.modalOverlay,onClick:()=>ke(!1),children:e.jsxs("div",{style:{...re.modal,maxWidth:"700px"},onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{style:re.modalHeader,children:[e.jsxs("h2",{style:re.modalTitle,children:[e.jsx(D,{size:24,color:"#ffd700"})," ",Re.titel]}),e.jsx("button",{style:re.closeButton,onClick:()=>ke(!1),children:e.jsx(k,{size:20})})]}),e.jsxs("div",{style:re.dokumentContent,children:[e.jsxs("div",{style:re.dokumentMeta,children:[e.jsxs("span",{children:["Version: ",Re.version]}),e.jsxs("span",{children:["Gültig ab: ",hs(Re.gueltig_ab)]})]}),e.jsx("div",{style:re.dokumentText,dangerouslySetInnerHTML:{__html:null==(M=Re.inhalt)?void 0:M.replace(/\n/g,"<br/>")}})]}),e.jsx("div",{style:re.modalFooter,children:e.jsx("button",{style:re.submitButton,onClick:()=>ke(!1),children:"Schließen"})})]})}),ze&&_e&&e.jsx("div",{style:re.modalOverlay,onClick:()=>Ne(!1),children:e.jsxs("div",{style:{...re.modal,maxWidth:"600px"},onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{style:re.modalHeader,children:[e.jsxs("h2",{style:re.modalTitle,children:[e.jsx(I,{size:24,color:"#ffd700"})," Vertrag unterschreiben"]}),e.jsx("button",{style:re.closeButton,onClick:()=>Ne(!1),children:e.jsx(k,{size:20})})]}),e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsxs("p",{style:re.signatureIntro,children:["Mit Ihrer Unterschrift bestätigen Sie den Mitgliedsvertrag für die TDA Verbandsmitgliedschaft zum Jahresbeitrag von ",us(_e.jahresbeitrag),"."]}),e.jsxs("div",{style:re.akzeptanzSection,children:[e.jsxs("label",{style:re.checkbox,children:[e.jsx("input",{type:"checkbox",checked:Ke.agb,onChange:e=>Oe({...Ke,agb:e.target.checked})}),e.jsxs("span",{children:["Ich akzeptiere die ",e.jsx("a",{href:"#",onClick:e=>{e.preventDefault(),ns("agb")},children:"AGB"})," *"]})]}),e.jsxs("label",{style:re.checkbox,children:[e.jsx("input",{type:"checkbox",checked:Ke.dsgvo,onChange:e=>Oe({...Ke,dsgvo:e.target.checked})}),e.jsxs("span",{children:["Ich akzeptiere die ",e.jsx("a",{href:"#",onClick:e=>{e.preventDefault(),ns("dsgvo")},children:"Datenschutzerklärung"})," *"]})]}),e.jsxs("label",{style:re.checkbox,children:[e.jsx("input",{type:"checkbox",checked:Ke.widerruf,onChange:e=>Oe({...Ke,widerruf:e.target.checked})}),e.jsxs("span",{children:["Ich habe die ",e.jsx("a",{href:"#",onClick:e=>{e.preventDefault(),ns("widerrufsbelehrung")},children:"Widerrufsbelehrung"})," zur Kenntnis genommen *"]})]})]}),e.jsxs("div",{style:re.signatureSection,children:[e.jsx("label",{style:re.label,children:"Ihre Unterschrift *"}),e.jsx("canvas",{ref:Pe,width:520,height:150,style:re.signatureCanvas,onMouseDown:as,onMouseMove:is,onMouseUp:ls,onMouseLeave:ls,onTouchStart:as,onTouchMove:is,onTouchEnd:ls}),e.jsx("button",{type:"button",style:re.clearSignatureButton,onClick:rs,children:"Unterschrift löschen"})]})]}),e.jsxs("div",{style:re.modalFooter,children:[e.jsx("button",{style:re.cancelButton,onClick:()=>Ne(!1),children:"Abbrechen"}),e.jsxs("button",{style:re.submitButton,onClick:async()=>{var e,s;if(Ve)if(Ke.agb&&Ke.dsgvo&&Ke.widerruf)try{await Je.post(`/verbandsmitgliedschaften/${_e.id}/unterschreiben`,{unterschrift_digital:Ve,agb_akzeptiert:Ke.agb,dsgvo_akzeptiert:Ke.dsgvo,widerrufsrecht_akzeptiert:Ke.widerruf}),Ne(!1),$e(null),Oe({agb:!1,dsgvo:!1,widerruf:!1}),Ze(),alert("Vertrag erfolgreich unterschrieben")}catch(n){alert((null==(s=null==(e=n.response)?void 0:e.data)?void 0:s.error)||"Fehler beim Unterschreiben")}else alert("Bitte akzeptieren Sie alle Bedingungen");else alert("Bitte unterschreiben Sie im Unterschriftsfeld")},children:[e.jsx(I,{size:18})," Verbindlich unterschreiben"]})]})]})})]})},re={container:{padding:"2rem",maxWidth:"1400px",margin:"0 auto"},loading:{display:"flex",flexDirection:"column",alignItems:"center",gap:"1rem",padding:"4rem",color:"#888"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem",flexWrap:"wrap",gap:"1rem"},title:{display:"flex",alignItems:"center",gap:"12px",color:"#fff",margin:0,fontSize:"1.8rem"},subtitle:{color:"#888",margin:"4px 0 0 40px",fontSize:"0.9rem"},primaryButton:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 20px",background:"linear-gradient(135deg, #ffd700, #ffaa00)",border:"none",borderRadius:"10px",color:"#000",fontWeight:"600",cursor:"pointer",transition:"transform 0.2s"},statsGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"2rem"},statCard:{display:"flex",alignItems:"center",gap:"16px",padding:"1.5rem",background:"rgba(255, 255, 255, 0.05)",borderRadius:"12px",border:"1px solid rgba(255, 255, 255, 0.1)"},statValue:{fontSize:"1.5rem",fontWeight:"700",color:"#fff"},statLabel:{fontSize:"0.85rem",color:"#888"},tabs:{display:"flex",gap:"8px",marginBottom:"1.5rem",borderBottom:"1px solid rgba(255, 255, 255, 0.1)",paddingBottom:"8px"},tab:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 16px",background:"transparent",border:"none",borderRadius:"8px",color:"#888",cursor:"pointer",transition:"all 0.2s"},tabActive:{background:"rgba(255, 215, 0, 0.15)",color:"#ffd700"},filterBar:{display:"flex",gap:"12px",marginBottom:"1.5rem",flexWrap:"wrap"},searchBox:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 14px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",flex:"1",minWidth:"200px"},searchInput:{background:"transparent",border:"none",outline:"none",color:"#fff",width:"100%",fontSize:"0.9rem"},select:{padding:"10px 14px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",color:"#fff",fontSize:"0.9rem",cursor:"pointer"},iconButton:{padding:"10px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",color:"#888",cursor:"pointer"},list:{display:"flex",flexDirection:"column",gap:"8px"},listItem:{display:"flex",alignItems:"center",gap:"16px",padding:"16px",background:"rgba(255, 255, 255, 0.03)",border:"1px solid rgba(255, 255, 255, 0.08)",borderRadius:"12px",cursor:"pointer",transition:"all 0.2s"},listItemIcon:{width:"48px",height:"48px",display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(255, 255, 255, 0.05)",borderRadius:"10px"},listItemContent:{flex:1},listItemHeader:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"6px"},listItemName:{color:"#fff",fontWeight:"600",fontSize:"1rem"},listItemMeta:{display:"flex",gap:"16px",color:"#888",fontSize:"0.8rem"},emptyState:{display:"flex",flexDirection:"column",alignItems:"center",gap:"16px",padding:"4rem",color:"#666"},vorteileContainer:{marginTop:"1rem"},sectionTitle:{color:"#ffd700",marginBottom:"1rem",fontSize:"1.1rem"},vorteileGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"1rem"},vorteilCard:{padding:"1.5rem",background:"rgba(255, 255, 255, 0.03)",border:"1px solid rgba(255, 215, 0, 0.2)",borderRadius:"12px"},vorteilHeader:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"10px"},vorteilTitel:{color:"#fff",fontWeight:"600"},vorteilBeschreibung:{color:"#aaa",fontSize:"0.85rem",marginBottom:"12px"},vorteilMeta:{display:"flex",gap:"8px",flexWrap:"wrap"},vorteilRabatt:{padding:"4px 10px",background:"rgba(255, 215, 0, 0.2)",color:"#ffd700",borderRadius:"6px",fontSize:"0.8rem",fontWeight:"600"},vorteilKategorie:{padding:"4px 10px",background:"rgba(255, 255, 255, 0.1)",color:"#888",borderRadius:"6px",fontSize:"0.8rem",textTransform:"capitalize"},vorteilGilt:{padding:"4px 10px",borderRadius:"6px",fontSize:"0.8rem",color:"#fff"},modalOverlay:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},modal:{background:"#1a1a2e",borderRadius:"16px",width:"100%",maxWidth:"550px",maxHeight:"90vh",overflow:"auto",border:"1px solid rgba(255, 215, 0, 0.2)"},modalHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"1.5rem",borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},modalTitle:{display:"flex",alignItems:"center",gap:"10px",color:"#fff",margin:0,fontSize:"1.2rem"},closeButton:{background:"transparent",border:"none",color:"#888",cursor:"pointer",padding:"8px"},typSelector:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",padding:"1.5rem"},typButton:{display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",padding:"20px",background:"rgba(255, 255, 255, 0.05)",border:"2px solid transparent",borderRadius:"12px",color:"#888",cursor:"pointer",transition:"all 0.2s"},typButtonActive:{borderColor:"#3b82f6",background:"rgba(59, 130, 246, 0.15)",color:"#3b82f6"},typButtonActiveGreen:{borderColor:"#10b981",background:"rgba(16, 185, 129, 0.15)",color:"#10b981"},typPrice:{fontSize:"0.85rem",opacity:.7},formGroup:{padding:"0 1.5rem",marginBottom:"1rem"},formRow:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",padding:"0 1.5rem",marginBottom:"1rem"},label:{display:"block",color:"#888",fontSize:"0.85rem",marginBottom:"6px"},input:{width:"100%",padding:"10px 12px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.15)",borderRadius:"8px",color:"#fff",fontSize:"0.9rem",outline:"none"},hint:{color:"#666",fontSize:"0.8rem",marginTop:"6px"},modalFooter:{display:"flex",justifyContent:"flex-end",gap:"12px",padding:"1.5rem",borderTop:"1px solid rgba(255, 255, 255, 0.1)"},cancelButton:{padding:"10px 20px",background:"rgba(255, 255, 255, 0.1)",border:"none",borderRadius:"8px",color:"#888",cursor:"pointer"},submitButton:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 20px",background:"linear-gradient(135deg, #ffd700, #ffaa00)",border:"none",borderRadius:"8px",color:"#000",fontWeight:"600",cursor:"pointer"},dangerButton:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 20px",background:"rgba(239, 68, 68, 0.2)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:"8px",color:"#ef4444",cursor:"pointer"},detailContent:{padding:"1.5rem"},detailRow:{display:"flex",gap:"24px",marginBottom:"16px",flexWrap:"wrap"},detailItem:{display:"flex",flexDirection:"column",gap:"4px"},detailLabel:{color:"#666",fontSize:"0.75rem",textTransform:"uppercase"},detailValue:{color:"#fff",fontSize:"0.95rem"},detailSection:{marginTop:"20px",paddingTop:"16px",borderTop:"1px solid rgba(255, 255, 255, 0.1)"},detailSectionTitle:{color:"#ffd700",fontSize:"0.9rem",marginBottom:"12px"},zahlungenList:{display:"flex",flexDirection:"column",gap:"10px"},zahlungItem:{padding:"12px",background:"rgba(255, 255, 255, 0.03)",borderRadius:"8px"},zahlungMain:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},zahlungNummer:{color:"#fff",fontWeight:"500"},zahlungBetrag:{color:"#ffd700",fontWeight:"600"},zahlungStatus:{fontWeight:"600",fontSize:"0.85rem"},zahlungMeta:{display:"flex",gap:"16px",color:"#666",fontSize:"0.8rem"},smallButton:{display:"flex",alignItems:"center",gap:"6px",marginTop:"8px",padding:"6px 12px",background:"rgba(16, 185, 129, 0.2)",border:"1px solid rgba(16, 185, 129, 0.3)",borderRadius:"6px",color:"#10b981",fontSize:"0.8rem",cursor:"pointer"},notizen:{color:"#aaa",fontSize:"0.9rem",whiteSpace:"pre-wrap"},detailTabs:{display:"flex",gap:"4px",padding:"0 1.5rem",borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},detailTab:{display:"flex",alignItems:"center",gap:"6px",padding:"12px 16px",background:"transparent",border:"none",borderBottom:"2px solid transparent",color:"#888",cursor:"pointer",transition:"all 0.2s"},detailTabActive:{color:"#ffd700",borderBottomColor:"#ffd700"},vertragActions:{display:"flex",gap:"12px",marginBottom:"1.5rem",flexWrap:"wrap"},actionButton:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 20px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"10px",color:"#fff",cursor:"pointer",transition:"all 0.2s"},actionButtonPrimary:{background:"linear-gradient(135deg, #ffd700, #ffaa00)",border:"none",color:"#000",fontWeight:"600"},vertragInfo:{marginBottom:"1.5rem"},vertragStatusGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"12px",marginTop:"12px"},vertragStatusItem:{display:"flex",alignItems:"center",gap:"10px",padding:"12px",background:"rgba(255, 255, 255, 0.03)",borderRadius:"8px",color:"#fff",fontSize:"0.9rem"},dokumenteListe:{display:"flex",flexWrap:"wrap",gap:"10px",marginTop:"12px"},dokumentButton:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 16px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.15)",borderRadius:"8px",color:"#aaa",cursor:"pointer",transition:"all 0.2s"},sepaListe:{display:"flex",flexDirection:"column",gap:"12px"},sepaItem:{padding:"16px",background:"rgba(255, 255, 255, 0.03)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"12px"},sepaHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},sepaMandatsref:{color:"#fff",fontWeight:"600",fontFamily:"monospace"},sepaStatus:{padding:"4px 10px",borderRadius:"6px",fontSize:"0.8rem",fontWeight:"600"},sepaDetails:{display:"flex",flexDirection:"column",gap:"6px",color:"#aaa",fontSize:"0.9rem"},sepaSignedBadge:{display:"inline-flex",alignItems:"center",gap:"6px",marginTop:"12px",padding:"6px 12px",background:"rgba(16, 185, 129, 0.15)",color:"#10b981",borderRadius:"6px",fontSize:"0.85rem"},sepaHinweis:{display:"flex",alignItems:"flex-start",gap:"12px",padding:"16px",background:"rgba(255, 215, 0, 0.1)",border:"1px solid rgba(255, 215, 0, 0.3)",borderRadius:"10px",marginTop:"1.5rem"},historieListe:{display:"flex",flexDirection:"column",gap:"12px",marginTop:"16px"},historieItem:{display:"flex",alignItems:"center",gap:"16px",padding:"12px",background:"rgba(255, 255, 255, 0.03)",borderRadius:"8px",borderLeft:"3px solid #ffd700"},historieDatum:{color:"#888",fontSize:"0.8rem",minWidth:"100px"},historieText:{color:"#fff",fontSize:"0.9rem"},signatureSection:{marginTop:"1.5rem"},signatureCanvas:{width:"100%",background:"#fff",borderRadius:"8px",cursor:"crosshair",touchAction:"none"},clearSignatureButton:{marginTop:"8px",padding:"8px 16px",background:"transparent",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"6px",color:"#888",cursor:"pointer",fontSize:"0.85rem"},signatureIntro:{color:"#aaa",fontSize:"0.95rem",lineHeight:1.6,marginBottom:"1.5rem"},akzeptanzSection:{display:"flex",flexDirection:"column",gap:"12px",marginBottom:"1.5rem"},checkbox:{display:"flex",alignItems:"center",gap:"10px",color:"#fff",cursor:"pointer"},dokumentContent:{padding:"1.5rem",maxHeight:"60vh",overflow:"auto"},dokumentMeta:{display:"flex",gap:"20px",marginBottom:"1rem",color:"#888",fontSize:"0.85rem"},dokumentText:{color:"#ccc",fontSize:"0.9rem",lineHeight:1.7,whiteSpace:"pre-wrap"},einstellungenContainer:{marginTop:"1rem"},einstellungenTabs:{display:"flex",gap:"8px",marginBottom:"1.5rem",flexWrap:"wrap"},einstellungenTab:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 16px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",color:"#888",cursor:"pointer",transition:"all 0.2s"},einstellungenTabActive:{background:"rgba(255, 215, 0, 0.15)",borderColor:"rgba(255, 215, 0, 0.3)",color:"#ffd700"},einstellungenGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},einstellungItem:{position:"relative",padding:"1rem",background:"rgba(255, 255, 255, 0.03)",borderRadius:"12px",border:"1px solid rgba(255, 255, 255, 0.08)"},einstellungLabel:{display:"block",color:"#fff",fontWeight:"500",marginBottom:"8px",fontSize:"0.95rem"},einstellungHint:{display:"block",color:"#666",fontSize:"0.8rem",fontWeight:"400",marginTop:"4px"},einstellungInput:{width:"100%",padding:"10px 14px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.15)",borderRadius:"8px",color:"#fff",fontSize:"0.95rem",outline:"none"},toggleLabel:{display:"flex",alignItems:"center",gap:"12px",cursor:"pointer"},toggleInput:{display:"none"},toggleSwitch:{position:"relative",width:"48px",height:"24px",background:"rgba(255, 255, 255, 0.2)",borderRadius:"12px",transition:"background 0.2s"},toggleText:{color:"#888",fontSize:"0.9rem"},changedBadge:{position:"absolute",top:"8px",right:"8px",padding:"2px 8px",background:"rgba(255, 215, 0, 0.2)",color:"#ffd700",borderRadius:"4px",fontSize:"0.7rem",fontWeight:"600"},einstellungenFooter:{display:"flex",alignItems:"center",gap:"12px",marginTop:"2rem",padding:"1rem",background:"rgba(255, 215, 0, 0.1)",borderRadius:"12px",border:"1px solid rgba(255, 215, 0, 0.2)"},changesCount:{flex:1,color:"#ffd700",fontWeight:"500"}},de={BadgeCheck:K,Award:r,Medal:$,ScrollText:D,Package:E,FileText:b,BookOpen:V,Star:P,Tag:G},oe=()=>{var n;const{token:i,user:l}=t(),[r,o]=s.useState([]),[c,u]=s.useState([]),[p,g]=s.useState("alle"),[m,N]=s.useState(""),[_,S]=s.useState([]),[C,w]=s.useState(!1),[B,I]=s.useState(!1),[D,G]=s.useState(null),[V,$]=s.useState({}),[K,J]=s.useState(!1),[Z,q]=s.useState(!1),[X,Y]=s.useState(!0),[Q,ee]=s.useState(null),se="admin"===(null==l?void 0:l.role),[ne,te]=s.useState(!1),[ae,ie]=s.useState(null),[le,re]=s.useState(!1),[oe,ce]=s.useState(null),[he,ue]=s.useState([]),[pe,xe]=s.useState({vorname:(null==l?void 0:l.vorname)||"",nachname:(null==l?void 0:l.nachname)||"",email:(null==l?void 0:l.email)||"",strasse:"",plz:"",ort:"",land:"Deutschland",telefon:"",anmerkungen:"",zahlungsart:"rechnung"});s.useEffect(()=>{(async()=>{try{Y(!0),ee(null);const[e,s]=await Promise.all([a.get("/shop/kategorien"),a.get("/shop/produkte")]),n=[];e.data.forEach(e=>{e.parent_id||(n.push({id:e.slug,dbId:e.id,name:e.name,icon:de[e.icon]||E,color:e.farbe,isParent:!0}),e.children&&e.children.length>0&&e.children.forEach(s=>{const t=de[s.icon]||E;n.push({id:s.slug,dbId:s.id,name:s.name,icon:t,color:s.farbe,parentDbId:e.id,parentSlug:e.slug,isChild:!0})}))}),u(n);const t=[];e.data.forEach(e=>{t.push({id:e.id,name:e.name,slug:e.slug,parent_id:null}),e.children&&e.children.forEach(s=>{t.push({id:s.id,name:`${e.name} → ${s.name}`,slug:s.slug,parent_id:e.id})})}),ue(t);const i=s.data.map(s=>{var n;return{id:s.id,dbId:s.id,kategorie_id:s.kategorie_id,kategorie:s.kategorie_slug,parentKategorie:s.parent_kategorie_id?null==(n=e.data.find(e=>e.id===s.parent_kategorie_id))?void 0:n.slug:null,sku:s.sku,name:s.name,beschreibung:s.beschreibung,preis:parseFloat(s.preis),bild:s.bild_url,details:s.details||[],optionen:s.optionen||null,lieferzeit:s.lieferzeit,featured:1===s.featured,aktiv:s.aktiv}});o(i)}catch(e){console.error("Fehler beim Laden der Shop-Daten:",e),ee("Shop-Daten konnten nicht geladen werden")}finally{Y(!1)}})()},[]),s.useEffect(()=>{const e=localStorage.getItem("tda_shop_warenkorb");if(e)try{S(JSON.parse(e))}catch(s){console.error("Fehler beim Laden des Warenkorbs:",s)}},[]),s.useEffect(()=>{localStorage.setItem("tda_shop_warenkorb",JSON.stringify(_))},[_]);const ge=r.filter(e=>{const s="alle"===p||e.kategorie===p||e.parentKategorie===p,n=""===m||e.name.toLowerCase().includes(m.toLowerCase())||e.beschreibung.toLowerCase().includes(m.toLowerCase());return s&&n}),me=r.filter(e=>e.featured),je=(e,s={})=>{const n={id:`${e.id}-${Date.now()}`,produktId:e.id,name:e.name,preis:e.preis,menge:1,optionen:s,bild:e.bild};S(e=>[...e,n]),G(null),$({})},be=(e,s)=>{s<1?ve(e):S(n=>n.map(n=>n.id===e?{...n,menge:s}:n))},ve=e=>{S(s=>s.filter(s=>s.id!==e))},fe=_.reduce((e,s)=>e+s.preis*s.menge,0),ye=_.reduce((e,s)=>e+s.menge,0),ke=fe>=50?0:4.95,ze=fe+ke,Ne=async()=>{q(!0);try{const e={positionen:_.map(e=>({produkt_id:e.produktId,menge:e.menge,optionen:e.optionen})),lieferadresse:{vorname:pe.vorname,nachname:pe.nachname,strasse:pe.strasse,plz:pe.plz,ort:pe.ort,land:pe.land,telefon:pe.telefon},rechnungsadresse:{vorname:pe.vorname,nachname:pe.nachname,email:pe.email,strasse:pe.strasse,plz:pe.plz,ort:pe.ort,land:pe.land},anmerkungen:pe.anmerkungen};await a.post("/shop/bestellungen",e,{headers:{Authorization:`Bearer ${i}`}}),J(!0),S([]),I(!1)}catch(e){console.error("Bestellfehler:",e),alert("Fehler bei der Bestellung. Bitte versuchen Sie es erneut.")}finally{q(!1)}},_e=async()=>{if(ae.name&&ae.sku){re(!0);try{const e={...ae,details:ae.details||[],optionen:ae.optionen||null};ae.id?await a.put(`/shop/admin/produkte/${ae.id}`,e,{headers:{Authorization:`Bearer ${i}`}}):await a.post("/shop/admin/produkte",e,{headers:{Authorization:`Bearer ${i}`}});const s=await a.get("/shop/produkte"),n=await a.get("/shop/kategorien"),t=s.data.map(e=>{var s;return{id:e.id,dbId:e.id,kategorie_id:e.kategorie_id,kategorie:e.kategorie_slug,parentKategorie:e.parent_kategorie_id?null==(s=n.data.find(s=>s.id===e.parent_kategorie_id))?void 0:s.slug:null,sku:e.sku,name:e.name,beschreibung:e.beschreibung,preis:parseFloat(e.preis),bild:e.bild_url,details:e.details||[],optionen:e.optionen||null,lieferzeit:e.lieferzeit,featured:1===e.featured,aktiv:e.aktiv}});o(t),te(!1),ie(null)}catch(e){console.error("Fehler beim Speichern:",e),alert("Fehler beim Speichern des Produkts")}finally{re(!1)}}else alert("Name und SKU sind erforderlich")},Se=()=>{ie(e=>({...e,details:[...e.details||[],""]}))},Ce=({kategorie:s,size:n=20})=>{const t=c.find(e=>e.id===s);if(!t)return e.jsx(E,{size:n});const a=t.icon;return e.jsx(a,{size:n,style:{color:t.color}})},we=({produkt:s})=>{var n;return e.jsxs("div",{className:"shop-produkt-karte "+(s.featured?"featured":""),onClick:()=>G(s),children:[s.featured&&e.jsxs("div",{className:"featured-badge",children:[e.jsx(P,{size:12})," Beliebt"]}),se&&e.jsxs("div",{className:"admin-buttons",children:[e.jsx("button",{className:"btn-admin-edit",onClick:e=>{e.stopPropagation(),(e=>{ie({id:e.dbId||e.id,sku:e.sku||"",name:e.name,beschreibung:e.beschreibung,preis:e.preis,kategorie_id:e.kategorie_id,details:e.details||[],optionen:e.optionen,lieferzeit:e.lieferzeit||"3-5 Werktage",featured:e.featured,aktiv:!1!==e.aktiv}),te(!0)})(s)},title:"Bearbeiten",children:e.jsx(O,{size:14})}),e.jsx("button",{className:"btn-admin-delete",onClick:e=>{e.stopPropagation(),(async e=>{if(confirm("Produkt wirklich löschen?"))try{await a.delete(`/shop/admin/produkte/${e}`,{headers:{Authorization:`Bearer ${i}`}}),o(s=>s.filter(s=>s.id!==e&&s.dbId!==e))}catch(s){console.error("Fehler beim Löschen:",s),alert("Fehler beim Löschen des Produkts")}})(s.dbId||s.id)},title:"Löschen",children:e.jsx(F,{size:14})})]}),e.jsx("div",{className:"produkt-bild",children:e.jsx(Ce,{kategorie:s.kategorie,size:48})}),e.jsxs("div",{className:"produkt-info",children:[e.jsx("span",{className:"produkt-kategorie",children:null==(n=c.find(e=>e.id===s.kategorie))?void 0:n.name}),e.jsx("h3",{className:"produkt-name",children:s.name}),e.jsx("p",{className:"produkt-beschreibung",children:s.beschreibung}),e.jsxs("div",{className:"produkt-footer",children:[e.jsxs("span",{className:"produkt-preis",children:[s.preis.toFixed(2)," €"]}),e.jsx("button",{className:"btn-add-cart",onClick:e=>{e.stopPropagation(),s.optionen?G(s):je(s)},children:e.jsx(R,{size:16})})]})]})]})},Be=({produkt:s})=>{var n;return e.jsx("div",{className:"modal-overlay",onClick:()=>G(null),children:e.jsxs("div",{className:"modal-content produkt-detail-modal",onClick:e=>e.stopPropagation(),children:[e.jsx("button",{className:"modal-close",onClick:()=>G(null),children:e.jsx(k,{size:24})}),e.jsxs("div",{className:"produkt-detail-grid",children:[e.jsx("div",{className:"produkt-detail-bild",children:e.jsx(Ce,{kategorie:s.kategorie,size:120})}),e.jsxs("div",{className:"produkt-detail-info",children:[e.jsx("span",{className:"produkt-kategorie-badge",children:null==(n=c.find(e=>e.id===s.kategorie))?void 0:n.name}),e.jsx("h2",{children:s.name}),e.jsx("p",{className:"produkt-detail-beschreibung",children:s.beschreibung}),s.details&&e.jsx("ul",{className:"produkt-details-liste",children:s.details.map((s,n)=>e.jsxs("li",{children:[e.jsx(z,{size:14})," ",s]},n))}),s.optionen&&e.jsx("div",{className:"produkt-optionen",children:s.optionen.map((s,n)=>e.jsxs("div",{className:"option-gruppe",children:[e.jsx("label",{children:s.name}),e.jsxs("select",{value:V[s.name]||"",onChange:e=>$(n=>({...n,[s.name]:e.target.value})),children:[e.jsx("option",{value:"",children:"Bitte wählen..."}),s.werte.map((s,n)=>e.jsx("option",{value:s,children:s},n))]})]},n))}),e.jsxs("div",{className:"produkt-detail-footer",children:[e.jsx("div",{className:"produkt-meta",children:e.jsxs("span",{className:"lieferzeit",children:[e.jsx(W,{size:14})," ",s.lieferzeit]})}),e.jsxs("div",{className:"produkt-kaufen",children:[e.jsxs("span",{className:"preis-gross",children:[s.preis.toFixed(2)," €"]}),e.jsxs("button",{className:"btn-kaufen",onClick:()=>{if(s.optionen){if(!s.optionen.every(e=>V[e.name]))return void alert("Bitte alle Optionen auswählen")}je(s,V)},children:[e.jsx(R,{size:18})," In den Warenkorb"]})]})]})]})]})]})})},Ie=()=>e.jsxs("div",{className:"warenkorb-sidebar "+(C?"open":""),children:[e.jsxs("div",{className:"warenkorb-header",children:[e.jsxs("h3",{children:[e.jsx(R,{size:20})," Warenkorb"]}),e.jsx("button",{className:"btn-close",onClick:()=>w(!1),children:e.jsx(k,{size:20})})]}),0===_.length?e.jsxs("div",{className:"warenkorb-leer",children:[e.jsx(R,{size:48}),e.jsx("p",{children:"Ihr Warenkorb ist leer"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"warenkorb-items",children:_.map(s=>e.jsxs("div",{className:"warenkorb-item",children:[e.jsxs("div",{className:"item-info",children:[e.jsx("span",{className:"item-name",children:s.name}),Object.keys(s.optionen).length>0&&e.jsx("span",{className:"item-optionen",children:Object.entries(s.optionen).map(([e,s])=>`${e}: ${s}`).join(", ")}),e.jsxs("span",{className:"item-preis",children:[s.preis.toFixed(2)," €"]})]}),e.jsxs("div",{className:"item-actions",children:[e.jsxs("div",{className:"menge-control",children:[e.jsx("button",{onClick:()=>be(s.id,s.menge-1),children:e.jsx(H,{size:14})}),e.jsx("span",{children:s.menge}),e.jsx("button",{onClick:()=>be(s.id,s.menge+1),children:e.jsx(d,{size:14})})]}),e.jsx("button",{className:"btn-remove",onClick:()=>ve(s.id),children:e.jsx(F,{size:16})})]})]},s.id))}),e.jsxs("div",{className:"warenkorb-summe",children:[e.jsxs("div",{className:"summe-zeile",children:[e.jsx("span",{children:"Zwischensumme"}),e.jsxs("span",{children:[fe.toFixed(2)," €"]})]}),e.jsxs("div",{className:"summe-zeile",children:[e.jsx("span",{children:"Versand"}),e.jsx("span",{children:0===ke?"Kostenlos":`${ke.toFixed(2)} €`})]}),fe<50&&e.jsxs("div",{className:"versand-hinweis",children:[e.jsx(W,{size:14})," Noch ",(50-fe).toFixed(2)," € bis zum kostenlosen Versand"]}),e.jsxs("div",{className:"summe-zeile total",children:[e.jsx("span",{children:"Gesamt"}),e.jsxs("span",{children:[ze.toFixed(2)," €"]})]})]}),e.jsx("div",{className:"warenkorb-actions",children:e.jsxs("button",{className:"btn-checkout",onClick:()=>{w(!1),I(!0)},children:["Zur Kasse ",e.jsx(U,{size:18})]})})]})]}),Te=()=>e.jsx("div",{className:"modal-overlay",onClick:()=>I(!1),children:e.jsxs("div",{className:"modal-content checkout-modal",onClick:e=>e.stopPropagation(),children:[e.jsx("button",{className:"modal-close",onClick:()=>I(!1),children:e.jsx(k,{size:24})}),e.jsxs("h2",{children:[e.jsx(j,{size:24})," Bestellung abschließen"]}),e.jsxs("div",{className:"checkout-grid",children:[e.jsxs("div",{className:"checkout-section",children:[e.jsxs("h3",{children:[e.jsx(W,{size:18})," Lieferadresse"]}),e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Vorname *"}),e.jsx("input",{type:"text",value:pe.vorname,onChange:e=>xe(s=>({...s,vorname:e.target.value})),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Nachname *"}),e.jsx("input",{type:"text",value:pe.nachname,onChange:e=>xe(s=>({...s,nachname:e.target.value})),required:!0})]}),e.jsxs("div",{className:"form-group full",children:[e.jsx("label",{children:"E-Mail *"}),e.jsx("input",{type:"email",value:pe.email,onChange:e=>xe(s=>({...s,email:e.target.value})),required:!0})]}),e.jsxs("div",{className:"form-group full",children:[e.jsx("label",{children:"Straße & Hausnummer *"}),e.jsx("input",{type:"text",value:pe.strasse,onChange:e=>xe(s=>({...s,strasse:e.target.value})),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"PLZ *"}),e.jsx("input",{type:"text",value:pe.plz,onChange:e=>xe(s=>({...s,plz:e.target.value})),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Ort *"}),e.jsx("input",{type:"text",value:pe.ort,onChange:e=>xe(s=>({...s,ort:e.target.value})),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Land"}),e.jsxs("select",{value:pe.land,onChange:e=>xe(s=>({...s,land:e.target.value})),children:[e.jsx("option",{value:"Deutschland",children:"Deutschland"}),e.jsx("option",{value:"Österreich",children:"Österreich"}),e.jsx("option",{value:"Schweiz",children:"Schweiz"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Telefon"}),e.jsx("input",{type:"tel",value:pe.telefon,onChange:e=>xe(s=>({...s,telefon:e.target.value}))})]})]})]}),e.jsxs("div",{className:"checkout-section",children:[e.jsxs("h3",{children:[e.jsx(j,{size:18})," Zahlungsart"]}),e.jsxs("div",{className:"zahlungsarten",children:[e.jsxs("label",{className:"zahlungsart "+("rechnung"===pe.zahlungsart?"selected":""),children:[e.jsx("input",{type:"radio",name:"zahlungsart",value:"rechnung",checked:"rechnung"===pe.zahlungsart,onChange:e=>xe(s=>({...s,zahlungsart:e.target.value}))}),e.jsx(b,{size:20}),e.jsxs("div",{children:[e.jsx("span",{className:"za-name",children:"Rechnung"}),e.jsx("span",{className:"za-info",children:"Zahlung nach Erhalt der Ware"})]})]}),e.jsxs("label",{className:"zahlungsart "+("vorkasse"===pe.zahlungsart?"selected":""),children:[e.jsx("input",{type:"radio",name:"zahlungsart",value:"vorkasse",checked:"vorkasse"===pe.zahlungsart,onChange:e=>xe(s=>({...s,zahlungsart:e.target.value}))}),e.jsx(h,{size:20}),e.jsxs("div",{children:[e.jsx("span",{className:"za-name",children:"Vorkasse"}),e.jsx("span",{className:"za-info",children:"Überweisung vor Versand"})]})]})]})]}),e.jsxs("div",{className:"checkout-section bestellung-uebersicht",children:[e.jsxs("h3",{children:[e.jsx(E,{size:18})," Ihre Bestellung"]}),e.jsx("div",{className:"bestellung-items",children:_.map(s=>e.jsxs("div",{className:"bestellung-item",children:[e.jsxs("span",{className:"item-menge",children:[s.menge,"x"]}),e.jsx("span",{className:"item-name",children:s.name}),e.jsxs("span",{className:"item-preis",children:[(s.preis*s.menge).toFixed(2)," €"]})]},s.id))}),e.jsxs("div",{className:"bestellung-summen",children:[e.jsxs("div",{className:"summe-zeile",children:[e.jsx("span",{children:"Zwischensumme"}),e.jsxs("span",{children:[fe.toFixed(2)," €"]})]}),e.jsxs("div",{className:"summe-zeile",children:[e.jsx("span",{children:"Versand"}),e.jsx("span",{children:0===ke?"Kostenlos":`${ke.toFixed(2)} €`})]}),e.jsxs("div",{className:"summe-zeile total",children:[e.jsx("span",{children:"Gesamtsumme"}),e.jsxs("span",{children:[ze.toFixed(2)," €"]})]})]})]}),e.jsxs("div",{className:"checkout-section full",children:[e.jsx("label",{children:"Anmerkungen zur Bestellung"}),e.jsx("textarea",{value:pe.anmerkungen,onChange:e=>xe(s=>({...s,anmerkungen:e.target.value})),placeholder:"Besondere Wünsche oder Hinweise...",rows:3})]})]}),e.jsxs("div",{className:"checkout-footer",children:[e.jsxs("p",{className:"agb-hinweis",children:[e.jsx(T,{size:14})," Mit der Bestellung akzeptieren Sie unsere AGB und Datenschutzerklärung."]}),e.jsx("button",{className:"btn-bestellen",onClick:Ne,disabled:Z||!pe.vorname||!pe.nachname||!pe.email||!pe.strasse||!pe.plz||!pe.ort,children:Z?e.jsxs(e.Fragment,{children:[e.jsx(L,{size:18,className:"spin"})," Wird verarbeitet..."]}):e.jsxs(e.Fragment,{children:["Kostenpflichtig bestellen (",ze.toFixed(2)," €)"]})})]})]})}),De=()=>e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content erfolg-modal",children:[e.jsx("div",{className:"erfolg-icon",children:e.jsx(z,{size:48})}),e.jsx("h2",{children:"Bestellung erfolgreich!"}),e.jsx("p",{children:"Vielen Dank für Ihre Bestellung. Sie erhalten in Kürze eine Bestätigung per E-Mail."}),e.jsxs("div",{className:"erfolg-info",children:[e.jsxs("div",{className:"info-item",children:[e.jsx(A,{size:18}),e.jsx("span",{children:"Bearbeitung: 1-2 Werktage"})]}),e.jsxs("div",{className:"info-item",children:[e.jsx(W,{size:18}),e.jsx("span",{children:"Lieferung: 3-7 Werktage"})]})]}),e.jsx("button",{className:"btn-primary",onClick:()=>J(!1),children:"Weiter einkaufen"})]})}),Fe=()=>e.jsx("div",{className:"modal-overlay",onClick:()=>te(!1),children:e.jsxs("div",{className:"modal-content produkt-editor-modal",onClick:e=>e.stopPropagation(),children:[e.jsx("button",{className:"modal-close",onClick:()=>te(!1),children:e.jsx(k,{size:24})}),e.jsxs("h2",{children:[e.jsx(x,{size:24}),(null==ae?void 0:ae.id)?"Produkt bearbeiten":"Neues Produkt"]}),e.jsxs("div",{className:"editor-form",children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Artikelnummer (SKU) *"}),e.jsx("input",{type:"text",value:(null==ae?void 0:ae.sku)||"",onChange:e=>ie(s=>({...s,sku:e.target.value})),placeholder:"z.B. URK-KAR-001"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kategorie *"}),e.jsx("select",{value:(null==ae?void 0:ae.kategorie_id)||"",onChange:e=>ie(s=>({...s,kategorie_id:parseInt(e.target.value)})),children:he.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Produktname *"}),e.jsx("input",{type:"text",value:(null==ae?void 0:ae.name)||"",onChange:e=>ie(s=>({...s,name:e.target.value})),placeholder:"z.B. Karate Kyu-Urkunde"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Beschreibung"}),e.jsx("textarea",{value:(null==ae?void 0:ae.beschreibung)||"",onChange:e=>ie(s=>({...s,beschreibung:e.target.value})),rows:3,placeholder:"Produktbeschreibung..."})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Preis (€) *"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:(null==ae?void 0:ae.preis)||0,onChange:e=>ie(s=>({...s,preis:parseFloat(e.target.value)||0}))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Lieferzeit"}),e.jsx("input",{type:"text",value:(null==ae?void 0:ae.lieferzeit)||"",onChange:e=>ie(s=>({...s,lieferzeit:e.target.value})),placeholder:"z.B. 3-5 Werktage"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Details (Aufzählungspunkte)"}),e.jsxs("div",{className:"details-list",children:[((null==ae?void 0:ae.details)||[]).map((s,n)=>e.jsxs("div",{className:"detail-item",children:[e.jsx("input",{type:"text",value:s,onChange:e=>((e,s)=>{const n=[...ae.details||[]];n[e]=s,ie(e=>({...e,details:n}))})(n,e.target.value),placeholder:"z.B. DIN A4 Format"}),e.jsx("button",{type:"button",onClick:()=>(e=>{ie(s=>({...s,details:s.details.filter((s,n)=>n!==e)}))})(n),className:"btn-remove-detail",children:e.jsx(k,{size:16})})]},n)),e.jsxs("button",{type:"button",onClick:Se,className:"btn-add-detail",children:[e.jsx(d,{size:16})," Detail hinzufügen"]})]})]}),e.jsxs("div",{className:"form-row checkboxes",children:[e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:(null==ae?void 0:ae.featured)||!1,onChange:e=>ie(s=>({...s,featured:e.target.checked}))}),e.jsx("span",{children:"Hervorgehoben (Featured)"})]}),e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:!1!==(null==ae?void 0:ae.aktiv),onChange:e=>ie(s=>({...s,aktiv:e.target.checked}))}),e.jsx("span",{children:"Aktiv (sichtbar im Shop)"})]})]})]}),e.jsxs("div",{className:"editor-footer",children:[e.jsx("button",{className:"btn-cancel",onClick:()=>te(!1),children:"Abbrechen"}),e.jsx("button",{className:"btn-save",onClick:_e,disabled:le,children:le?e.jsxs(e.Fragment,{children:[e.jsx(L,{size:18,className:"spin"})," Speichern..."]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{size:18})," Speichern"]})})]})]})});return X?e.jsx("div",{className:"verband-shop",children:e.jsxs("div",{className:"shop-loading",children:[e.jsx(L,{size:48,className:"spin"}),e.jsx("p",{children:"Shop wird geladen..."})]})}):Q?e.jsx("div",{className:"verband-shop",children:e.jsxs("div",{className:"shop-error",children:[e.jsx(M,{size:48}),e.jsx("p",{children:Q}),e.jsx("button",{onClick:()=>window.location.reload(),children:"Erneut versuchen"})]})}):e.jsxs("div",{className:"verband-shop",children:[e.jsxs("div",{className:"shop-header",children:[e.jsxs("div",{className:"shop-search",children:[e.jsx(f,{size:18}),e.jsx("input",{type:"text",placeholder:"Produkte suchen...",value:m,onChange:e=>N(e.target.value)})]}),e.jsxs("button",{className:"btn-warenkorb",onClick:()=>w(!0),children:[e.jsx(R,{size:20}),ye>0&&e.jsx("span",{className:"warenkorb-badge",children:ye})]})]}),e.jsxs("div",{className:"shop-kategorien",children:[e.jsxs("button",{className:"kategorie-btn "+("alle"===p?"active":""),onClick:()=>g("alle"),children:[e.jsx(E,{size:18}),e.jsx("span",{children:"Alle"})]}),c.filter(e=>e.isParent).map(s=>{const n=c.filter(e=>e.parentDbId===s.dbId),t=n.length>0;return e.jsx("div",{className:"kategorie-gruppe",children:t?e.jsxs("div",{className:"kategorie-dropdown",children:[e.jsxs("button",{className:"kategorie-btn parent has-dropdown "+(p===s.id||n.some(e=>e.id===p)?"active":""),onClick:()=>ce(oe===s.id?null:s.id),style:{"--kat-color":s.color},children:[e.jsx(s.icon,{size:18}),e.jsx("span",{children:s.name}),e.jsx(y,{size:14,className:"dropdown-arrow "+(oe===s.id?"open":"")})]}),oe===s.id&&e.jsxs("div",{className:"dropdown-menu",children:[e.jsxs("button",{className:"dropdown-item "+(p===s.id?"active":""),onClick:()=>{g(s.id),ce(null)},children:["Alle ",s.name]}),n.map(s=>{const n=s.icon;return e.jsxs("button",{className:"dropdown-item "+(p===s.id?"active":""),onClick:()=>{g(s.id),ce(null)},style:{"--kat-color":s.color},children:[e.jsx(n,{size:14}),s.name]},s.id)})]})]}):e.jsxs("button",{className:"kategorie-btn "+(p===s.id?"active":""),onClick:()=>g(s.id),style:{"--kat-color":s.color},children:[e.jsx(s.icon,{size:18}),e.jsx("span",{children:s.name})]})},s.id)}),se&&e.jsxs("button",{className:"kategorie-btn admin-btn",onClick:()=>{var e;ie({id:null,sku:"",name:"",beschreibung:"",preis:0,kategorie_id:(null==(e=he[0])?void 0:e.id)||1,details:[],optionen:null,lieferzeit:"3-5 Werktage",featured:!1,aktiv:!0}),te(!0)},children:[e.jsx(d,{size:18}),e.jsx("span",{children:"Neu"})]})]}),"alle"===p&&""===m&&e.jsxs("div",{className:"shop-featured",children:[e.jsxs("h2",{children:[e.jsx(P,{size:20})," Beliebte Produkte"]}),e.jsx("div",{className:"featured-grid",children:me.map(s=>e.jsx(we,{produkt:s},s.id))})]}),e.jsxs("div",{className:"shop-produkte",children:["alle"!==p&&e.jsxs("h2",{children:[e.jsx(Ce,{kategorie:p,size:24}),null==(n=c.find(e=>e.id===p))?void 0:n.name]}),m&&e.jsxs("p",{className:"search-results",children:[ge.length,' Ergebnis(se) für "',m,'"']}),e.jsx("div",{className:"produkte-grid",children:ge.map(s=>e.jsx(we,{produkt:s},s.id))}),0===ge.length&&e.jsxs("div",{className:"keine-produkte",children:[e.jsx(E,{size:48}),e.jsx("p",{children:"Keine Produkte gefunden"})]})]}),e.jsxs("div",{className:"shop-versand-info",children:[e.jsxs("div",{className:"info-item",children:[e.jsx(W,{size:24}),e.jsxs("div",{children:[e.jsx("strong",{children:"Kostenloser Versand"}),e.jsx("span",{children:"ab 50 € Bestellwert"})]})]}),e.jsxs("div",{className:"info-item",children:[e.jsx(T,{size:24}),e.jsxs("div",{children:[e.jsx("strong",{children:"Sichere Zahlung"}),e.jsx("span",{children:"Rechnung oder Vorkasse"})]})]}),e.jsxs("div",{className:"info-item",children:[e.jsx(A,{size:24}),e.jsxs("div",{children:[e.jsx("strong",{children:"Schnelle Lieferung"}),e.jsx("span",{children:"3-7 Werktage"})]})]})]}),D&&e.jsx(Be,{produkt:D}),e.jsx(Ie,{}),B&&e.jsx(Te,{}),K&&e.jsx(De,{}),ne&&e.jsx(Fe,{}),C&&e.jsx("div",{className:"sidebar-overlay",onClick:()=>w(!1)})]})},ce=()=>{const{token:r}=t();n();const[d,c]=s.useState(!0),[p,x]=s.useState(""),[g,v]=s.useState("overview"),[f,y]=s.useState({mitgliedsschulen:0,einzelmitglieder:0,aktiveMitgliedschaften:0,pendingMitgliedschaften:0,turniere:0,events:0,jahresbeitraege:0,offeneBeitraege:0}),[k,z]=s.useState([]),[N,_]=s.useState([]),[S,C]=s.useState([]);s.useEffect(()=>{w()},[]);const w=async()=>{c(!0),x("");try{const[e,s,n]=await Promise.all([a.get(`${i.apiBaseUrl}/verbandsmitgliedschaften/stats`,{headers:{Authorization:`Bearer ${r}`}}).catch(()=>({data:{success:!1}})),a.get(`${i.apiBaseUrl}/verbandsmitgliedschaften?limit=5`,{headers:{Authorization:`Bearer ${r}`}}).catch(()=>({data:{success:!1,mitgliedschaften:[]}})),a.get(`${i.apiBaseUrl}/events?public=true&limit=5`,{headers:{Authorization:`Bearer ${r}`}}).catch(()=>({data:{success:!1,events:[]}}))]);if(e.data.success){const s=e.data.stats||{};y({mitgliedsschulen:s.dojos||0,einzelmitglieder:s.einzelpersonen||0,aktiveMitgliedschaften:s.aktiv||0,pendingMitgliedschaften:s.pending||0,turniere:s.turniere||0,events:s.events||0,jahresbeitraege:s.jahresbeitraege||0,offeneBeitraege:s.offene_beitraege||0})}s.data.success&&z(s.data.mitgliedschaften||[]),n.data.success&&_(n.data.events||[])}catch(e){console.error("Fehler beim Laden der Verbandsdaten:",e),x("Fehler beim Laden der Verbandsdaten")}finally{c(!1)}},B=[{id:"overview",label:"Übersicht",icon:Z},{id:"mitglieder",label:"Mitglieder",icon:q},{id:"shop",label:"Shop",icon:R},{id:"entwicklung",label:"Entwicklung",icon:X},{id:"support",label:"Support",icon:Y},{id:"turniere",label:"Turniere",icon:Q},{id:"events",label:"Events",icon:m},{id:"finanzen",label:"Finanzen",icon:h}],I=({status:s})=>{const n={aktiv:{color:"#22c55e",bg:"rgba(34, 197, 94, 0.2)",label:"Aktiv"},pending:{color:"#f59e0b",bg:"rgba(245, 158, 11, 0.2)",label:"Ausstehend"},inaktiv:{color:"#6b7280",bg:"rgba(107, 114, 128, 0.2)",label:"Inaktiv"},gekuendigt:{color:"#ef4444",bg:"rgba(239, 68, 68, 0.2)",label:"Gekündigt"}},t=n[s]||n.pending;return e.jsx("span",{style:{display:"inline-flex",alignItems:"center",padding:"4px 10px",borderRadius:"12px",fontSize:"0.75rem",fontWeight:600,color:t.color,background:t.bg},children:t.label})},T=()=>e.jsxs("div",{className:"verband-overview",children:[e.jsxs("div",{className:"verband-stats-grid",children:[e.jsxs("div",{className:"verband-stat-card primary",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(o,{size:24})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("span",{className:"stat-value",children:f.mitgliedsschulen}),e.jsx("span",{className:"stat-label",children:"Mitgliedsschulen"})]}),e.jsx("div",{className:"stat-badge",children:e.jsx("span",{className:"badge-text",children:"99€/Jahr"})})]}),e.jsxs("div",{className:"verband-stat-card secondary",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(q,{size:24})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("span",{className:"stat-value",children:f.einzelmitglieder}),e.jsx("span",{className:"stat-label",children:"Einzelmitglieder"})]}),e.jsx("div",{className:"stat-badge",children:e.jsx("span",{className:"badge-text",children:"49€/Jahr"})})]}),e.jsxs("div",{className:"verband-stat-card success",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(ee,{size:24})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("span",{className:"stat-value",children:f.aktiveMitgliedschaften}),e.jsx("span",{className:"stat-label",children:"Aktive Mitgliedschaften"})]})]}),e.jsxs("div",{className:"verband-stat-card warning",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(A,{size:24})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("span",{className:"stat-value",children:f.pendingMitgliedschaften}),e.jsx("span",{className:"stat-label",children:"Ausstehend"})]})]}),e.jsxs("div",{className:"verband-stat-card gold",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(Q,{size:24})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("span",{className:"stat-value",children:f.turniere}),e.jsx("span",{className:"stat-label",children:"Turniere"})]})]}),e.jsxs("div",{className:"verband-stat-card info",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(h,{size:24})}),e.jsxs("div",{className:"stat-content",children:[e.jsxs("span",{className:"stat-value",children:[f.jahresbeitraege.toLocaleString("de-DE"),"€"]}),e.jsx("span",{className:"stat-label",children:"Jahresbeiträge"})]})]})]}),e.jsxs("div",{className:"verband-content-grid",children:[e.jsxs("div",{className:"verband-panel",children:[e.jsxs("div",{className:"panel-header",children:[e.jsxs("h3",{children:[e.jsx(q,{size:18})," Neueste Mitgliedschaften"]}),e.jsxs("button",{className:"btn-link",onClick:()=>v("mitglieder"),children:["Alle anzeigen ",e.jsx(U,{size:14})]})]}),e.jsx("div",{className:"panel-content",children:k.length>0?e.jsx("div",{className:"mitgliedschaft-list",children:k.map(s=>e.jsxs("div",{className:"mitgliedschaft-item",children:[e.jsx("div",{className:"mitgliedschaft-icon",children:"dojo"===s.typ?e.jsx(o,{size:20}):e.jsx(q,{size:20})}),e.jsxs("div",{className:"mitgliedschaft-info",children:[e.jsx("span",{className:"mitgliedschaft-name",children:"dojo"===s.typ?s.dojo_name:`${s.person_vorname} ${s.person_nachname}`}),e.jsxs("span",{className:"mitgliedschaft-meta",children:[s.mitgliedsnummer," • seit ",new Date(s.beitritt_datum).toLocaleDateString("de-DE")]})]}),e.jsx(I,{status:s.status})]},s.id))}):e.jsxs("div",{className:"empty-state",children:[e.jsx(q,{size:32}),e.jsx("p",{children:"Keine Mitgliedschaften vorhanden"})]})})]}),e.jsxs("div",{className:"verband-panel",children:[e.jsxs("div",{className:"panel-header",children:[e.jsxs("h3",{children:[e.jsx(m,{size:18})," Kommende Events"]}),e.jsxs("button",{className:"btn-link",onClick:()=>v("events"),children:["Alle anzeigen ",e.jsx(U,{size:14})]})]}),e.jsx("div",{className:"panel-content",children:N.length>0?e.jsx("div",{className:"event-list",children:N.map(s=>e.jsxs("div",{className:"event-item",children:[e.jsxs("div",{className:"event-date",children:[e.jsx("span",{className:"date-day",children:new Date(s.datum).getDate()}),e.jsx("span",{className:"date-month",children:new Date(s.datum).toLocaleDateString("de-DE",{month:"short"})})]}),e.jsxs("div",{className:"event-info",children:[e.jsx("span",{className:"event-title",children:s.titel}),e.jsx("span",{className:"event-location",children:s.ort||"Online"})]})]},s.id))}):e.jsxs("div",{className:"empty-state",children:[e.jsx(m,{size:32}),e.jsx("p",{children:"Keine kommenden Events"})]})})]})]}),e.jsxs("div",{className:"verband-quick-actions",children:[e.jsx("h3",{children:"Schnellzugriff"}),e.jsxs("div",{className:"quick-action-grid",children:[e.jsxs("button",{className:"quick-action-btn",onClick:()=>v("mitglieder"),children:[e.jsx(se,{size:24}),e.jsx("span",{children:"Neues Mitglied"})]}),e.jsxs("button",{className:"quick-action-btn",onClick:()=>window.open("https://events.tda-intl.org","_blank"),children:[e.jsx(Q,{size:24}),e.jsx("span",{children:"Turnier erstellen"})]}),e.jsxs("button",{className:"quick-action-btn",onClick:()=>v("finanzen"),children:[e.jsx(b,{size:24}),e.jsx("span",{children:"Beiträge verwalten"})]}),e.jsxs("button",{className:"quick-action-btn",onClick:()=>window.open("https://www.tda-intl.com","_blank"),children:[e.jsx(J,{size:24}),e.jsx("span",{children:"Verbandswebsite"})]})]})]})]}),D=()=>e.jsxs("div",{className:"verband-turniere",children:[e.jsxs("div",{className:"info-banner",children:[e.jsx(Q,{size:24}),e.jsxs("div",{children:[e.jsx("h4",{children:"Turnierverwaltung"}),e.jsx("p",{children:"Die Turniere werden über die separate Turniersoftware verwaltet."}),e.jsxs("a",{href:"https://events.tda-intl.org",target:"_blank",rel:"noopener noreferrer",className:"btn-primary",children:["Zur Turniersoftware ",e.jsx(U,{size:16})]})]})]}),e.jsx("div",{className:"verband-stats-grid",style:{marginTop:"2rem"},children:e.jsxs("div",{className:"verband-stat-card gold",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(Q,{size:24})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("span",{className:"stat-value",children:f.turniere}),e.jsx("span",{className:"stat-label",children:"Turniere gesamt"})]})]})})]}),F=()=>e.jsxs("div",{className:"verband-events",children:[e.jsxs("div",{className:"panel-header",children:[e.jsxs("h3",{children:[e.jsx(m,{size:20})," Verbands-Events"]}),e.jsxs("button",{className:"btn-secondary",children:[e.jsx(ne,{size:16})," Event erstellen"]})]}),N.length>0?e.jsx("div",{className:"events-list-full",children:N.map(s=>e.jsxs("div",{className:"event-card",children:[e.jsxs("div",{className:"event-card-date",children:[e.jsx("span",{className:"date-day",children:new Date(s.datum).getDate()}),e.jsx("span",{className:"date-month",children:new Date(s.datum).toLocaleDateString("de-DE",{month:"long"})}),e.jsx("span",{className:"date-year",children:new Date(s.datum).getFullYear()})]}),e.jsxs("div",{className:"event-card-content",children:[e.jsx("h4",{children:s.titel}),e.jsx("p",{children:s.beschreibung}),e.jsx("div",{className:"event-meta",children:e.jsxs("span",{children:[e.jsx(m,{size:14})," ",s.ort||"Online"]})})]})]},s.id))}):e.jsxs("div",{className:"empty-state large",children:[e.jsx(m,{size:48}),e.jsx("h4",{children:"Keine Events geplant"}),e.jsx("p",{children:"Erstellen Sie neue Events für den Verband."})]})]}),M=()=>e.jsxs("div",{className:"verband-finanzen",children:[e.jsxs("div",{className:"verband-stats-grid",children:[e.jsxs("div",{className:"verband-stat-card success",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(h,{size:24})}),e.jsxs("div",{className:"stat-content",children:[e.jsxs("span",{className:"stat-value",children:[f.jahresbeitraege.toLocaleString("de-DE"),"€"]}),e.jsx("span",{className:"stat-label",children:"Eingegangene Beiträge"})]})]}),e.jsxs("div",{className:"verband-stat-card warning",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(u,{size:24})}),e.jsxs("div",{className:"stat-content",children:[e.jsxs("span",{className:"stat-value",children:[f.offeneBeitraege.toLocaleString("de-DE"),"€"]}),e.jsx("span",{className:"stat-label",children:"Offene Beiträge"})]})]}),e.jsxs("div",{className:"verband-stat-card info",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(j,{size:24})}),e.jsxs("div",{className:"stat-content",children:[e.jsxs("span",{className:"stat-value",children:[99*f.mitgliedsschulen+49*f.einzelmitglieder,"€"]}),e.jsx("span",{className:"stat-label",children:"Erwartete Jahresbeiträge"})]})]})]}),e.jsxs("div",{className:"info-banner",style:{marginTop:"2rem"},children:[e.jsx(te,{size:24}),e.jsxs("div",{children:[e.jsx("h4",{children:"Beitragsstruktur"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Mitgliedsschulen (Dojos):"})," 99€ pro Jahr",e.jsx("br",{}),e.jsx("strong",{children:"Einzelmitglieder:"})," 49€ pro Jahr"]})]})]})]});return d?e.jsx("div",{className:"verband-dashboard loading",children:e.jsxs("div",{className:"loading-spinner",children:[e.jsx(L,{size:40,className:"spin"}),e.jsx("p",{children:"Lade Verbandsdaten..."})]})}):e.jsxs("div",{className:"verband-dashboard",children:[e.jsxs("div",{className:"verband-subheader",children:[e.jsxs("div",{className:"subheader-left",children:[e.jsx(J,{size:20,className:"subheader-icon"}),e.jsx("span",{children:"Verbandsverwaltung"})]}),e.jsxs("button",{className:"btn-refresh-small",onClick:w,children:[e.jsx(l,{size:14})," Aktualisieren"]})]}),p&&e.jsxs("div",{className:"error-banner",children:[e.jsx(u,{size:20}),e.jsx("span",{children:p})]}),e.jsx("div",{className:"verband-tabs",children:B.map(s=>e.jsxs("button",{className:"verband-tab "+(g===s.id?"active":""),onClick:()=>v(s.id),children:[e.jsx(s.icon,{size:18}),e.jsx("span",{children:s.label})]},s.id))}),e.jsxs("div",{className:"verband-tab-content",children:["overview"===g&&e.jsx(T,{}),"mitglieder"===g&&e.jsx(le,{}),"shop"===g&&e.jsx(oe,{}),"entwicklung"===g&&e.jsx(ae,{bereich:"verband"}),"support"===g&&e.jsx(ie,{bereich:"verband"}),"turniere"===g&&e.jsx(D,{}),"events"===g&&e.jsx(F,{}),"finanzen"===g&&e.jsx(M,{})]})]})};export{ce as default};
