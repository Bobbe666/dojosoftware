import{a as e,j as s,b as a}from"./query-Caj74EYQ.js";import{a as n,u as r,f as i,c as t,b as l,d,e as c,g as o,h,L as m,S as x,i as u,j as p,k as j}from"./index-1YdTwRLp.js";import{j as b}from"./index-CkXcCt97.js";/* empty css                  */import{D as g,S as v,T as f,A as N}from"./TrialBanner-D52LBnhq.js";import y from"./MemberDashboard-CylUk2fm.js";import{m as k,n as _,o as z,A as w,D as S,p as A,T as D,q as C,r as E,k as B,G as T,s as F,t as M,u as R,v as L,W as I,F as P,w as $,g as U,x as V,d as W,y as K,z as O,J as G,P as Z,K as q,N as J,O as H,Q as Y,V as Q,a as X,b as ee,X as se,Y as ae,_ as ne,$ as re,R as ie,a0 as te,a1 as le,a2 as de,a3 as ce,a4 as oe}from"./icons-UlaFLuKM.js";import{R as he,A as me,C as xe,X as ue,Y as pe,T as je,a as be,B as ge,b as ve,P as fe,c as Ne,d as ye,L as ke,e as _e}from"./charts-QHQg_ypW.js";import{Z as ze}from"./ZieleEntwicklung-DztYF_Im.js";import we from"./SupportTickets-B9a6lul-.js";import{V as Se,a as Ae}from"./VerbandDashboard-Cna51BW-.js";import De from"./FeatureBoard-uhEU9fbw.js";import{u as Ce,d as Ee,O as Be}from"./vendor-router-B2AaIOtG.js";import{A as Te}from"./AgbStatusWidget-DyCvsLDz.js";import"./MemberHeader-APnguvix.js";/* empty css                      */import"./index-wRQyZq66.js";/* empty css                         *//* empty css                       */const Fe=["#FFD700","#FFA500","#FF6B35","#4ECDC4","#45B7D1","#96CEB4"],Me=["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],Re=(e,s=0)=>{const a=parseFloat(e);return isNaN(a)||null==e?s>0?"0,00":"0":a.toLocaleString("de-DE",{minimumFractionDigits:s,maximumFractionDigits:s})},Le=({icon:e,title:a,subtitle:n})=>s.jsxs("div",{className:"empty-state",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"40px 20px",color:"rgba(255,255,255,0.5)",textAlign:"center"},children:[s.jsx(e,{size:48,style:{marginBottom:"16px",opacity:.5}}),s.jsx("div",{style:{fontSize:"1.1rem",fontWeight:500,marginBottom:"8px"},children:a}),s.jsx("div",{style:{fontSize:"0.9rem",opacity:.7},children:n})]}),Ie=({token:a})=>{const[r,i]=e.useState(!0),[t,l]=e.useState(""),[d,c]=e.useState(null);e.useEffect(()=>{o()},[]);const o=async()=>{var e,s;i(!0),l("");try{const e=await n.get("/admin/statistics",{headers:{Authorization:`Bearer ${a}`}});c(e.data.statistics),console.log("✅ Statistiken geladen:",e.data.statistics)}catch(r){console.error("❌ Fehler beim Laden der Statistiken:",r),l((null==(s=null==(e=r.response)?void 0:e.data)?void 0:s.message)||"Fehler beim Laden der Statistiken")}finally{i(!1)}};if(r)return s.jsxs("div",{className:"statistics-loading",children:[s.jsx("div",{className:"loading-spinner"}),s.jsx("p",{children:"Lade Statistiken..."})]});if(t)return s.jsxs("div",{className:"statistics-error",children:[s.jsx("p",{children:t}),s.jsx("button",{onClick:o,className:"btn btn-primary",children:"Erneut versuchen"})]});if(!d)return s.jsx("div",{className:"statistics-tab",children:s.jsx(Le,{icon:k,title:"Noch keine Statistiken verfügbar",subtitle:"Sobald Daten vorliegen, werden hier Statistiken angezeigt"})});const h=d.memberStatus||{aktiv:0,inaktiv:0},m=d.trialStats||{trial:0,active:0},x=Array.isArray(d.revenuePerDojo)?d.revenuePerDojo:[],u=(Array.isArray(d.revenueTrend)?d.revenueTrend:[]).map(e=>({monat:Me[(e.monat||1)-1],umsatz:parseFloat(e.umsatz)||0})),p=(j=x,b="umsatz",Array.isArray(j)&&0!==j.length?j.reduce((e,s)=>e+(parseFloat(s[b])||0),0):0);var j,b;const g=p>0||u.some(e=>e.umsatz>0);return s.jsxs("div",{className:"statistics-tab",children:[s.jsxs("div",{className:"stats-kpi-grid",children:[s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon success",children:s.jsx(_,{size:24})}),s.jsxs("div",{className:"kpi-content",children:[s.jsx("div",{className:"kpi-label",children:"Conversion Rate"}),s.jsxs("div",{className:"kpi-value",children:[Re(d.conversionRate||0),"%"]}),s.jsx("div",{className:"kpi-sublabel",children:"Trial → Active"})]})]}),s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon primary",children:s.jsx(z,{size:24})}),s.jsxs("div",{className:"kpi-content",children:[s.jsx("div",{className:"kpi-label",children:"Aktive Mitglieder"}),s.jsx("div",{className:"kpi-value",children:Re(h.aktiv)}),s.jsxs("div",{className:"kpi-sublabel",children:["von ",Re((h.aktiv||0)+(h.inaktiv||0))," gesamt"]})]})]}),s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon warning",children:s.jsx(w,{size:24})}),s.jsxs("div",{className:"kpi-content",children:[s.jsx("div",{className:"kpi-label",children:"Trial Dojos"}),s.jsx("div",{className:"kpi-value",children:Re(m.trial)}),s.jsxs("div",{className:"kpi-sublabel",children:[Re(m.active)," aktive Abos"]})]})]}),s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon success",children:s.jsx(S,{size:24})}),s.jsxs("div",{className:"kpi-content",children:[s.jsxs("div",{className:"kpi-label",children:["Gesamt-Umsatz ",(new Date).getFullYear()]}),s.jsx("div",{className:"kpi-value",children:p>0?`${Re(p,2)} €`:"Noch keine Umsätze"}),s.jsx("div",{className:"kpi-sublabel",children:x.length>0?`${x.length} Dojos`:"Keine Daten"})]})]})]}),s.jsxs("div",{className:"charts-grid",children:[s.jsxs("div",{className:"chart-card",children:[s.jsxs("h3",{className:"chart-title",children:[s.jsx(A,{size:18}),"Umsatz-Entwicklung ",(new Date).getFullYear()]}),u.length>0&&g?s.jsx(he,{width:"100%",height:300,children:s.jsxs(me,{data:u,children:[s.jsx("defs",{children:s.jsxs("linearGradient",{id:"colorUmsatz",x1:"0",y1:"0",x2:"0",y2:"1",children:[s.jsx("stop",{offset:"5%",stopColor:"#FFD700",stopOpacity:.8}),s.jsx("stop",{offset:"95%",stopColor:"#FFD700",stopOpacity:0})]})}),s.jsx(xe,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.1)"}),s.jsx(ue,{dataKey:"monat",stroke:"#fff"}),s.jsx(pe,{stroke:"#fff"}),s.jsx(je,{contentStyle:{backgroundColor:"#1a1a2e",border:"1px solid rgba(255,255,255,0.2)",borderRadius:"8px"},labelStyle:{color:"#FFD700"},formatter:e=>[`${Re(e,2)} €`,"Umsatz"]}),s.jsx(be,{type:"monotone",dataKey:"umsatz",stroke:"#FFD700",fillOpacity:1,fill:"url(#colorUmsatz)"})]})}):s.jsx(Le,{icon:A,title:"Noch keine Umsätze",subtitle:"Umsatzdaten werden hier angezeigt, sobald Einnahmen verbucht werden"})]}),s.jsxs("div",{className:"chart-card",children:[s.jsxs("h3",{className:"chart-title",children:[s.jsx(S,{size:18}),"Umsatz pro Dojo"]}),x.length>0&&p>0?s.jsx(he,{width:"100%",height:300,children:s.jsxs(ge,{data:x,children:[s.jsx(xe,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.1)"}),s.jsx(ue,{dataKey:"dojoname",stroke:"#fff",angle:-45,textAnchor:"end",height:100}),s.jsx(pe,{stroke:"#fff"}),s.jsx(je,{contentStyle:{backgroundColor:"#1a1a2e",border:"1px solid rgba(255,255,255,0.2)",borderRadius:"8px"},labelStyle:{color:"#FFD700"},formatter:e=>[`${Re(e,2)} €`,"Umsatz"]}),s.jsx(ve,{dataKey:"umsatz",fill:"#FFD700"})]})}):s.jsx(Le,{icon:S,title:"Noch keine Umsätze pro Dojo",subtitle:"Hier werden Umsätze nach Dojo aufgeschlüsselt"})]}),s.jsxs("div",{className:"chart-card",children:[s.jsxs("h3",{className:"chart-title",children:[s.jsx(w,{size:18}),"Subscription Status"]}),Array.isArray(d.subscriptionDistribution)&&d.subscriptionDistribution.length>0?s.jsx(he,{width:"100%",height:300,children:s.jsxs(fe,{children:[s.jsx(Ne,{data:d.subscriptionDistribution,cx:"50%",cy:"50%",labelLine:!1,label:({status:e,anzahl:s})=>`${e}: ${Re(s)}`,outerRadius:100,fill:"#8884d8",dataKey:"anzahl",nameKey:"status",children:d.subscriptionDistribution.map((e,a)=>s.jsx(ye,{fill:Fe[a%Fe.length]},`cell-${a}`))}),s.jsx(je,{contentStyle:{backgroundColor:"#1a1a2e",border:"1px solid rgba(255,255,255,0.2)",borderRadius:"8px"}})]})}):s.jsx(Le,{icon:w,title:"Keine Abonnements",subtitle:"Hier wird die Verteilung der Abo-Status angezeigt"})]}),s.jsxs("div",{className:"chart-card",children:[s.jsxs("h3",{className:"chart-title",children:[s.jsx(z,{size:18}),"Top Dojos nach Mitgliedern"]}),Array.isArray(d.topDojos)&&d.topDojos.length>0?s.jsx(he,{width:"100%",height:300,children:s.jsxs(ge,{data:d.topDojos,layout:"vertical",children:[s.jsx(xe,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.1)"}),s.jsx(ue,{type:"number",stroke:"#fff"}),s.jsx(pe,{dataKey:"dojoname",type:"category",stroke:"#fff",width:150}),s.jsx(je,{contentStyle:{backgroundColor:"#1a1a2e",border:"1px solid rgba(255,255,255,0.2)",borderRadius:"8px"},labelStyle:{color:"#FFD700"}}),s.jsx(ve,{dataKey:"mitglieder",fill:"#4ECDC4"})]})}):s.jsx(Le,{icon:z,title:"Noch keine Dojos mit Mitgliedern",subtitle:"Top Dojos werden hier angezeigt, sobald Mitglieder registriert sind"})]})]})]})},Pe={verband:"#3b82f6",software:"#10b981",schulen:"#f59e0b",gesamt:"#8b5cf6",positiv:"#22c55e",negativ:"#ef4444",warnung:"#f97316"},$e=()=>{var a,n,l,d,c,o,h,m,x,u,p,j,b,g,v,f,N,y,k,w,U,V;const{dojos:W}=r(),[K,O]=e.useState(!0),[G,Z]=e.useState(null),[q,J]=e.useState("month"),[H,Y]=e.useState("alle"),[Q,X]=e.useState(null),[ee,se]=e.useState(null),[ae,ne]=e.useState(null),[re,ie]=e.useState(null),[te,le]=e.useState([]);e.useEffect(()=>{de()},[q]);const de=async()=>{try{O(!0),Z(null);const e=W&&W.length>0?W.map(e=>e.id).join(","):"2,3",[s,a,n,r,l]=await Promise.all([i(`${t.apiBaseUrl}/admin/finance`),i(`${t.apiBaseUrl}/admin/statistics`),i(`${t.apiBaseUrl}/admin/contracts`),i(`${t.apiBaseUrl}/finanzcockpit/stats?period=${q}&dojo_ids=${e}`),i(`${t.apiBaseUrl}/finanzcockpit/timeline?months=12&dojo_ids=${e}`)]);if(s.ok){const e=await s.json();X(e.success?e.finance:e)}if(a.ok){const e=await a.json();se(e.success?e.statistics:e)}if(n.ok){const e=await n.json();ne(e.success?e.contracts:e)}if(r.ok){const e=await r.json();ie(e.success?e.data:e)}if(l.ok){const e=await l.json();if(e.success&&e.data){const s=ce(e.data);le(s)}}O(!1)}catch(e){console.error("Fehler beim Laden der Finanzdaten:",e),Z(e.message),O(!1)}},ce=e=>{if(!e||e.length<3)return e;const s=e.length;let a=0,n=0,r=0,i=0;e.forEach((e,s)=>{const t=e.umsatz||0;a+=s,n+=t,r+=s*t,i+=s*s});const t=s*i-a*a;if(0===t)return e;const l=(s*r-a*n)/t,d=(n-l*a)/s,c=e.map((e,s)=>({...e,trend:Math.max(0,l*s+d)})),o=["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"];for(let h=1;h<=6;h++){const e=new Date;e.setMonth(e.getMonth()+h);const a=o[e.getMonth()]+" "+e.getFullYear().toString().slice(-2),n=Math.max(0,l*(s+h-1)+d);c.push({label:a,umsatz:null,prognose:n,prognoseMin:.85*n,prognoseMax:1.15*n,isPrognose:!0})}return c},oe=e=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR",maximumFractionDigits:0}).format(e||0),ge=e=>`${e>=0?"+":""}${(e||0).toFixed(1)}%`,ve=e=>new Intl.NumberFormat("de-DE").format(e||0),ze=e.useMemo(()=>{var e,s,a,n,r,i,t,l,d,c,o,h,m,x;if(!Q&&!re)return null;const u=(null==(s=null==(e=null==Q?void 0:Q.verband)?void 0:e.einnahmen)?void 0:s.jahresbeitrag_erwartet)||0,p=u/12,j=(null==(n=null==(a=null==Q?void 0:Q.verband)?void 0:a.einnahmen)?void 0:n.bezahlt)||0,b=(null==(r=null==Q?void 0:Q.subscriptionRevenue)?void 0:r.mrr)||0,g=(null==re?void 0:re.gesamteinnahmen)||0,v=p+b+g,f=v-((null==re?void 0:re.gesamteAusgaben)||0),N=((null==(t=null==(i=null==Q?void 0:Q.verband)?void 0:i.einnahmen)?void 0:t.offen)||0)+((null==re?void 0:re.offeneRechnungenBetrag)||0),y=(null==re?void 0:re.offeneRechnungen)||0;return{gesamt:{value:v,trend:(null==re?void 0:re.einnahmenTrend)||0},verband:{value:p,jahresbeitrag:u,bezahlt:j,mitglieder:(null==(d=null==(l=null==Q?void 0:Q.verband)?void 0:l.mitglieder)?void 0:d.aktiv)||0,dojos:(null==(o=null==(c=null==Q?void 0:Q.verband)?void 0:c.mitglieder)?void 0:o.dojos)||0,einzelpersonen:(null==(m=null==(h=null==Q?void 0:Q.verband)?void 0:h.mitglieder)?void 0:m.einzelpersonen)||0},software:{value:b,arr:(null==(x=null==Q?void 0:Q.subscriptionRevenue)?void 0:x.arr)||0},schulen:{value:g,trend:(null==re?void 0:re.einnahmenTrend)||0},cashflow:{value:f,percent:v>0?f/v*100:0},offenePosten:{value:N,count:y}}},[Q,re]),we=e.useMemo(()=>ze?[{name:"Verband",value:ze.verband.value,color:Pe.verband},{name:"Software",value:ze.software.value,color:Pe.software},{name:"Schulen",value:ze.schulen.value,color:Pe.schulen}].filter(e=>e.value>0):[],[ze]);e.useMemo(()=>{if(!te||te.length<2)return[];te.find(e=>!e.isPrognose&&null!==e.umsatz);const e=te.length>1?te[te.length-8]:null;return[{name:"Aktuell",verband:0,software:(null==ze?void 0:ze.software.value)||0,schulen:(null==ze?void 0:ze.schulen.value)||0},{name:"Vormonat",verband:0,software:.95*((null==ze?void 0:ze.software.value)||0),schulen:(null==e?void 0:e.umsatz)||0}]},[te,ze]);const Se=e.useMemo(()=>{if(!ze)return null;const e=12*ze.gesamt.value*(1+(ze.gesamt.trend||0)/100);return{konservativ:.9*e,realistisch:e,optimistisch:1.15*e}},[ze]),Ae=e.useMemo(()=>{var e;const s=[];return(null==re?void 0:re.ueberfaelligeRechnungen)>0&&s.push({type:"warning",icon:D,text:`${re.ueberfaelligeRechnungen} Rechnungen überfällig (${oe(re.offeneRechnungenBetrag)})`}),(null==(e=null==ae?void 0:ae.renewals)?void 0:e.next30Days)>0&&s.push({type:"info",icon:C,text:`${ae.renewals.next30Days} Verträge laufen in 30 Tagen aus`}),(null==ze?void 0:ze.cashflow.value)<0&&s.push({type:"error",icon:E,text:`Negativer Cashflow: ${oe(ze.cashflow.value)}`}),(null==ze?void 0:ze.gesamt.trend)>10&&s.push({type:"success",icon:A,text:`Überdurchschnittliches Wachstum: ${ge(ze.gesamt.trend)}`}),s},[re,ae,ze]);return K?s.jsx("div",{className:"saf",children:s.jsxs("div",{className:"saf-card saf__loading",children:[s.jsx("div",{className:"saf__spinner"}),s.jsx("p",{children:"Finanzdaten werden geladen..."})]})}):G?s.jsx("div",{className:"saf",children:s.jsxs("div",{className:"saf-card saf__error",children:[s.jsx(B,{size:48}),s.jsx("h3",{children:"Fehler beim Laden"}),s.jsx("p",{children:G}),s.jsx("button",{onClick:de,children:"Erneut versuchen"})]})}):s.jsxs("div",{className:"saf",children:[s.jsx("header",{className:"saf-card saf__header",children:s.jsxs("div",{className:"saf__header-top",children:[s.jsxs("div",{className:"saf__headline",children:[s.jsx("span",{className:"saf__eyebrow",children:"TDA Int'l Org"}),s.jsx("h1",{className:"saf__title",children:"Finanzübersicht"}),s.jsx("p",{className:"saf__subtitle",children:"Alle Geschäftsbereiche auf einen Blick - Verband, Software & Schulen"})]}),s.jsxs("div",{className:"saf__controls",children:[s.jsx("div",{className:"saf__bereich-switcher",children:["alle","verband","software","schulen"].map(e=>s.jsxs("button",{className:H===e?"active":"",onClick:()=>Y(e),children:["alle"===e&&s.jsx(T,{size:14}),"verband"===e&&s.jsx(z,{size:14}),"software"===e&&s.jsx(F,{size:14}),"schulen"===e&&s.jsx(M,{size:14}),e.charAt(0).toUpperCase()+e.slice(1)]},e))}),s.jsxs("div",{className:"saf__period-selector",children:[s.jsx("button",{className:"month"===q?"active":"",onClick:()=>J("month"),children:"Monat"}),s.jsx("button",{className:"quarter"===q?"active":"",onClick:()=>J("quarter"),children:"Quartal"}),s.jsx("button",{className:"year"===q?"active":"",onClick:()=>J("year"),children:"Jahr"})]})]})]})}),ze&&s.jsxs("section",{className:`saf__kpi-grid saf__kpi-grid--${H}`,children:["alle"===H&&s.jsxs("div",{className:"saf-card saf__kpi-card saf__kpi-card--gesamt",children:[s.jsx("div",{className:"saf__kpi-icon",children:s.jsx(S,{size:20})}),s.jsxs("div",{className:"saf__kpi-content",children:[s.jsx("span",{className:"saf__kpi-label",children:"Gesamtumsatz"}),s.jsx("span",{className:"saf__kpi-value",children:oe(ze.gesamt.value)}),s.jsxs("span",{className:"saf__kpi-trend "+(ze.gesamt.trend>=0?"positive":"negative"),children:[ze.gesamt.trend>=0?s.jsx(R,{size:14}):s.jsx(L,{size:14}),ge(ze.gesamt.trend)]})]})]}),("alle"===H||"verband"===H)&&s.jsxs("div",{className:"saf-card saf__kpi-card saf__kpi-card--verband "+("verband"===H?"saf__kpi-card--expanded":""),children:[s.jsx("div",{className:"saf__kpi-icon",children:s.jsx(z,{size:20})}),s.jsxs("div",{className:"saf__kpi-content",children:[s.jsx("span",{className:"saf__kpi-label",children:"Verband"}),s.jsx("span",{className:"saf__kpi-value",children:oe(ze.verband.value)}),s.jsx("span",{className:"saf__kpi-detail",children:"verband"===H?`${ve(ze.verband.mitglieder)} aktive Mitglieder`:"Mitgliedsbeiträge & Events"}),"verband"===H&&s.jsx(s.Fragment,{children:s.jsxs("span",{className:"saf__kpi-detail",children:[ve(ze.verband.dojos)," Dojos | ",ve(ze.verband.einzelpersonen)," Einzelpersonen"]})})]})]}),("alle"===H||"software"===H)&&s.jsxs("div",{className:"saf-card saf__kpi-card saf__kpi-card--software "+("software"===H?"saf__kpi-card--expanded":""),children:[s.jsx("div",{className:"saf__kpi-icon",children:s.jsx(F,{size:20})}),s.jsxs("div",{className:"saf__kpi-content",children:[s.jsx("span",{className:"saf__kpi-label",children:"Software MRR"}),s.jsx("span",{className:"saf__kpi-value",children:oe(ze.software.value)}),s.jsxs("span",{className:"saf__kpi-detail",children:["ARR: ",oe(ze.software.arr)]}),"software"===H&&s.jsx(s.Fragment,{children:s.jsxs("span",{className:"saf__kpi-detail",children:["Aktive Abos: ",ve((null==(n=null==(a=null==Q?void 0:Q.subscriptionRevenue)?void 0:a.breakdown)?void 0:n.reduce((e,s)=>e+(s.anzahl||0),0))||0)]})})]})]}),("alle"===H||"schulen"===H)&&s.jsxs("div",{className:"saf-card saf__kpi-card saf__kpi-card--schulen "+("schulen"===H?"saf__kpi-card--expanded":""),children:[s.jsx("div",{className:"saf__kpi-icon",children:s.jsx(M,{size:20})}),s.jsxs("div",{className:"saf__kpi-content",children:[s.jsx("span",{className:"saf__kpi-label",children:"Schulen"}),s.jsx("span",{className:"saf__kpi-value",children:oe(ze.schulen.value)}),s.jsxs("span",{className:"saf__kpi-trend "+(ze.schulen.trend>=0?"positive":"negative"),children:[ze.schulen.trend>=0?s.jsx(R,{size:14}):s.jsx(L,{size:14}),ge(ze.schulen.trend)]}),"schulen"===H&&s.jsx(s.Fragment,{children:s.jsxs("span",{className:"saf__kpi-detail",children:[ve((null==re?void 0:re.anzahlVertraege)||0)," aktive Verträge"]})})]})]}),("alle"===H||"schulen"===H)&&s.jsxs("div",{className:"saf-card saf__kpi-card "+(ze.cashflow.value>=0?"saf__kpi-card--positive":"saf__kpi-card--negative"),children:[s.jsx("div",{className:"saf__kpi-icon",children:s.jsx(I,{size:20})}),s.jsxs("div",{className:"saf__kpi-content",children:[s.jsx("span",{className:"saf__kpi-label",children:"Cashflow"}),s.jsx("span",{className:"saf__kpi-value",children:oe(ze.cashflow.value)}),s.jsxs("span",{className:"saf__kpi-detail",children:[ge(ze.cashflow.percent)," Marge"]})]})]}),("alle"===H||"schulen"===H||"verband"===H)&&s.jsxs("div",{className:"saf-card saf__kpi-card "+(ze.offenePosten.count>0?"saf__kpi-card--warning":"saf__kpi-card--positive"),children:[s.jsx("div",{className:"saf__kpi-icon",children:s.jsx(P,{size:20})}),s.jsxs("div",{className:"saf__kpi-content",children:[s.jsx("span",{className:"saf__kpi-label",children:"Offene Posten"}),s.jsx("span",{className:"saf__kpi-value",children:oe(ze.offenePosten.value)}),s.jsxs("span",{className:"saf__kpi-detail",children:[ze.offenePosten.count," Rechnungen"]})]})]})]}),s.jsxs("section",{className:"saf__charts-grid "+("alle"!==H?"saf__charts-grid--single":""),children:[s.jsxs("div",{className:"saf-card saf__chart-card "+("alle"!==H?"saf__chart-card--full":"saf__chart-card--wide"),children:[s.jsxs("div",{className:"saf__card-header",children:[s.jsxs("div",{children:[s.jsx("span",{className:"saf__card-eyebrow",children:"alle"===H?"Entwicklung":`${H.charAt(0).toUpperCase()+H.slice(1)} - Entwicklung`}),s.jsxs("h3",{children:["schulen"===H?"Schulen-Umsatz & Prognose":"verband"===H?"Verband - Beiträge & Prognose":"software"===H?"Software - MRR & Prognose":"Umsatz & Prognose"," (12 + 6 Monate)"]})]}),s.jsx(A,{size:20})]}),s.jsx(he,{width:"100%",height:300,children:s.jsxs(me,{data:te,children:[s.jsxs("defs",{children:[s.jsxs("linearGradient",{id:"colorUmsatz",x1:"0",y1:"0",x2:"0",y2:"1",children:[s.jsx("stop",{offset:"5%",stopColor:Pe.schulen,stopOpacity:.3}),s.jsx("stop",{offset:"95%",stopColor:Pe.schulen,stopOpacity:0})]}),s.jsxs("linearGradient",{id:"colorPrognose",x1:"0",y1:"0",x2:"0",y2:"1",children:[s.jsx("stop",{offset:"5%",stopColor:Pe.gesamt,stopOpacity:.3}),s.jsx("stop",{offset:"95%",stopColor:Pe.gesamt,stopOpacity:0})]})]}),s.jsx(xe,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.1)"}),s.jsx(ue,{dataKey:"label",stroke:"rgba(255,255,255,0.6)",fontSize:12}),s.jsx(pe,{stroke:"rgba(255,255,255,0.6)",fontSize:12,tickFormatter:e=>Math.abs(e)>=1e6?new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR",maximumFractionDigits:1,notation:"compact"}).format(e||0):oe(e)}),s.jsx(je,{contentStyle:{backgroundColor:"rgba(15, 23, 42, 0.95)",border:"1px solid rgba(255,215,0,0.3)",borderRadius:"8px",color:"#fff"},formatter:e=>oe(e)}),s.jsx(ke,{}),s.jsx(be,{type:"monotone",dataKey:"umsatz",stroke:Pe.schulen,fill:"url(#colorUmsatz)",strokeWidth:2,name:"Ist-Umsatz",dot:{fill:Pe.schulen,r:3}}),s.jsx(be,{type:"monotone",dataKey:"prognose",stroke:Pe.gesamt,fill:"url(#colorPrognose)",strokeWidth:2,strokeDasharray:"5 5",name:"Prognose",dot:{fill:Pe.gesamt,r:3}}),s.jsx(_e,{type:"monotone",dataKey:"trend",stroke:"#22c55e",strokeWidth:2,strokeDasharray:"3 3",name:"Trend",dot:!1})]})})]}),"alle"===H&&s.jsxs("div",{className:"saf-card saf__chart-card",children:[s.jsxs("div",{className:"saf__card-header",children:[s.jsxs("div",{children:[s.jsx("span",{className:"saf__card-eyebrow",children:"Verteilung"}),s.jsx("h3",{children:"Umsatz nach Bereich"})]}),s.jsx($,{size:20})]}),s.jsx(he,{width:"100%",height:280,children:s.jsxs(fe,{children:[s.jsx(Ne,{data:we,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:3,dataKey:"value",label:({name:e,percent:s})=>`${e}: ${(100*s).toFixed(0)}%`,labelLine:!1,children:we.map((e,a)=>s.jsx(ye,{fill:e.color},`cell-${a}`))}),s.jsx(je,{contentStyle:{backgroundColor:"rgba(15, 23, 42, 0.95)",border:"1px solid rgba(255,215,0,0.3)",borderRadius:"8px",color:"#fff"},formatter:e=>oe(e)})]})}),s.jsx("div",{className:"saf__pie-legend",children:we.map(e=>s.jsxs("div",{className:"saf__pie-legend-item",children:[s.jsx("span",{className:"saf__pie-dot",style:{backgroundColor:e.color}}),s.jsx("span",{children:e.name}),s.jsx("span",{className:"saf__pie-value",children:oe(e.value)})]},e.name))})]})]}),Se&&s.jsx("section",{className:"saf__prognose-section",children:s.jsxs("div",{className:"saf-card",children:[s.jsxs("div",{className:"saf__card-header",children:[s.jsxs("div",{children:[s.jsx("span",{className:"saf__card-eyebrow",children:"Prognose"}),s.jsxs("h3",{children:["Jahresprognose ",(new Date).getFullYear()]})]}),s.jsx(_,{size:20})]}),s.jsxs("div",{className:"saf__szenarien-grid",children:[s.jsxs("div",{className:"saf__szenario saf__szenario--konservativ",children:[s.jsx("span",{className:"saf__szenario-label",children:"Konservativ"}),s.jsx("span",{className:"saf__szenario-value",children:oe(Se.konservativ)}),s.jsx("span",{className:"saf__szenario-detail",children:"-10% vom Trend"})]}),s.jsxs("div",{className:"saf__szenario saf__szenario--realistisch",children:[s.jsx("span",{className:"saf__szenario-label",children:"Realistisch"}),s.jsx("span",{className:"saf__szenario-value",children:oe(Se.realistisch)}),s.jsx("span",{className:"saf__szenario-detail",children:"Basierend auf Trend"})]}),s.jsxs("div",{className:"saf__szenario saf__szenario--optimistisch",children:[s.jsx("span",{className:"saf__szenario-label",children:"Optimistisch"}),s.jsx("span",{className:"saf__szenario-value",children:oe(Se.optimistisch)}),s.jsx("span",{className:"saf__szenario-detail",children:"+15% vom Trend"})]})]})]})}),s.jsxs("section",{className:`saf__details-grid saf__details-grid--${H}`,children:[("alle"===H||"verband"===H)&&s.jsxs("div",{className:"saf-card saf__detail-card",children:[s.jsxs("div",{className:"saf__detail-header",children:[s.jsx(z,{size:20,style:{color:Pe.verband}}),s.jsxs("div",{children:[s.jsx("h3",{children:"Verband"}),s.jsx("p",{children:"TDA International"})]})]}),s.jsxs("div",{className:"saf__detail-list",children:[s.jsxs("div",{className:"saf__detail-row",children:[s.jsx("span",{children:"Aktive Mitglieder"}),s.jsx("span",{children:ve((null==(d=null==(l=null==Q?void 0:Q.verband)?void 0:l.mitglieder)?void 0:d.aktiv)||0)})]}),null==(o=null==(c=null==Q?void 0:Q.verband)?void 0:c.breakdown)?void 0:o.map(e=>s.jsxs("div",{className:"saf__detail-row saf__detail-row--sub",children:[s.jsx("span",{children:"dojo"===e.typ?"Dojos":"Einzelpersonen"}),s.jsxs("span",{children:[ve(e.anzahl)," (",oe(e.durchschnitt),"/Jahr)"]})]},e.typ)),s.jsxs("div",{className:"saf__detail-row",children:[s.jsx("span",{children:"Jahresbeiträge (erwartet)"}),s.jsx("span",{children:oe((null==(m=null==(h=null==Q?void 0:Q.verband)?void 0:h.einnahmen)?void 0:m.jahresbeitrag_erwartet)||0)})]}),s.jsxs("div",{className:"saf__detail-row",children:[s.jsx("span",{children:"Bezahlt"}),s.jsx("span",{style:{color:Pe.positiv},children:oe((null==(u=null==(x=null==Q?void 0:Q.verband)?void 0:x.einnahmen)?void 0:u.bezahlt)||0)})]}),s.jsxs("div",{className:"saf__detail-row",children:[s.jsx("span",{children:"Offen"}),s.jsx("span",{style:{color:((null==(j=null==(p=null==Q?void 0:Q.verband)?void 0:p.einnahmen)?void 0:j.offen)||0)>0?Pe.warnung:Pe.positiv},children:oe((null==(g=null==(b=null==Q?void 0:Q.verband)?void 0:b.einnahmen)?void 0:g.offen)||0)})]}),s.jsxs("div",{className:"saf__detail-row saf__detail-row--total",children:[s.jsx("span",{children:"Monatlich (anteilig)"}),s.jsx("span",{children:oe(((null==(f=null==(v=null==Q?void 0:Q.verband)?void 0:v.einnahmen)?void 0:f.jahresbeitrag_erwartet)||0)/12)})]})]})]}),("alle"===H||"software"===H)&&s.jsxs("div",{className:"saf-card saf__detail-card",children:[s.jsxs("div",{className:"saf__detail-header",children:[s.jsx(F,{size:20,style:{color:Pe.software}}),s.jsxs("div",{children:[s.jsx("h3",{children:"Software"}),s.jsx("p",{children:"SaaS Subscriptions"})]})]}),s.jsxs("div",{className:"saf__detail-list",children:[s.jsxs("div",{className:"saf__detail-row",children:[s.jsx("span",{children:"MRR (Monthly)"}),s.jsx("span",{children:oe((null==(N=null==Q?void 0:Q.subscriptionRevenue)?void 0:N.mrr)||0)})]}),s.jsxs("div",{className:"saf__detail-row",children:[s.jsx("span",{children:"ARR (Annual)"}),s.jsx("span",{children:oe((null==(y=null==Q?void 0:Q.subscriptionRevenue)?void 0:y.arr)||0)})]}),s.jsxs("div",{className:"saf__detail-row",children:[s.jsx("span",{children:"Aktive Abos"}),s.jsx("span",{children:ve((null==(w=null==(k=null==Q?void 0:Q.subscriptionRevenue)?void 0:k.breakdown)?void 0:w.reduce((e,s)=>e+(s.anzahl||0),0))||0)})]}),null==(V=null==(U=null==Q?void 0:Q.subscriptionRevenue)?void 0:U.breakdown)?void 0:V.map(e=>s.jsxs("div",{className:"saf__detail-row saf__detail-row--sub",children:[s.jsxs("span",{children:[e.plan," (",e.interval||"monatlich",")"]}),s.jsxs("span",{children:[e.anzahl,"x à ",oe(e.preis),"/Mo"]})]},e.plan))]})]}),("alle"===H||"schulen"===H)&&s.jsxs("div",{className:"saf-card saf__detail-card",children:[s.jsxs("div",{className:"saf__detail-header",children:[s.jsx(M,{size:20,style:{color:Pe.schulen}}),s.jsxs("div",{children:[s.jsx("h3",{children:"Kampfsportschulen"}),s.jsx("p",{children:"KSS & TDA"})]})]}),s.jsxs("div",{className:"saf__detail-list",children:[s.jsxs("div",{className:"saf__detail-row",children:[s.jsx("span",{children:"Monatliche Einnahmen"}),s.jsx("span",{children:oe((null==re?void 0:re.monatlicheEinnahmen)||0)})]}),s.jsxs("div",{className:"saf__detail-row",children:[s.jsx("span",{children:"Verkäufe"}),s.jsx("span",{children:oe((null==re?void 0:re.verkaeufeEinnahmen)||0)})]}),s.jsxs("div",{className:"saf__detail-row",children:[s.jsx("span",{children:"Aktive Verträge"}),s.jsx("span",{children:ve((null==re?void 0:re.anzahlVertraege)||0)})]}),s.jsxs("div",{className:"saf__detail-row",children:[s.jsx("span",{children:"Ausgaben"}),s.jsx("span",{style:{color:Pe.negativ},children:oe((null==re?void 0:re.gesamteAusgaben)||0)})]}),s.jsxs("div",{className:"saf__detail-row saf__detail-row--total",children:[s.jsx("span",{children:"Gesamt"}),s.jsx("span",{children:oe((null==re?void 0:re.gesamteinnahmen)||0)})]})]})]})]}),Ae.length>0&&s.jsx("section",{className:"saf__alerts-section",children:s.jsxs("div",{className:"saf-card",children:[s.jsxs("div",{className:"saf__card-header",children:[s.jsxs("div",{children:[s.jsx("span",{className:"saf__card-eyebrow",children:"Insights"}),s.jsx("h3",{children:"Warnungen & Hinweise"})]}),s.jsx(B,{size:20})]}),s.jsx("div",{className:"saf__alerts-list",children:Ae.map((e,a)=>{const n=e.icon;return s.jsxs("div",{className:`saf__alert saf__alert--${e.type}`,children:[s.jsx(n,{size:18}),s.jsx("span",{children:e.text})]},a)})})]})})]})},Ue=["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],Ve=({token:a})=>{var r,i,t,l,d,c;const[o,h]=e.useState(!0),[m,x]=e.useState(""),[u,p]=e.useState(null);e.useEffect(()=>{j()},[]);const j=async()=>{var e,s;h(!0),x("");try{const e=await n.get("/admin/contracts",{headers:{Authorization:`Bearer ${a}`}});p(e.data.contracts),console.log("✅ Vertragsdaten geladen:",e.data.contracts)}catch(r){console.error("❌ Fehler beim Laden der Vertragsdaten:",r),x((null==(s=null==(e=r.response)?void 0:e.data)?void 0:s.message)||"Fehler beim Laden der Vertragsdaten")}finally{h(!1)}};if(o)return s.jsxs("div",{className:"statistics-loading",children:[s.jsx("div",{className:"loading-spinner"}),s.jsx("p",{children:"Lade Vertragsdaten..."})]});if(m)return s.jsxs("div",{className:"statistics-error",children:[s.jsx("p",{children:m}),s.jsx("button",{onClick:j,className:"btn btn-primary",children:"Erneut versuchen"})]});if(!u)return null;const b=u.monthlyContracts.map(e=>({monat:Ue[e.monat-1],vertraege:e.anzahl_vertraege,aktiv:e.aktiv,abgelaufen:e.abgelaufen})),g=(null==(i=null==(r=u.contractStats)?void 0:r.active)?void 0:i.anzahl)||0,v=(null==(l=null==(t=u.contractStats)?void 0:t.trial)?void 0:l.anzahl)||0;return null==(c=null==(d=u.contractStats)?void 0:d.expired)||c.anzahl,s.jsxs("div",{className:"statistics-tab contracts-tab",children:[s.jsxs("div",{className:"stats-kpi-grid",children:[s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon success",children:s.jsx(U,{size:24})}),s.jsxs("div",{className:"kpi-content",children:[s.jsx("div",{className:"kpi-label",children:"Aktive Verträge"}),s.jsx("div",{className:"kpi-value",children:g}),s.jsxs("div",{className:"kpi-sublabel",children:[v," in Trial-Phase"]})]})]}),s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon warning",children:s.jsx(C,{size:24})}),s.jsxs("div",{className:"kpi-content",children:[s.jsx("div",{className:"kpi-label",children:"Ablaufend (30 Tage)"}),s.jsx("div",{className:"kpi-value",children:u.upcomingRenewals.next30Days.length}),s.jsxs("div",{className:"kpi-sublabel",children:[u.upcomingRenewals.count90Days," in 90 Tagen"]})]})]}),s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon primary",children:s.jsx(A,{size:24})}),s.jsxs("div",{className:"kpi-content",children:[s.jsx("div",{className:"kpi-label",children:"Ø Vertragslaufzeit"}),s.jsxs("div",{className:"kpi-value",children:[Math.round(u.avgContractDuration.avg_tage/30)," Monate"]}),s.jsxs("div",{className:"kpi-sublabel",children:[u.avgContractDuration.avg_tage," Tage"]})]})]}),s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon success",children:s.jsx(w,{size:24})}),s.jsxs("div",{className:"kpi-content",children:[s.jsx("div",{className:"kpi-label",children:"Verlängerungs-Rate"}),s.jsxs("div",{className:"kpi-value",children:[u.renewalRate,"%"]}),s.jsx("div",{className:"kpi-sublabel",children:"Verträge erneuert"})]})]})]}),s.jsx("div",{className:"charts-grid",children:s.jsxs("div",{className:"chart-card chart-wide",children:[s.jsxs("h3",{className:"chart-title",children:[s.jsx(A,{size:18}),"Vertragsabschlüsse 2026"]}),s.jsx(he,{width:"100%",height:300,children:s.jsxs(ge,{data:b,children:[s.jsx(xe,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.1)"}),s.jsx(ue,{dataKey:"monat",stroke:"#fff"}),s.jsx(pe,{stroke:"#fff"}),s.jsx(je,{contentStyle:{backgroundColor:"#1a1a2e",border:"1px solid rgba(255,255,255,0.2)",borderRadius:"8px"},labelStyle:{color:"#FFD700"}}),s.jsx(ke,{}),s.jsx(ve,{dataKey:"aktiv",fill:"#4ECDC4",name:"Aktiv"}),s.jsx(ve,{dataKey:"abgelaufen",fill:"#FF6B35",name:"Abgelaufen"})]})})]})}),u.upcomingRenewals.next30Days.length>0&&s.jsxs("div",{className:"finance-section",children:[s.jsxs("h3",{className:"section-title",children:[s.jsx(D,{size:18}),"Bald ablaufende Verträge (nächste 30 Tage)"]}),s.jsx("div",{className:"finance-table-container",children:s.jsxs("table",{className:"finance-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Dojo"}),s.jsx("th",{children:"Plan"}),s.jsx("th",{children:"Endet am"}),s.jsx("th",{children:"Verbleibend"}),s.jsx("th",{children:"Preis"})]})}),s.jsx("tbody",{children:u.upcomingRenewals.next30Days.map((e,a)=>s.jsxs("tr",{className:e.tage_bis_ende<=7?"urgent":"",children:[s.jsx("td",{className:"dojo-name",children:e.dojoname}),s.jsx("td",{children:e.subscription_plan||"Standard"}),s.jsx("td",{children:new Date(e.subscription_end).toLocaleDateString("de-DE")}),s.jsxs("td",{className:e.tage_bis_ende<=7?"urgent-text":"warning-text",children:[e.tage_bis_ende," Tage"]}),s.jsx("td",{children:e.custom_pricing?s.jsxs("span",{className:"custom-price",children:[e.custom_pricing.toFixed(2)," € (Custom)"]}):s.jsx("span",{children:"Standard"})})]},a))})]})})]}),s.jsxs("div",{className:"finance-section",children:[s.jsxs("h3",{className:"section-title",children:[s.jsx(U,{size:18}),"Aktive Verträge (",u.activeContracts.length,")"]}),s.jsx("div",{className:"finance-table-container",children:s.jsxs("table",{className:"finance-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Dojo"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Plan"}),s.jsx("th",{children:"Start"}),s.jsx("th",{children:"Ende"}),s.jsx("th",{children:"Mitglieder"}),s.jsx("th",{children:"Bemerkungen"})]})}),s.jsx("tbody",{children:u.activeContracts.map((e,a)=>s.jsxs("tr",{children:[s.jsx("td",{className:"dojo-name",children:e.dojoname}),s.jsx("td",{children:s.jsx("span",{className:"status-badge "+("trial"===e.subscription_status?"warning":"success"),children:"trial"===e.subscription_status?"Trial":"Aktiv"})}),s.jsx("td",{children:e.subscription_plan||"Standard"}),s.jsx("td",{children:e.subscription_start?new Date(e.subscription_start).toLocaleDateString("de-DE"):"-"}),s.jsx("td",{children:e.subscription_end?new Date(e.subscription_end).toLocaleDateString("de-DE"):"-"}),s.jsx("td",{className:"member-count",children:e.mitglied_count}),s.jsxs("td",{className:"notes-cell",children:[e.custom_pricing&&s.jsxs("span",{className:"custom-badge",children:["Custom: ",e.custom_pricing.toFixed(2)," €"]}),e.custom_notes&&s.jsxs("span",{className:"notes-text",title:e.custom_notes,children:[e.custom_notes.substring(0,50),e.custom_notes.length>50?"...":""]})]})]},a))})]})})]}),u.customContracts.length>0&&s.jsxs("div",{className:"finance-section",children:[s.jsxs("h3",{className:"section-title",children:[s.jsx(P,{size:18}),"Verträge mit individueller Preisgestaltung (",u.customContracts.length,")"]}),s.jsx("div",{className:"custom-contracts-grid",children:u.customContracts.map((e,a)=>s.jsxs("div",{className:"custom-contract-card",children:[s.jsxs("div",{className:"contract-header",children:[s.jsx("h4",{children:e.dojoname}),s.jsx("span",{className:"status-badge "+("active"===e.subscription_status?"success":"warning"),children:e.subscription_status})]}),s.jsxs("div",{className:"contract-details",children:[s.jsxs("div",{className:"detail-row",children:[s.jsx("span",{className:"label",children:"Plan:"}),s.jsx("span",{className:"value",children:e.subscription_plan||"Standard"})]}),s.jsxs("div",{className:"detail-row",children:[s.jsx("span",{className:"label",children:"Custom Preis:"}),s.jsxs("span",{className:"value custom-price",children:[e.custom_pricing.toFixed(2)," € / Monat"]})]}),s.jsxs("div",{className:"detail-row",children:[s.jsx("span",{className:"label",children:"Laufzeit:"}),s.jsxs("span",{className:"value",children:[new Date(e.subscription_start).toLocaleDateString("de-DE")," - ",new Date(e.subscription_end).toLocaleDateString("de-DE")]})]}),e.custom_notes&&s.jsxs("div",{className:"detail-row notes-row",children:[s.jsx("span",{className:"label",children:"Notizen:"}),s.jsx("span",{className:"value notes",children:e.custom_notes})]})]})]},a))})]}),u.trialConversions.length>0&&s.jsxs("div",{className:"finance-section",children:[s.jsxs("h3",{className:"section-title",children:[s.jsx(w,{size:18}),"Trial Conversions (Letzte 90 Tage)"]}),s.jsx("div",{className:"trial-conversions-grid",children:u.trialConversions.map((e,a)=>s.jsxs("div",{className:"trial-conversion-card",children:[s.jsx("div",{className:"conversion-dojo",children:e.dojoname}),s.jsxs("div",{className:"conversion-timeline",children:[s.jsxs("div",{className:"timeline-item",children:[s.jsx("span",{className:"timeline-label",children:"Trial Ende:"}),s.jsx("span",{className:"timeline-date",children:new Date(e.trial_end).toLocaleDateString("de-DE")})]}),s.jsx("div",{className:"timeline-arrow",children:"→"}),s.jsxs("div",{className:"timeline-item",children:[s.jsx("span",{className:"timeline-label",children:"Aktiviert:"}),s.jsx("span",{className:"timeline-date",children:new Date(e.subscription_start).toLocaleDateString("de-DE")})]})]}),s.jsxs("div",{className:"conversion-duration",children:["Trial-Dauer: ",e.trial_dauer_tage," Tage"]})]},a))})]}),u.expiredContracts.length>0&&s.jsxs("div",{className:"finance-section",children:[s.jsxs("h3",{className:"section-title",children:[s.jsx(D,{size:18}),"Abgelaufene Verträge (Letzte 90 Tage)"]}),s.jsx("div",{className:"finance-table-container",children:s.jsxs("table",{className:"finance-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Dojo"}),s.jsx("th",{children:"Plan"}),s.jsx("th",{children:"Abgelaufen am"}),s.jsx("th",{children:"Tage seit Ablauf"})]})}),s.jsx("tbody",{children:u.expiredContracts.map((e,a)=>s.jsxs("tr",{className:"expired",children:[s.jsx("td",{className:"dojo-name",children:e.dojoname}),s.jsx("td",{children:e.subscription_plan||"Standard"}),s.jsx("td",{children:new Date(e.subscription_end).toLocaleDateString("de-DE")}),s.jsxs("td",{className:"expired-days",children:[e.tage_abgelaufen," Tage"]})]},a))})]})})]})]})},We=({token:a})=>{var r,i;const[t,l]=e.useState(!0),[d,c]=e.useState(""),[o,h]=e.useState(null);e.useEffect(()=>{m()},[]);const m=async()=>{var e,s;l(!0),c("");try{const e=await n.get("/admin/users",{headers:{Authorization:`Bearer ${a}`}});h(e.data.users),console.log("✅ Benutzerdaten geladen:",e.data.users)}catch(r){console.error("❌ Fehler beim Laden der Benutzerdaten:",r),c((null==(s=null==(e=r.response)?void 0:e.data)?void 0:s.message)||"Fehler beim Laden der Benutzerdaten")}finally{l(!1)}};if(t)return s.jsxs("div",{className:"statistics-loading",children:[s.jsx("div",{className:"loading-spinner"}),s.jsx("p",{children:"Lade Benutzerdaten..."})]});if(d)return s.jsxs("div",{className:"statistics-error",children:[s.jsx("p",{children:d}),s.jsx("button",{onClick:m,className:"btn btn-primary",children:"Erneut versuchen"})]});if(!o)return null;const x={super_admin:"Super-Admin",admin:"Administrator",mitarbeiter:"Mitarbeiter",eingeschraenkt:"Eingeschränkt"};return s.jsxs("div",{className:"statistics-tab users-tab",children:[s.jsxs("div",{className:"stats-kpi-grid",children:[s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon primary",children:s.jsx(z,{size:24})}),s.jsxs("div",{className:"kpi-content",children:[s.jsx("div",{className:"kpi-label",children:"Gesamt Benutzer"}),s.jsx("div",{className:"kpi-value",children:o.userStats.total+o.dojoUsers.length}),s.jsxs("div",{className:"kpi-sublabel",children:[o.userStats.total," Admin + ",o.dojoUsers.length," Dojo"]})]})]}),s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon success",children:s.jsx(U,{size:24})}),s.jsxs("div",{className:"kpi-content",children:[s.jsx("div",{className:"kpi-label",children:"Aktive Benutzer"}),s.jsx("div",{className:"kpi-value",children:o.userStats.active}),s.jsxs("div",{className:"kpi-sublabel",children:[o.activeUsers.length," in letzten 7 Tagen"]})]})]}),s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon warning",children:s.jsx(V,{size:24})}),s.jsxs("div",{className:"kpi-content",children:[s.jsx("div",{className:"kpi-label",children:"Logins (30 Tage)"}),s.jsx("div",{className:"kpi-value",children:o.loginStats.total_logins}),s.jsxs("div",{className:"kpi-sublabel",children:["Ø ",o.loginStats.avg_per_day," pro Tag"]})]})]}),s.jsxs("div",{className:"kpi-card",children:[s.jsx("div",{className:"kpi-icon primary",children:s.jsx(W,{size:24})}),s.jsxs("div",{className:"kpi-content",children:[s.jsx("div",{className:"kpi-label",children:"Super-Admins"}),s.jsx("div",{className:"kpi-value",children:(null==(r=o.userStats.byRole)?void 0:r.super_admin)||0}),s.jsxs("div",{className:"kpi-sublabel",children:[(null==(i=o.userStats.byRole)?void 0:i.admin)||0," Admins gesamt"]})]})]})]}),o.adminUsers.length>0&&s.jsxs("div",{className:"finance-section",children:[s.jsxs("h3",{className:"section-title",children:[s.jsx(K,{size:18}),"Admin-Benutzer (",o.adminUsers.length,")"]}),s.jsx("div",{className:"finance-table-container",children:s.jsxs("table",{className:"finance-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Benutzername"}),s.jsx("th",{children:"Name"}),s.jsx("th",{children:"Email"}),s.jsx("th",{children:"Rolle"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Letzter Login"}),s.jsx("th",{children:"Erstellt"})]})}),s.jsx("tbody",{children:o.adminUsers.map((e,a)=>s.jsxs("tr",{className:e.aktiv?"":"inactive-user",children:[s.jsx("td",{className:"username",children:e.username}),s.jsxs("td",{children:[e.vorname," ",e.nachname]}),s.jsx("td",{className:"email-cell",children:e.email}),s.jsx("td",{children:s.jsx("span",{className:`role-badge ${e.rolle}`,children:x[e.rolle]||e.rolle})}),s.jsx("td",{children:e.aktiv?s.jsxs("span",{className:"status-badge success",children:[s.jsx(U,{size:14})," Aktiv"]}):s.jsxs("span",{className:"status-badge inactive",children:[s.jsx(O,{size:14})," Inaktiv"]})}),s.jsx("td",{children:e.letzter_login?s.jsxs(s.Fragment,{children:[new Date(e.letzter_login).toLocaleDateString("de-DE"),s.jsx("span",{className:"time-cell",children:new Date(e.letzter_login).toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"})})]}):s.jsx("span",{className:"no-data",children:"Noch nie"})}),s.jsx("td",{children:new Date(e.erstellt_am).toLocaleDateString("de-DE")})]},a))})]})})]}),o.activeUsers.length>0&&s.jsxs("div",{className:"finance-section",children:[s.jsxs("h3",{className:"section-title",children:[s.jsx(V,{size:18}),"Kürzlich aktive Benutzer (Letzte 7 Tage)"]}),s.jsx("div",{className:"active-users-grid",children:o.activeUsers.map((e,a)=>{var n,r;return s.jsxs("div",{className:"active-user-card",children:[s.jsxs("div",{className:"user-avatar",children:[((null==(n=e.vorname)?void 0:n[0])||"?").toUpperCase(),((null==(r=e.nachname)?void 0:r[0])||"?").toUpperCase()]}),s.jsxs("div",{className:"user-info",children:[s.jsxs("div",{className:"user-name",children:[e.vorname," ",e.nachname]}),s.jsxs("div",{className:"user-username",children:["@",e.username]}),s.jsxs("div",{className:"user-activity",children:[s.jsx(C,{size:12}),0===e.tage_seit_login?"Heute":`Vor ${e.tage_seit_login} Tagen`]})]})]},a)})})]}),o.dojoUsers.length>0&&s.jsxs("div",{className:"finance-section",children:[s.jsxs("h3",{className:"section-title",children:[s.jsx(z,{size:18}),"Dojo-Administratoren (",o.dojoUsers.length,")"]}),s.jsx("div",{className:"dojo-users-container",children:Object.entries(o.usersByDojo).map(([e,a],n)=>s.jsxs("div",{className:"dojo-users-group",children:[s.jsxs("h4",{className:"dojo-group-title",children:[e," (",a.length,")"]}),s.jsx("div",{className:"finance-table-container",children:s.jsxs("table",{className:"finance-table compact",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Benutzername"}),s.jsx("th",{children:"Email"}),s.jsx("th",{children:"Aktivität (30 Tage)"}),s.jsx("th",{children:"Erstellt"})]})}),s.jsx("tbody",{children:a.map((e,a)=>s.jsxs("tr",{children:[s.jsx("td",{className:"username",children:e.benutzername}),s.jsx("td",{className:"email-cell",children:e.email}),s.jsx("td",{className:"activity-cell",children:e.activity_last_30_days>0?s.jsxs("span",{className:"activity-badge active",children:[e.activity_last_30_days," Aktionen"]}):s.jsx("span",{className:"activity-badge inactive",children:"Keine Aktivität"})}),s.jsx("td",{children:new Date(e.created_at).toLocaleDateString("de-DE")})]},a))})]})})]},n))})]}),o.recentActivity.length>0&&s.jsxs("div",{className:"finance-section",children:[s.jsxs("h3",{className:"section-title",children:[s.jsx(V,{size:18}),"Letzte Aktivitäten (50)"]}),s.jsx("div",{className:"activity-log-container",children:o.recentActivity.map((e,a)=>s.jsxs("div",{className:"activity-log-item",children:[s.jsx("div",{className:"activity-icon",children:s.jsx(V,{size:16})}),s.jsxs("div",{className:"activity-content",children:[s.jsxs("div",{className:"activity-header",children:[s.jsx("span",{className:"activity-user",children:e.username}),s.jsx("span",{className:"activity-action",children:e.aktion}),s.jsxs("span",{className:"activity-bereich",children:["in ",e.bereich]})]}),e.beschreibung&&s.jsx("div",{className:"activity-description",children:e.beschreibung}),s.jsx("div",{className:"activity-time",children:new Date(e.erstellt_am).toLocaleString("de-DE")})]})]},a))})]})]})},Ke=({token:a})=>{const[r,i]=e.useState([]),[t,l]=e.useState([]),[d,c]=e.useState([]),[o,h]=e.useState(!0),[m,x]=e.useState(!1),[u,p]=e.useState(!1),[j,b]=e.useState(null),[g,v]=e.useState({kontoinhaber:"",iban:"",bic:"",mandats_datum:(new Date).toISOString().split("T")[0]}),[f,N]=e.useState("");e.useEffect(()=>{y()},[]);const y=async()=>{h(!0);try{const[e,s,r]=await Promise.all([n.get("/admin/sepa/mandate",{headers:{Authorization:`Bearer ${a}`}}),n.get("/admin/sepa/batches",{headers:{Authorization:`Bearer ${a}`}}),n.get("/admin/sepa/dojos-without-mandate",{headers:{Authorization:`Bearer ${a}`}})]);i(e.data.mandate||[]),l(s.data.batches||[]),c(r.data.dojos||[])}catch(e){console.error("Fehler beim Laden:",e)}finally{h(!1)}},k=async(e,s)=>{try{await n.put(`/admin/sepa/mandate/${e}`,{status:s},{headers:{Authorization:`Bearer ${a}`}}),y()}catch(r){alert("Fehler beim Aktualisieren")}},_=e=>{const a={aktiv:{bg:"rgba(16,185,129,0.2)",color:"#10b981"},pausiert:{bg:"rgba(251,191,36,0.2)",color:"#fbbf24"},widerrufen:{bg:"rgba(239,68,68,0.2)",color:"#ef4444"},erstellt:{bg:"rgba(59,130,246,0.2)",color:"#3b82f6"},exportiert:{bg:"rgba(16,185,129,0.2)",color:"#10b981"},eingereicht:{bg:"rgba(139,92,246,0.2)",color:"#8b5cf6"},ausgefuehrt:{bg:"rgba(16,185,129,0.3)",color:"#10b981"}}[e]||{bg:"rgba(156,163,175,0.2)",color:"#9ca3af"};return s.jsx("span",{style:{padding:"0.25rem 0.5rem",borderRadius:"4px",fontSize:"0.75rem",background:a.bg,color:a.color},children:e})};return o?s.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:"Lade SEPA-Daten..."}):s.jsxs("div",{className:"sepa-tab",children:[s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"1rem",marginBottom:"2rem"},children:[s.jsx("div",{style:{background:"var(--bg-secondary)",padding:"1.25rem",borderRadius:"12px",border:"1px solid var(--border-default)"},children:s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[s.jsx("div",{style:{background:"rgba(16,185,129,0.2)",padding:"0.75rem",borderRadius:"8px"},children:s.jsx(z,{size:20,color:"#10b981"})}),s.jsxs("div",{children:[s.jsx("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)"},children:"Aktive Mandate"}),s.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"700",color:"var(--primary)"},children:r.filter(e=>"aktiv"===e.status).length})]})]})}),s.jsx("div",{style:{background:"var(--bg-secondary)",padding:"1.25rem",borderRadius:"12px",border:"1px solid var(--border-default)"},children:s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[s.jsx("div",{style:{background:"rgba(251,191,36,0.2)",padding:"0.75rem",borderRadius:"8px"},children:s.jsx(C,{size:20,color:"#fbbf24"})}),s.jsxs("div",{children:[s.jsx("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)"},children:"Ohne Mandat"}),s.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"700",color:"#fbbf24"},children:d.length})]})]})}),s.jsx("div",{style:{background:"var(--bg-secondary)",padding:"1.25rem",borderRadius:"12px",border:"1px solid var(--border-default)"},children:s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[s.jsx("div",{style:{background:"rgba(59,130,246,0.2)",padding:"0.75rem",borderRadius:"8px"},children:s.jsx(P,{size:20,color:"#3b82f6"})}),s.jsxs("div",{children:[s.jsx("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)"},children:"Batches"}),s.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"700",color:"#3b82f6"},children:t.length})]})]})}),s.jsx("div",{style:{background:"var(--bg-secondary)",padding:"1.25rem",borderRadius:"12px",border:"1px solid var(--border-default)"},children:s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[s.jsx("div",{style:{background:"rgba(16,185,129,0.2)",padding:"0.75rem",borderRadius:"8px"},children:s.jsx(G,{size:20,color:"#10b981"})}),s.jsxs("div",{children:[s.jsx("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)"},children:"MRR (SEPA)"}),s.jsxs("div",{style:{fontSize:"1.5rem",fontWeight:"700",color:"var(--primary)"},children:[r.filter(e=>"aktiv"===e.status).reduce((e,s)=>e+parseFloat(s.monthly_price||0),0).toFixed(0)," EUR"]})]})]})})]}),s.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"2rem"},children:[s.jsxs("button",{onClick:()=>x(!0),style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.75rem 1.25rem",background:"var(--primary)",color:"#000",border:"none",borderRadius:"8px",fontWeight:"600",cursor:"pointer"},children:[s.jsx(Z,{size:18})," Neues Mandat"]}),s.jsxs("button",{onClick:()=>p(!0),style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.75rem 1.25rem",background:"rgba(59,130,246,0.2)",color:"#3b82f6",border:"1px solid #3b82f6",borderRadius:"8px",fontWeight:"600",cursor:"pointer"},children:[s.jsx(P,{size:18})," Lastschrift-Batch erstellen"]})]}),s.jsxs("div",{style:{marginBottom:"2rem"},children:[s.jsxs("h3",{style:{marginBottom:"1rem",color:"var(--primary)",display:"flex",alignItems:"center",gap:"0.5rem"},children:[s.jsx(q,{size:20})," SEPA-Mandate"]}),s.jsx("div",{style:{background:"var(--bg-secondary)",borderRadius:"12px",border:"1px solid var(--border-default)",overflow:"hidden"},children:s.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[s.jsx("thead",{children:s.jsxs("tr",{style:{borderBottom:"1px solid var(--border-default)"},children:[s.jsx("th",{style:{padding:"0.75rem",textAlign:"left",color:"var(--text-secondary)",fontSize:"0.85rem"},children:"Dojo"}),s.jsx("th",{style:{padding:"0.75rem",textAlign:"left",color:"var(--text-secondary)",fontSize:"0.85rem"},children:"Kontoinhaber"}),s.jsx("th",{style:{padding:"0.75rem",textAlign:"left",color:"var(--text-secondary)",fontSize:"0.85rem"},children:"IBAN"}),s.jsx("th",{style:{padding:"0.75rem",textAlign:"left",color:"var(--text-secondary)",fontSize:"0.85rem"},children:"Plan"}),s.jsx("th",{style:{padding:"0.75rem",textAlign:"right",color:"var(--text-secondary)",fontSize:"0.85rem"},children:"Betrag"}),s.jsx("th",{style:{padding:"0.75rem",textAlign:"center",color:"var(--text-secondary)",fontSize:"0.85rem"},children:"Status"}),s.jsx("th",{style:{padding:"0.75rem",textAlign:"center",color:"var(--text-secondary)",fontSize:"0.85rem"},children:"Aktion"})]})}),s.jsx("tbody",{children:0===r.length?s.jsx("tr",{children:s.jsx("td",{colSpan:"7",style:{padding:"2rem",textAlign:"center",color:"var(--text-secondary)"},children:"Keine Mandate vorhanden"})}):r.map(e=>s.jsxs("tr",{style:{borderBottom:"1px solid var(--border-default)"},children:[s.jsx("td",{style:{padding:"0.75rem",color:"var(--text-primary)"},children:e.dojoname}),s.jsx("td",{style:{padding:"0.75rem",color:"var(--text-primary)"},children:e.kontoinhaber}),s.jsx("td",{style:{padding:"0.75rem",color:"var(--text-secondary)",fontFamily:"monospace",fontSize:"0.85rem"},children:e.iban}),s.jsx("td",{style:{padding:"0.75rem",color:"var(--text-secondary)"},children:e.plan_type}),s.jsxs("td",{style:{padding:"0.75rem",textAlign:"right",color:"var(--primary)",fontWeight:"600"},children:[parseFloat(e.monthly_price||0).toFixed(2)," EUR"]}),s.jsx("td",{style:{padding:"0.75rem",textAlign:"center"},children:_(e.status)}),s.jsx("td",{style:{padding:"0.75rem",textAlign:"center"},children:"aktiv"===e.status?s.jsx("button",{onClick:()=>k(e.id,"pausiert"),style:{background:"rgba(251,191,36,0.2)",color:"#fbbf24",border:"none",padding:"0.25rem 0.5rem",borderRadius:"4px",cursor:"pointer",fontSize:"0.75rem"},children:"Pausieren"}):"pausiert"===e.status?s.jsx("button",{onClick:()=>k(e.id,"aktiv"),style:{background:"rgba(16,185,129,0.2)",color:"#10b981",border:"none",padding:"0.25rem 0.5rem",borderRadius:"4px",cursor:"pointer",fontSize:"0.75rem"},children:"Aktivieren"}):null})]},e.id))})]})})]}),s.jsxs("div",{children:[s.jsxs("h3",{style:{marginBottom:"1rem",color:"var(--primary)",display:"flex",alignItems:"center",gap:"0.5rem"},children:[s.jsx(P,{size:20})," Lastschrift-Batches"]}),s.jsx("div",{style:{background:"var(--bg-secondary)",borderRadius:"12px",border:"1px solid var(--border-default)",overflow:"hidden"},children:s.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[s.jsx("thead",{children:s.jsxs("tr",{style:{borderBottom:"1px solid var(--border-default)"},children:[s.jsx("th",{style:{padding:"0.75rem",textAlign:"left",color:"var(--text-secondary)",fontSize:"0.85rem"},children:"Referenz"}),s.jsx("th",{style:{padding:"0.75rem",textAlign:"left",color:"var(--text-secondary)",fontSize:"0.85rem"},children:"Erstellt"}),s.jsx("th",{style:{padding:"0.75rem",textAlign:"left",color:"var(--text-secondary)",fontSize:"0.85rem"},children:"Ausfuehrung"}),s.jsx("th",{style:{padding:"0.75rem",textAlign:"center",color:"var(--text-secondary)",fontSize:"0.85rem"},children:"Transaktionen"}),s.jsx("th",{style:{padding:"0.75rem",textAlign:"right",color:"var(--text-secondary)",fontSize:"0.85rem"},children:"Betrag"}),s.jsx("th",{style:{padding:"0.75rem",textAlign:"center",color:"var(--text-secondary)",fontSize:"0.85rem"},children:"Status"}),s.jsx("th",{style:{padding:"0.75rem",textAlign:"center",color:"var(--text-secondary)",fontSize:"0.85rem"},children:"XML"})]})}),s.jsx("tbody",{children:0===t.length?s.jsx("tr",{children:s.jsx("td",{colSpan:"7",style:{padding:"2rem",textAlign:"center",color:"var(--text-secondary)"},children:"Keine Batches vorhanden"})}):t.map(e=>s.jsxs("tr",{style:{borderBottom:"1px solid var(--border-default)"},children:[s.jsx("td",{style:{padding:"0.75rem",color:"var(--text-primary)",fontFamily:"monospace",fontSize:"0.85rem"},children:e.batch_referenz}),s.jsx("td",{style:{padding:"0.75rem",color:"var(--text-secondary)"},children:new Date(e.erstelldatum).toLocaleDateString("de-DE")}),s.jsx("td",{style:{padding:"0.75rem",color:"var(--text-primary)"},children:new Date(e.ausfuehrungsdatum).toLocaleDateString("de-DE")}),s.jsx("td",{style:{padding:"0.75rem",textAlign:"center",color:"var(--text-primary)"},children:e.anzahl_transaktionen}),s.jsxs("td",{style:{padding:"0.75rem",textAlign:"right",color:"var(--primary)",fontWeight:"600"},children:[parseFloat(e.gesamtbetrag).toFixed(2)," EUR"]}),s.jsx("td",{style:{padding:"0.75rem",textAlign:"center"},children:_(e.status)}),s.jsx("td",{style:{padding:"0.75rem",textAlign:"center"},children:s.jsxs("button",{onClick:()=>(async e=>{try{const s=await n.get(`/admin/sepa/batch/${e}/xml`,{headers:{Authorization:`Bearer ${a}`},responseType:"blob"}),r=window.URL.createObjectURL(new Blob([s.data])),i=document.createElement("a");i.href=r,i.setAttribute("download",`SEPA-Lastschrift-${e}.xml`),document.body.appendChild(i),i.click(),i.remove(),y()}catch(s){alert("Fehler beim Download")}})(e.id),style:{background:"rgba(16,185,129,0.2)",color:"#10b981",border:"none",padding:"0.4rem 0.75rem",borderRadius:"4px",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.25rem",margin:"0 auto"},children:[s.jsx(J,{size:14})," XML"]})})]},e.id))})]})})]}),m&&s.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},onClick:()=>x(!1),children:s.jsxs("div",{onClick:e=>e.stopPropagation(),style:{background:"var(--bg-primary)",borderRadius:"16px",width:"90%",maxWidth:"500px",border:"1px solid var(--border-default)"},children:[s.jsxs("div",{style:{padding:"1.25rem",borderBottom:"1px solid var(--border-default)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsx("h3",{style:{margin:0,color:"var(--primary)"},children:"Neues SEPA-Mandat"}),s.jsx("button",{onClick:()=>x(!1),style:{background:"none",border:"none",color:"var(--text-primary)",fontSize:"1.5rem",cursor:"pointer"},children:"x"})]}),s.jsxs("div",{style:{padding:"1.5rem"},children:[s.jsxs("div",{style:{marginBottom:"1rem"},children:[s.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"var(--text-secondary)"},children:"Dojo auswaehlen *"}),s.jsxs("select",{value:(null==j?void 0:j.id)||"",onChange:e=>b(d.find(s=>s.id===parseInt(e.target.value))),style:{width:"100%",padding:"0.75rem",background:"var(--bg-secondary)",border:"1px solid var(--border-default)",borderRadius:"8px",color:"var(--text-primary)"},children:[s.jsx("option",{value:"",children:"-- Dojo waehlen --"}),d.map(e=>s.jsxs("option",{value:e.id,children:[e.dojoname," (",e.plan_type," - ",e.monthly_price," EUR)"]},e.id))]})]}),s.jsxs("div",{style:{marginBottom:"1rem"},children:[s.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"var(--text-secondary)"},children:"Kontoinhaber *"}),s.jsx("input",{type:"text",value:g.kontoinhaber,onChange:e=>v({...g,kontoinhaber:e.target.value}),style:{width:"100%",padding:"0.75rem",background:"var(--bg-secondary)",border:"1px solid var(--border-default)",borderRadius:"8px",color:"var(--text-primary)"}})]}),s.jsxs("div",{style:{marginBottom:"1rem"},children:[s.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"var(--text-secondary)"},children:"IBAN *"}),s.jsx("input",{type:"text",value:g.iban,onChange:e=>v({...g,iban:e.target.value}),placeholder:"DE89 3704 0044 0532 0130 00",style:{width:"100%",padding:"0.75rem",background:"var(--bg-secondary)",border:"1px solid var(--border-default)",borderRadius:"8px",color:"var(--text-primary)",fontFamily:"monospace"}})]}),s.jsxs("div",{style:{marginBottom:"1rem"},children:[s.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"var(--text-secondary)"},children:"BIC"}),s.jsx("input",{type:"text",value:g.bic,onChange:e=>v({...g,bic:e.target.value}),style:{width:"100%",padding:"0.75rem",background:"var(--bg-secondary)",border:"1px solid var(--border-default)",borderRadius:"8px",color:"var(--text-primary)"}})]}),s.jsxs("div",{style:{marginBottom:"1rem"},children:[s.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"var(--text-secondary)"},children:"Mandatsdatum"}),s.jsx("input",{type:"date",value:g.mandats_datum,onChange:e=>v({...g,mandats_datum:e.target.value}),style:{width:"100%",padding:"0.75rem",background:"var(--bg-secondary)",border:"1px solid var(--border-default)",borderRadius:"8px",color:"var(--text-primary)"}})]})]}),s.jsxs("div",{style:{padding:"1rem 1.5rem",borderTop:"1px solid var(--border-default)",display:"flex",justifyContent:"flex-end",gap:"1rem"},children:[s.jsx("button",{onClick:()=>x(!1),style:{padding:"0.75rem 1.5rem",background:"var(--bg-secondary)",border:"1px solid var(--border-default)",borderRadius:"8px",color:"var(--text-primary)",cursor:"pointer"},children:"Abbrechen"}),s.jsx("button",{onClick:async()=>{var e,s;if(j&&g.kontoinhaber&&g.iban)try{await n.post("/admin/sepa/mandate",{dojo_id:j.id,...g},{headers:{Authorization:`Bearer ${a}`}}),alert("SEPA-Mandat erfolgreich erstellt"),x(!1),v({kontoinhaber:"",iban:"",bic:"",mandats_datum:(new Date).toISOString().split("T")[0]}),b(null),y()}catch(r){alert("Fehler: "+((null==(s=null==(e=r.response)?void 0:e.data)?void 0:s.error)||r.message))}else alert("Bitte alle Pflichtfelder ausfuellen")},style:{padding:"0.75rem 1.5rem",background:"var(--primary)",border:"none",borderRadius:"8px",color:"#000",fontWeight:"600",cursor:"pointer"},children:"Mandat erstellen"})]})]})}),u&&s.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},onClick:()=>p(!1),children:s.jsxs("div",{onClick:e=>e.stopPropagation(),style:{background:"var(--bg-primary)",borderRadius:"16px",width:"90%",maxWidth:"450px",border:"1px solid var(--border-default)"},children:[s.jsxs("div",{style:{padding:"1.25rem",borderBottom:"1px solid var(--border-default)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsx("h3",{style:{margin:0,color:"var(--primary)"},children:"Lastschrift-Batch erstellen"}),s.jsx("button",{onClick:()=>p(!1),style:{background:"none",border:"none",color:"var(--text-primary)",fontSize:"1.5rem",cursor:"pointer"},children:"x"})]}),s.jsxs("div",{style:{padding:"1.5rem"},children:[s.jsx("p",{style:{color:"var(--text-secondary)",marginBottom:"1rem"},children:"Es werden alle aktiven Mandate mit laufenden Subscriptions einbezogen."}),s.jsxs("p",{style:{color:"var(--text-primary)",marginBottom:"1.5rem"},children:[s.jsx("strong",{children:r.filter(e=>"aktiv"===e.status).length})," Mandate aktiv"]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"var(--text-secondary)"},children:"Gewuenschtes Einzugsdatum *"}),s.jsx("input",{type:"date",value:f,onChange:e=>N(e.target.value),min:new Date(Date.now()+432e6).toISOString().split("T")[0],style:{width:"100%",padding:"0.75rem",background:"var(--bg-secondary)",border:"1px solid var(--border-default)",borderRadius:"8px",color:"var(--text-primary)"}}),s.jsx("small",{style:{color:"var(--text-secondary)"},children:"Mind. 5 Werktage in der Zukunft"})]})]}),s.jsxs("div",{style:{padding:"1rem 1.5rem",borderTop:"1px solid var(--border-default)",display:"flex",justifyContent:"flex-end",gap:"1rem"},children:[s.jsx("button",{onClick:()=>p(!1),style:{padding:"0.75rem 1.5rem",background:"var(--bg-secondary)",border:"1px solid var(--border-default)",borderRadius:"8px",color:"var(--text-primary)",cursor:"pointer"},children:"Abbrechen"}),s.jsx("button",{onClick:async()=>{var e,s;if(f)try{const e=await n.post("/admin/sepa/batch/create",{ausfuehrungsdatum:f},{headers:{Authorization:`Bearer ${a}`}});alert(`Batch erstellt: ${e.data.anzahl} Lastschriften, Gesamt: ${e.data.gesamtbetrag.toFixed(2)} EUR`),p(!1),y()}catch(r){alert("Fehler: "+((null==(s=null==(e=r.response)?void 0:e.data)?void 0:s.error)||r.message))}else alert("Bitte Ausfuehrungsdatum waehlen")},style:{padding:"0.75rem 1.5rem",background:"#3b82f6",border:"none",borderRadius:"8px",color:"#fff",fontWeight:"600",cursor:"pointer"},children:"Batch erstellen"})]})]})})]})},Oe=()=>{var r,i,t,d,c,o,h,m,x;const{token:u}=l(),[p,j]=e.useState(!0),[b,g]=e.useState(""),[v,f]=e.useState(null),[N,y]=e.useState(null),[k,_]=e.useState([]),[w,S]=e.useState(!1),[E,B]=e.useState(!1),[F,M]=e.useState(null),[R,L]=e.useState(!1),[I,P]=e.useState(!1),[$,W]=e.useState(14),[K,G]=e.useState("starter"),[J,re]=e.useState("monthly"),[ie,te]=e.useState(12),[le,de]=e.useState(""),[ce,oe]=e.useState(""),[he,me]=e.useState(!1),[xe,ue]=e.useState(new Set),[pe,je]=e.useState("overview"),[be,ge]=e.useState([]),[ve,fe]=e.useState(null),[Ne,ye]=e.useState(!1),[ke,_e]=e.useState({smtp_host:"",smtp_port:587,smtp_secure:!0,smtp_user:"",smtp_password:"",default_from_email:"noreply@tda-intl.com",default_from_name:"DojoSoftware",aktiv:!0}),[Ae,De]=e.useState(!1),[Ce,Ee]=e.useState(""),[Be,Te]=e.useState("");e.useEffect(()=>{if(u)try{const e=JSON.parse(atob(u.split(".")[1]));me("admin"===e.username||1===e.user_id)}catch(e){console.error("Token decode error:",e)}},[u]),e.useEffect(()=>{Fe(),Me()},[]);const Fe=async()=>{var e,s;j(!0),g("");try{const[e,s,a]=await Promise.all([n.get("/admin/tda-stats",{headers:{Authorization:`Bearer ${u}`}}),n.get("/admin/global-stats",{headers:{Authorization:`Bearer ${u}`}}),n.get("/admin/dojos",{headers:{Authorization:`Bearer ${u}`}})]);f(e.data.stats),y(s.data.stats),_(a.data.dojos),console.log("✅ Super-Admin Daten geladen")}catch(a){console.error("❌ Fehler beim Laden der Super-Admin Daten:",a),g((null==(s=null==(e=a.response)?void 0:e.data)?void 0:s.message)||"Fehler beim Laden der Daten")}finally{j(!1)}},Me=async()=>{try{ye(!0);const e=await n.get("/admin/subscription-plans",{headers:{Authorization:`Bearer ${u}`}});e.data.success&&ge(e.data.plans)}catch(e){console.error("Fehler beim Laden der Pläne:",e)}finally{ye(!1)}};e.useEffect(()=>{"email"===pe&&(async()=>{try{De(!0);const e=await n.get("/email-settings/global",{headers:{Authorization:`Bearer ${u}`}});e.data.success&&_e(e.data.data)}catch(e){console.error("Fehler beim Laden der E-Mail-Einstellungen:",e)}finally{De(!1)}})()},[pe]);const Re=e=>{const a={trial:{label:"Trial",className:"info",icon:s.jsx(C,{size:14})},active:{label:"Aktiv",className:"success",icon:s.jsx(U,{size:14})},expired:{label:"Abgelaufen",className:"danger",icon:s.jsx(O,{size:14})},cancelled:{label:"Gekündigt",className:"warning",icon:s.jsx(D,{size:14})},suspended:{label:"Gesperrt",className:"danger",icon:s.jsx(O,{size:14})}},n=a[e.subscription_status]||a.trial;return s.jsxs("span",{className:`status-badge ${n.className}`,children:[n.icon," ",n.label]})},Le=e=>{if("trial"===e.subscription_status){const a=e.trial_days_remaining;return null===a?"-":a<0?s.jsx("span",{className:"text-danger",children:"Abgelaufen"}):0===a?s.jsx("span",{className:"text-danger",children:"Heute"}):a<=3?s.jsxs("span",{className:"text-danger",children:[a," Tage"]}):a<=7?s.jsxs("span",{className:"text-warning",children:[a," Tage"]}):s.jsxs("span",{children:[a," Tage"]})}if("active"===e.subscription_status){const a=e.subscription_days_remaining;if(null===a)return"-";if(a<0)return s.jsx("span",{className:"text-danger",children:"Abgelaufen"});if(0===a)return s.jsx("span",{className:"text-danger",children:"Heute"});if(a<=14)return s.jsxs("span",{className:"text-warning",children:[a," Tage"]});return new Date(e.subscription_ends_at).toLocaleDateString("de-DE")}return"-"},Pe=e=>{ue(s=>{const a=new Set(s);return a.has(e)?a.delete(e):a.add(e),a})};if(p)return s.jsx("div",{className:"super-admin-dashboard",children:s.jsxs("div",{className:"loading-container",children:[s.jsx("div",{className:"loading-spinner"}),s.jsx("p",{children:"Lade Super-Admin Dashboard..."})]})});if(b)return s.jsx("div",{className:"super-admin-dashboard",children:s.jsxs("div",{className:"error-container",children:[s.jsx(O,{size:48}),s.jsx("h2",{children:"Fehler"}),s.jsx("p",{children:b}),s.jsx("button",{onClick:Fe,className:"btn btn-primary",children:"Erneut versuchen"})]})});return s.jsxs("div",{className:"super-admin-dashboard",children:[s.jsx("div",{className:"dashboard-tabs",children:[{id:"overview",label:"Übersicht",icon:"📊"},{id:"verbandsmitglieder",label:"Verbandsmitglieder",icon:"🏆"},{id:"entwicklung",label:"Entwicklung",icon:"🎯"},{id:"support",label:"Support",icon:"🎫"},{id:"statistics",label:"Statistiken",icon:"📈"},{id:"finance",label:"Finanzen",icon:"💰"},{id:"contracts",label:"Verträge",icon:"📄"},{id:"users",label:"Benutzer",icon:"👤"},{id:"plans",label:"Pläne & Preise",icon:"💳"},{id:"sepa",label:"SEPA Lastschrift",icon:"€"},{id:"email",label:"E-Mail",icon:"✉️"}].map(e=>s.jsxs("button",{className:"dashboard-tab "+(pe===e.id?"active":""),onClick:()=>je(e.id),children:[s.jsx("span",{className:"tab-icon",children:e.icon}),s.jsx("span",{className:"tab-label",children:e.label})]},e.id))}),s.jsxs("div",{className:"tab-content",children:["overview"===pe&&s.jsxs(s.Fragment,{children:[s.jsxs("section",{className:"stats-section",children:[s.jsxs("h2",{className:"section-title",children:[s.jsx(H,{size:20}),"TDA International Statistiken"]}),s.jsx("div",{className:"stats-grid",children:s.jsxs("div",{className:"stat-card primary",children:[s.jsx("div",{className:"stat-icon",children:s.jsx(z,{size:32})}),s.jsxs("div",{className:"stat-content",children:[s.jsx("div",{className:"stat-value",children:(null==(r=null==v?void 0:v.members)?void 0:r.active_members)||0}),s.jsx("div",{className:"stat-label",children:"Aktive Mitglieder"}),s.jsxs("div",{className:"stat-sublabel",children:["von ",(null==(i=null==v?void 0:v.members)?void 0:i.total_members)||0," gesamt"]})]})]})})]}),s.jsxs("section",{className:"stats-section",children:[s.jsxs("h2",{className:"section-title",children:[s.jsx(T,{size:20}),"Verbandsstatistiken (Alle Dojos)"]}),s.jsxs("div",{className:"stats-grid",children:[s.jsxs("div",{className:"stat-card global-primary",children:[s.jsx("div",{className:"stat-icon",children:s.jsx(H,{size:32})}),s.jsxs("div",{className:"stat-content",children:[s.jsx("div",{className:"stat-value",children:(null==(t=null==N?void 0:N.dojos)?void 0:t.active_dojos)||0}),s.jsx("div",{className:"stat-label",children:"Aktive Dojos"}),s.jsxs("div",{className:"stat-sublabel",children:["von ",(null==(d=null==N?void 0:N.dojos)?void 0:d.total_dojos)||0," gesamt"]})]})]}),s.jsxs("div",{className:"stat-card global-success",children:[s.jsx("div",{className:"stat-icon",children:s.jsx(z,{size:32})}),s.jsxs("div",{className:"stat-content",children:[s.jsx("div",{className:"stat-value",children:(null==(c=null==N?void 0:N.members)?void 0:c.active_members)||0}),s.jsx("div",{className:"stat-label",children:"Mitglieder (Verband)"}),s.jsxs("div",{className:"stat-sublabel",children:["in ",(null==(o=null==N?void 0:N.members)?void 0:o.dojos_with_members)||0," Dojos"]})]})]}),s.jsxs("div",{className:"stat-card global-warning",children:[s.jsx("div",{className:"stat-icon",children:s.jsx(Y,{size:32})}),s.jsxs("div",{className:"stat-content",children:[s.jsxs("div",{className:"stat-value",children:[(null==(h=null==N?void 0:N.storage)?void 0:h.used_gb)||"0"," / ",(null==(m=null==N?void 0:N.storage)?void 0:m.total_gb)||"0"," GB"]}),s.jsx("div",{className:"stat-label",children:"Server-Speicher"}),s.jsxs("div",{className:"stat-sublabel",children:[(null==(x=null==N?void 0:N.storage)?void 0:x.percent_used)||0,"% belegt"]})]})]})]})]}),s.jsxs("section",{className:"dojos-section",children:[s.jsxs("div",{className:"section-header",children:[s.jsxs("h2",{className:"section-title",children:[s.jsx(Q,{size:20}),"Dojo-Verwaltung"]}),s.jsx("div",{className:"header-actions",children:s.jsxs("button",{onClick:()=>{M(null),S(!0)},className:"btn btn-primary",children:[s.jsx(Z,{size:16}),"Neues Dojo anlegen"]})})]}),s.jsxs("div",{className:"dojos-table-container",children:[s.jsxs("table",{className:"dojos-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{style:{width:"40px"}}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Dojo-Name"}),s.jsx("th",{children:"Subdomain"}),s.jsx("th",{children:"Inhaber"}),s.jsx("th",{children:"Ort"}),s.jsx("th",{className:"text-center",children:"Mitglieder"}),s.jsx("th",{className:"text-center",children:"Kurse"}),s.jsx("th",{className:"text-center",children:"Speicher"}),s.jsx("th",{className:"text-center",children:"Abo-Status"}),s.jsx("th",{className:"text-center",children:"Trial/Abo Ende"})]})}),s.jsx("tbody",{children:k.map(e=>{const r=xe.has(e.id);return s.jsxs(a.Fragment,{children:[s.jsxs("tr",{className:`dojo-row ${e.ist_aktiv?"":"inactive"} ${r?"expanded":""}`,onClick:()=>Pe(e.id),style:{cursor:"pointer"},children:[s.jsx("td",{children:s.jsx("button",{className:"expand-toggle",onClick:s=>{s.stopPropagation(),Pe(e.id)},children:r?s.jsx(X,{size:16}):s.jsx(ee,{size:16})})}),s.jsx("td",{children:e.ist_aktiv?s.jsxs("span",{className:"status-badge active",children:[s.jsx(U,{size:14})," Aktiv"]}):s.jsxs("span",{className:"status-badge inactive",children:[s.jsx(O,{size:14})," Inaktiv"]})}),s.jsx("td",{className:"font-bold",children:e.dojoname}),s.jsx("td",{children:s.jsx("code",{className:"subdomain",children:e.subdomain})}),s.jsx("td",{children:e.inhaber}),s.jsx("td",{children:e.ort||"-"}),s.jsx("td",{className:"text-center",children:e.mitglieder_count||0}),s.jsx("td",{className:"text-center",children:e.kurse_count||0}),s.jsx("td",{className:"text-center",children:e.storage_mb>=1024?`${e.storage_gb} GB`:`${e.storage_mb} MB`}),s.jsx("td",{className:"text-center",children:Re(e)}),s.jsx("td",{className:"text-center",children:Le(e)})]}),r&&s.jsx("tr",{className:"expandable-row",children:s.jsx("td",{colSpan:11,className:"expandable-cell",children:s.jsxs("div",{className:"expandable-content",children:[s.jsxs("div",{className:"expandable-section",children:[s.jsx("h4",{children:"Kontaktdaten"}),s.jsxs("div",{className:"info-grid",children:[s.jsxs("div",{className:"info-item",children:[s.jsx("strong",{children:"E-Mail:"})," ",e.email||"-"]}),s.jsxs("div",{className:"info-item",children:[s.jsx("strong",{children:"Telefon:"})," ",e.telefon||"-"]}),s.jsxs("div",{className:"info-item",children:[s.jsx("strong",{children:"Straße:"})," ",e.strasse||"-"," ",e.hausnummer||""]}),s.jsxs("div",{className:"info-item",children:[s.jsx("strong",{children:"PLZ:"})," ",e.plz||"-"]}),s.jsxs("div",{className:"info-item",children:[s.jsx("strong",{children:"Ort:"})," ",e.ort||"-"]}),s.jsxs("div",{className:"info-item",children:[s.jsx("strong",{children:"Land:"})," ",e.land||"-"]})]})]}),s.jsxs("div",{className:"expandable-section",children:[s.jsx("h4",{children:"Abonnement Details"}),s.jsxs("div",{className:"info-grid",children:[s.jsxs("div",{className:"info-item",children:[s.jsx("strong",{children:"Status:"})," ",Re(e)]}),"trial"===e.subscription_status&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"info-item",children:[s.jsx("strong",{children:"Trial Start:"})," ",e.trial_starts_at?new Date(e.trial_starts_at).toLocaleDateString("de-DE"):"-"]}),s.jsxs("div",{className:"info-item",children:[s.jsx("strong",{children:"Trial Ende:"})," ",e.trial_ends_at?new Date(e.trial_ends_at).toLocaleDateString("de-DE"):"-"]}),s.jsxs("div",{className:"info-item",children:[s.jsx("strong",{children:"Verbleibende Tage:"})," ",null!==e.trial_days_remaining?`${e.trial_days_remaining} Tage`:"-"]})]}),"active"===e.subscription_status&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"info-item",children:[s.jsx("strong",{children:"Plan:"})," ",e.subscription_plan||"-"]}),s.jsxs("div",{className:"info-item",children:[s.jsx("strong",{children:"Intervall:"})," ",e.subscription_interval||"-"]}),s.jsxs("div",{className:"info-item",children:[s.jsx("strong",{children:"Abo Start:"})," ",e.subscription_starts_at?new Date(e.subscription_starts_at).toLocaleDateString("de-DE"):"-"]}),s.jsxs("div",{className:"info-item",children:[s.jsx("strong",{children:"Abo Ende:"})," ",e.subscription_ends_at?new Date(e.subscription_ends_at).toLocaleDateString("de-DE"):"-"]}),null!==e.subscription_days_remaining&&s.jsxs("div",{className:"info-item",children:[s.jsx("strong",{children:"Verbleibende Tage:"})," ",e.subscription_days_remaining," Tage"]})]})]})]}),s.jsxs("div",{className:"expandable-section",children:[s.jsx("h4",{children:"Aktionen"}),s.jsxs("div",{className:"action-buttons",children:["trial"===e.subscription_status&&s.jsxs("button",{onClick:s=>{s.stopPropagation(),(e=>{M(e),W(14),L(!0)})(e)},className:"btn btn-sm btn-warning",title:"Trial verlängern",children:[s.jsx(C,{size:14})," Trial verlängern"]}),("trial"===e.subscription_status||"expired"===e.subscription_status)&&s.jsxs("button",{onClick:s=>{s.stopPropagation(),(e=>{M(e),G("basic"),re("monthly"),te(12),de(""),oe(""),P(!0)})(e)},className:"btn btn-sm btn-success",title:"Abo aktivieren",children:[s.jsx(U,{size:14})," Abo aktivieren"]}),s.jsxs("button",{onClick:s=>{s.stopPropagation(),(e=>{M(e),B(!0)})(e)},className:"btn btn-sm btn-secondary",title:"Bearbeiten",children:[s.jsx(se,{size:14})," Bearbeiten"]}),2!==e.id&&s.jsxs("button",{onClick:s=>{s.stopPropagation(),(async e=>{var s,a;if(confirm(`Möchten Sie "${e.dojoname}" wirklich deaktivieren?`))try{await n.delete(`/admin/dojos/${e.id}`,{headers:{Authorization:`Bearer ${u}`}}),alert(`Dojo "${e.dojoname}" wurde deaktiviert`),Fe()}catch(r){console.error("❌ Fehler beim Löschen:",r),alert((null==(a=null==(s=r.response)?void 0:s.data)?void 0:a.error)||"Fehler beim Löschen")}})(e)},className:"btn btn-sm btn-danger",title:"Deaktivieren",children:[s.jsx(ae,{size:14})," Deaktivieren"]})]})]})]})})})]},e.id)})})]}),0===k.length&&s.jsxs("div",{className:"empty-state",children:[s.jsx(H,{size:48}),s.jsx("p",{children:"Keine Dojos gefunden"})]})]})]}),(null==N?void 0:N.top_dojos)&&N.top_dojos.length>0&&s.jsxs("section",{className:"top-dojos-section",children:[s.jsxs("h2",{className:"section-title",children:[s.jsx(A,{size:20}),"Top Dojos nach Mitgliederzahl"]}),s.jsx("div",{className:"top-dojos-grid",children:N.top_dojos.slice(0,5).map((e,a)=>s.jsxs("div",{className:"top-dojo-card",children:[s.jsxs("div",{className:"ranking-badge",children:["#",a+1]}),s.jsxs("div",{className:"dojo-info",children:[s.jsx("h3",{children:e.dojoname}),s.jsxs("div",{className:"dojo-stats",children:[s.jsxs("span",{children:[s.jsx(z,{size:14})," ",e.member_count," Mitglieder"]}),s.jsxs("span",{children:[s.jsx(V,{size:14})," ",e.course_count," Kurse"]})]})]})]},e.id))})]})]}),"verbandsmitglieder"===pe&&s.jsx(Se,{}),"entwicklung"===pe&&s.jsx(ze,{bereich:"org"}),"support"===pe&&s.jsx(we,{bereich:"org",showAllBereiche:!0}),"statistics"===pe&&s.jsx(Ie,{token:u}),"finance"===pe&&s.jsx($e,{}),"contracts"===pe&&s.jsx(Ve,{token:u}),"plans"===pe&&s.jsxs("div",{className:"plans-management",children:[s.jsxs("h2",{className:"section-title",style:{marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[s.jsx(q,{size:24})," Pläne & Preise verwalten"]}),s.jsx("p",{style:{color:"var(--text-secondary)",marginBottom:"2rem"},children:"Änderungen hier werden automatisch auf der Pricing-Seite und im Vertragsmodul übernommen."}),Ne?s.jsx("p",{children:"Lade Pläne..."}):s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(350px, 1fr))",gap:"1.5rem"},children:be.map(e=>s.jsxs("div",{className:"plan-card",style:{background:"var(--bg-secondary)",borderRadius:"12px",padding:"1.5rem",border:"1px solid var(--border-default)",opacity:e.is_visible?1:.6},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[s.jsx("h3",{style:{margin:0,color:"var(--primary)"},children:e.display_name}),s.jsxs("button",{onClick:()=>fe(ve===e.plan_id?null:e.plan_id),style:{background:"var(--bg-tertiary)",border:"1px solid var(--border-default)",borderRadius:"6px",padding:"0.4rem 0.8rem",cursor:"pointer",color:"var(--text-primary)"},children:[s.jsx(se,{size:14})," ",ve===e.plan_id?"Abbrechen":"Bearbeiten"]})]}),ve===e.plan_id?s.jsx("form",{onSubmit:s=>{s.preventDefault();const a=new FormData(s.target);(async(e,s)=>{try{(await n.put(`/admin/subscription-plans/${e}`,s,{headers:{Authorization:`Bearer ${u}`}})).data.success&&(Me(),fe(null),alert("Plan erfolgreich aktualisiert"))}catch(a){console.error("Fehler beim Aktualisieren:",a),alert("Fehler beim Aktualisieren des Plans")}})(e.plan_id,{display_name:a.get("display_name"),description:a.get("description"),price_monthly:parseFloat(a.get("price_monthly")),price_yearly:parseFloat(a.get("price_yearly")),max_members:parseInt(a.get("max_members")),max_dojos:parseInt(a.get("max_dojos")),storage_limit_mb:parseInt(a.get("storage_limit_mb")),feature_verkauf:"on"===a.get("feature_verkauf"),feature_buchfuehrung:"on"===a.get("feature_buchfuehrung"),feature_events:"on"===a.get("feature_events"),feature_multidojo:"on"===a.get("feature_multidojo"),feature_api:"on"===a.get("feature_api"),is_visible:"on"===a.get("is_visible")})},children:s.jsxs("div",{style:{display:"grid",gap:"0.75rem"},children:[s.jsxs("div",{children:[s.jsx("label",{style:{fontSize:"0.85rem",color:"var(--text-secondary)"},children:"Anzeigename"}),s.jsx("input",{name:"display_name",defaultValue:e.display_name,className:"form-control",style:{width:"100%",background:"var(--bg-primary)",color:"var(--text-primary)",border:"1px solid var(--border-default)"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{fontSize:"0.85rem",color:"var(--text-secondary)"},children:"Beschreibung"}),s.jsx("input",{name:"description",defaultValue:e.description,className:"form-control",style:{width:"100%",background:"var(--bg-primary)",color:"var(--text-primary)",border:"1px solid var(--border-default)"}})]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem"},children:[s.jsxs("div",{children:[s.jsx("label",{style:{fontSize:"0.85rem",color:"var(--text-secondary)"},children:"Preis/Monat"}),s.jsx("input",{name:"price_monthly",type:"number",step:"0.01",defaultValue:e.price_monthly,className:"form-control",style:{background:"var(--bg-primary)",color:"var(--text-primary)",border:"1px solid var(--border-default)"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{fontSize:"0.85rem",color:"var(--text-secondary)"},children:"Preis/Jahr"}),s.jsx("input",{name:"price_yearly",type:"number",step:"0.01",defaultValue:e.price_yearly,className:"form-control",style:{background:"var(--bg-primary)",color:"var(--text-primary)",border:"1px solid var(--border-default)"}})]})]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"0.5rem"},children:[s.jsxs("div",{children:[s.jsx("label",{style:{fontSize:"0.85rem",color:"var(--text-secondary)"},children:"Max Mitglieder"}),s.jsx("input",{name:"max_members",type:"number",defaultValue:e.max_members,className:"form-control",style:{background:"var(--bg-primary)",color:"var(--text-primary)",border:"1px solid var(--border-default)"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{fontSize:"0.85rem",color:"var(--text-secondary)"},children:"Max Dojos"}),s.jsx("input",{name:"max_dojos",type:"number",defaultValue:e.max_dojos,className:"form-control",style:{background:"var(--bg-primary)",color:"var(--text-primary)",border:"1px solid var(--border-default)"}})]}),s.jsxs("div",{children:[s.jsx("label",{style:{fontSize:"0.85rem",color:"var(--text-secondary)"},children:"Speicher MB"}),s.jsx("input",{name:"storage_limit_mb",type:"number",defaultValue:e.storage_limit_mb,className:"form-control",style:{background:"var(--bg-primary)",color:"var(--text-primary)",border:"1px solid var(--border-default)"}})]})]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"0.5rem",marginTop:"0.5rem"},children:[s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.3rem",fontSize:"0.85rem"},children:[s.jsx("input",{name:"feature_verkauf",type:"checkbox",defaultChecked:e.feature_verkauf})," Verkauf"]}),s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.3rem",fontSize:"0.85rem"},children:[s.jsx("input",{name:"feature_buchfuehrung",type:"checkbox",defaultChecked:e.feature_buchfuehrung})," Buchführung"]}),s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.3rem",fontSize:"0.85rem"},children:[s.jsx("input",{name:"feature_events",type:"checkbox",defaultChecked:e.feature_events})," Events"]}),s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.3rem",fontSize:"0.85rem"},children:[s.jsx("input",{name:"feature_multidojo",type:"checkbox",defaultChecked:e.feature_multidojo})," Multi-Dojo"]}),s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.3rem",fontSize:"0.85rem"},children:[s.jsx("input",{name:"feature_api",type:"checkbox",defaultChecked:e.feature_api})," API"]}),s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.3rem",fontSize:"0.85rem"},children:[s.jsx("input",{name:"is_visible",type:"checkbox",defaultChecked:e.is_visible})," Sichtbar"]})]}),s.jsxs("button",{type:"submit",style:{marginTop:"1rem",background:"var(--primary)",color:"#000",border:"none",borderRadius:"6px",padding:"0.6rem 1rem",cursor:"pointer",fontWeight:"600",display:"flex",alignItems:"center",gap:"0.5rem",justifyContent:"center"},children:[s.jsx(ne,{size:16})," Speichern"]})]})}):s.jsxs(s.Fragment,{children:[s.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"0.9rem",marginBottom:"1rem"},children:e.description}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem",marginBottom:"1rem"},children:[s.jsxs("div",{style:{background:"var(--bg-tertiary)",padding:"0.75rem",borderRadius:"8px"},children:[s.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:"Monatlich"}),s.jsxs("div",{style:{fontSize:"1.25rem",fontWeight:"700",color:"var(--primary)"},children:[e.price_monthly,"€"]})]}),s.jsxs("div",{style:{background:"var(--bg-tertiary)",padding:"0.75rem",borderRadius:"8px"},children:[s.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:"Jährlich"}),s.jsxs("div",{style:{fontSize:"1.25rem",fontWeight:"700",color:"var(--primary)"},children:[e.price_yearly,"€"]})]})]}),s.jsxs("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)"},children:[s.jsxs("div",{children:["Max. ",e.max_members>=999999?"Unbegrenzt":e.max_members," Mitglieder"]}),s.jsxs("div",{style:{marginTop:"0.5rem",display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[e.feature_verkauf?s.jsx("span",{style:{background:"rgba(16,185,129,0.2)",color:"#10b981",padding:"0.2rem 0.5rem",borderRadius:"4px",fontSize:"0.75rem"},children:"Verkauf"}):null,e.feature_buchfuehrung?s.jsx("span",{style:{background:"rgba(16,185,129,0.2)",color:"#10b981",padding:"0.2rem 0.5rem",borderRadius:"4px",fontSize:"0.75rem"},children:"Buchführung"}):null,e.feature_events?s.jsx("span",{style:{background:"rgba(16,185,129,0.2)",color:"#10b981",padding:"0.2rem 0.5rem",borderRadius:"4px",fontSize:"0.75rem"},children:"Events"}):null,e.feature_multidojo?s.jsx("span",{style:{background:"rgba(16,185,129,0.2)",color:"#10b981",padding:"0.2rem 0.5rem",borderRadius:"4px",fontSize:"0.75rem"},children:"Multi-Dojo"}):null,e.feature_api?s.jsx("span",{style:{background:"rgba(16,185,129,0.2)",color:"#10b981",padding:"0.2rem 0.5rem",borderRadius:"4px",fontSize:"0.75rem"},children:"API"}):null]})]})]})]},e.plan_id))})]}),"sepa"===pe&&s.jsx(Ke,{token:u}),"users"===pe&&s.jsx(We,{token:u}),"email"===pe&&s.jsx("div",{className:"tab-content",children:s.jsxs("div",{className:"section-card",children:[s.jsx("h3",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1.5rem"},children:"✉️ Globale E-Mail-Einstellungen"}),s.jsx("p",{style:{color:"var(--text-secondary)",marginBottom:"1.5rem"},children:"Diese Einstellungen werden als Fallback für alle Dojos verwendet, die keine eigenen SMTP-Daten hinterlegt haben."}),Ce&&s.jsx("div",{style:{padding:"1rem",borderRadius:"8px",marginBottom:"1.5rem",background:Ce.includes("✅")?"rgba(16,185,129,0.1)":"rgba(239,68,68,0.1)",border:"1px solid "+(Ce.includes("✅")?"#10b981":"#ef4444"),color:Ce.includes("✅")?"#10b981":"#ef4444"},children:Ce}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"SMTP-Server"}),s.jsx("input",{type:"text",value:ke.smtp_host,onChange:e=>_e({...ke,smtp_host:e.target.value}),placeholder:"z.B. smtp.tda-intl.com"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"SMTP-Port"}),s.jsx("input",{type:"number",value:ke.smtp_port,onChange:e=>_e({...ke,smtp_port:parseInt(e.target.value)||587}),placeholder:"587"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"SMTP-Benutzer"}),s.jsx("input",{type:"text",value:ke.smtp_user,onChange:e=>_e({...ke,smtp_user:e.target.value}),placeholder:"E-Mail-Adresse für Login"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"SMTP-Passwort"}),s.jsx("input",{type:"password",value:ke.smtp_password,onChange:e=>_e({...ke,smtp_password:e.target.value}),placeholder:ke.has_password?"********":"Passwort eingeben"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Absender-E-Mail"}),s.jsx("input",{type:"email",value:ke.default_from_email,onChange:e=>_e({...ke,default_from_email:e.target.value}),placeholder:"noreply@tda-intl.com"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Absender-Name"}),s.jsx("input",{type:"text",value:ke.default_from_name,onChange:e=>_e({...ke,default_from_name:e.target.value}),placeholder:"DojoSoftware"})]})]}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"1.5rem"},children:[s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[s.jsx("input",{type:"checkbox",checked:ke.smtp_secure,onChange:e=>_e({...ke,smtp_secure:e.target.checked})}),"TLS/SSL verwenden"]}),s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[s.jsx("input",{type:"checkbox",checked:ke.aktiv,onChange:e=>_e({...ke,aktiv:e.target.checked})}),"E-Mail-Versand aktiviert"]})]}),s.jsx("div",{style:{display:"flex",gap:"1rem",marginBottom:"2rem"},children:s.jsxs("button",{className:"btn-primary",onClick:async()=>{var e,s;try{De(!0),Ee("");(await n.put("/email-settings/global",ke,{headers:{Authorization:`Bearer ${u}`}})).data.success&&Ee("✅ E-Mail-Einstellungen erfolgreich gespeichert")}catch(a){console.error("Fehler beim Speichern:",a),Ee("❌ Fehler beim Speichern: "+((null==(s=null==(e=a.response)?void 0:e.data)?void 0:s.error)||a.message))}finally{De(!1)}},disabled:Ae,style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[s.jsx(ne,{size:18}),Ae?"Speichern...":"Einstellungen speichern"]})}),s.jsx("hr",{style:{border:"none",borderTop:"1px solid var(--border)",margin:"2rem 0"}}),s.jsx("h4",{style:{marginBottom:"1rem"},children:"🧪 Test-E-Mail senden"}),s.jsx("p",{style:{color:"var(--text-secondary)",marginBottom:"1rem",fontSize:"0.9rem"},children:"Senden Sie eine Test-E-Mail, um die Konfiguration zu prüfen."}),s.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"flex-end"},children:[s.jsxs("div",{className:"form-group",style:{flex:1,marginBottom:0},children:[s.jsx("label",{children:"Test-E-Mail-Adresse"}),s.jsx("input",{type:"email",value:Be,onChange:e=>Te(e.target.value),placeholder:"ihre-email@beispiel.de"})]}),s.jsx("button",{className:"btn-secondary",onClick:async()=>{var e,s;if(Be)try{De(!0),Ee("");const e=await n.post("/email-settings/test",{test_email:Be,use_global:!0},{headers:{Authorization:`Bearer ${u}`}});e.data.success&&Ee(`✅ ${e.data.message}`)}catch(a){console.error("Test-E-Mail fehlgeschlagen:",a),Ee("❌ "+((null==(s=null==(e=a.response)?void 0:e.data)?void 0:s.error)||a.message))}finally{De(!1)}else Ee("⚠️ Bitte geben Sie eine Test-E-Mail-Adresse ein")},disabled:Ae||!Be,style:{marginBottom:"0.5rem"},children:Ae?"Sende...":"Test senden"})]}),s.jsxs("div",{style:{marginTop:"2rem",padding:"1rem",background:"rgba(59,130,246,0.1)",borderRadius:"8px",border:"1px solid rgba(59,130,246,0.2)"},children:[s.jsx("h4",{style:{color:"#3b82f6",marginBottom:"0.5rem"},children:"ℹ️ So funktioniert das 3-Stufen-System"}),s.jsxs("ol",{style:{color:"var(--text-secondary)",fontSize:"0.9rem",margin:0,paddingLeft:"1.5rem"},children:[s.jsxs("li",{style:{marginBottom:"0.5rem"},children:[s.jsx("strong",{children:"Eigene SMTP-Daten:"})," Dojos können eigene Mailserver-Daten hinterlegen"]}),s.jsxs("li",{style:{marginBottom:"0.5rem"},children:[s.jsx("strong",{children:"TDA-E-Mail:"})," Sie können Dojos eine @tda-intl.com Adresse zuweisen"]}),s.jsxs("li",{children:[s.jsx("strong",{children:"Zentraler Versand (Fallback):"})," Diese globalen Einstellungen werden verwendet, wenn nichts anderes konfiguriert ist"]})]})]})]})})]}),w&&s.jsx(Ge,{onClose:()=>S(!1),onSuccess:()=>{S(!1),Fe()},token:u}),E&&F&&s.jsx(Ge,{dojo:F,onClose:()=>B(!1),onSuccess:()=>{B(!1),Fe()},token:u}),R&&F&&s.jsx("div",{className:"modal-overlay",onClick:()=>L(!1),children:s.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsxs("h2",{children:[s.jsx(C,{size:24}),"Trial verlängern"]}),s.jsx("button",{onClick:()=>L(!1),className:"modal-close",children:s.jsx(O,{size:20})})]}),s.jsxs("div",{className:"modal-body",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Dojo:"})," ",F.dojoname]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Aktuelles Trial-Ende:"})," ",new Date(F.trial_ends_at).toLocaleDateString("de-DE")]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Verbleibende Tage:"})," ",F.trial_days_remaining," Tage"]}),s.jsxs("div",{className:"form-group",style:{marginTop:"1.5rem"},children:[s.jsx("label",{children:"Trial verlängern um (Tage):"}),s.jsx("input",{type:"number",min:"1",max:"365",value:$,onChange:e=>W(parseInt(e.target.value)),className:"form-control"}),s.jsxs("small",{style:{color:"rgba(255,255,255,0.6)",marginTop:"0.5rem",display:"block"},children:["Neues Trial-Ende: ",new Date(new Date(F.trial_ends_at).getTime()+24*$*60*60*1e3).toLocaleDateString("de-DE")]})]})]}),s.jsxs("div",{className:"modal-actions",children:[s.jsx("button",{onClick:()=>L(!1),className:"btn btn-secondary",children:"Abbrechen"}),s.jsx("button",{onClick:async()=>{var e,s;if(F)try{await n.put(`/admin/dojos/${F.id}/extend-trial`,{days:$},{headers:{Authorization:`Bearer ${u}`}}),alert(`Trial für "${F.dojoname}" um ${$} Tage verlängert`),L(!1),Fe()}catch(a){console.error("❌ Fehler beim Verlängern:",a),alert((null==(s=null==(e=a.response)?void 0:e.data)?void 0:s.error)||"Fehler beim Verlängern des Trials")}},className:"btn btn-warning",children:"Trial verlängern"})]})]})}),I&&F&&s.jsx("div",{className:"modal-overlay",onClick:()=>P(!1),children:s.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsxs("h2",{children:[s.jsx(U,{size:24}),"Abonnement aktivieren"]}),s.jsx("button",{onClick:()=>P(!1),className:"modal-close",children:s.jsx(O,{size:20})})]}),s.jsxs("div",{className:"modal-body",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Dojo:"})," ",F.dojoname]}),s.jsxs("div",{className:"form-group",style:{marginTop:"1.5rem"},children:[s.jsx("label",{children:"Abo-Plan:"}),s.jsxs("select",{value:K,onChange:e=>G(e.target.value),className:"form-control",children:[s.jsx("option",{value:"starter",children:"Starter (49€/Monat)"}),s.jsx("option",{value:"professional",children:"Professional (89€/Monat)"}),s.jsx("option",{value:"premium",children:"Premium (149€/Monat)"}),s.jsx("option",{value:"enterprise",children:"Enterprise (249€/Monat)"}),he&&s.jsxs(s.Fragment,{children:[s.jsx("option",{value:"free",children:"🎁 Kostenloser Account (Lifetime)"}),s.jsx("option",{value:"custom",children:"⚙️ Flexibel/Custom"})]})]})]}),"custom"===K&&he&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Custom Preis (€):"}),s.jsx("input",{type:"number",min:"0",step:"0.01",value:le,onChange:e=>de(e.target.value),className:"form-control",placeholder:"z.B. 39.99"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Notizen/Details:"}),s.jsx("textarea",{value:ce,onChange:e=>oe(e.target.value),className:"form-control",rows:"3",placeholder:"z.B. Sonderkonditionen, Rabatte, besondere Vereinbarungen..."})]})]}),"free"!==K&&s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Zahlungsintervall:"}),s.jsxs("select",{value:J,onChange:e=>re(e.target.value),className:"form-control",children:[s.jsx("option",{value:"monthly",children:"Monatlich"}),s.jsx("option",{value:"quarterly",children:"Quartalsweise"}),s.jsx("option",{value:"yearly",children:"Jährlich"})]})]}),"free"!==K&&s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Laufzeit (Monate):"}),s.jsx("input",{type:"number",min:"1",max:"60",value:ie,onChange:e=>te(parseInt(e.target.value)),className:"form-control"}),s.jsxs("small",{style:{color:"rgba(255,255,255,0.6)",marginTop:"0.5rem",display:"block"},children:["Abo-Ende: ",new Date((new Date).setMonth((new Date).getMonth()+ie)).toLocaleDateString("de-DE")]})]}),"free"===K&&s.jsxs("div",{style:{background:"rgba(16, 185, 129, 0.1)",border:"1px solid rgba(16, 185, 129, 0.3)",borderRadius:"8px",padding:"1rem",marginTop:"1rem",color:"rgba(255, 255, 255, 0.9)"},children:[s.jsx("strong",{children:"🎁 Kostenloser Account"}),s.jsx("br",{}),"Dieser Account hat unbegrenzten Zugriff ohne Ablaufdatum."]})]}),s.jsxs("div",{className:"modal-actions",children:[s.jsx("button",{onClick:()=>P(!1),className:"btn btn-secondary",children:"Abbrechen"}),s.jsx("button",{onClick:async()=>{var e,s;if(F)try{const e={plan:K,interval:J,duration_months:ie};he&&("free"===K?e.is_free=!0:"custom"===K&&(e.custom_price=le,e.custom_notes=ce)),await n.put(`/admin/dojos/${F.id}/activate-subscription`,e,{headers:{Authorization:`Bearer ${u}`}});const s="free"===K?`Kostenloser Account für "${F.dojoname}" aktiviert (unbegrenzt)`:"custom"===K?`Custom Abo für "${F.dojoname}" aktiviert (${le}€, ${ie} Monate)`:`Abonnement für "${F.dojoname}" aktiviert (${K}, ${ie} Monate)`;alert(s),P(!1),Fe()}catch(a){console.error("❌ Fehler beim Aktivieren:",a),alert((null==(s=null==(e=a.response)?void 0:e.data)?void 0:s.error)||"Fehler beim Aktivieren des Abonnements")}},className:"btn btn-success",children:"Abo aktivieren"})]})]})})]})},Ge=({dojo:a,onClose:r,onSuccess:i,token:t})=>{const l=!!a,[d,c]=e.useState({dojoname:(null==a?void 0:a.dojoname)||"",subdomain:(null==a?void 0:a.subdomain)||"",inhaber:(null==a?void 0:a.inhaber)||"",email:(null==a?void 0:a.email)||"",telefon:(null==a?void 0:a.telefon)||"",strasse:(null==a?void 0:a.strasse)||"",hausnummer:(null==a?void 0:a.hausnummer)||"",plz:(null==a?void 0:a.plz)||"",ort:(null==a?void 0:a.ort)||"",land:(null==a?void 0:a.land)||"Deutschland"}),[o,h]=e.useState(!1),[m,x]=e.useState(""),u=e=>{const{name:s,value:a}=e.target;c(e=>({...e,[s]:a}))};return s.jsx("div",{className:"modal-overlay",onClick:r,children:s.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:l?"Dojo bearbeiten":"Neues Dojo anlegen"}),s.jsx("button",{onClick:r,className:"modal-close",children:"×"})]}),s.jsxs("form",{onSubmit:async e=>{var s,r;e.preventDefault(),h(!0),x("");try{l?(await n.put(`/admin/dojos/${a.id}`,d,{headers:{Authorization:`Bearer ${t}`}}),alert("Dojo erfolgreich aktualisiert!")):(await n.post("/admin/dojos",d,{headers:{Authorization:`Bearer ${t}`}}),alert("Dojo erfolgreich angelegt!")),i()}catch(c){console.error("❌ Fehler beim Speichern:",c),x((null==(r=null==(s=c.response)?void 0:s.data)?void 0:r.error)||"Fehler beim Speichern")}finally{h(!1)}},className:"dojo-form",children:[s.jsxs("div",{className:"form-row",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Dojo-Name *"}),s.jsx("input",{type:"text",name:"dojoname",value:d.dojoname,onChange:u,required:!0})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Subdomain *"}),s.jsx("input",{type:"text",name:"subdomain",value:d.subdomain,onChange:u,placeholder:"z.B. mein-dojo",required:!0}),s.jsx("small",{children:".dojo.tda-intl.org"})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Inhaber *"}),s.jsx("input",{type:"text",name:"inhaber",value:d.inhaber,onChange:u,required:!0})]}),s.jsxs("div",{className:"form-row",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"E-Mail"}),s.jsx("input",{type:"email",name:"email",value:d.email,onChange:u})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Telefon"}),s.jsx("input",{type:"tel",name:"telefon",value:d.telefon,onChange:u})]})]}),s.jsxs("div",{className:"form-row",children:[s.jsxs("div",{className:"form-group flex-2",children:[s.jsx("label",{children:"Straße"}),s.jsx("input",{type:"text",name:"strasse",value:d.strasse,onChange:u})]}),s.jsxs("div",{className:"form-group flex-1",children:[s.jsx("label",{children:"Hausnr."}),s.jsx("input",{type:"text",name:"hausnummer",value:d.hausnummer,onChange:u})]})]}),s.jsxs("div",{className:"form-row",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"PLZ"}),s.jsx("input",{type:"text",name:"plz",value:d.plz,onChange:u})]}),s.jsxs("div",{className:"form-group flex-2",children:[s.jsx("label",{children:"Ort"}),s.jsx("input",{type:"text",name:"ort",value:d.ort,onChange:u})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Land"}),s.jsx("input",{type:"text",name:"land",value:d.land,onChange:u})]})]}),m&&s.jsxs("div",{className:"error-message",children:[s.jsx(O,{size:16}),m]}),s.jsxs("div",{className:"modal-actions",children:[s.jsx("button",{type:"button",onClick:r,className:"btn btn-secondary",disabled:o,children:"Abbrechen"}),s.jsx("button",{type:"submit",className:"btn btn-primary",disabled:o,children:o?"Speichere...":l?"Aktualisieren":"Anlegen"})]})]})]})})},Ze=()=>{const{token:a,user:r}=l();Ce();const[i,t]=e.useState(!0),[d,c]=e.useState(""),[o,h]=e.useState("tickets"),[m,x]=e.useState({gesamt:0,offen:0,in_bearbeitung:0,warten_auf_antwort:0,erledigt:0,geschlossen:0,heute_erstellt:0,durchschnittliche_bearbeitungszeit:0}),[u,p]=e.useState({gesamt:0,neu:0,geprueft:0,geplant:0,in_arbeit:0,umgesetzt:0,abgelehnt:0}),j=("admin"===(null==r?void 0:r.rolle)||"admin"===(null==r?void 0:r.role))&&null===(null==r?void 0:r.dojo_id),b=[{id:"tickets",label:"Tickets",icon:re},{id:"wunschliste",label:"Wunschliste",icon:le},{id:"statistiken",label:"Statistiken",icon:Q}];e.useEffect(()=>{g()},[]);const g=async()=>{t(!0),c("");try{const[e,s]=await Promise.all([n.get("/support-tickets/statistiken",{headers:{Authorization:`Bearer ${a}`}}),n.get("/feature-requests",{headers:{Authorization:`Bearer ${a}`}})]);e.data.success&&x(e.data.statistiken||{}),s.data.success&&p(s.data.stats||{})}catch(e){console.error("Fehler beim Laden der Statistiken:",e),c("Fehler beim Laden der Statistiken")}finally{t(!1)}},v=({icon:e,label:a,value:n,color:r,trend:i})=>s.jsxs("div",{className:"support-stat-card",style:{borderLeftColor:r},children:[s.jsx("div",{className:"stat-icon",style:{backgroundColor:`${r}20`},children:s.jsx(e,{size:24,color:r})}),s.jsxs("div",{className:"stat-content",children:[s.jsx("div",{className:"stat-value",children:n}),s.jsx("div",{className:"stat-label",children:a}),i&&s.jsxs("div",{className:"stat-trend "+(i>0?"up":"down"),children:[s.jsx(A,{size:12}),Math.abs(i),"% vs. letzte Woche"]})]})]});return s.jsxs("div",{className:"support-dashboard",children:[s.jsxs("div",{className:"support-header",children:[s.jsxs("div",{className:"support-header-info",children:[s.jsxs("h1",{children:[s.jsx(re,{size:28}),"Support Center"]}),s.jsx("p",{children:"Verwalten Sie Support-Tickets aus allen Bereichen"})]}),s.jsx("div",{className:"support-header-actions",children:s.jsxs("button",{onClick:g,className:"btn-refresh",disabled:i,children:[s.jsx(ie,{size:16,className:i?"spin":""}),"Aktualisieren"]})})]}),s.jsxs("div",{className:"support-stats-grid",children:[s.jsx(v,{icon:re,label:"Gesamt",value:m.gesamt||0,color:"#6366f1"}),s.jsx(v,{icon:B,label:"Offen",value:m.offen||0,color:"#f59e0b"}),s.jsx(v,{icon:C,label:"In Bearbeitung",value:m.in_bearbeitung||0,color:"#3b82f6"}),s.jsx(v,{icon:te,label:"Warten auf Antwort",value:m.warten_auf_antwort||0,color:"#8b5cf6"}),s.jsx(v,{icon:U,label:"Erledigt",value:m.erledigt||0,color:"#10b981"})]}),s.jsx("div",{className:"support-tabs",children:b.map(e=>{const a=e.icon;return s.jsxs("button",{className:"support-tab "+(o===e.id?"active":""),onClick:()=>h(e.id),children:[s.jsx(a,{size:18}),s.jsx("span",{children:e.label})]},e.id)})}),s.jsxs("div",{className:"support-content",children:["tickets"===o&&s.jsx(we,{bereich:"support",showAllBereiche:j,compact:!1}),"wunschliste"===o&&s.jsx(De,{adminMode:!0}),"statistiken"===o&&s.jsx("div",{className:"support-statistiken",children:s.jsxs("div",{className:"statistiken-two-columns",children:[s.jsxs("div",{className:"statistiken-column tickets-column",children:[s.jsxs("div",{className:"column-header",children:[s.jsx(re,{size:24}),s.jsx("h2",{children:"Support-Tickets"})]}),s.jsxs("div",{className:"stats-numbers-row",children:[s.jsxs("div",{className:"stat-number-box",children:[s.jsx("span",{className:"stat-big-number",children:m.gesamt||0}),s.jsx("span",{className:"stat-number-label",children:"Gesamt"})]}),s.jsxs("div",{className:"stat-number-box orange",children:[s.jsx("span",{className:"stat-big-number",children:m.offen||0}),s.jsx("span",{className:"stat-number-label",children:"Offen"})]}),s.jsxs("div",{className:"stat-number-box blue",children:[s.jsx("span",{className:"stat-big-number",children:m.in_bearbeitung||0}),s.jsx("span",{className:"stat-number-label",children:"In Bearbeitung"})]}),s.jsxs("div",{className:"stat-number-box green",children:[s.jsx("span",{className:"stat-big-number",children:m.erledigt||0}),s.jsx("span",{className:"stat-number-label",children:"Erledigt"})]})]}),s.jsxs("div",{className:"statistik-card",children:[s.jsx("h3",{children:"Nach Kategorie"}),s.jsx("div",{className:"kategorie-bars",children:[{name:"Vertrag",count:m.kategorie_vertrag||0,color:"#3b82f6"},{name:"Hilfe",count:m.kategorie_hilfe||0,color:"#10b981"},{name:"Problem",count:m.kategorie_problem||0,color:"#f59e0b"},{name:"Sonstiges",count:m.kategorie_sonstiges||0,color:"#6b7280"}].map(e=>{const a=(m.kategorie_vertrag||0)+(m.kategorie_hilfe||0)+(m.kategorie_problem||0)+(m.kategorie_sonstiges||0),n=a>0?e.count/a*100:0;return s.jsxs("div",{className:"kategorie-item",children:[s.jsxs("div",{className:"kategorie-label",children:[s.jsx("span",{children:e.name}),s.jsx("span",{children:e.count})]}),s.jsx("div",{className:"kategorie-bar",children:s.jsx("div",{className:"kategorie-fill",style:{width:`${n}%`,backgroundColor:e.color}})})]},e.name)})})]}),s.jsxs("div",{className:"statistik-card",children:[s.jsx("h3",{children:"Nach Bereich"}),s.jsxs("div",{className:"bereich-stats",children:[s.jsxs("div",{className:"bereich-item dojo",children:[s.jsx("div",{className:"bereich-icon",children:"🥋"}),s.jsxs("div",{className:"bereich-info",children:[s.jsx("span",{className:"bereich-name",children:"Dojo"}),s.jsx("span",{className:"bereich-count",children:m.bereich_dojo||0})]})]}),s.jsxs("div",{className:"bereich-item verband",children:[s.jsx("div",{className:"bereich-icon",children:"🌐"}),s.jsxs("div",{className:"bereich-info",children:[s.jsx("span",{className:"bereich-name",children:"Verband"}),s.jsx("span",{className:"bereich-count",children:m.bereich_verband||0})]})]}),s.jsxs("div",{className:"bereich-item org",children:[s.jsx("div",{className:"bereich-icon",children:"🏆"}),s.jsxs("div",{className:"bereich-info",children:[s.jsx("span",{className:"bereich-name",children:"Org"}),s.jsx("span",{className:"bereich-count",children:m.bereich_org||0})]})]})]})]}),s.jsxs("div",{className:"statistik-card",children:[s.jsx("h3",{children:"Performance"}),s.jsxs("div",{className:"performance-stats",children:[s.jsxs("div",{className:"performance-item",children:[s.jsx(C,{size:20}),s.jsxs("div",{children:[s.jsxs("span",{className:"performance-value",children:[m.durchschnittliche_bearbeitungszeit||"-"," Std"]}),s.jsx("span",{className:"performance-label",children:"Ø Bearbeitungszeit"})]})]}),s.jsxs("div",{className:"performance-item",children:[s.jsx(re,{size:20}),s.jsxs("div",{children:[s.jsx("span",{className:"performance-value",children:m.heute_erstellt||0}),s.jsx("span",{className:"performance-label",children:"Heute erstellt"})]})]}),s.jsxs("div",{className:"performance-item",children:[s.jsx(U,{size:20}),s.jsxs("div",{children:[s.jsx("span",{className:"performance-value",children:m.heute_geschlossen||0}),s.jsx("span",{className:"performance-label",children:"Heute geschlossen"})]})]})]})]})]}),s.jsxs("div",{className:"statistiken-column features-column",children:[s.jsxs("div",{className:"column-header features",children:[s.jsx(le,{size:24}),s.jsx("h2",{children:"Feature-Wünsche"})]}),s.jsxs("div",{className:"stats-numbers-row",children:[s.jsxs("div",{className:"stat-number-box",children:[s.jsx("span",{className:"stat-big-number",children:u.gesamt||0}),s.jsx("span",{className:"stat-number-label",children:"Gesamt"})]}),s.jsxs("div",{className:"stat-number-box orange",children:[s.jsx("span",{className:"stat-big-number",children:u.neu||0}),s.jsx("span",{className:"stat-number-label",children:"Neu"})]}),s.jsxs("div",{className:"stat-number-box purple",children:[s.jsx("span",{className:"stat-big-number",children:u.geplant||0}),s.jsx("span",{className:"stat-number-label",children:"Geplant"})]}),s.jsxs("div",{className:"stat-number-box green",children:[s.jsx("span",{className:"stat-big-number",children:u.umgesetzt||0}),s.jsx("span",{className:"stat-number-label",children:"Umgesetzt"})]})]}),s.jsxs("div",{className:"statistik-card",children:[s.jsx("h3",{children:"Nach Status"}),s.jsx("div",{className:"kategorie-bars",children:[{name:"Neu",count:u.neu||0,color:"#f59e0b"},{name:"Geprüft",count:u.geprueft||0,color:"#3b82f6"},{name:"Geplant",count:u.geplant||0,color:"#8b5cf6"},{name:"In Arbeit",count:u.in_arbeit||0,color:"#ec4899"},{name:"Umgesetzt",count:u.umgesetzt||0,color:"#10b981"},{name:"Abgelehnt",count:u.abgelehnt||0,color:"#6b7280"}].map(e=>{const a=u.gesamt||1,n=a>0?e.count/a*100:0;return s.jsxs("div",{className:"kategorie-item",children:[s.jsxs("div",{className:"kategorie-label",children:[s.jsx("span",{children:e.name}),s.jsx("span",{children:e.count})]}),s.jsx("div",{className:"kategorie-bar",children:s.jsx("div",{className:"kategorie-fill",style:{width:`${n}%`,backgroundColor:e.color}})})]},e.name)})})]}),s.jsxs("div",{className:"statistik-card",children:[s.jsx("h3",{children:"Voting-Info"}),s.jsxs("div",{className:"voting-info",children:[s.jsxs("div",{className:"voting-stat",children:[s.jsx(de,{size:20}),s.jsxs("div",{children:[s.jsxs("span",{className:"voting-value",children:[u.gesamt>0?Math.round(((u.geplant||0)+(u.in_arbeit||0)+(u.umgesetzt||0))/u.gesamt*100):0,"%"]}),s.jsx("span",{className:"voting-label",children:"Umsetzungsrate"})]})]}),s.jsxs("div",{className:"voting-stat",children:[s.jsx(C,{size:20}),s.jsxs("div",{children:[s.jsx("span",{className:"voting-value",children:u.in_arbeit||0}),s.jsx("span",{className:"voting-label",children:"Aktuell in Arbeit"})]})]})]})]})]})]})})]})]})},qe="/dojo-logo.png",Je={background:"linear-gradient(135deg, #ffd700, #ff6b35, #f7931e)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",textShadow:"none",fontWeight:600};function He(){const{t:i}=d("dashboard"),k=Ee(),_=Ce(),{token:z,logout:w}=l(),{getDojoFilterParam:S,selectedDojo:A}=r(),{standorte:D}=c(),{updateTrigger:C}=o(),{theme:E,setTheme:B,isDarkMode:T,toggleDarkMode:F,themes:M}=h(),[R,L]=e.useState({mitglieder:0,anwesenheit:0,kurse:0,trainer:0,beitraege:0,checkins_heute:0,stile:0,termine:0,inventar:0,personal:0,buddy_gruppen:0,tarife:0,zahlungszyklen:0}),[I,P]=e.useState([]),[$,U]=e.useState(!1),[V,W]=e.useState(""),[K,O]=e.useState(""),[G,Z]=e.useState("checkin"),[q,J]=e.useState(!1),H=a.useRef(null);let Y="mitglied",Q=!1;try{if(z){const e=b(z);Y=e.role||"mitglied",Q=1===e.id||1===e.user_id||"admin"===e.username}}catch(ue){console.error("Fehler beim Dekodieren des Tokens:",ue)}const X=async()=>{U(!0),W("");try{const e=S(),s=await u(z,e);if(L({...s.stats,checkins_heute:s.stats.checkins_heute||0,stile:s.stats.stile||0,termine:s.stats.termine||0,inventar:s.stats.inventar||0,personal:s.stats.personal||0,buddy_gruppen:s.stats.buddy_gruppen||0,tarife:s.stats.tarife||0,zahlungszyklen:s.stats.zahlungszyklen||0}),s.activities){const e=s.activities.activities||s.activities||[];P(e)}}catch(e){console.error("Fehler beim Laden der Dashboard-Statistiken:",e),W("Fehler beim Laden der Statistiken: "+e.message);try{const e=S(),[s,a]=await Promise.all([p(z,e),j(z,e)]);L({...s,checkins_heute:s.checkins_heute||0,stile:s.stile||0,termine:s.termine||0,inventar:s.inventar||0,personal:s.personal||0,buddy_gruppen:s.buddy_gruppen||0,tarife:s.tarife||0,zahlungszyklen:s.zahlungszyklen||0});const n=a.activities||a||[];P(n),W("")}catch(s){console.error("Fallback fehlgeschlagen:",s)}}finally{U(!1)}};e.useEffect(()=>{z&&X()},[z,S,C]),e.useEffect(()=>{(async()=>{try{if(z){const s=b(z);if("admin"===s.role)O(s.username||"Admin");else if(s.email)try{const e=await n.get(`/mitglieder/by-email/${encodeURIComponent(s.email)}`);if(e.data){const a=`${e.data.vorname||""} ${e.data.nachname||""}`.trim();O(a||s.username||"Mitglied")}}catch(e){console.error("Fehler beim Laden des Mitgliedsnamens:",e),O(s.username||"Mitglied")}}}catch(ue){console.error("Fehler beim Dekodieren des Tokens:",ue)}})()},[z]),e.useEffect(()=>{const e=e=>{H.current&&!H.current.contains(e.target)&&J(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const ee=()=>{w(),_("/login")},se=e=>{if("/dashboard/stundenplan"===e)try{_(e)}catch(ue){console.error("❌ Stundenplan Navigation Fehler:",ue),window.location.href=e}else _(e)},ae=[{id:"checkin",label:i("tabs.checkin"),icon:"📱"},{id:"mitglieder",label:i("tabs.mitglieder"),icon:"👥"},{id:"pruefungswesen",label:i("tabs.pruefungswesen"),icon:"🏆"},{id:"events",label:i("tabs.events"),icon:"📅"},{id:"finanzen",label:i("tabs.finanzen"),icon:"💰"},{id:"artikelverwaltung",label:i("tabs.artikelverwaltung"),icon:"📦"},{id:"verwaltung",label:i("tabs.verwaltung"),icon:"🔧"},{id:"personal",label:i("tabs.personal"),icon:"👨‍🏫"},{id:"berichte",label:i("tabs.berichte"),icon:"📊"},{id:"einstellungen",label:i("tabs.einstellungen"),icon:"⚙️"},{id:"schnellaktionen",label:i("tabs.schnellaktionen"),icon:"⚡"},{id:"support",label:i("tabs.support"),icon:"🎫"},{id:"wunschliste",label:i("tabs.wunschliste"),icon:"💡"},{id:"info",label:i("tabs.info"),icon:"ℹ️"}],ne=e=>0===e?"0":e.toLocaleString("de-DE"),re="/dashboard"===k.pathname,ie=i("admin"===Y?"header.title":"header.memberTitle"),te=[{icon:"👥",title:"Mitglieder",description:"Verwalten Sie alle Dojo-Mitglieder",path:"/dashboard/mitglieder",count:R.mitglieder},{icon:"👥",title:"Buddy-Gruppen",description:"Freunde-Einladungen und Gruppenverwaltung",path:"/dashboard/buddy-gruppen",badge:"NEU",featured:!0,count:R.buddy_gruppen||0},{icon:"📧",title:"Newsletter & Benachrichtigungen",description:"Email-Versand, Push-Nachrichten & Server-Einstellungen",path:"/dashboard/notifications",badge:"NEU",featured:!0},{icon:"👋",title:"Ehemalige",description:"Ehemalige Mitglieder verwalten",path:"/dashboard/ehemalige",badge:"NEU",count:R.ehemalige||0},{icon:"💼",title:"Interessenten",description:"Potenzielle Mitglieder und Leads",path:"/dashboard/interessenten",badge:"NEU",count:R.interessenten||0}],le=[{icon:"🥋",title:"Kurse",description:"Kurse und Gruppen verwalten",path:"/dashboard/kurse",count:R.kurse},{icon:"📋",title:"Stundenplan",description:"Stundenplan und Kurszeiten verwalten",path:"/dashboard/stundenplan",featured:!0},{icon:"🎖️",title:"Stil-Verwaltung",description:"Kampfkunst-Stile, Prüfungen & Techniken",path:"/dashboard/stile",badge:"NEU",featured:!0,count:R.stile||0},{icon:"👥",title:"Gruppen",description:"Trainingsgruppen verwalten",path:"/dashboard/gruppen"},{icon:"📍",title:"Standorte",description:"Standorte & Filialen verwalten",path:"/dashboard/standorte",count:(null==D?void 0:D.length)||0}],de=[{icon:"👨‍🏫",title:"Trainer",description:"Trainer und Qualifikationen verwalten",path:"/dashboard/trainer",count:R.trainer},{icon:"🧑‍💼",title:"Personal",description:"Mitarbeiter & Personalverwaltung",path:"/dashboard/personal",count:R.personal,badge:"NEU",featured:!0}],he=[{icon:"📊",title:"Finanzcockpit",description:"Übersicht über alle Finanzkennzahlen",path:"/dashboard/finanzcockpit",featured:!0},{icon:"📈",title:"EÜR",description:"Einnahmen-Überschuss-Rechnung",path:"/dashboard/euer",badge:"NEU",featured:!0},{icon:"📉",title:"Ausgaben",description:"Betriebsausgaben erfassen",path:"/dashboard/ausgaben",badge:"NEU",featured:!0},{icon:"💰",title:"Beiträge",description:"Mitgliedsbeiträge und Zahlungen",path:"/dashboard/beitraege",count:R.beitraege,featured:!0},{icon:"🧾",title:"Rechnungen",description:"Rechnungen erstellen und verwalten",path:"/dashboard/rechnungen",featured:!0},{icon:"💳",title:"Lastschriftlauf",description:"SEPA-Lastschriften generieren und verwalten",path:"/dashboard/lastschriftlauf",featured:!0},{icon:"📋",title:"SEPA-Mandate",description:"SEPA-Einzugsermächtigungen verwalten",path:"/dashboard/sepa-mandate",featured:!0},{icon:"⚠️",title:"Mahnwesen",description:"Offene Rechnungen und Mahnungen",path:"/dashboard/mahnwesen",featured:!0},{icon:"🔴",title:"Offene Zahlungen",description:"Rücklastschriften & Chargebacks verwalten",path:"/dashboard/offene-zahlungen",badge:"NEU",featured:!0},{icon:"🎯",title:"Tarife & Preise",description:"Mitgliedschaftstarife und Preisgestaltung",path:"/dashboard/tarife",featured:!0},{icon:"🔄",title:"Zahlungszyklen",description:"Automatische Beitragszahlungen verwalten",path:"/dashboard/zahlungszyklen",badge:"NEU",featured:!0},{icon:"⚙️",title:"Zahlungseinstellungen",description:"Stripe & DATEV Integration",path:"/dashboard/einstellungen/zahlungen",badge:"NEU",featured:!0},{icon:"📊",title:"DATEV Export",description:"Buchungsdaten für Steuerberater exportieren",path:"/dashboard/datev-export",badge:"NEU",featured:!0}],me=[{icon:"🎯",title:"Prüfung durchführen",description:"Live-Ansicht für Prüfungstag - Ergebnisse eintragen",path:"/dashboard/pruefung-durchfuehren",badge:"LIVE",featured:!0},{icon:"🏆",title:"Prüfungen & Termine",description:"Events, Prüfungen und Termine verwalten",path:"/dashboard/termine",badge:"NEU",featured:!0,count:R.termine||0},{icon:"🏅",title:"Auszeichnungen",description:"Badges vergeben und verwalten",path:"/dashboard/badges",badge:"NEU",featured:!0}],xe=[{icon:"📊",title:"Auswertungen",description:"Statistiken und Berichte erstellen",path:"/dashboard/auswertungen",badge:"NEU",featured:!0},{icon:"📄",title:"Berichte & Dokumente",description:"PDF-Berichte erstellen, ändern & verwalten",path:"/dashboard/berichte",badge:"NEU",featured:!0},{icon:"📋",title:"Vertragsdokumente",description:"AGB, Datenschutz & Hausordnung verwalten",path:"/dashboard/vertragsdokumente",badge:"NEU",featured:!0},{icon:"🥊",title:"Equipment",description:"Inventar und Ausrüstung verwalten",path:"/dashboard/inventar",badge:"NEU",featured:!0,count:R.inventar||0}];return"admin"!==Y&&re?s.jsx(y,{}):(console.log("🔍 Super-Admin Dashboard Check:",{role:Y,selectedDojo:A,isMainDashboard:re,pathname:k.pathname}),"admin"===Y&&"super-admin"===A?(console.log("✅ Zeige Super-Admin Dashboard für TDA Int'l Org"),s.jsxs("div",{className:"dashboard-container "+("tda-vib"===E?"dashboard-tda-vib":""),children:[s.jsxs("header",{className:"dashboard-header",style:{background:T?"rgba(15, 15, 35, 0.85)":"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)"},children:[s.jsxs("div",{className:"dashboard-header-left",children:[s.jsx("img",{src:qe,alt:"DojoSoftware Logo",className:"dashboard-logo dojo-software-logo"}),s.jsx("h2",{children:"🏆 TDA Int'l Org - Super-Admin"}),s.jsxs("span",{className:"version-badge",style:{background:"rgba(255, 215, 0, 0.15)",color:"#ffd700",border:"1px solid rgba(255, 215, 0, 0.3)"},children:["v",t.app.version]})]}),s.jsxs("div",{className:"dashboard-header-right",children:[s.jsx(g,{}),!re&&window.history.length>1&&s.jsxs("button",{onClick:()=>_(-1),className:"logout-button",title:"Zur vorherigen Seite",children:["← ",i("header.back")]}),!re&&s.jsxs("button",{onClick:()=>_("/dashboard"),className:"logout-button",children:["← ",i("header.dashboard")]}),s.jsxs("div",{style:{position:"relative"},children:[s.jsxs("button",{onClick:()=>J(!q),className:"logout-button",style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx("span",{children:"👤"}),s.jsx("span",{children:K||"User"}),s.jsx("span",{style:{fontSize:"0.7rem"},children:"▼"})]}),q&&s.jsxs("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"8px",background:"#1f2937",border:"1px solid rgba(255,255,255,0.15)",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.3)",minWidth:"200px",zIndex:1e4,overflow:"hidden"},children:[s.jsxs("button",{onClick:F,style:{width:"100%",padding:"12px 16px",background:"transparent",border:"none",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.9)",cursor:"pointer",display:"flex",alignItems:"center",gap:"12px",fontSize:"0.9rem",textAlign:"left"},children:[T?s.jsx(ce,{size:18}):s.jsx(oe,{size:18}),s.jsx("span",{children:T?"Helles Theme":"Dunkles Theme"})]}),s.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(255,255,255,0.1)",display:"flex",alignItems:"center",gap:"12px",fontSize:"0.9rem",color:"rgba(255,255,255,0.9)"},children:[s.jsx("span",{children:"🌐"}),s.jsx(m,{compact:!0,showLabel:!1})]}),s.jsxs("button",{onClick:()=>{J(!1),ee()},style:{width:"100%",padding:"12px 16px",background:"transparent",border:"none",color:"#ef4444",cursor:"pointer",display:"flex",alignItems:"center",gap:"12px",fontSize:"0.9rem",textAlign:"left"},children:[s.jsx("span",{children:"🚪"}),s.jsx("span",{children:i("header.logout")})]})]})]})]})]}),s.jsx("main",{className:"dashboard-main",children:s.jsx(Oe,{})})]})):"admin"===Y&&"verband"===A?(console.log("✅ Zeige Verband Dashboard für TDA Verband"),s.jsxs("div",{className:"dashboard-container "+("tda-vib"===E?"dashboard-tda-vib":""),children:[s.jsxs("header",{className:"dashboard-header",style:{background:T?"rgba(15, 15, 35, 0.85)":"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)"},children:[s.jsxs("div",{className:"dashboard-header-left",children:[s.jsx("img",{src:qe,alt:"DojoSoftware Logo",className:"dashboard-logo dojo-software-logo"}),s.jsx("h2",{children:"🌐 TDA Verband"}),s.jsxs("span",{className:"version-badge",style:{background:"rgba(255, 215, 0, 0.15)",color:"#ffd700",border:"1px solid rgba(255, 215, 0, 0.3)"},children:["v",t.app.version]})]}),s.jsxs("div",{className:"dashboard-header-right",children:[s.jsx(g,{}),s.jsxs("div",{style:{position:"relative"},children:[s.jsxs("button",{onClick:()=>J(!q),className:"logout-button",style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx("span",{children:"👤"}),s.jsx("span",{children:K||"User"}),s.jsx("span",{style:{fontSize:"0.7rem"},children:"▼"})]}),q&&s.jsxs("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"8px",background:"#1f2937",border:"1px solid rgba(255,255,255,0.15)",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.3)",minWidth:"200px",zIndex:1e4,overflow:"hidden"},children:[s.jsxs("button",{onClick:F,style:{width:"100%",padding:"12px 16px",background:"transparent",border:"none",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.9)",cursor:"pointer",display:"flex",alignItems:"center",gap:"12px",fontSize:"0.9rem",textAlign:"left"},children:[T?s.jsx(ce,{size:18}):s.jsx(oe,{size:18}),s.jsx("span",{children:T?"Helles Theme":"Dunkles Theme"})]}),s.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(255,255,255,0.1)",display:"flex",alignItems:"center",gap:"12px",fontSize:"0.9rem",color:"rgba(255,255,255,0.9)"},children:[s.jsx("span",{children:"🌐"}),s.jsx(m,{compact:!0,showLabel:!1})]}),s.jsxs("button",{onClick:()=>{J(!1),ee()},style:{width:"100%",padding:"12px 16px",background:"transparent",border:"none",color:"#ef4444",cursor:"pointer",display:"flex",alignItems:"center",gap:"12px",fontSize:"0.9rem",textAlign:"left"},children:[s.jsx("span",{children:"🚪"}),s.jsx("span",{children:i("header.logout")})]})]})]})]})]}),s.jsx("main",{className:"dashboard-main",children:s.jsx(Ae,{})})]})):"admin"===Y&&"support"===A?(console.log("✅ Zeige Support Dashboard für Support Center"),s.jsxs("div",{className:"dashboard-container "+("tda-vib"===E?"dashboard-tda-vib":""),children:[s.jsxs("header",{className:"dashboard-header",style:{background:T?"rgba(15, 15, 35, 0.85)":"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)"},children:[s.jsxs("div",{className:"dashboard-header-left",children:[s.jsx("img",{src:qe,alt:"DojoSoftware Logo",className:"dashboard-logo dojo-software-logo"}),s.jsx("h2",{children:"🎫 Support Center"}),s.jsxs("span",{className:"version-badge",style:{background:"rgba(255, 215, 0, 0.15)",color:"#ffd700",border:"1px solid rgba(255, 215, 0, 0.3)"},children:["v",t.app.version]})]}),s.jsxs("div",{className:"dashboard-header-right",children:[s.jsx(g,{}),s.jsxs("div",{style:{position:"relative"},children:[s.jsxs("button",{onClick:()=>J(!q),className:"logout-button",style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx("span",{children:"👤"}),s.jsx("span",{children:K||"User"}),s.jsx("span",{style:{fontSize:"0.7rem"},children:"▼"})]}),q&&s.jsxs("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"8px",background:"#1f2937",border:"1px solid rgba(255,255,255,0.15)",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.3)",minWidth:"200px",zIndex:1e4,overflow:"hidden"},children:[s.jsxs("button",{onClick:F,style:{width:"100%",padding:"12px 16px",background:"transparent",border:"none",borderBottom:"1px solid rgba(255,255,255,0.1)",color:"rgba(255,255,255,0.9)",cursor:"pointer",display:"flex",alignItems:"center",gap:"12px",fontSize:"0.9rem",textAlign:"left"},children:[T?s.jsx(ce,{size:18}):s.jsx(oe,{size:18}),s.jsx("span",{children:T?"Helles Theme":"Dunkles Theme"})]}),s.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(255,255,255,0.1)",display:"flex",alignItems:"center",gap:"12px",fontSize:"0.9rem",color:"rgba(255,255,255,0.9)"},children:[s.jsx("span",{children:"🌐"}),s.jsx(m,{compact:!0,showLabel:!1})]}),s.jsxs("button",{onClick:()=>{J(!1),ee()},style:{width:"100%",padding:"12px 16px",background:"transparent",border:"none",color:"#ef4444",cursor:"pointer",display:"flex",alignItems:"center",gap:"12px",fontSize:"0.9rem",textAlign:"left"},children:[s.jsx("span",{children:"🚪"}),s.jsx("span",{children:i("header.logout")})]})]})]})]})]}),s.jsx("main",{className:"dashboard-main",children:s.jsx(Ze,{})})]})):s.jsxs("div",{className:"dashboard-container "+("tda-vib"===E?"dashboard-tda-vib":""),children:[s.jsxs("header",{className:"dashboard-header",children:[s.jsxs("div",{className:"dashboard-header-left",children:[s.jsx("img",{src:qe,alt:"DojoSoftware Logo",className:"dashboard-logo dojo-software-logo"}),s.jsx("h2",{children:ie}),s.jsxs("span",{className:"version-badge",style:{background:"rgba(255, 215, 0, 0.15)",color:"#ffd700",border:"1px solid rgba(255, 215, 0, 0.3)"},children:["v",t.app.version]})]}),s.jsxs("div",{className:"dashboard-header-right",children:["admin"===Y&&s.jsx(g,{}),"admin"===Y&&s.jsx(v,{}),!re&&window.history.length>1&&s.jsx("button",{onClick:()=>_(-1),className:"logout-button",title:"Zur vorherigen Seite",children:"← Zurück"}),!re&&s.jsx("button",{onClick:()=>_("/dashboard"),className:"logout-button",children:"← Dashboard"}),s.jsxs("div",{ref:H,style:{position:"relative"},children:[s.jsxs("button",{onClick:()=>J(!q),className:"logout-button",style:{display:"flex",alignItems:"center",gap:"8px"},children:[s.jsx("span",{children:"👤"}),s.jsx("span",{children:K||"User"}),s.jsx("span",{style:{fontSize:"0.7rem"},children:"▼"})]}),q&&s.jsxs("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"8px",background:"#1f2937",border:"1px solid rgba(255, 255, 255, 0.15)",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",minWidth:"200px",zIndex:1e4},children:[s.jsxs("button",{onClick:()=>{F()},style:{width:"100%",padding:"12px 16px",background:"transparent",border:"none",borderBottom:"1px solid rgba(255, 255, 255, 0.1)",color:"rgba(255, 255, 255, 0.9)",cursor:"pointer",display:"flex",alignItems:"center",gap:"12px",fontSize:"0.9rem",textAlign:"left"},onMouseEnter:e=>e.target.style.background="rgba(255, 255, 255, 0.1)",onMouseLeave:e=>e.target.style.background="transparent",children:[T?s.jsx(ce,{size:18}):s.jsx(oe,{size:18}),s.jsx("span",{children:T?"Helles Theme":"Dunkles Theme"})]}),s.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(255, 255, 255, 0.1)",display:"flex",alignItems:"center",gap:"12px",fontSize:"0.9rem",color:"rgba(255, 255, 255, 0.9)"},children:[s.jsx("span",{children:"🌐"}),s.jsx(m,{compact:!0,showLabel:!1})]}),s.jsxs("button",{onClick:()=>{J(!1),ee()},style:{width:"100%",padding:"12px 16px",background:"transparent",border:"none",color:"#ef4444",cursor:"pointer",display:"flex",alignItems:"center",gap:"12px",fontSize:"0.9rem",textAlign:"left"},onMouseEnter:e=>e.target.style.background="rgba(239, 68, 68, 0.1)",onMouseLeave:e=>e.target.style.background="transparent",children:[s.jsx("span",{children:"🚪"}),s.jsx("span",{children:i("header.logout")})]})]})]})]})]}),s.jsx("div",{className:"dashboard-content",children:s.jsx("main",{className:"dashboard-main",children:re?s.jsxs("div",{className:"content-card",children:[V&&s.jsxs("div",{className:"error-message",children:["⚠️ ",V,s.jsx("button",{onClick:X,className:"btn btn-neutral btn-small",style:{marginLeft:"10px"},children:"🔄 Erneut versuchen"})]}),s.jsx(f,{stats:R}),"admin"===Y&&s.jsx(s.Fragment,{children:s.jsx("div",{className:"dashboard-tabs",children:ae.map(e=>s.jsxs("button",{className:"dashboard-tab "+(G===e.id?"active":""),onClick:()=>Z(e.id),children:[s.jsx("span",{className:"tab-icon",children:e.icon}),s.jsx("span",{className:"tab-label",children:e.label})]},e.id))})}),s.jsx("div",{className:"dashboard-navigation",children:"admin"===Y?s.jsx(s.Fragment,{children:s.jsxs("div",{className:"tab-content",children:["checkin"===G&&s.jsxs("div",{className:"nav-cards",children:[s.jsxs("div",{onClick:()=>se("/dashboard/checkin"),className:"nav-card clickable featured",children:[s.jsx("div",{className:"nav-badge live",children:"LIVE"}),s.jsxs("div",{className:"nav-content",children:[s.jsxs("div",{className:"nav-card-header",children:[s.jsx("span",{className:"nav-icon",children:"📱"}),s.jsxs("h3",{style:Je,children:["Mitglieder Check-in",s.jsxs("span",{className:"nav-count",children:["(",ne(R.checkins_heute),")"]})]})]}),s.jsx("p",{children:"Touch & QR-Code Check-in für Mitglieder"})]}),s.jsx("div",{className:"nav-arrow",children:"→"})]}),s.jsxs("div",{onClick:()=>se("/dashboard/anwesenheit"),className:"nav-card clickable",children:[s.jsxs("div",{className:"nav-content",children:[s.jsxs("div",{className:"nav-card-header",children:[s.jsx("span",{className:"nav-icon",children:"✅"}),s.jsxs("h3",{style:Je,children:["Anwesenheit",s.jsxs("span",{className:"nav-count",children:["(",ne(R.anwesenheit),")"]})]})]}),s.jsx("p",{children:"Anwesenheitsverfolgung und Statistiken"})]}),s.jsx("div",{className:"nav-arrow",children:"→"})]}),s.jsxs("div",{onClick:()=>se("/dashboard/personal-checkin"),className:"nav-card clickable featured",children:[s.jsx("div",{className:"nav-badge new",children:"NEU"}),s.jsxs("div",{className:"nav-content",children:[s.jsxs("div",{className:"nav-card-header",children:[s.jsx("span",{className:"nav-icon",children:"👥"}),s.jsxs("h3",{style:Je,children:["Personal Check-in",s.jsxs("span",{className:"nav-count",children:["(",ne(R.personal_checkins_heute||0),")"]})]})]}),s.jsx("p",{children:"Arbeitszeit-Erfassung für Personal"})]}),s.jsx("div",{className:"nav-arrow",children:"→"})]}),s.jsxs("div",{onClick:()=>window.open("/public-checkin","_blank","fullscreen=yes,scrollbars=yes"),className:"nav-card clickable featured",children:[s.jsx("div",{className:"nav-badge live",children:"LIVE"}),s.jsxs("div",{className:"nav-content",children:[s.jsxs("div",{className:"nav-card-header",children:[s.jsx("span",{className:"nav-icon",children:"🖥️"}),s.jsxs("h3",{style:Je,children:["Check-in Anzeige",s.jsx("span",{className:"nav-count",children:"(LIVE)"})]})]}),s.jsx("p",{children:"Check-in Display für 2. Monitor"})]}),s.jsx("div",{className:"nav-arrow",children:"↗"})]}),s.jsxs("div",{onClick:()=>window.open("/public-timetable","_blank","fullscreen=yes,scrollbars=yes"),className:"nav-card clickable featured",children:[s.jsx("div",{className:"nav-badge live",children:"LIVE"}),s.jsxs("div",{className:"nav-content",children:[s.jsxs("div",{className:"nav-card-header",children:[s.jsx("span",{className:"nav-icon",children:"📚"}),s.jsxs("h3",{style:Je,children:["Stundenplan Anzeige",s.jsx("span",{className:"nav-count",children:"(AUTO)"})]})]}),s.jsx("p",{children:"Rotierender Stundenplan für 2. Monitor"})]}),s.jsx("div",{className:"nav-arrow",children:"↗"})]}),s.jsxs("div",{onClick:()=>se("/dashboard/kasse"),className:"nav-card clickable featured",children:[s.jsx("div",{className:"nav-badge new",children:"NEU"}),s.jsxs("div",{className:"nav-content",children:[s.jsxs("div",{className:"nav-card-header",children:[s.jsx("span",{className:"nav-icon",children:"💰"}),s.jsx("h3",{style:Je,children:"Barverkauf"})]}),s.jsx("p",{children:"Touch-Kasse für Verkäufe und Barzahlungen"})]}),s.jsx("div",{className:"nav-arrow",children:"→"})]}),s.jsxs("div",{onClick:()=>se("/dashboard/tresen"),className:"nav-card clickable featured",children:[s.jsx("div",{className:"nav-badge live",children:"LIVE"}),s.jsxs("div",{className:"nav-content",children:[s.jsxs("div",{className:"nav-card-header",children:[s.jsx("span",{className:"nav-icon",children:"🏪"}),s.jsx("h3",{style:Je,children:"Tresen-Übersicht"})]}),s.jsx("p",{children:"Empfang, Checkin & Tagesübersicht"})]}),s.jsx("div",{className:"nav-arrow",children:"→"})]})]}),"mitglieder"===G&&s.jsx("div",{className:"nav-cards",children:te.map((e,a)=>s.jsxs("div",{onClick:()=>se(e.path),className:"nav-card clickable "+(e.featured?"featured":""),children:[e.badge&&s.jsx("div",{className:"nav-badge "+("NEU"===e.badge?"new":"live"),children:e.badge}),s.jsxs("div",{className:"nav-content",children:[s.jsxs("div",{className:"nav-card-header",children:[s.jsx("span",{className:"nav-icon",children:e.icon}),s.jsxs("h3",{style:Je,children:[e.title,void 0!==e.count&&s.jsxs("span",{className:"nav-count",children:["(",ne(e.count),")"]})]})]}),s.jsx("p",{children:e.description})]}),s.jsx("div",{className:"nav-arrow",children:"→"})]},a))}),"pruefungswesen"===G&&s.jsx("div",{className:"nav-cards",children:me.map((e,a)=>s.jsxs("div",{onClick:()=>se(e.path),className:"nav-card clickable "+(e.featured?"featured":""),children:[e.badge&&s.jsx("div",{className:"nav-badge "+("NEU"===e.badge?"new":"LIVE"===e.badge?"live":"admin"),children:e.badge}),s.jsxs("div",{className:"nav-content",children:[s.jsxs("div",{className:"nav-card-header",children:[s.jsx("span",{className:"nav-icon",children:e.icon}),s.jsxs("h3",{style:Je,children:[e.title,void 0!==e.count&&s.jsxs("span",{className:"nav-count",children:["(",ne(e.count),")"]})]})]}),s.jsx("p",{children:e.description})]}),s.jsx("div",{className:"nav-arrow",children:"→"})]},a))}),"events"===G&&s.jsx("div",{className:"nav-cards",children:[{icon:"📅",title:"Events verwalten",description:"Veranstaltungen, Wettkämpfe und besondere Termine",path:"/dashboard/events",badge:"NEU",featured:!0},{icon:"📊",title:"Event-Dashboard",description:"Statistiken, Zahlungen & Export",path:"/dashboard/events-dashboard",badge:"NEU"}].map((e,a)=>s.jsxs("div",{onClick:()=>se(e.path),className:"nav-card clickable "+(e.featured?"featured":""),children:[e.badge&&s.jsx("div",{className:"nav-badge "+("NEU"===e.badge?"new":"LIVE"===e.badge?"live":"admin"),children:e.badge}),s.jsxs("div",{className:"nav-content",children:[s.jsxs("div",{className:"nav-card-header",children:[s.jsx("span",{className:"nav-icon",children:e.icon}),s.jsx("h3",{style:Je,children:e.title})]}),s.jsx("p",{children:e.description})]}),s.jsx("div",{className:"nav-arrow",children:"→"})]},a))}),"finanzen"===G&&s.jsx("div",{className:"nav-cards",children:he.map((e,a)=>s.jsxs("div",{onClick:()=>se(e.path),className:"nav-card clickable "+(e.featured?"featured":""),children:[e.badge&&s.jsx("div",{className:"nav-badge "+("NEU"===e.badge?"new":"live"),children:e.badge}),s.jsxs("div",{className:"nav-content",children:[s.jsxs("div",{className:"nav-card-header",children:[s.jsx("span",{className:"nav-icon",children:e.icon}),s.jsxs("h3",{style:Je,children:[e.title,void 0!==e.count&&s.jsxs("span",{className:"nav-count",children:["(",ne(e.count),")"]})]})]}),s.jsx("p",{children:e.description})]}),s.jsx("div",{className:"nav-arrow",children:"→"})]},a))}),"artikelverwaltung"===G&&s.jsx("div",{className:"nav-cards",children:[{icon:"📁",title:"Artikelgruppen",description:"Kampfsport-Kategorien und Unterkategorien",path:"/dashboard/artikelgruppen",badge:"NEU",featured:!0},{icon:"📦",title:"Artikelverwaltung",description:"Sortiment und Lagerbestände verwalten",path:"/dashboard/artikel",badge:"NEU",featured:!0}].map((e,a)=>s.jsxs("div",{onClick:()=>se(e.path),className:"nav-card clickable "+(e.featured?"featured":""),children:[e.badge&&s.jsx("div",{className:"nav-badge "+("NEU"===e.badge?"new":"LIVE"===e.badge?"live":"admin"),children:e.badge}),s.jsxs("div",{className:"nav-content",children:[s.jsxs("div",{className:"nav-card-header",children:[s.jsx("span",{className:"nav-icon",children:e.icon}),s.jsx("h3",{style:Je,children:e.title})]}),s.jsx("p",{children:e.description})]}),s.jsx("div",{className:"nav-arrow",children:"→"})]},a))}),"verwaltung"===G&&s.jsx("div",{className:"nav-cards",children:le.map((e,a)=>s.jsxs("div",{onClick:()=>se(e.path),className:"nav-card clickable "+(e.featured?"featured":""),children:[e.badge&&s.jsx("div",{className:"nav-badge "+("NEU"===e.badge?"new":"live"),children:e.badge}),s.jsxs("div",{className:"nav-content",children:[s.jsxs("div",{className:"nav-card-header",children:[s.jsx("span",{className:"nav-icon",children:e.icon}),s.jsxs("h3",{style:Je,children:[e.title,void 0!==e.count&&s.jsxs("span",{className:"nav-count",children:["(",ne(e.count),")"]})]})]}),s.jsx("p",{children:e.description})]}),s.jsx("div",{className:"nav-arrow",children:"→"})]},a))}),"personal"===G&&s.jsx("div",{className:"nav-cards",children:de.map((e,a)=>s.jsxs("div",{onClick:()=>se(e.path),className:"nav-card clickable "+(e.featured?"featured":""),children:[e.badge&&s.jsx("div",{className:"nav-badge "+("NEU"===e.badge?"new":"live"),children:e.badge}),s.jsxs("div",{className:"nav-content",children:[s.jsxs("div",{className:"nav-card-header",children:[s.jsx("span",{className:"nav-icon",children:e.icon}),s.jsxs("h3",{style:Je,children:[e.title,void 0!==e.count&&s.jsxs("span",{className:"nav-count",children:["(",ne(e.count),")"]})]})]}),s.jsx("p",{children:e.description})]}),s.jsx("div",{className:"nav-arrow",children:"→"})]},a))}),"berichte"===G&&s.jsx("div",{className:"nav-cards",children:xe.map((e,a)=>s.jsxs("div",{onClick:()=>se(e.path),className:"nav-card clickable "+(e.featured?"featured":""),children:[e.badge&&s.jsx("div",{className:"nav-badge "+("NEU"===e.badge?"new":"LIVE"===e.badge?"live":"admin"),children:e.badge}),s.jsxs("div",{className:"nav-content",children:[s.jsxs("div",{className:"nav-card-header",children:[s.jsx("span",{className:"nav-icon",children:e.icon}),s.jsxs("h3",{style:Je,children:[e.title,void 0!==e.count&&s.jsxs("span",{className:"nav-count",children:["(",ne(e.count),")"]})]})]}),s.jsx("p",{children:e.description})]}),s.jsx("div",{className:"nav-arrow",children:"→"})]},a))}),"einstellungen"===G&&s.jsx("div",{className:"nav-cards",children:[{icon:"🏯",title:"Dojo-Verwaltung",description:"Dojos verwalten, Design, Theme, Verträge & Steuern",path:"/dashboard/dojos",badge:"DESIGN",featured:!0},{icon:"📥",title:"MagicLine Import",description:"Mitglieder & Verträge aus MagicLine importieren",path:"/dashboard/magicline-import",badge:"IMPORT",featured:!0},{icon:"📋",title:"Audit-Log",description:"Alle Änderungen nachverfolgen - Wer hat wann was geändert?",path:"/dashboard/audit-log",badge:"NEU",featured:!1},{icon:"🔗",title:"Webhooks & Zapier",description:"Automatisierungen mit externen Services",path:"/dashboard/webhooks",badge:"NEU",featured:!0},{icon:"🔌",title:"Integrationen",description:"PayPal, LexOffice, DATEV konfigurieren",path:"/dashboard/integrationen",badge:"NEU",featured:!0},{icon:"📅",title:"Kalender-Synchronisation",description:"iCal-Links für Google, Outlook, Apple",path:"/dashboard/kalender-sync",badge:"NEU",featured:!0}].map((e,a)=>s.jsxs("div",{onClick:()=>se(e.path),className:"nav-card clickable "+(e.featured?"featured":""),children:[e.badge&&s.jsx("div",{className:"nav-badge "+("NEU"===e.badge?"new":"LIVE"===e.badge?"live":"admin"),children:e.badge}),s.jsxs("div",{className:"nav-content",children:[s.jsxs("div",{className:"nav-card-header",children:[s.jsx("span",{className:"nav-icon",children:e.icon}),s.jsx("h3",{style:Je,children:e.title})]}),s.jsx("p",{children:e.description})]}),s.jsx("div",{className:"nav-arrow",children:"→"})]},a))}),"schnellaktionen"===G&&s.jsxs("div",{className:"nav-section",children:[s.jsxs("h2",{className:"section-header quick-actions-header",style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",backgroundImage:"none",WebkitBackgroundClip:"unset",WebkitTextFillColor:"#FFD700",backgroundClip:"unset",color:"#FFD700",textShadow:"0 2px 4px rgba(0, 0, 0, 0.3)",marginBottom:"2rem"},children:[s.jsx("span",{style:{fontSize:"1.5rem",filter:"drop-shadow(0 2px 8px rgba(255, 215, 0, 0.3))",position:"relative",zIndex:10,lineHeight:1,display:"inline-block",flexShrink:0},children:"⚡"}),s.jsx("span",{style:{WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",color:"#FFD700 !important",WebkitTextFillColor:"#FFD700 !important",backgroundImage:"none !important",WebkitBackgroundClip:"unset !important",backgroundClip:"unset !important"},children:i("quickActions.title")})]}),"admin"===Y?s.jsx("div",{className:"quick-actions",children:[{label:"➕ Neues Mitglied",path:"/dashboard/mitglieder/neu",className:"primary"},{label:"🎖️ Neuen Stil anlegen",path:"/dashboard/stile/neu",className:"info"},{label:"✅ Anwesenheit erfassen",path:"/dashboard/anwesenheit",className:"secondary"},{label:"🥋 Prüfung verwalten",path:"/dashboard/stile/pruefungen",className:"warning"},{label:"👥 Buddy-Gruppe erstellen",path:"/dashboard/buddy-gruppen",className:"success"},{label:"🎯 Neuen Tarif anlegen",path:"/dashboard/tarife",className:"info"},{label:"📦 Artikel hinzufügen",path:"/dashboard/artikel",className:"success"},{label:"💰 Barverkauf",path:"/dashboard/kasse",className:"primary"},{label:"💰 Zahlungseinstellungen",path:"/dashboard/einstellungen/zahlungen",className:"warning"}].map((e,a)=>s.jsx("button",{onClick:()=>se(e.path),className:`quick-action-btn ${e.className}`,children:e.label},a))}):s.jsx("div",{className:"quick-actions",children:[{label:"📅 Kurs buchen",path:"/dashboard/kurse",className:"primary"},{label:"👤 Daten bearbeiten",path:"/dashboard/meine-daten",className:"secondary"}].map((e,a)=>s.jsx("button",{onClick:()=>se(e.path),className:`quick-action-btn ${e.className}`,children:e.label},a))}),s.jsx("div",{style:{marginTop:"2rem",textAlign:"center"},children:s.jsxs("button",{onClick:X,className:"quick-action-btn info",disabled:$,children:["🔄 ",i($?"quickActions.loading":"quickActions.refreshStats")]})})]}),"support"===G&&s.jsx("div",{className:"nav-section",children:s.jsx(we,{bereich:"dojo"})}),"wunschliste"===G&&s.jsx("div",{className:"nav-section",children:s.jsx(De,{})}),"info"===G&&s.jsxs("div",{className:"nav-section",children:[s.jsxs("h2",{className:"section-header",children:["ℹ️ ",i("info.title")]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(320px, 1fr))",gap:"1.5rem",maxWidth:"1200px",margin:"0 auto"},children:[s.jsx("div",{style:{gridColumn:"span 1",background:"var(--glass-bg)",borderRadius:"16px",border:"1px solid var(--border-accent)",overflow:"hidden"},children:s.jsx(Te,{})}),s.jsxs("div",{style:{background:"var(--glass-bg)",borderRadius:"16px",padding:"1.5rem",border:"1px solid var(--border-accent)"},children:[s.jsxs("h3",{style:{color:"var(--primary)",marginBottom:"1rem",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:["📊 ",i("info.dojoStats")]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[s.jsxs("div",{style:{background:"rgba(255,215,0,0.1)",padding:"1rem",borderRadius:"8px",textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"1.8rem",fontWeight:"700",color:"var(--primary)"},children:ne(R.mitglieder)}),s.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)"},children:i("info.members")})]}),s.jsxs("div",{style:{background:"rgba(96,165,250,0.1)",padding:"1rem",borderRadius:"8px",textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"1.8rem",fontWeight:"700",color:"#60A5FA"},children:ne(R.kurse)}),s.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)"},children:i("info.courses")})]}),s.jsxs("div",{style:{background:"rgba(52,211,153,0.1)",padding:"1rem",borderRadius:"8px",textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"1.8rem",fontWeight:"700",color:"#34D399"},children:ne(R.trainer)}),s.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)"},children:i("info.trainers")})]}),s.jsxs("div",{style:{background:"rgba(244,114,182,0.1)",padding:"1rem",borderRadius:"8px",textAlign:"center"},children:[s.jsx("div",{style:{fontSize:"1.8rem",fontWeight:"700",color:"#F472B6"},children:ne(R.checkins_heute)}),s.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)"},children:i("info.checkinsToday")})]})]})]}),s.jsxs("div",{style:{background:"var(--glass-bg)",borderRadius:"16px",padding:"1.5rem",border:"1px solid var(--border-accent)"},children:[s.jsxs("h3",{style:{color:"var(--primary)",marginBottom:"1rem",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:["⚙️ ",i("info.system")]}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"0.5rem 0",borderBottom:"1px solid var(--border-accent)"},children:[s.jsx("span",{style:{color:"var(--text-secondary)"},children:i("info.version")}),s.jsxs("span",{style:{color:"var(--text-primary)",fontWeight:"600"},children:["v",t.app.version]})]}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"0.5rem 0",borderBottom:"1px solid var(--border-accent)"},children:[s.jsx("span",{style:{color:"var(--text-secondary)"},children:i("info.build")}),s.jsx("span",{style:{color:"var(--text-primary)"},children:t.app.buildDate})]}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"0.5rem 0",borderBottom:"1px solid var(--border-accent)"},children:[s.jsx("span",{style:{color:"var(--text-secondary)"},children:i("info.developer")}),s.jsx("span",{style:{color:"var(--text-primary)"},children:t.app.author})]}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"0.5rem 0"},children:[s.jsx("span",{style:{color:"var(--text-secondary)"},children:i("info.support")}),s.jsx("a",{href:`mailto:${t.app.contactEmail}`,style:{color:"var(--primary)"},children:t.app.contactEmail})]})]})]}),s.jsxs("div",{style:{background:"var(--glass-bg)",borderRadius:"16px",padding:"1.5rem",border:"1px solid var(--border-accent)"},children:[s.jsxs("h3",{style:{color:"var(--primary)",marginBottom:"1rem",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:["🔗 ",i("info.quickAccess")]}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[s.jsxs("button",{onClick:()=>se("/dashboard/einstellungen"),style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem 1rem",background:"rgba(255,255,255,0.05)",border:"1px solid var(--border-accent)",borderRadius:"8px",color:"var(--text-primary)",cursor:"pointer",textAlign:"left",width:"100%"},children:[s.jsx("span",{children:"🏯"}),s.jsx("span",{children:i("info.dojoSettings")})]}),s.jsxs("button",{onClick:()=>se("/dashboard/audit-log"),style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem 1rem",background:"rgba(255,255,255,0.05)",border:"1px solid var(--border-accent)",borderRadius:"8px",color:"var(--text-primary)",cursor:"pointer",textAlign:"left",width:"100%"},children:[s.jsx("span",{children:"📋"}),s.jsx("span",{children:i("einstellungen.auditLog")})]}),s.jsxs("button",{onClick:()=>se("/dashboard/vertragsdokumente"),style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem 1rem",background:"rgba(255,255,255,0.05)",border:"1px solid var(--border-accent)",borderRadius:"8px",color:"var(--text-primary)",cursor:"pointer",textAlign:"left",width:"100%"},children:[s.jsx("span",{children:"📄"}),s.jsx("span",{children:i("info.editAgb")})]})]})]}),s.jsx("div",{style:{gridColumn:"1 / -1"},children:s.jsx(x,{maxItems:3})})]})]})]})}):s.jsx(s.Fragment,{children:s.jsxs("div",{className:"nav-section",children:[s.jsx("h2",{className:"section-header",children:"🥋 Meine Dojo-Bereiche"}),s.jsx("div",{className:"nav-cards",children:[{icon:"✅",title:"Meine Anwesenheit",description:"Ihre Trainingshistorie einsehen",path:"/dashboard/meine-anwesenheit"},{icon:"🥋",title:"Meine Kurse",description:"Angemeldete Kurse und Termine",path:"/dashboard/meine-kurse"},{icon:"👤",title:"Meine Daten",description:"Persönliche Daten bearbeiten",path:"/dashboard/meine-daten"},{icon:"🎖️",title:"Meine Prüfungen",description:"Prüfungsstatus und nächste Gürtelprüfung",path:"/dashboard/meine-pruefungen"},{icon:"💰",title:"Meine Beiträge",description:"Zahlungshistorie und offene Beiträge",path:"/dashboard/meine-beitraege"}].map((e,a)=>s.jsxs("div",{onClick:()=>se(e.path),className:"nav-card clickable",children:[s.jsxs("div",{className:"nav-content",children:[s.jsxs("div",{className:"nav-card-header",children:[s.jsx("span",{className:"nav-icon",children:e.icon}),s.jsx("h3",{style:Je,children:e.title})]}),s.jsx("p",{children:e.description})]}),s.jsx("div",{className:"nav-arrow",children:"→"})]},a))})]})})})]}):s.jsx("div",{className:"content-card",children:s.jsx(Be,{})})})}),"admin"===Y&&s.jsx(N,{})]}))}export{He as default};
