import{a as e,j as s}from"./query-Caj74EYQ.js";import{a}from"./index-BfO9IvyN.js";import"./vendor-router-Co3o87Zc.js";import"./icons-DiLw-1i5.js";import"./charts-C1Gv3M_c.js";const t=()=>{const[t,n]=e.useState([]),[i,r]=e.useState(new Date),[c,l]=e.useState(0),[d,o]=e.useState(!1),[m,h]=e.useState("");e.useEffect(()=>{const e=async()=>{try{o(!0);const e=(await a.get("/stundenplan")).data;n(Array.isArray(e)?e:e.stundenplan||[])}catch(e){console.error("âŒ Fehler beim Laden des Stundenplans:",e),n([])}finally{o(!1)}};e();const s=setInterval(e,3e4),t=setInterval(()=>{r(new Date)},1e3),i=setInterval(()=>{l(e=>(e+1)%3)},1e4);return()=>{clearInterval(s),clearInterval(t),clearInterval(i)}},[]),e.useEffect(()=>{const e=()=>{const e=g();if(e){const s=N(e);h(s)}else h("")};e();const s=setInterval(e,1e3);return()=>{clearInterval(s)}},[t,i]);const u=e=>e?e.substring(0,5):"",x=()=>i.toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),v=()=>["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"][i.getDay()],j=()=>{const e=v();return t.filter(s=>s.tag===e)},g=()=>{const e=v(),s=x().substring(0,5),a=j().find(e=>e.uhrzeit_start>s);if(a)return{...a,isNextDay:!1,tag:e};const n=["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],r=i.getDay();let c=(r+1)%7;for(let i=0;i<7;i++){const e=n[c],s=t.filter(s=>s.tag===e);if(s.length>0){const a=c===(r+1)%7;return{...s.sort((e,s)=>{const a=e.uhrzeit_start||"00:00",t=s.uhrzeit_start||"00:00";return a.localeCompare(t)})[0],isNextDay:a,tag:e}}c=(c+1)%7}return null},N=e=>{if(!e||!e.uhrzeit_start||!e.tag)return"";const s=new Date,a=s.getDay(),t=["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"].indexOf(e.tag);if(-1===t)return"";let n=t-a;if(n<0&&(n+=7),0===n){const[a,t]=e.uhrzeit_start.split(":"),i=new Date(s);i.setHours(parseInt(a,10),parseInt(t,10),0,0),i<s&&(n=7)}const i=new Date(s);i.setDate(i.getDate()+n);const[r,c]=e.uhrzeit_start.split(":");i.setHours(parseInt(r,10),parseInt(c,10),0,0);const l=i-s;if(l<=0)return"Bereits gestartet";const d=Math.floor(l/864e5),o=Math.floor(l%864e5/36e5),m=Math.floor(l%36e5/6e4);return d>0?`${d} Tag${d>1?"e":""}, ${o} Stunde${1!==o?"n":""}`:o>0?`${o} Stunde${1!==o?"n":""}, ${m} Minute${1!==m?"n":""}`:`${m} Minute${1!==m?"n":""}`},p=()=>{const e=j();return s.jsx("div",{className:"view-content today-view",children:0===e.length?s.jsxs("div",{className:"no-classes",children:[s.jsx("div",{className:"no-classes-icon",children:"ğŸ®"}),s.jsx("h3",{children:"Heute keine Kurse"}),s.jsx("p",{children:"GenieÃŸt euren freien Tag!"})]}):s.jsx("div",{className:"classes-grid",children:e.map((e,a)=>s.jsxs("div",{className:"class-card",style:{animationDelay:.1*a+"s"},children:[s.jsxs("div",{className:"class-time",children:[s.jsx("span",{className:"start-time",children:u(e.uhrzeit_start)}),s.jsx("span",{className:"time-separator",children:"-"}),s.jsx("span",{className:"end-time",children:u(e.uhrzeit_ende)})]}),s.jsxs("div",{className:"class-info",children:[s.jsx("div",{className:"class-name",children:e.kursname}),s.jsxs("div",{className:"class-style",children:["ğŸ¥‹ ",e.stil]}),s.jsxs("div",{className:"class-trainer",children:["ğŸ‘¨â€ğŸ« ",e.trainer_vorname," ",e.trainer_nachname]})]}),s.jsx("div",{className:"class-status",children:s.jsx("div",{className:"status-indicator"})})]},`${e.id}-${a}`))})})},y=()=>{const e=["Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag","Sonntag"].map(e=>({day:e,classes:t.filter(s=>s.tag===e)}));return s.jsx("div",{className:"view-content weekly-view",children:s.jsx("div",{className:"weekly-grid",children:e.map((e,a)=>s.jsxs("div",{className:"day-column "+(e.day===v()?"current-day":""),style:{animationDelay:.1*a+"s"},children:[s.jsxs("div",{className:"day-header",children:[s.jsx("div",{className:"day-name",children:e.day}),s.jsxs("div",{className:"day-count",children:[e.classes.length," Kurse"]})]}),s.jsx("div",{className:"day-classes",children:0===e.classes.length?s.jsx("div",{className:"no-day-classes",children:"Kein Kurs"}):e.classes.map((e,a)=>s.jsxs("div",{className:"mini-class-card",children:[s.jsxs("div",{className:"mini-time",children:[u(e.uhrzeit_start)," - ",u(e.uhrzeit_ende)]}),s.jsx("div",{className:"mini-name",children:e.kursname}),s.jsx("div",{className:"mini-style",children:e.stil})]},`${e.id}-${a}`))})]},e.day))})})};return s.jsxs("div",{className:"public-timetable-display",children:[s.jsxs("div",{className:"view-indicator",children:[s.jsx("div",{className:"left-info",children:s.jsx("span",{className:"info-text",children:"ğŸ”„ Wechsel alle 10s â€¢ ğŸ“¡ Live Updates"})}),s.jsxs("div",{className:"view-center",children:[s.jsxs("div",{className:"view-info",children:[s.jsx("span",{className:"current-view-name",children:["Heute","NÃ¤chste Stunde","WochenÃ¼bersicht"][c]}),s.jsxs("span",{className:"view-progress",children:["(",c+1,"/3)"]})]}),s.jsx("div",{className:"view-dots",children:[0,1,2].map(e=>s.jsx("div",{className:"view-dot "+(e===c?"active":"")},e))})]}),s.jsxs("div",{className:"current-time",children:[s.jsx("div",{className:"time",children:x()}),s.jsx("div",{className:"date",children:i.toLocaleDateString("de-DE",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]})]}),d&&s.jsxs("div",{className:"loading-indicator",children:[s.jsx("div",{className:"spinner"}),s.jsx("span",{children:"Aktualisiere..."})]}),s.jsx("div",{className:"main-content",children:(()=>{switch(c){case 0:default:return p();case 1:return(()=>{const e=g();return s.jsx("div",{className:"view-content next-class-view",children:e?s.jsxs("div",{className:"next-class-card",children:[s.jsx("div",{className:"next-class-header",children:s.jsx("div",{className:"next-class-day",children:e.isNextDay?`Morgen - ${e.tag}`:e.tag===v()?`Heute - ${e.tag}`:e.tag})}),s.jsxs("div",{className:"next-class-time",children:[s.jsx("span",{className:"big-time",children:u(e.uhrzeit_start)}),s.jsx("span",{className:"time-separator",children:"-"}),s.jsx("span",{className:"big-time",children:u(e.uhrzeit_ende)})]}),s.jsxs("div",{className:"next-class-details",children:[s.jsx("div",{className:"next-class-name",children:e.kursname}),s.jsxs("div",{className:"next-class-style",children:["ğŸ¥‹ ",e.stil]}),s.jsxs("div",{className:"next-class-trainer",children:["ğŸ‘¨â€ğŸ« ",e.trainer_vorname," ",e.trainer_nachname]})]}),s.jsxs("div",{className:"countdown-section",children:[s.jsx("div",{className:"countdown-label",children:"Beginnt in"}),s.jsxs("div",{className:"countdown-timer",children:["â±ï¸ ",m||"Berechnung lÃ¤uft..."]})]})]}):s.jsxs("div",{className:"no-classes",children:[s.jsx("div",{className:"no-classes-icon",children:"ğŸ“…"}),s.jsx("h3",{children:"Keine weiteren Kurse geplant"}),s.jsx("p",{children:"Schaut spÃ¤ter wieder vorbei!"})]})})})();case 2:return y()}})()})]})};export{t as default};
