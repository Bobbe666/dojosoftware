import{a as e,j as t}from"./query-Caj74EYQ.js";import{b as a,a as r}from"./index-BfO9IvyN.js";import{o as n,s as i,ao as s,ap as l,aq as o,ar as d}from"./icons-DiLw-1i5.js";import{u as g}from"./vendor-router-Co3o87Zc.js";import"./charts-C1Gv3M_c.js";const c=()=>{const{getDojoFilterParam:c}=a(),[m,p]=e.useState([]),[h,x]=e.useState(!0),[u,b]=e.useState(""),[j,f]=e.useState(""),[y,v]=e.useState(""),S=g(),[k,w]=e.useState({page:1,limit:50,total:0,totalPages:0});e.useEffect(()=>{const e=setTimeout(()=>{f(y),w(e=>({...e,page:1}))},300);return()=>clearTimeout(e)},[y]);const z=e.useCallback(async()=>{try{x(!0);const e=c(),t=new URLSearchParams;if(e){const[a,r]=e.split("=");t.append(a,r)}t.append("page",k.page),t.append("limit",k.limit),j&&t.append("search",j);const a=await r.get(`/ehemalige?${t.toString()}`);a.data.data?(p(a.data.data),w(e=>({...e,...a.data.pagination}))):(p(a.data),w(e=>({...e,total:a.data.length,totalPages:1}))),x(!1)}catch(e){console.error("Fehler beim Laden der ehemaligen Mitglieder:",e),b("Fehler beim Laden der Daten"),x(!1)}},[c,k.page,k.limit,j]);e.useEffect(()=>{z()},[z]);const N=e=>{e>=1&&e<=k.totalPages&&w(t=>({...t,page:e}))},P=()=>{if(k.totalPages<=1)return null;const e=[];let a=Math.max(1,k.page-Math.floor(2.5)),r=Math.min(k.totalPages,a+5-1);r-a+1<5&&(a=Math.max(1,r-5+1));for(let t=a;t<=r;t++)e.push(t);return t.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"0.5rem",marginTop:"2rem",flexWrap:"wrap"},children:[t.jsx("button",{onClick:()=>N(1),disabled:1===k.page,className:"pagination-btn",title:"Erste Seite",children:t.jsx(s,{size:18})}),t.jsx("button",{onClick:()=>N(k.page-1),disabled:1===k.page,className:"pagination-btn",title:"Vorherige Seite",children:t.jsx(l,{size:18})}),a>1&&t.jsx("span",{style:{color:"rgba(255,255,255,0.5)"},children:"..."}),e.map(e=>t.jsx("button",{onClick:()=>N(e),className:"pagination-btn "+(k.page===e?"active":""),children:e},e)),r<k.totalPages&&t.jsx("span",{style:{color:"rgba(255,255,255,0.5)"},children:"..."}),t.jsx("button",{onClick:()=>N(k.page+1),disabled:k.page===k.totalPages,className:"pagination-btn",title:"N채chste Seite",children:t.jsx(o,{size:18})}),t.jsx("button",{onClick:()=>N(k.totalPages),disabled:k.page===k.totalPages,className:"pagination-btn",title:"Letzte Seite",children:t.jsx(d,{size:18})})]})};return u?t.jsx("div",{className:"dashboard-container",children:t.jsx("div",{className:"error",children:u})}):t.jsxs("div",{className:"dashboard-container",children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},children:[t.jsxs("h1",{style:{margin:0,display:"flex",alignItems:"center",gap:"0.5rem"},children:[t.jsx(n,{size:28}),"Ehemalige Mitglieder"]}),t.jsx("button",{className:"primary-button",onClick:()=>S("/dashboard/mitglieder"),children:"Zur체ck zu Mitgliedern"})]}),t.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",gap:"1rem",alignItems:"center",flexWrap:"wrap"},children:[t.jsxs("div",{style:{position:"relative",flex:1,minWidth:"250px"},children:[t.jsx(i,{size:18,style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"rgba(255,255,255,0.5)"}}),t.jsx("input",{type:"text",placeholder:"Suchen nach Name, Email...",value:y,onChange:e=>v(e.target.value),style:{width:"100%",padding:"0.75rem 0.75rem 0.75rem 40px",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.2)",background:"rgba(31, 41, 55, 0.6)",color:"white"}})]}),t.jsxs("div",{style:{color:"rgba(255, 255, 255, 0.7)",background:"rgba(31, 41, 55, 0.6)",padding:"0.75rem 1rem",borderRadius:"6px",whiteSpace:"nowrap"},children:[h?"...":`${k.total} Ehemalige`,k.totalPages>1&&` | Seite ${k.page}/${k.totalPages}`]})]}),h?t.jsx("div",{style:{textAlign:"center",padding:"3rem",color:"rgba(255,255,255,0.7)"},children:"Lade ehemalige Mitglieder..."}):t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"1rem"},children:m.length>0?m.map(e=>t.jsxs("div",{className:"stat-card",style:{padding:"1rem",borderRadius:"8px",cursor:"pointer",transition:"all 0.2s"},children:[t.jsxs("h3",{style:{fontSize:"1.1rem",fontWeight:"600",margin:"0 0 0.5rem 0",color:"#ffd700"},children:[e.nachname,", ",e.vorname]}),t.jsxs("div",{style:{fontSize:"0.85rem",color:"rgba(255, 255, 255, 0.7)",lineHeight:"1.6"},children:[e.austrittsdatum&&t.jsxs("p",{style:{margin:"0.2rem 0"},children:[t.jsx("strong",{children:"Austritt:"})," ",new Date(e.austrittsdatum).toLocaleDateString("de-DE")]}),e.email&&t.jsxs("p",{style:{margin:"0.2rem 0"},children:[t.jsx("strong",{children:"Email:"})," ",e.email]}),e.letzter_guertel&&t.jsxs("p",{style:{margin:"0.2rem 0"},children:[t.jsx("strong",{children:"Letzter G체rtel:"})," ",e.letzter_guertel]}),e.austrittsgrund&&t.jsxs("p",{style:{margin:"0.2rem 0"},children:[t.jsx("strong",{children:"Grund:"})," ",e.austrittsgrund]})]})]},e.id)):t.jsxs("div",{className:"stat-card",style:{gridColumn:"1 / -1",padding:"2rem",textAlign:"center"},children:[t.jsx("h3",{children:"Keine ehemaligen Mitglieder gefunden"}),t.jsx("p",{style:{color:"rgba(255, 255, 255, 0.6)"},children:j?"Keine Treffer f체r die Suche.":"Es sind noch keine ehemaligen Mitglieder im System erfasst."})]})}),t.jsx(P,{})]}),t.jsx("style",{children:"\n        .pagination-btn {\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          min-width: 36px;\n          height: 36px;\n          padding: 0 0.5rem;\n          background: rgba(31, 41, 55, 0.6);\n          border: 1px solid rgba(255, 255, 255, 0.2);\n          border-radius: 6px;\n          color: rgba(255, 255, 255, 0.8);\n          cursor: pointer;\n          transition: all 0.2s;\n          font-weight: 500;\n        }\n        .pagination-btn:hover:not(:disabled) {\n          background: rgba(59, 130, 246, 0.3);\n          border-color: rgba(59, 130, 246, 0.5);\n        }\n        .pagination-btn:disabled {\n          opacity: 0.4;\n          cursor: not-allowed;\n        }\n        .pagination-btn.active {\n          background: linear-gradient(135deg, #3B82F6 0%, #1D4ED8 100%);\n          border-color: transparent;\n          color: white;\n        }\n      "})]})};export{c as default};
