import{j as e}from"./animation-1wuIdCBS.js";import{r as s}from"./vendor-router-BhMXg4Z-.js";import r from"./MemberHeader-Byiis1Cp.js";import{g as a}from"./index-BJCk5MxH.js";import{e as i,g as n,C as t,U as d,q as l,aW as c,ay as o}from"./icons-C6KFH58b.js";import"./vendor-react-DtuzQOD1.js";/* empty css                  */import"./query-Bs1dTGah.js";const h=()=>{const[h,m]=s.useState([]),[j,u]=s.useState(0),[x,g]=s.useState(""),[v,w]=s.useState(!0),[b,p]=s.useState(!1),[N,f]=s.useState(!1),B=e=>{const s="string"==typeof e?new Date(e):e,r=new Date,a=new Date(r.getTime()-864e5);return s.toDateString()===r.toDateString()?"Heute":s.toDateString()===a.toDateString()?"Gestern":s.toLocaleDateString("de-DE",{weekday:"short",day:"numeric",month:"short"})};if(s.useEffect(()=>{(async()=>{w(!0);try{const e=await fetch(`${a.apiBaseUrl}/mitglieder/ratable-courses`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(e.ok){const s=await e.json();m(s.courses||[])}else console.error("Fehler beim Laden der bewertbaren Kurse:",e.statusText),m([])}catch(e){console.error("Fehler beim Laden der Kurse:",e),m([])}finally{w(!1)}})()},[]),v)return e.jsxs("div",{className:"dashboard-container",children:[e.jsx(r,{}),e.jsx("div",{className:"dashboard-content",children:e.jsxs("div",{className:"course-rating-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("span",{children:"Lade bewertbare Kurse..."})]})})]});const S=h.filter(e=>!e.rated),k=h.filter(e=>e.rated);return e.jsxs("div",{className:"dashboard-container",children:[e.jsx(r,{}),e.jsx("div",{className:"dashboard-content",children:e.jsxs("div",{className:"course-rating",children:[e.jsx("div",{className:"rating-header",children:e.jsxs("div",{className:"header-content",children:[e.jsx(i,{size:24}),e.jsx("h1",{children:"Kurs-Bewertung"}),e.jsx("p",{children:"Wie war dein Training? Teile deine Erfahrung mit uns!"})]})}),N&&e.jsxs("div",{className:"success-message",children:[e.jsx(n,{size:20}),e.jsx("span",{children:"Vielen Dank fÃ¼r deine Bewertung! ğŸ‰"})]}),S.length>0?e.jsxs("div",{className:"ratable-courses",children:[e.jsxs("h2",{children:[e.jsx(t,{size:20}),"Bewerte deine Kurse"]}),e.jsx("div",{className:"courses-list",children:S.map(s=>e.jsxs("div",{className:"course-card",children:[e.jsxs("div",{className:"course-info",children:[e.jsxs("div",{className:"course-header",children:[e.jsx("h3",{children:s.kurs_name}),e.jsx("span",{className:"course-date",children:B(s.datum)})]}),e.jsxs("div",{className:"course-details",children:[e.jsxs("div",{className:"detail-item",children:[e.jsx(d,{size:16}),e.jsx("span",{children:s.trainer_name})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx(l,{size:16}),e.jsxs("span",{children:[s.uhrzeit," â€¢ ",s.duration," Min"]})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx(c,{size:16}),e.jsx("span",{children:s.raum})]})]})]}),e.jsxs("div",{className:"rating-section",children:[e.jsxs("div",{className:"rating-stars",children:[e.jsx("label",{children:"Wie war das Training?"}),e.jsx("div",{className:"stars",children:[1,2,3,4,5].map(s=>e.jsx("button",{className:"star "+(s<=j?"filled":""),onClick:()=>u(s),children:e.jsx(i,{size:24})},s))}),e.jsxs("div",{className:"rating-text",children:[0===j&&"Bewertung wÃ¤hlen",1===j&&"ğŸ˜ Sehr schlecht",2===j&&"ğŸ˜• Schlecht",3===j&&"ğŸ˜ Okay",4===j&&"ğŸ˜Š Gut",5===j&&"ğŸ¤© Sehr gut!"]})]}),e.jsxs("div",{className:"comment-section",children:[e.jsx("label",{children:"Optional: Kommentar hinzufÃ¼gen"}),e.jsx("textarea",{value:x,onChange:e=>g(e.target.value),placeholder:"Wie war der Trainer? Was hat dir besonders gefallen? VerbesserungsvorschlÃ¤ge?",rows:"3",maxLength:"500"}),e.jsxs("div",{className:"comment-counter",children:[x.length,"/500 Zeichen"]})]}),e.jsx("button",{className:"submit-button",onClick:()=>(async e=>{if(0!==j){p(!0);try{const s=await fetch(`${a.apiBaseUrl}/mitglieder/submit-rating`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({courseId:e,rating:j,comment:x.trim()})});if(!s.ok){const e=await s.json();throw new Error(e.message||"Fehler beim Speichern der Bewertung")}await s.json(),m(s=>s.map(s=>s.id===e?{...s,rated:!0}:s)),f(!0),u(0),g(""),setTimeout(()=>f(!1),3e3)}catch(s){console.error("Fehler beim Absenden der Bewertung:",s),alert(`Fehler beim Absenden der Bewertung: ${s.message}`)}finally{p(!1)}}else alert("Bitte wÃ¤hle eine Bewertung aus!")})(s.id),disabled:0===j||b,children:b?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"loading-spinner small"}),"Wird gesendet..."]}):e.jsxs(e.Fragment,{children:[e.jsx(o,{size:16}),"Bewertung absenden"]})})]})]},s.id))})]}):e.jsxs("div",{className:"no-ratable-courses",children:[e.jsx(i,{size:48}),e.jsx("h3",{children:"Keine Kurse zu bewerten"}),e.jsx("p",{children:"Du hast momentan keine Kurse, die bewertet werden kÃ¶nnen."})]}),k.length>0&&e.jsxs("div",{className:"rated-courses",children:[e.jsxs("h2",{children:[e.jsx(n,{size:20}),"Bereits bewertete Kurse"]}),e.jsx("div",{className:"rated-list",children:k.map(s=>e.jsxs("div",{className:"rated-card",children:[e.jsxs("div",{className:"rated-info",children:[e.jsx("h4",{children:s.kurs_name}),e.jsxs("div",{className:"rated-details",children:[e.jsx("span",{children:s.trainer_name}),e.jsx("span",{children:B(s.datum)})]})]}),e.jsxs("div",{className:"rated-status",children:[e.jsx(n,{size:16}),e.jsx("span",{children:"Bewertet"})]})]},s.id))})]}),e.jsxs("div",{className:"rating-tips",children:[e.jsx("h3",{children:"ğŸ’¡ Tipps fÃ¼r deine Bewertung"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Deine Bewertung hilft uns, die Kurse zu verbessern"}),e.jsx("li",{children:"Konstruktive Kritik ist immer willkommen"}),e.jsx("li",{children:"Alle Bewertungen werden anonym an die Trainer weitergegeben"}),e.jsx("li",{children:"Du kannst nur Kurse bewerten, die du besucht hast"})]})]})]})})]})};export{h as default};
