import{j as e}from"./animation-1wuIdCBS.js";import{r,b as i}from"./vendor-router-BhMXg4Z-.js";import{b as a,l}from"./index-BJCk5MxH.js";import{a2 as n,A as t,c as d,P as o,q as s,av as g,V as c,d as b,a3 as m,a4 as p,a5 as u,p as h,Z as x,a6 as f,o as y,a7 as v,n as j,a8 as k,a9 as w,a0 as z,e as _,aa as S,K as C}from"./icons-C6KFH58b.js";import"./vendor-react-DtuzQOD1.js";import"./query-Bs1dTGah.js";const B={award:t,star:_,trophy:n,medal:z,crown:w,flame:k,target:j,heart:v,users:y,swords:f,zap:x,"trending-up":h,footprints:u,layers:p,brain:m,shield:b},R=[{value:"award",label:"Award"},{value:"star",label:"Star"},{value:"trophy",label:"Trophy"},{value:"medal",label:"Medal"},{value:"crown",label:"Crown"},{value:"flame",label:"Flame"},{value:"target",label:"Target"},{value:"heart",label:"Heart"},{value:"users",label:"Users"},{value:"swords",label:"Swords"},{value:"zap",label:"Zap"},{value:"trending-up",label:"Trending Up"},{value:"footprints",label:"Footprints"},{value:"layers",label:"Layers"},{value:"brain",label:"Brain"},{value:"shield",label:"Shield"}],$=[{value:"training",label:"Training"},{value:"pruefung",label:"Pruefung"},{value:"skill",label:"Skill"},{value:"special",label:"Spezial"}],A=[{value:"",label:"Manuell (kein Kriterium)"},{value:"trainings_anzahl",label:"Anzahl Trainings"},{value:"pruefung_bestanden",label:"Pruefungen bestanden"},{value:"skill_gemeistert",label:"Skills gemeistert"}],I=["#FFD700","#22c55e","#3b82f6","#f97316","#ef4444","#8b5cf6","#ec4899","#06b6d4","#84cc16","#f59e0b"],T=()=>{var b,m,p;const{activeDojo:u}=a(),[h,x]=r.useState({members:[],badges:[],pendingAwards:[],summary:{}}),[f,y]=r.useState(!0),[v,j]=r.useState([]),[k,w]=r.useState(""),[z,_]=r.useState(!1),[T,W]=r.useState(!1),[F,P]=r.useState({mitglied_id:null,badge_id:null}),[L,V]=r.useState(null),[D,K]=r.useState(null),[M,N]=r.useState("vergeben");r.useEffect(()=>{O()},[u]);const O=async()=>{const e=l();if(!e)return K("Kein gueltiger Token gefunden. Bitte neu einloggen."),void y(!1);K(null),y(!0);try{const r=!u||"super-admin"===u||"all"===u||"all"===(null==u?void 0:u.id),i=!r&&(null==u?void 0:u.id)?`dojo_id=${u.id}`:"";console.log("Badge loadData:",{activeDojo:u,isAllDojos:r,dojoParam:i});const a=await fetch(`/api/badges/admin/overview?${i}`,{headers:{Authorization:`Bearer ${e}`}});if(a.ok){const e=await a.json();x(e)}else 403===a.status?K("Keine Berechtigung (403). Bitte neu einloggen."):K(`Server-Fehler: ${a.status}`)}catch(r){console.error("Fehler beim Laden:",r),K(`Netzwerkfehler: ${r.message}`)}finally{y(!1)}},E=e=>B[e]||t,U=h.pendingAwards.filter(e=>`${e.vorname} ${e.nachname}`.toLowerCase().includes(k.toLowerCase())||e.badge_name.toLowerCase().includes(k.toLowerCase()));return f?e.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"rgba(255,255,255,0.5)"},children:"Lade Daten..."}):D?e.jsxs("div",{style:{padding:"2rem",textAlign:"center"},children:[e.jsxs("div",{style:{color:"#ef4444",marginBottom:"1rem"},children:["Fehler: ",D]}),e.jsx("button",{onClick:()=>window.location.href="/login",style:{background:"#ffd700",color:"#1a1a1a",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:"pointer",fontWeight:600},children:"Zum Login"})]}):e.jsxs("div",{style:{padding:"1rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[e.jsx("div",{children:e.jsxs("h2",{style:{color:"#ffd700",margin:0,fontSize:"1.25rem"},children:[e.jsx(n,{size:24,style:{marginRight:"0.5rem",verticalAlign:"middle"}}),"Badge-Verwaltung"]})}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("button",{onClick:()=>N("vergeben"),style:{background:"vergeben"===M?"rgba(255, 215, 0, 0.3)":"rgba(255,255,255,0.1)",border:"1px solid "+("vergeben"===M?"rgba(255, 215, 0, 0.5)":"rgba(255,255,255,0.2)"),color:"vergeben"===M?"#ffd700":"rgba(255,255,255,0.7)",padding:"0.5rem 1rem",borderRadius:"6px",cursor:"pointer",fontWeight:500},children:[e.jsx(t,{size:16,style:{marginRight:"0.5rem",verticalAlign:"middle"}}),"Vergeben"]}),e.jsxs("button",{onClick:()=>N("verwalten"),style:{background:"verwalten"===M?"rgba(255, 215, 0, 0.3)":"rgba(255,255,255,0.1)",border:"1px solid "+("verwalten"===M?"rgba(255, 215, 0, 0.5)":"rgba(255,255,255,0.2)"),color:"verwalten"===M?"#ffd700":"rgba(255,255,255,0.7)",padding:"0.5rem 1rem",borderRadius:"6px",cursor:"pointer",fontWeight:500},children:[e.jsx(d,{size:16,style:{marginRight:"0.5rem",verticalAlign:"middle"}}),"Verwalten"]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",borderRadius:"10px",padding:"1rem",border:"1px solid rgba(255, 215, 0, 0.2)",textAlign:"center"},children:[e.jsx("div",{style:{color:"#ffd700",fontSize:"2rem",fontWeight:700},children:h.summary.total_members||0}),e.jsx("div",{style:{color:"rgba(255,255,255,0.6)",fontSize:"0.8rem"},children:"Aktive Mitglieder"})]}),e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",borderRadius:"10px",padding:"1rem",border:"1px solid rgba(34, 197, 94, 0.3)",textAlign:"center"},children:[e.jsx("div",{style:{color:"#22c55e",fontSize:"2rem",fontWeight:700},children:h.badges.length}),e.jsx("div",{style:{color:"rgba(255,255,255,0.6)",fontSize:"0.8rem"},children:"Verfuegbare Badges"})]}),e.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(249, 115, 22, 0.2), rgba(249, 115, 22, 0.05))",borderRadius:"10px",padding:"1rem",border:"2px solid rgba(249, 115, 22, 0.4)",textAlign:"center"},children:[e.jsx("div",{style:{color:"#f97316",fontSize:"2rem",fontWeight:700},children:h.summary.pending_awards||0}),e.jsx("div",{style:{color:"rgba(255,255,255,0.7)",fontSize:"0.8rem",fontWeight:600},children:"Ausstehende Badges"})]})]}),"vergeben"===M&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:"1rem"},children:e.jsxs("button",{onClick:()=>_(!0),style:{background:"linear-gradient(135deg, rgba(255, 215, 0, 0.3), rgba(255, 215, 0, 0.1))",border:"1px solid rgba(255, 215, 0, 0.4)",color:"#ffd700",padding:"0.5rem 1rem",borderRadius:"8px",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",fontWeight:600},children:[e.jsx(o,{size:18})," Manuell verleihen"]})}),h.pendingAwards.length>0&&e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",borderRadius:"12px",padding:"1.25rem",border:"1px solid rgba(249, 115, 22, 0.3)",marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsxs("h3",{style:{color:"#f97316",margin:0,fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(s,{size:18})," Verdiente Badges zum Verleihen"]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsxs("div",{style:{position:"relative"},children:[e.jsx(g,{size:16,style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)",color:"rgba(255,255,255,0.4)"}}),e.jsx("input",{type:"text",placeholder:"Suchen...",value:k,onChange:e=>w(e.target.value),style:{background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.2)",borderRadius:"6px",padding:"0.4rem 0.75rem 0.4rem 2rem",color:"white",fontSize:"0.85rem",width:"180px"}})]}),e.jsxs("button",{onClick:()=>{v.length===h.pendingAwards.length?j([]):j(h.pendingAwards.map(e=>`${e.mitglied_id}_${e.badge_id}`))},style:{background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.2)",color:"rgba(255,255,255,0.8)",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem"},children:[v.length===h.pendingAwards.length?"Keine":"Alle"," auswaehlen"]}),v.length>0&&e.jsxs("button",{onClick:async()=>{if(0===v.length)return;const e=v.map(e=>{const[r,i]=e.split("_");return{mitglied_id:parseInt(r),badge_id:parseInt(i)}});try{(await fetch("/api/badges/admin/award-pending",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l()}`},body:JSON.stringify({awards:e,verliehen_von_name:"Admin"})})).ok&&(j([]),O())}catch(r){console.error("Fehler beim Verleihen:",r)}},style:{background:"linear-gradient(135deg, #22c55e, #16a34a)",border:"none",color:"white",padding:"0.4rem 1rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",fontWeight:600,display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(c,{size:16})," ",v.length," verleihen"]})]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"0.75rem",maxHeight:"400px",overflowY:"auto"},children:U.map((r,i)=>{const a=`${r.mitglied_id}_${r.badge_id}`,l=v.includes(a),n=E(r.badge_icon);return e.jsxs("div",{onClick:()=>(e=>{const r=`${e.mitglied_id}_${e.badge_id}`;j(e=>e.includes(r)?e.filter(e=>e!==r):[...e,r])})(r),style:{background:l?"rgba(34, 197, 94, 0.15)":"rgba(255,255,255,0.03)",borderRadius:"8px",padding:"0.75rem",border:l?"2px solid #22c55e":"1px solid rgba(255,255,255,0.1)",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.75rem",transition:"all 0.2s ease"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:`linear-gradient(135deg, ${r.badge_farbe}40, ${r.badge_farbe}20)`,border:`2px solid ${r.badge_farbe}`,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(n,{size:20,color:r.badge_farbe})}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{style:{fontWeight:600,color:"rgba(255,255,255,0.9)",fontSize:"0.9rem"},children:[r.vorname," ",r.nachname]}),e.jsx("div",{style:{color:r.badge_farbe,fontSize:"0.8rem",fontWeight:500},children:r.badge_name}),e.jsxs("div",{style:{color:"rgba(255,255,255,0.5)",fontSize:"0.7rem"},children:[r.aktueller_wert," ",r.kriterium]})]}),e.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"4px",border:l?"2px solid #22c55e":"2px solid rgba(255,255,255,0.2)",background:l?"#22c55e":"transparent",display:"flex",alignItems:"center",justifyContent:"center"},children:l&&e.jsx(c,{size:16,color:"white"})})]},i)})})]})]}),"verwalten"===M&&e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",borderRadius:"12px",padding:"1.25rem",border:"1px solid rgba(255, 215, 0, 0.2)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h3",{style:{color:"#ffd700",margin:0,fontSize:"1rem"},children:"Badge-Definitionen"}),e.jsxs("button",{onClick:()=>{V({name:"",beschreibung:"",icon:"award",farbe:"#FFD700",kategorie:"special",kriterium_typ:"",kriterium_wert:null,aktiv:!0}),W(!0)},style:{background:"linear-gradient(135deg, #22c55e, #16a34a)",border:"none",color:"white",padding:"0.5rem 1rem",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",fontWeight:600},children:[e.jsx(o,{size:16})," Neuer Badge"]})]}),e.jsx("div",{style:{display:"grid",gap:"0.75rem"},children:h.badges.map(r=>{const i=E(r.icon);return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",background:"rgba(255,255,255,0.03)",borderRadius:"8px",padding:"0.75rem",border:"1px solid rgba(255,255,255,0.1)"},children:[e.jsx("div",{style:{width:"50px",height:"50px",borderRadius:"50%",background:`linear-gradient(135deg, ${r.farbe}40, ${r.farbe}20)`,border:`2px solid ${r.farbe}`,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(i,{size:24,color:r.farbe})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:600,color:r.farbe,fontSize:"1rem"},children:r.name}),e.jsx("div",{style:{color:"rgba(255,255,255,0.6)",fontSize:"0.8rem"},children:r.beschreibung||"Keine Beschreibung"}),e.jsxs("div",{style:{color:"rgba(255,255,255,0.4)",fontSize:"0.75rem",marginTop:"0.25rem"},children:[r.kategorie.toUpperCase()," | ",r.kriterium_typ?`${r.kriterium_wert} ${r.kriterium_typ.replace("_"," ")}`:"Manuell"]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{onClick:()=>{V(r),W(!0)},style:{background:"rgba(59, 130, 246, 0.2)",border:"1px solid rgba(59, 130, 246, 0.4)",color:"#3b82f6",padding:"0.4rem",borderRadius:"6px",cursor:"pointer"},children:e.jsx(S,{size:16})}),e.jsx("button",{onClick:()=>(async e=>{if(confirm("Badge wirklich deaktivieren?"))try{(await fetch(`/api/badges/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${l()}`}})).ok&&O()}catch(r){console.error("Fehler beim Loeschen:",r)}})(r.badge_id),style:{background:"rgba(239, 68, 68, 0.2)",border:"1px solid rgba(239, 68, 68, 0.4)",color:"#ef4444",padding:"0.4rem",borderRadius:"6px",cursor:"pointer"},children:e.jsx(C,{size:16})})]})]},r.badge_id)})})]}),z&&e.jsx("div",{onClick:()=>_(!1),style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:e.jsxs("div",{onClick:e=>e.stopPropagation(),style:{background:"#1a1a1a",borderRadius:"12px",padding:"1.5rem",width:"400px",maxWidth:"90%",border:"1px solid rgba(255, 215, 0, 0.3)"},children:[e.jsx("h3",{style:{color:"#ffd700",margin:"0 0 1rem 0"},children:"Badge manuell verleihen"}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("label",{style:{display:"block",color:"rgba(255,255,255,0.7)",fontSize:"0.85rem",marginBottom:"0.5rem"},children:["Mitglied (",(null==(b=h.members)?void 0:b.length)||0," verfuegbar)"]}),e.jsxs("select",{value:F.mitglied_id||"",onChange:e=>P({...F,mitglied_id:e.target.value}),style:{width:"100%",background:"#2a2a2a",border:"1px solid rgba(255,255,255,0.2)",borderRadius:"6px",padding:"0.6rem",color:"white",fontSize:"0.9rem",cursor:"pointer"},children:[e.jsx("option",{value:"",children:"Mitglied waehlen..."}),null==(m=h.members)?void 0:m.slice().sort((e,r)=>`${e.nachname} ${e.vorname}`.localeCompare(`${r.nachname} ${r.vorname}`)).map(r=>e.jsxs("option",{value:r.mitglied_id,children:[r.nachname,", ",r.vorname]},r.mitglied_id))]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",color:"rgba(255,255,255,0.7)",fontSize:"0.85rem",marginBottom:"0.5rem"},children:"Badge"}),e.jsxs("select",{value:F.badge_id||"",onChange:e=>P({...F,badge_id:e.target.value}),style:{width:"100%",background:"#2a2a2a",border:"1px solid rgba(255,255,255,0.2)",borderRadius:"6px",padding:"0.6rem",color:"white",fontSize:"0.9rem",cursor:"pointer"},children:[e.jsx("option",{value:"",children:"Badge waehlen..."}),null==(p=h.badges)?void 0:p.map(r=>e.jsxs("option",{value:r.badge_id,children:[r.name," (",r.kategorie,")"]},r.badge_id))]})]}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("label",{style:{display:"block",color:"rgba(255,255,255,0.7)",fontSize:"0.85rem",marginBottom:"0.5rem"},children:"Kommentar (optional)"}),e.jsx("input",{type:"text",value:F.kommentar||"",onChange:e=>P({...F,kommentar:e.target.value}),placeholder:"Grund fuer die Auszeichnung...",style:{width:"100%",background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.2)",borderRadius:"6px",padding:"0.6rem",color:"white",fontSize:"0.9rem"}})]}),e.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>_(!1),style:{background:"transparent",border:"1px solid rgba(255,255,255,0.3)",color:"rgba(255,255,255,0.7)",padding:"0.5rem 1rem",borderRadius:"6px",cursor:"pointer"},children:"Abbrechen"}),e.jsx("button",{onClick:async()=>{if(F.mitglied_id&&F.badge_id)try{(await fetch(`/api/badges/mitglied/${F.mitglied_id}/${F.badge_id}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l()}`},body:JSON.stringify({verliehen_von_name:"Admin",kommentar:F.kommentar})})).ok&&(_(!1),P({mitglied_id:null,badge_id:null}),O())}catch(e){console.error("Fehler beim manuellen Verleihen:",e)}},disabled:!F.mitglied_id||!F.badge_id,style:{background:"linear-gradient(135deg, #22c55e, #16a34a)",border:"none",color:"white",padding:"0.5rem 1rem",borderRadius:"6px",cursor:"pointer",fontWeight:600,opacity:F.mitglied_id&&F.badge_id?1:.5},children:"Verleihen"})]})]})}),T&&L&&e.jsx("div",{onClick:()=>W(!1),style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:e.jsxs("div",{onClick:e=>e.stopPropagation(),style:{background:"#1a1a1a",borderRadius:"12px",padding:"1.5rem",width:"500px",maxWidth:"90%",maxHeight:"90vh",overflowY:"auto",border:"1px solid rgba(255, 215, 0, 0.3)"},children:[e.jsx("h3",{style:{color:"#ffd700",margin:"0 0 1rem 0"},children:L.badge_id?"Badge bearbeiten":"Neuer Badge"}),e.jsx("div",{style:{display:"flex",justifyContent:"center",marginBottom:"1.5rem"},children:e.jsx("div",{style:{width:"80px",height:"80px",borderRadius:"50%",background:`linear-gradient(135deg, ${L.farbe}40, ${L.farbe}20)`,border:`3px solid ${L.farbe}`,display:"flex",alignItems:"center",justifyContent:"center"},children:i.createElement(E(L.icon),{size:40,color:L.farbe})})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",color:"rgba(255,255,255,0.7)",fontSize:"0.85rem",marginBottom:"0.5rem"},children:"Name *"}),e.jsx("input",{type:"text",value:L.name,onChange:e=>V({...L,name:e.target.value}),style:{width:"100%",background:"#2a2a2a",border:"1px solid rgba(255,255,255,0.2)",borderRadius:"6px",padding:"0.6rem",color:"white",fontSize:"0.9rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",color:"rgba(255,255,255,0.7)",fontSize:"0.85rem",marginBottom:"0.5rem"},children:"Kategorie *"}),e.jsx("select",{value:L.kategorie,onChange:e=>V({...L,kategorie:e.target.value}),style:{width:"100%",background:"#2a2a2a",border:"1px solid rgba(255,255,255,0.2)",borderRadius:"6px",padding:"0.6rem",color:"white",fontSize:"0.9rem"},children:$.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))})]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",color:"rgba(255,255,255,0.7)",fontSize:"0.85rem",marginBottom:"0.5rem"},children:"Beschreibung"}),e.jsx("textarea",{value:L.beschreibung||"",onChange:e=>V({...L,beschreibung:e.target.value}),rows:2,style:{width:"100%",background:"#2a2a2a",border:"1px solid rgba(255,255,255,0.2)",borderRadius:"6px",padding:"0.6rem",color:"white",fontSize:"0.9rem",resize:"vertical"}})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",color:"rgba(255,255,255,0.7)",fontSize:"0.85rem",marginBottom:"0.5rem"},children:"Icon *"}),e.jsx("select",{value:L.icon,onChange:e=>V({...L,icon:e.target.value}),style:{width:"100%",background:"#2a2a2a",border:"1px solid rgba(255,255,255,0.2)",borderRadius:"6px",padding:"0.6rem",color:"white",fontSize:"0.9rem"},children:R.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",color:"rgba(255,255,255,0.7)",fontSize:"0.85rem",marginBottom:"0.5rem"},children:"Farbe *"}),e.jsx("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:I.map(r=>e.jsx("div",{onClick:()=>V({...L,farbe:r}),style:{width:"28px",height:"28px",borderRadius:"50%",background:r,cursor:"pointer",border:L.farbe===r?"3px solid white":"2px solid rgba(255,255,255,0.2)"}},r))})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",color:"rgba(255,255,255,0.7)",fontSize:"0.85rem",marginBottom:"0.5rem"},children:"Kriterium"}),e.jsx("select",{value:L.kriterium_typ||"",onChange:e=>V({...L,kriterium_typ:e.target.value||null}),style:{width:"100%",background:"#2a2a2a",border:"1px solid rgba(255,255,255,0.2)",borderRadius:"6px",padding:"0.6rem",color:"white",fontSize:"0.9rem"},children:A.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))})]}),L.kriterium_typ&&e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",color:"rgba(255,255,255,0.7)",fontSize:"0.85rem",marginBottom:"0.5rem"},children:"Wert"}),e.jsx("input",{type:"number",value:L.kriterium_wert||"",onChange:e=>V({...L,kriterium_wert:parseInt(e.target.value)||null}),style:{width:"100%",background:"#2a2a2a",border:"1px solid rgba(255,255,255,0.2)",borderRadius:"6px",padding:"0.6rem",color:"white",fontSize:"0.9rem"}})]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>{W(!1),V(null)},style:{background:"transparent",border:"1px solid rgba(255,255,255,0.3)",color:"rgba(255,255,255,0.7)",padding:"0.5rem 1rem",borderRadius:"6px",cursor:"pointer"},children:"Abbrechen"}),e.jsx("button",{onClick:async()=>{if((null==L?void 0:L.name)&&(null==L?void 0:L.icon)&&(null==L?void 0:L.farbe)&&(null==L?void 0:L.kategorie))try{const e=!L.badge_id,r=e?"/api/badges":`/api/badges/${L.badge_id}`,i=e?"POST":"PUT",a=await fetch(r,{method:i,headers:{"Content-Type":"application/json",Authorization:`Bearer ${l()}`},body:JSON.stringify(L)});if(a.ok)W(!1),V(null),O();else{const e=await a.json();alert(e.error||"Fehler beim Speichern")}}catch(e){console.error("Fehler beim Speichern:",e)}else alert("Bitte alle Pflichtfelder ausfuellen")},style:{background:"linear-gradient(135deg, #22c55e, #16a34a)",border:"none",color:"white",padding:"0.5rem 1rem",borderRadius:"6px",cursor:"pointer",fontWeight:600},children:"Speichern"})]})]})})]})};export{T as default};
