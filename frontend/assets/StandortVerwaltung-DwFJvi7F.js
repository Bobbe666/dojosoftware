import{j as e}from"./animation-1wuIdCBS.js";import{r as s}from"./vendor-router-BhMXg4Z-.js";import{c as a,D as n,a as t}from"./index-BJCk5MxH.js";import{P as i,x as l,W as r,o as d,a as o,b as c,aa as h,K as u,Y as m,M as x,q as j,X as g,N as f}from"./icons-C6KFH58b.js";import"./vendor-react-DtuzQOD1.js";import"./query-Bs1dTGah.js";const v=()=>{const{standorte:v,loadStandorte:p}=a(),{trainer:N}=s.useContext(n),[b,z]=s.useState(!1),[y,k]=s.useState(""),[S,_]=s.useState(!1),[w,C]=s.useState(null),[F,$]=s.useState(null),[D,E]=s.useState({}),[O,B]=s.useState("basis"),[K,I]=s.useState({name:"",ist_hauptstandort:!1,farbe:"#4F46E5",strasse:"",hausnummer:"",plz:"",ort:"",land:"Deutschland",telefon:"",email:"",notizen:"",ist_aktiv:!0,sortierung:0,oeffnungszeiten:{regular:{monday:{open:"09:00",close:"21:00",closed:!1},tuesday:{open:"09:00",close:"21:00",closed:!1},wednesday:{open:"09:00",close:"21:00",closed:!1},thursday:{open:"09:00",close:"21:00",closed:!1},friday:{open:"09:00",close:"21:00",closed:!1},saturday:{open:"10:00",close:"18:00",closed:!1},sunday:{closed:!0}},exceptions:[],vacation:null}}),L={monday:"Montag",tuesday:"Dienstag",wednesday:"Mittwoch",thursday:"Donnerstag",friday:"Freitag",saturday:"Samstag",sunday:"Sonntag"};s.useEffect(()=>{M()},[v]);const M=async()=>{try{const e={};for(const s of v){const a=await t.get(`/standorte/${s.standort_id}/stats`);e[s.standort_id]=a.data.data}E(e)}catch(e){console.error("Fehler beim Laden der Statistiken:",e)}},A=(e=null)=>{e?(C(e),I({name:e.name||"",ist_hauptstandort:e.ist_hauptstandort||!1,farbe:e.farbe||"#4F46E5",strasse:e.strasse||"",hausnummer:e.hausnummer||"",plz:e.plz||"",ort:e.ort||"",land:e.land||"Deutschland",telefon:e.telefon||"",email:e.email||"",notizen:e.notizen||"",ist_aktiv:!1!==e.ist_aktiv,sortierung:e.sortierung||0,oeffnungszeiten:e.oeffnungszeiten?"string"==typeof e.oeffnungszeiten?JSON.parse(e.oeffnungszeiten):e.oeffnungszeiten:K.oeffnungszeiten})):(C(null),I({name:"",ist_hauptstandort:!1,farbe:"#4F46E5",strasse:"",hausnummer:"",plz:"",ort:"",land:"Deutschland",telefon:"",email:"",notizen:"",ist_aktiv:!0,sortierung:v.length,oeffnungszeiten:{regular:{monday:{open:"09:00",close:"21:00",closed:!1},tuesday:{open:"09:00",close:"21:00",closed:!1},wednesday:{open:"09:00",close:"21:00",closed:!1},thursday:{open:"09:00",close:"21:00",closed:!1},friday:{open:"09:00",close:"21:00",closed:!1},saturday:{open:"10:00",close:"18:00",closed:!1},sunday:{closed:!0}},exceptions:[],vacation:null}})),_(!0)},J=()=>{_(!1),C(null),k(""),B("basis")},H=(e,s,a)=>{I(n=>({...n,oeffnungszeiten:{...n.oeffnungszeiten,regular:{...n.oeffnungszeiten.regular,[e]:{...n.oeffnungszeiten.regular[e],[s]:a}}}}))},W=e=>{if(!e)return"Keine Ã–ffnungszeiten";const s="string"==typeof e?JSON.parse(e):e;if(!s.regular)return"Keine Ã–ffnungszeiten";const a=Object.entries(s.regular).filter(([e,s])=>!s.closed).map(([e,s])=>`${L[e]}: ${s.open}-${s.close}`);return a.length>0?a.slice(0,2).join(", ")+(a.length>2?"...":""):"Geschlossen"};return e.jsxs("div",{className:"standortverwaltung-container",children:[e.jsxs("div",{className:"standortverwaltung-header",children:[e.jsxs("div",{className:"header-left",children:[e.jsx("h2",{children:"ðŸ“ Standort-Verwaltung"}),e.jsx("p",{className:"subtitle",children:"Verwalten Sie alle Standorte Ihres Dojos"})]}),e.jsxs("button",{className:"btn-primary",onClick:()=>A(),children:[e.jsx(i,{size:18}),e.jsx("span",{children:"Neuer Standort"})]})]}),e.jsxs("div",{className:"stats-grid",children:[e.jsxs("div",{className:"stat-card-large",children:[e.jsx("div",{className:"stat-icon",style:{background:"linear-gradient(135deg, #10B981 0%, #059669 100%)"},children:e.jsx(l,{size:24})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-value",children:v.length}),e.jsx("div",{className:"stat-label",children:"Standorte gesamt"})]})]}),e.jsxs("div",{className:"stat-card-large",children:[e.jsx("div",{className:"stat-icon",style:{background:"linear-gradient(135deg, #3B82F6 0%, #2563EB 100%)"},children:e.jsx(r,{size:24})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-value",children:v.filter(e=>e.ist_aktiv).length}),e.jsx("div",{className:"stat-label",children:"Aktive Standorte"})]})]}),e.jsxs("div",{className:"stat-card-large",children:[e.jsx("div",{className:"stat-icon",style:{background:"linear-gradient(135deg, #F59E0B 0%, #D97706 100%)"},children:e.jsx(d,{size:24})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-value",children:Object.values(D).reduce((e,s)=>e+((null==s?void 0:s.anzahl_kurse)||0),0)}),e.jsx("div",{className:"stat-label",children:"Kurse gesamt"})]})]})]}),e.jsx("div",{className:"standorte-grid",children:v.sort((e,s)=>e.ist_hauptstandort&&!s.ist_hauptstandort?-1:!e.ist_hauptstandort&&s.ist_hauptstandort?1:(e.sortierung||0)-(s.sortierung||0)).map(s=>e.jsxs("div",{className:`standort-card ${s.ist_aktiv?"":"inactive"} ${F===s.standort_id?"expanded":""}`,children:[e.jsxs("div",{className:"standort-card-header",children:[e.jsxs("div",{className:"header-left-section",children:[e.jsx("div",{className:"color-indicator",style:{background:s.farbe||"#4F46E5"}}),e.jsxs("div",{className:"standort-info",children:[e.jsx("h3",{children:s.name}),e.jsxs("div",{className:"badges",children:[s.ist_hauptstandort&&e.jsx("span",{className:"badge badge-haupt",children:"Hauptstandort"}),!s.ist_aktiv&&e.jsx("span",{className:"badge badge-inactive",children:"Inaktiv"})]})]})]}),e.jsxs("div",{className:"header-actions",children:[e.jsx("button",{className:"btn-icon",onClick:()=>{return e=s.standort_id,void $(F===e?null:e);var e},title:F===s.standort_id?"Weniger anzeigen":"Mehr anzeigen",children:F===s.standort_id?e.jsx(o,{size:18}):e.jsx(c,{size:18})}),e.jsx("button",{className:"btn-icon btn-edit",onClick:()=>A(s),title:"Bearbeiten",children:e.jsx(h,{size:18})}),e.jsx("button",{className:"btn-icon btn-delete",onClick:()=>(async e=>{var s,a;if(window.confirm("MÃ¶chten Sie diesen Standort wirklich lÃ¶schen?")){z(!0);try{await t.delete(`/standorte/${e}`),alert("Standort erfolgreich gelÃ¶scht!"),await p(),await M()}catch(n){console.error("Fehler beim LÃ¶schen:",n),alert((null==(a=null==(s=n.response)?void 0:s.data)?void 0:a.error)||"Fehler beim LÃ¶schen des Standorts")}finally{z(!1)}}})(s.standort_id),title:"LÃ¶schen",children:e.jsx(u,{size:18})})]})]}),e.jsxs("div",{className:"standort-card-body",children:[(s.strasse||s.ort)&&e.jsxs("div",{className:"info-row",children:[e.jsx(r,{size:16,className:"icon"}),e.jsxs("span",{children:[s.strasse," ",s.hausnummer,", ",s.plz," ",s.ort]})]}),s.telefon&&e.jsxs("div",{className:"info-row",children:[e.jsx(m,{size:16,className:"icon"}),e.jsx("span",{children:s.telefon})]}),s.email&&e.jsxs("div",{className:"info-row",children:[e.jsx(x,{size:16,className:"icon"}),e.jsx("span",{children:s.email})]}),e.jsxs("div",{className:"info-row",children:[e.jsx(j,{size:16,className:"icon"}),e.jsx("span",{children:W(s.oeffnungszeiten)})]}),D[s.standort_id]&&e.jsxs("div",{className:"standort-stats",children:[e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-number",children:D[s.standort_id].anzahl_kurse||0}),e.jsx("span",{className:"stat-text",children:"Kurse"})]}),e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-number",children:D[s.standort_id].anzahl_raeume||0}),e.jsx("span",{className:"stat-text",children:"RÃ¤ume"})]}),e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-number",children:D[s.standort_id].anzahl_trainer||0}),e.jsx("span",{className:"stat-text",children:"Trainer"})]})]}),F===s.standort_id&&e.jsxs("div",{className:"expanded-details",children:[s.oeffnungszeiten&&e.jsxs("div",{className:"detail-section",children:[e.jsx("h4",{children:"Ã–ffnungszeiten"}),e.jsx("div",{className:"oeffnungszeiten-list",children:Object.entries(("string"==typeof s.oeffnungszeiten?JSON.parse(s.oeffnungszeiten):s.oeffnungszeiten).regular||{}).map(([s,a])=>e.jsxs("div",{className:"oeffnungszeit-row",children:[e.jsx("span",{className:"day-name",children:L[s]}),e.jsx("span",{className:"time-range",children:a.closed?"Geschlossen":`${a.open} - ${a.close}`})]},s))})]}),s.notizen&&e.jsxs("div",{className:"detail-section",children:[e.jsx("h4",{children:"Notizen"}),e.jsx("p",{children:s.notizen})]}),e.jsx("div",{className:"detail-section",children:e.jsx("button",{className:"btn-toggle "+(s.ist_aktiv?"active":"inactive"),onClick:()=>(async e=>{try{await t.put(`/standorte/${e.standort_id}`,{...e,ist_aktiv:!e.ist_aktiv,oeffnungszeiten:"string"==typeof e.oeffnungszeiten?e.oeffnungszeiten:JSON.stringify(e.oeffnungszeiten||K.oeffnungszeiten)}),await p(),await M()}catch(s){console.error("Fehler beim Aktivieren/Deaktivieren:",s),alert("Fehler beim Ã„ndern des Status")}})(s),children:s.ist_aktiv?"Standort deaktivieren":"Standort aktivieren"})})]})]})]},s.standort_id))}),0===v.length&&e.jsxs("div",{className:"empty-state",children:[e.jsx(l,{size:64,className:"empty-icon"}),e.jsx("h3",{children:"Keine Standorte vorhanden"}),e.jsx("p",{children:"Erstellen Sie Ihren ersten Standort, um zu beginnen."}),e.jsxs("button",{className:"btn-primary",onClick:()=>A(),children:[e.jsx(i,{size:18}),e.jsx("span",{children:"Ersten Standort erstellen"})]})]}),S&&e.jsx("div",{className:"modal-overlay",onClick:J,children:e.jsxs("div",{className:"modal-content-large",onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:w?"Standort bearbeiten":"Neuer Standort"}),e.jsx("button",{className:"btn-close",onClick:J,children:e.jsx(g,{size:20})})]}),e.jsxs("div",{className:"modal-tabs",children:[e.jsx("button",{className:"modal-tab "+("basis"===O?"active":""),onClick:()=>B("basis"),children:"Basis"}),e.jsx("button",{className:"modal-tab "+("adresse"===O?"active":""),onClick:()=>B("adresse"),children:"Adresse"}),e.jsx("button",{className:"modal-tab "+("kontakt"===O?"active":""),onClick:()=>B("kontakt"),children:"Kontakt"}),e.jsx("button",{className:"modal-tab "+("oeffnungszeiten"===O?"active":""),onClick:()=>B("oeffnungszeiten"),children:"Ã–ffnungszeiten"}),e.jsx("button",{className:"modal-tab "+("notizen"===O?"active":""),onClick:()=>B("notizen"),children:"Notizen"})]}),e.jsxs("div",{className:"modal-body",children:[y&&e.jsx("div",{className:"error-message",children:y}),"basis"===O&&e.jsxs("div",{className:"form-section",children:[e.jsx("h4",{children:"Basis-Informationen"}),e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group full-width",children:[e.jsx("label",{children:"Name *"}),e.jsx("input",{type:"text",value:K.name,onChange:e=>I({...K,name:e.target.value}),placeholder:"z.B. Hauptstandort, Filiale Nord"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Farbe"}),e.jsxs("div",{className:"color-picker-wrapper",children:[e.jsx("input",{type:"color",value:K.farbe,onChange:e=>I({...K,farbe:e.target.value})}),e.jsx("span",{className:"color-value",children:K.farbe})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Sortierung"}),e.jsx("input",{type:"number",value:K.sortierung,onChange:e=>I({...K,sortierung:parseInt(e.target.value)||0})})]}),e.jsx("div",{className:"form-group checkbox-group full-width",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:K.ist_hauptstandort,onChange:e=>I({...K,ist_hauptstandort:e.target.checked})}),e.jsx("span",{children:"Dies ist der Hauptstandort"})]})})]})]}),"adresse"===O&&e.jsxs("div",{className:"form-section",children:[e.jsx("h4",{children:"Adresse"}),e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"StraÃŸe"}),e.jsx("input",{type:"text",value:K.strasse,onChange:e=>I({...K,strasse:e.target.value})})]}),e.jsxs("div",{className:"form-group",style:{maxWidth:"150px"},children:[e.jsx("label",{children:"Hausnummer"}),e.jsx("input",{type:"text",value:K.hausnummer,onChange:e=>I({...K,hausnummer:e.target.value})})]}),e.jsxs("div",{className:"form-group",style:{maxWidth:"150px"},children:[e.jsx("label",{children:"PLZ"}),e.jsx("input",{type:"text",value:K.plz,onChange:e=>I({...K,plz:e.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Ort"}),e.jsx("input",{type:"text",value:K.ort,onChange:e=>I({...K,ort:e.target.value})})]}),e.jsxs("div",{className:"form-group full-width",children:[e.jsx("label",{children:"Land"}),e.jsx("input",{type:"text",value:K.land,onChange:e=>I({...K,land:e.target.value})})]})]})]}),"kontakt"===O&&e.jsxs("div",{className:"form-section",children:[e.jsx("h4",{children:"Kontakt"}),e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Telefon"}),e.jsx("input",{type:"tel",value:K.telefon,onChange:e=>I({...K,telefon:e.target.value}),placeholder:"+49 123 456789"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"E-Mail"}),e.jsx("input",{type:"email",value:K.email,onChange:e=>I({...K,email:e.target.value}),placeholder:"standort@dojo.de"})]})]})]}),"oeffnungszeiten"===O&&e.jsxs("div",{className:"form-section",children:[e.jsx("h4",{children:"Ã–ffnungszeiten"}),e.jsx("div",{className:"oeffnungszeiten-editor",children:Object.entries(L).map(([s,a])=>{var n,t,i,l,r;return e.jsxs("div",{className:"oeffnungszeit-row-editor",children:[e.jsx("div",{className:"day-label",children:a}),e.jsxs("div",{className:"time-inputs",children:[e.jsx("input",{type:"time",value:(null==(n=K.oeffnungszeiten.regular[s])?void 0:n.open)||"09:00",onChange:e=>H(s,"open",e.target.value),disabled:null==(t=K.oeffnungszeiten.regular[s])?void 0:t.closed}),e.jsx("span",{children:"bis"}),e.jsx("input",{type:"time",value:(null==(i=K.oeffnungszeiten.regular[s])?void 0:i.close)||"21:00",onChange:e=>H(s,"close",e.target.value),disabled:null==(l=K.oeffnungszeiten.regular[s])?void 0:l.closed})]}),e.jsxs("label",{className:"checkbox-inline",children:[e.jsx("input",{type:"checkbox",checked:(null==(r=K.oeffnungszeiten.regular[s])?void 0:r.closed)||!1,onChange:e=>H(s,"closed",e.target.checked)}),e.jsx("span",{children:"Geschlossen"})]})]},s)})})]}),"notizen"===O&&e.jsxs("div",{className:"form-section",children:[e.jsx("h4",{children:"Notizen"}),e.jsx("div",{className:"form-group full-width",children:e.jsx("textarea",{value:K.notizen,onChange:e=>I({...K,notizen:e.target.value}),rows:4,placeholder:"ZusÃ¤tzliche Informationen zum Standort..."})})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn-secondary",onClick:J,children:"Abbrechen"}),e.jsxs("button",{className:"btn-primary",onClick:async()=>{var e,s;if(K.name.trim()){z(!0),k("");try{const e={...K,oeffnungszeiten:JSON.stringify(K.oeffnungszeiten)};w?(await t.put(`/standorte/${w.standort_id}`,e),alert("Standort erfolgreich aktualisiert!")):(await t.post("/standorte",e),alert("Standort erfolgreich erstellt!")),await p(),await M(),J()}catch(a){console.error("Fehler beim Speichern:",a),k((null==(s=null==(e=a.response)?void 0:e.data)?void 0:s.error)||"Fehler beim Speichern des Standorts")}finally{z(!1)}}else k("Bitte geben Sie einen Namen ein.")},disabled:b,children:[e.jsx(f,{size:18}),e.jsx("span",{children:b?"Speichern...":"Speichern"})]})]})]})})]})};export{v as default};
