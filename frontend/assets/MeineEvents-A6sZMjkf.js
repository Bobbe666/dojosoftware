import{j as e}from"./animation-1wuIdCBS.js";import{r as s}from"./vendor-router-BhMXg4Z-.js";import{u as n,a,g as i}from"./index-BJCk5MxH.js";import{j as r}from"./index-CkXcCt97.js";/* empty css               */import"./vendor-react-DtuzQOD1.js";import"./query-Bs1dTGah.js";import"./icons-C6KFH58b.js";const l=()=>{const{token:l}=n(),[d,t]=s.useState([]),[c,o]=s.useState([]),[m,h]=s.useState(!1),[x,v]=s.useState(""),[g,j]=s.useState(""),[u,b]=s.useState(null),[p,N]=s.useState(!1),[f,y]=s.useState(null),[_,w]=s.useState(!1),[z,k]=s.useState("");s.useEffect(()=>{if(l)try{const e=r(l);e.mitglied_id&&b(e.mitglied_id)}catch(e){console.error("Fehler beim Dekodieren des Tokens:",e)}},[l]);const A=s.useCallback(async()=>{if(l){h(!0),v("");try{const e=await a.get(`${i.apiBaseUrl}/events?upcoming=true&status=anmeldung_offen`,{headers:{Authorization:`Bearer ${l}`}});t(e.data)}catch(e){console.error("Fehler beim Laden der Events:",e),v("Fehler beim Laden der Events: "+e.message)}finally{h(!1)}}},[l]),B=s.useCallback(async()=>{if(l&&u)try{const e=await a.get(`${i.apiBaseUrl}/events/mitglied/${u}`,{headers:{Authorization:`Bearer ${l}`}});o(e.data)}catch(e){console.error("Fehler beim Laden meiner Events:",e)}},[l,u]);s.useEffect(()=>{l&&u&&(A(),B())},[l,u,A,B]);const C=e=>{y(e),N(!0)},$=e=>e?new Date(e).toLocaleDateString("de-DE",{weekday:"long",day:"2-digit",month:"long",year:"numeric"}):"",E=e=>e?e.substring(0,5):"",F=e=>({Turnier:"badge-danger",Lehrgang:"badge-info","PrÃ¼fung":"badge-warning",Seminar:"badge-success",Workshop:"badge-primary",Feier:"badge-special",Sonstiges:"badge-secondary"}[e]||"badge-secondary"),S=e=>({angemeldet:"Angemeldet",bestaetigt:"BestÃ¤tigt",abgesagt:"Abgesagt",teilgenommen:"Teilgenommen",nicht_erschienen:"Nicht erschienen"}[e]||e);return e.jsxs("div",{className:"events-container",children:[e.jsxs("div",{className:"page-header",children:[e.jsx("h1",{className:"page-title",children:"Meine Events"}),e.jsx("p",{className:"page-subtitle",children:"Veranstaltungen und Anmeldungen"})]}),e.jsxs("div",{className:"events-content",children:[x&&e.jsxs("div",{className:"error-message",style:{marginBottom:"1rem"},children:["âš ï¸ ",x]}),g&&e.jsxs("div",{className:"success-message",style:{marginBottom:"1rem",background:"rgba(25, 135, 84, 0.1)",border:"1px solid rgba(25, 135, 84, 0.3)",borderRadius:"8px",padding:"1rem",color:"#75d175",display:"flex",alignItems:"center",gap:"0.5rem"},children:["âœ… ",g]}),e.jsxs("div",{className:"glass-card",style:{marginBottom:"2rem"},children:[e.jsx("div",{className:"card-header",children:e.jsx("h2",{children:"Meine Anmeldungen"})}),e.jsx("div",{className:"card-body",children:0===c.length?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"ğŸ“…"}),e.jsx("h3",{children:"Keine Anmeldungen"}),e.jsx("p",{children:"Sie sind momentan fÃ¼r keine Events angemeldet."})]}):e.jsx("div",{className:"events-list",children:c.map(s=>{return e.jsxs("div",{className:"event-card",children:[e.jsx("div",{className:"event-card-header",children:e.jsxs("div",{className:"event-title-section",children:[e.jsx("h3",{children:s.titel}),e.jsxs("div",{className:"event-badges",children:[e.jsx("span",{className:`badge ${F(s.event_typ)}`,children:s.event_typ}),e.jsx("span",{className:`badge ${n=s.anmeldung_status,{angemeldet:"badge-success",bestaetigt:"badge-info",abgesagt:"badge-danger",teilgenommen:"badge-success",nicht_erschienen:"badge-dark"}[n]||"badge-secondary"}`,children:S(s.anmeldung_status)}),s.bezahlt&&e.jsx("span",{className:"badge badge-success",children:"âœ… Bezahlt"})]})]})}),e.jsxs("div",{className:"event-card-body",children:[e.jsxs("div",{className:"event-info-row",children:[e.jsx("span",{className:"event-icon",children:"ğŸ“…"}),e.jsx("span",{children:$(s.datum)})]}),s.uhrzeit_beginn&&e.jsxs("div",{className:"event-info-row",children:[e.jsx("span",{className:"event-icon",children:"ğŸ•"}),e.jsxs("span",{children:[E(s.uhrzeit_beginn),s.uhrzeit_ende&&` - ${E(s.uhrzeit_ende)}`]})]}),s.ort&&e.jsxs("div",{className:"event-info-row",children:[e.jsx("span",{className:"event-icon",children:"ğŸ“"}),e.jsx("span",{children:s.ort})]}),s.raum_name&&e.jsxs("div",{className:"event-info-row",children:[e.jsx("span",{className:"event-icon",children:"ğŸšª"}),e.jsxs("span",{children:["Raum: ",s.raum_name]})]}),s.teilnahmegebuehr>0&&e.jsxs("div",{className:"event-info-row",children:[e.jsx("span",{className:"event-icon",children:"ğŸ’°"}),e.jsxs("span",{children:[parseFloat(s.teilnahmegebuehr).toFixed(2)," â‚¬"]})]}),e.jsxs("div",{className:"event-info-row",children:[e.jsx("span",{className:"event-icon",children:"ğŸ“"}),e.jsxs("span",{children:["Angemeldet am: ",$(s.anmeldedatum)]})]})]}),e.jsxs("div",{className:"event-card-footer",style:{justifyContent:"space-between"},children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>C(s),children:"Details anzeigen"}),["angemeldet","bestaetigt"].includes(s.anmeldung_status)&&e.jsx("button",{className:"btn btn-secondary",onClick:()=>(async e=>{var s,n;if(window.confirm("MÃ¶chten Sie sich wirklich von diesem Event abmelden?")){v(""),j("");try{await a.post(`${i.apiBaseUrl}/events/${e}/abmelden`,{mitglied_id:u},{headers:{Authorization:`Bearer ${l}`}}),j("Sie wurden erfolgreich abgemeldet!"),A(),B(),setTimeout(()=>j(""),5e3)}catch(r){console.error("Fehler bei der Abmeldung:",r),v((null==(n=null==(s=r.response)?void 0:s.data)?void 0:n.error)||"Fehler bei der Abmeldung")}}})(s.event_id),style:{background:"rgba(220, 53, 69, 0.2)",borderColor:"rgba(220, 53, 69, 0.3)",color:"#ea868f"},children:"Abmelden"})]})]},s.event_id);var n})})})]}),e.jsxs("div",{className:"glass-card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h2",{children:"VerfÃ¼gbare Events"})}),e.jsx("div",{className:"card-body",children:m?e.jsx("div",{className:"loading-state",children:e.jsx("p",{children:"Lade Events..."})}):0===d.length?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"ğŸ“…"}),e.jsx("h3",{children:"Keine Events verfÃ¼gbar"}),e.jsx("p",{children:"Momentan sind keine Events zur Anmeldung verfÃ¼gbar."})]}):e.jsx("div",{className:"events-list",children:d.map(s=>{const n=(a=s.event_id,c.some(e=>e.event_id===a&&["angemeldet","bestaetigt"].includes(e.anmeldung_status)));var a;const i=!!(r=s.anmeldefrist)&&new Date(r)<new Date;var r;const l=s.ist_ausgebucht;return e.jsxs("div",{className:"event-card",children:[e.jsx("div",{className:"event-card-header",children:e.jsxs("div",{className:"event-title-section",children:[e.jsx("h3",{children:s.titel}),e.jsxs("div",{className:"event-badges",children:[e.jsx("span",{className:`badge ${F(s.event_typ)}`,children:s.event_typ}),l&&e.jsx("span",{className:"badge badge-danger",children:"Ausgebucht"}),n&&e.jsx("span",{className:"badge badge-success",children:"âœ“ Angemeldet"})]})]})}),e.jsxs("div",{className:"event-card-body",children:[e.jsxs("div",{className:"event-info-row",children:[e.jsx("span",{className:"event-icon",children:"ğŸ“…"}),e.jsx("span",{children:$(s.datum)})]}),s.uhrzeit_beginn&&e.jsxs("div",{className:"event-info-row",children:[e.jsx("span",{className:"event-icon",children:"ğŸ•"}),e.jsxs("span",{children:[E(s.uhrzeit_beginn),s.uhrzeit_ende&&` - ${E(s.uhrzeit_ende)}`]})]}),s.ort&&e.jsxs("div",{className:"event-info-row",children:[e.jsx("span",{className:"event-icon",children:"ğŸ“"}),e.jsx("span",{children:s.ort})]}),s.max_teilnehmer&&e.jsxs("div",{className:"event-info-row",children:[e.jsx("span",{className:"event-icon",children:"ğŸ‘¥"}),e.jsxs("span",{children:[s.anzahl_anmeldungen||0," / ",s.max_teilnehmer," Teilnehmer",null!==s.verfuegbare_plaetze&&e.jsxs("span",{className:0===s.verfuegbare_plaetze?"text-danger":"text-success",children:[" ","(",s.verfuegbare_plaetze," PlÃ¤tze frei)"]})]})]}),s.teilnahmegebuehr>0&&e.jsxs("div",{className:"event-info-row",children:[e.jsx("span",{className:"event-icon",children:"ğŸ’°"}),e.jsxs("span",{children:[parseFloat(s.teilnahmegebuehr).toFixed(2)," â‚¬"]})]}),s.anmeldefrist&&e.jsxs("div",{className:"event-info-row",children:[e.jsx("span",{className:"event-icon",children:"â°"}),e.jsxs("span",{className:i?"text-danger":"",children:["Anmeldefrist: ",$(s.anmeldefrist),i&&" (abgelaufen)"]})]}),s.beschreibung&&e.jsx("div",{className:"event-description",children:e.jsx("p",{children:s.beschreibung})})]}),e.jsxs("div",{className:"event-card-footer",style:{justifyContent:"space-between"},children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>C(s),children:"Details anzeigen"}),!n&&!l&&!i&&e.jsx("button",{className:"btn btn-primary",onClick:()=>(e=>{y(e),k(""),w(!0)})(s),children:"Jetzt anmelden"})]})]},s.event_id)})})})]})]}),_&&f&&e.jsx("div",{className:"modal-overlay",onClick:()=>w(!1),children:e.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:"Event-Anmeldung"}),e.jsx("button",{className:"modal-close",onClick:()=>w(!1),children:"âœ•"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsx("h3",{style:{color:"var(--farbe-hauptfarbe)",marginBottom:"1rem"},children:f.titel}),e.jsxs("div",{className:"event-info-row",children:[e.jsx("span",{className:"event-icon",children:"ğŸ“…"}),e.jsx("span",{children:$(f.datum)})]}),f.uhrzeit_beginn&&e.jsxs("div",{className:"event-info-row",children:[e.jsx("span",{className:"event-icon",children:"ğŸ•"}),e.jsxs("span",{children:[E(f.uhrzeit_beginn),f.uhrzeit_ende&&` - ${E(f.uhrzeit_ende)}`]})]}),f.teilnahmegebuehr>0&&e.jsxs("div",{className:"event-info-row",children:[e.jsx("span",{className:"event-icon",children:"ğŸ’°"}),e.jsxs("span",{children:[parseFloat(f.teilnahmegebuehr).toFixed(2)," â‚¬"]})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Bemerkung (optional)"}),e.jsx("textarea",{value:z,onChange:e=>k(e.target.value),rows:"3",placeholder:"z.B. Besondere Anforderungen, ErnÃ¤hrungshinweise, etc.",style:{background:"rgba(0, 0, 0, 0.3)",border:"1px solid rgba(255, 215, 0, 0.2)",borderRadius:"8px",padding:"0.75rem",color:"var(--farbe-text)",width:"100%",resize:"vertical",fontFamily:"inherit"}})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>w(!1),children:"Abbrechen"}),e.jsx("button",{className:"btn btn-primary",onClick:async()=>{var e,s;if(u&&f){v(""),j("");try{await a.post(`${i.apiBaseUrl}/events/${f.event_id}/anmelden`,{mitglied_id:u,bemerkung:z},{headers:{Authorization:`Bearer ${l}`}}),j("Sie wurden erfolgreich fÃ¼r das Event angemeldet!"),w(!1),k(""),A(),B(),setTimeout(()=>j(""),5e3)}catch(n){console.error("Fehler bei der Anmeldung:",n),v((null==(s=null==(e=n.response)?void 0:e.data)?void 0:s.error)||"Fehler bei der Anmeldung")}}},children:"Verbindlich anmelden"})]})]})}),p&&f&&e.jsx("div",{className:"modal-overlay",onClick:()=>N(!1),children:e.jsxs("div",{className:"modal-content modal-large",onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:f.titel}),e.jsx("button",{className:"modal-close",onClick:()=>N(!1),children:"âœ•"})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"details-section",children:[e.jsx("h3",{children:"Event-Informationen"}),e.jsxs("div",{className:"details-info",children:[e.jsxs("div",{className:"info-row",children:[e.jsx("span",{className:"info-label",children:"Typ:"}),e.jsx("span",{className:`badge ${F(f.event_typ)}`,children:f.event_typ})]}),e.jsxs("div",{className:"info-row",children:[e.jsx("span",{className:"info-label",children:"Datum:"}),e.jsx("span",{children:$(f.datum)})]}),f.uhrzeit_beginn&&e.jsxs("div",{className:"info-row",children:[e.jsx("span",{className:"info-label",children:"Uhrzeit:"}),e.jsxs("span",{children:[E(f.uhrzeit_beginn),f.uhrzeit_ende&&` - ${E(f.uhrzeit_ende)}`]})]}),f.ort&&e.jsxs("div",{className:"info-row",children:[e.jsx("span",{className:"info-label",children:"Ort:"}),e.jsx("span",{children:f.ort})]}),f.raum_name&&e.jsxs("div",{className:"info-row",children:[e.jsx("span",{className:"info-label",children:"Raum:"}),e.jsx("span",{children:f.raum_name})]}),f.max_teilnehmer&&e.jsxs("div",{className:"info-row",children:[e.jsx("span",{className:"info-label",children:"Teilnehmer:"}),e.jsxs("span",{children:[f.anzahl_anmeldungen||0," / ",f.max_teilnehmer,null!==f.verfuegbare_plaetze&&e.jsxs("span",{className:0===f.verfuegbare_plaetze?"text-danger":"text-success",children:[" ","(",f.verfuegbare_plaetze," PlÃ¤tze frei)"]})]})]}),f.teilnahmegebuehr>0&&e.jsxs("div",{className:"info-row",children:[e.jsx("span",{className:"info-label",children:"GebÃ¼hr:"}),e.jsxs("span",{children:[parseFloat(f.teilnahmegebuehr).toFixed(2)," â‚¬"]})]}),f.anmeldefrist&&e.jsxs("div",{className:"info-row",children:[e.jsx("span",{className:"info-label",children:"Anmeldefrist:"}),e.jsx("span",{children:$(f.anmeldefrist)})]})]}),f.beschreibung&&e.jsxs("div",{className:"details-description",children:[e.jsx("h4",{children:"Beschreibung"}),e.jsx("p",{children:f.beschreibung})]}),f.anforderungen&&e.jsxs("div",{className:"details-description",children:[e.jsx("h4",{children:"Anforderungen / Voraussetzungen"}),e.jsx("p",{children:f.anforderungen})]})]})}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{className:"btn btn-secondary",onClick:()=>N(!1),children:"SchlieÃŸen"})})]})})]})};export{l as default};
