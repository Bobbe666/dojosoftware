import{j as e}from"./animation-1wuIdCBS.js";import{g as i,u as r,r as a}from"./vendor-router-BhMXg4Z-.js";import{b as n,k as t,g as s}from"./index-BJCk5MxH.js";/* empty css                     */import{O as d,w as l,k as g,o,M as c,v as h,F as m}from"./icons-C6KFH58b.js";import"./vendor-react-DtuzQOD1.js";import"./query-Bs1dTGah.js";const b=()=>{const{filterType:b}=i(),u=r(),{getDojoFilterParam:p,activeDojo:x}=n(),[f,j]=a.useState(!0),[v,y]=a.useState([]),[w,k]=a.useState("all");a.useEffect(()=>{M()},[b,x,w]);const M=async()=>{try{j(!0);const e=p(),i=e?"&":"";let r="";switch(b){case"ohne-sepa":r=`/mitglieder/filter/ohne-sepa?${e}`;break;case"ohne-vertrag":r=`/mitglieder/filter/ohne-vertrag?${e}`;break;case"tarif-abweichung":r=`/mitglieder/filter/tarif-abweichung?${e}`;break;case"zahlungsweisen":r=`/mitglieder/filter/zahlungsweisen?payment_method=${w}${i}${e}`;break;default:r=`/mitglieder?${e}`}const a=await t(`${s.apiBaseUrl}${r}`);if(!a.ok)throw new Error("Fehler beim Laden der Mitglieder");const n=await a.json();y(n.data||n.mitglieder||[]),j(!1)}catch(e){console.error("Fehler beim Laden der Mitglieder:",e),y([]),j(!1)}};return e.jsxs("div",{style:{padding:"2rem",minHeight:"100vh"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem",flexWrap:"wrap",gap:"1rem"},children:[e.jsxs("button",{className:"btn btn-secondary",onClick:()=>u("/dashboard/finanzcockpit"),children:[e.jsx(d,{size:20}),"Zur√ºck zum Finanzcockpit"]}),e.jsxs("div",{children:[e.jsx("h1",{children:(()=>{switch(b){case"ohne-sepa":return"üö´ Mitglieder ohne SEPA-Mandat";case"ohne-vertrag":return"üìÑ Mitglieder ohne Vertrag";case"tarif-abweichung":return"‚ö†Ô∏è Mitglieder mit Tarif-Abweichungen";case"zahlungsweisen":return"üí≥ Mitglieder nach Zahlungsweise";default:return"üë• Mitglieder"}})()}),e.jsx("p",{children:(()=>{switch(b){case"ohne-sepa":return"Diese Mitglieder haben Lastschrift als Zahlungsmethode, aber kein aktives SEPA-Mandat hinterlegt.";case"ohne-vertrag":return"Diese Mitglieder haben aktuell keinen aktiven Vertrag.";case"tarif-abweichung":return"Diese Mitglieder zahlen einen abweichenden Beitrag vom Standard-Tarif.";case"zahlungsweisen":return"Mitglieder gefiltert nach ihrer Zahlungsmethode.";default:return""}})()})]}),e.jsx("div",{style:{display:"flex",gap:"0.5rem"},children:e.jsxs("button",{className:"btn btn-primary",onClick:()=>{const e=[["ID","Vorname","Nachname","Email","Zahlungsmethode","Monatsbeitrag","Status"],...v.map(e=>[e.mitglied_id,e.vorname,e.nachname,e.email,e.zahlungsmethode||"-",e.monatsbeitrag||"-",e.aktiv?"Aktiv":"Inaktiv"])].map(e=>e.map(e=>`"${e}"`).join(";")).join("\n"),i=new Blob(["\ufeff"+e],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a");r.href=URL.createObjectURL(i),r.download=`mitglieder_${b}_${(new Date).toISOString().split("T")[0]}.csv`,r.click()},disabled:0===v.length,children:[e.jsx(l,{size:20}),"CSV Export"]})})]}),"zahlungsweisen"===b&&e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"12px",padding:"1.5rem",marginBottom:"2rem",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("h3",{style:{color:"#FFD700",marginBottom:"1rem"},children:"Zahlungsmethode w√§hlen"}),e.jsx("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:["all","Lastschrift","√úberweisung","Bar","Karte","PayPal"].map(i=>e.jsx("button",{className:"btn "+(w===i?"btn-primary":"btn-secondary"),onClick:()=>k(i),children:"all"===i?"üîç Alle":i},i))})]}),e.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"12px",padding:"1.5rem",marginBottom:"2rem",display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx(g,{size:32,color:"#3b82f6"}),e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0,color:"#3b82f6"},children:f?"Laden...":`${v.length} Mitglied${1!==v.length?"er":""} gefunden`}),e.jsxs("p",{style:{margin:"0.5rem 0 0 0",color:"rgba(255, 255, 255, 0.7)",fontSize:"0.9rem"},children:["ohne-sepa"===b&&"Bitte SEPA-Mandate f√ºr diese Mitglieder hinterlegen.","ohne-vertrag"===b&&"Diese Mitglieder ben√∂tigen m√∂glicherweise einen neuen Vertrag.","tarif-abweichung"===b&&"Pr√ºfen Sie die Beitr√§ge dieser Mitglieder.","zahlungsweisen"===b&&"√úbersicht √ºber Zahlungsmethoden der Mitglieder."]})]})]}),f?e.jsx("div",{style:{textAlign:"center",padding:"3rem"},children:e.jsx("p",{children:"Lade Mitglieder..."})}):0===v.length?e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"12px",padding:"3rem",textAlign:"center",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx(o,{size:48,color:"#9ca3af",style:{marginBottom:"1rem"}}),e.jsx("h3",{style:{color:"#9ca3af"},children:"Keine Mitglieder gefunden"}),e.jsxs("p",{style:{color:"rgba(255, 255, 255, 0.5)"},children:["ohne-sepa"===b&&"Alle Mitglieder mit Lastschrift haben ein SEPA-Mandat. ‚úÖ","ohne-vertrag"===b&&"Alle aktiven Mitglieder haben einen Vertrag. ‚úÖ","tarif-abweichung"===b&&"Keine Tarif-Abweichungen gefunden. ‚úÖ","zahlungsweisen"===b&&"Keine Mitglieder mit dieser Zahlungsmethode."]})]}):e.jsx("div",{className:"mitglieder-grid",children:v.map(i=>{return e.jsxs("div",{className:"mitglied-card",onClick:()=>u(`/dashboard/mitglieder/${i.mitglied_id}`),style:{cursor:"pointer"},children:[e.jsxs("div",{className:"mitglied-card__header",children:[e.jsxs("div",{children:[e.jsxs("h3",{children:[i.vorname," ",i.nachname]}),e.jsxs("p",{children:["ID: ",i.mitglied_id]})]}),e.jsx("span",{className:"mitglied-card__badge "+(i.aktiv?"badge-success":"badge-danger"),children:i.aktiv?"‚úÖ Aktiv":"‚ùå Inaktiv"})]}),e.jsxs("div",{className:"mitglied-card__body",children:[e.jsxs("div",{className:"mitglied-card__info",children:[e.jsx(c,{size:16}),e.jsx("span",{children:i.email||"Keine Email"})]}),i.zahlungsmethode&&e.jsxs("div",{className:"mitglied-card__info",children:[e.jsx(h,{size:16}),e.jsx("span",{children:i.zahlungsmethode})]}),i.monatsbeitrag&&e.jsx("div",{className:"mitglied-card__info",children:e.jsxs("span",{style:{fontWeight:"600",color:"#4caf50"},children:[(r=i.monatsbeitrag,new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(r||0)),"/Monat"]})}),"ohne-sepa"===b&&e.jsxs("div",{style:{marginTop:"0.75rem",padding:"0.5rem",background:"rgba(239, 68, 68, 0.1)",borderRadius:"6px",fontSize:"0.85rem",color:"#ef4444",border:"1px solid rgba(239, 68, 68, 0.3)"},children:[e.jsx(g,{size:14,style:{display:"inline",marginRight:"0.5rem"}}),"Kein SEPA-Mandat"]}),"ohne-vertrag"===b&&e.jsxs("div",{style:{marginTop:"0.75rem",padding:"0.5rem",background:"rgba(245, 158, 11, 0.1)",borderRadius:"6px",fontSize:"0.85rem",color:"#f59e0b",border:"1px solid rgba(245, 158, 11, 0.3)"},children:[e.jsx(m,{size:14,style:{display:"inline",marginRight:"0.5rem"}}),"Kein aktiver Vertrag"]}),"tarif-abweichung"===b&&i.abweichung_grund&&e.jsx("div",{style:{marginTop:"0.75rem",padding:"0.5rem",background:"rgba(139, 92, 246, 0.1)",borderRadius:"6px",fontSize:"0.85rem",color:"#8b5cf6",border:"1px solid rgba(139, 92, 246, 0.3)"},children:i.abweichung_grund})]})]},i.mitglied_id);var r})})]})};export{b as default};
