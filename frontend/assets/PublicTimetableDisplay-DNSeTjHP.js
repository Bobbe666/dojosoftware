import{j as e}from"./animation-1wuIdCBS.js";import{r as s}from"./vendor-router-BhMXg4Z-.js";import{a}from"./index-BJCk5MxH.js";import"./vendor-react-DtuzQOD1.js";import"./query-Bs1dTGah.js";import"./icons-C6KFH58b.js";const t=()=>{const[t,n]=s.useState([]),[i,r]=s.useState(new Date),[c,l]=s.useState(0),[d,o]=s.useState(!1),[m,h]=s.useState("");s.useEffect(()=>{const e=async()=>{try{o(!0);const e=(await a.get("/stundenplan")).data;n(Array.isArray(e)?e:e.stundenplan||[])}catch(e){console.error("âŒ Fehler beim Laden des Stundenplans:",e),n([])}finally{o(!1)}};e();const s=setInterval(e,3e4),t=setInterval(()=>{r(new Date)},1e3),i=setInterval(()=>{l(e=>(e+1)%3)},1e4);return()=>{clearInterval(s),clearInterval(t),clearInterval(i)}},[]),s.useEffect(()=>{const e=()=>{const e=g();if(e){const s=N(e);h(s)}else h("")};e();const s=setInterval(e,1e3);return()=>{clearInterval(s)}},[t,i]);const u=e=>e?e.substring(0,5):"",x=()=>i.toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),v=()=>["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"][i.getDay()],j=()=>{const e=v();return t.filter(s=>s.tag===e)},g=()=>{const e=v(),s=x().substring(0,5),a=j().find(e=>e.uhrzeit_start>s);if(a)return{...a,isNextDay:!1,tag:e};const n=["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],r=i.getDay();let c=(r+1)%7;for(let i=0;i<7;i++){const e=n[c],s=t.filter(s=>s.tag===e);if(s.length>0){const a=c===(r+1)%7;return{...s.sort((e,s)=>{const a=e.uhrzeit_start||"00:00",t=s.uhrzeit_start||"00:00";return a.localeCompare(t)})[0],isNextDay:a,tag:e}}c=(c+1)%7}return null},N=e=>{if(!e||!e.uhrzeit_start||!e.tag)return"";const s=new Date,a=s.getDay(),t=["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"].indexOf(e.tag);if(-1===t)return"";let n=t-a;if(n<0&&(n+=7),0===n){const[a,t]=e.uhrzeit_start.split(":"),i=new Date(s);i.setHours(parseInt(a,10),parseInt(t,10),0,0),i<s&&(n=7)}const i=new Date(s);i.setDate(i.getDate()+n);const[r,c]=e.uhrzeit_start.split(":");i.setHours(parseInt(r,10),parseInt(c,10),0,0);const l=i-s;if(l<=0)return"Bereits gestartet";const d=Math.floor(l/864e5),o=Math.floor(l%864e5/36e5),m=Math.floor(l%36e5/6e4);return d>0?`${d} Tag${d>1?"e":""}, ${o} Stunde${1!==o?"n":""}`:o>0?`${o} Stunde${1!==o?"n":""}, ${m} Minute${1!==m?"n":""}`:`${m} Minute${1!==m?"n":""}`},p=()=>{const s=j();return e.jsx("div",{className:"view-content today-view",children:0===s.length?e.jsxs("div",{className:"no-classes",children:[e.jsx("div",{className:"no-classes-icon",children:"ğŸ®"}),e.jsx("h3",{children:"Heute keine Kurse"}),e.jsx("p",{children:"GenieÃŸt euren freien Tag!"})]}):e.jsx("div",{className:"classes-grid",children:s.map((s,a)=>e.jsxs("div",{className:"class-card",style:{animationDelay:.1*a+"s"},children:[e.jsxs("div",{className:"class-time",children:[e.jsx("span",{className:"start-time",children:u(s.uhrzeit_start)}),e.jsx("span",{className:"time-separator",children:"-"}),e.jsx("span",{className:"end-time",children:u(s.uhrzeit_ende)})]}),e.jsxs("div",{className:"class-info",children:[e.jsx("div",{className:"class-name",children:s.kursname}),e.jsxs("div",{className:"class-style",children:["ğŸ¥‹ ",s.stil]}),e.jsxs("div",{className:"class-trainer",children:["ğŸ‘¨â€ğŸ« ",s.trainer_vorname," ",s.trainer_nachname]})]}),e.jsx("div",{className:"class-status",children:e.jsx("div",{className:"status-indicator"})})]},`${s.id}-${a}`))})})},y=()=>{const s=["Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag","Sonntag"].map(e=>({day:e,classes:t.filter(s=>s.tag===e)}));return e.jsx("div",{className:"view-content weekly-view",children:e.jsx("div",{className:"weekly-grid",children:s.map((s,a)=>e.jsxs("div",{className:"day-column "+(s.day===v()?"current-day":""),style:{animationDelay:.1*a+"s"},children:[e.jsxs("div",{className:"day-header",children:[e.jsx("div",{className:"day-name",children:s.day}),e.jsxs("div",{className:"day-count",children:[s.classes.length," Kurse"]})]}),e.jsx("div",{className:"day-classes",children:0===s.classes.length?e.jsx("div",{className:"no-day-classes",children:"Kein Kurs"}):s.classes.map((s,a)=>e.jsxs("div",{className:"mini-class-card",children:[e.jsxs("div",{className:"mini-time",children:[u(s.uhrzeit_start)," - ",u(s.uhrzeit_ende)]}),e.jsx("div",{className:"mini-name",children:s.kursname}),e.jsx("div",{className:"mini-style",children:s.stil})]},`${s.id}-${a}`))})]},s.day))})})};return e.jsxs("div",{className:"public-timetable-display",children:[e.jsxs("div",{className:"view-indicator",children:[e.jsx("div",{className:"left-info",children:e.jsx("span",{className:"info-text",children:"ğŸ”„ Wechsel alle 10s â€¢ ğŸ“¡ Live Updates"})}),e.jsxs("div",{className:"view-center",children:[e.jsxs("div",{className:"view-info",children:[e.jsx("span",{className:"current-view-name",children:["Heute","NÃ¤chste Stunde","WochenÃ¼bersicht"][c]}),e.jsxs("span",{className:"view-progress",children:["(",c+1,"/3)"]})]}),e.jsx("div",{className:"view-dots",children:[0,1,2].map(s=>e.jsx("div",{className:"view-dot "+(s===c?"active":"")},s))})]}),e.jsxs("div",{className:"current-time",children:[e.jsx("div",{className:"time",children:x()}),e.jsx("div",{className:"date",children:i.toLocaleDateString("de-DE",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]})]}),d&&e.jsxs("div",{className:"loading-indicator",children:[e.jsx("div",{className:"spinner"}),e.jsx("span",{children:"Aktualisiere..."})]}),e.jsx("div",{className:"main-content",children:(()=>{switch(c){case 0:default:return p();case 1:return(()=>{const s=g();return e.jsx("div",{className:"view-content next-class-view",children:s?e.jsxs("div",{className:"next-class-card",children:[e.jsx("div",{className:"next-class-header",children:e.jsx("div",{className:"next-class-day",children:s.isNextDay?`Morgen - ${s.tag}`:s.tag===v()?`Heute - ${s.tag}`:s.tag})}),e.jsxs("div",{className:"next-class-time",children:[e.jsx("span",{className:"big-time",children:u(s.uhrzeit_start)}),e.jsx("span",{className:"time-separator",children:"-"}),e.jsx("span",{className:"big-time",children:u(s.uhrzeit_ende)})]}),e.jsxs("div",{className:"next-class-details",children:[e.jsx("div",{className:"next-class-name",children:s.kursname}),e.jsxs("div",{className:"next-class-style",children:["ğŸ¥‹ ",s.stil]}),e.jsxs("div",{className:"next-class-trainer",children:["ğŸ‘¨â€ğŸ« ",s.trainer_vorname," ",s.trainer_nachname]})]}),e.jsxs("div",{className:"countdown-section",children:[e.jsx("div",{className:"countdown-label",children:"Beginnt in"}),e.jsxs("div",{className:"countdown-timer",children:["â±ï¸ ",m||"Berechnung lÃ¤uft..."]})]})]}):e.jsxs("div",{className:"no-classes",children:[e.jsx("div",{className:"no-classes-icon",children:"ğŸ“…"}),e.jsx("h3",{children:"Keine weiteren Kurse geplant"}),e.jsx("p",{children:"Schaut spÃ¤ter wieder vorbei!"})]})})})();case 2:return y()}})()})]})};export{t as default};
