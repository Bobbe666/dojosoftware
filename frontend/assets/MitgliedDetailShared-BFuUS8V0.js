import{j as e,A as t,m as r}from"./animation-1wuIdCBS.js";import{r as n,g as i,u as a,b as s}from"./vendor-router-BhMXg4Z-.js";import{a as l,b as d,u as o,V as c,g}from"./index-BJCk5MxH.js";import{u as h,b as u}from"./query-Bs1dTGah.js";import{p as m,n as x,A as p,a0 as b,P as f,K as j,X as y,k as v,w as k,a1 as S,N as z,v as w,g as _,F as N,C as D,q as C,t as F,a2 as B,d as T,a3 as A,a4 as E,a5 as M,Z as R,a6 as L,o as W,a7 as I,a8 as $,a9 as P,e as V}from"./icons-C6KFH58b.js";import{c as K}from"./sanitizer-DJNv4htu.js";import"./vendor-react-DtuzQOD1.js";const G=({variant:t="text",width:r,height:n,className:i="",count:a=1,style:s={}})=>{const l="skeleton",d=`skeleton-${t}`,o={...s,...r&&{width:r},...n&&{height:n}};return a>1?e.jsx("div",{className:"skeleton-group",children:Array.from({length:a}).map((t,r)=>e.jsx("div",{className:`${l} ${d} ${i}`,style:o},r))}):e.jsx("div",{className:`${l} ${d} ${i}`,style:o})},H=()=>e.jsxs("div",{className:"skeleton-profile",children:[e.jsxs("div",{className:"skeleton-profile-header",children:[e.jsx(G,{variant:"avatar",width:"120px",height:"120px"}),e.jsxs("div",{className:"skeleton-profile-info",children:[e.jsx(G,{variant:"title",width:"200px"}),e.jsx(G,{variant:"text",width:"150px"}),e.jsx(G,{variant:"text",width:"180px"})]})]}),e.jsxs("div",{className:"skeleton-profile-stats",children:[e.jsx(G,{variant:"card",width:"100px",height:"60px"}),e.jsx(G,{variant:"card",width:"100px",height:"60px"}),e.jsx(G,{variant:"card",width:"100px",height:"60px"})]}),e.jsx("div",{className:"skeleton-profile-content",children:e.jsx(G,{variant:"text",count:5})})]}),U=({mitgliedId:t,readOnly:r=!1})=>{const[i,a]=n.useState([]),[s,d]=n.useState([]),[o,c]=n.useState([]),[g,h]=n.useState([]),[u,v]=n.useState([]),[k,S]=n.useState(!0),[z,w]=n.useState("skills"),[_,N]=n.useState(!1),[D,C]=n.useState(null),[F,B]=n.useState(!1),[T,A]=n.useState([]),[E,M]=n.useState(null),R=n.useRef(null);n.useEffect(()=>{if(_&&R.current){const e=R.current;e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.zIndex="2147483647"}},[_]),n.useEffect(()=>{if(F){const e=document.querySelector("[data-history-modal]");e&&(e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.zIndex="2147483647")}},[F]);const[L,W]=n.useState({kategorie_id:"",skill_name:"",beschreibung:"",fortschritt_prozent:0,status:"nicht_gestartet",prioritaet:"mittel",schwierigkeit:"anfaenger"}),[I,$]=n.useState({titel:"",beschreibung:"",start_datum:(new Date).toISOString().split("T")[0],ziel_datum:"",prioritaet:"mittel"}),[P,V]=n.useState({titel:"",beschreibung:"",typ:"achievement",ziel_datum:""});n.useEffect(()=>{t&&K()},[t]);const K=async()=>{S(!0);try{const[e,r,n,i,s]=await Promise.all([l.get(`/fortschritt/mitglied/${t}`),l.get(`/fortschritt/mitglied/${t}/ziele`),l.get(`/fortschritt/mitglied/${t}/meilensteine`),l.get("/fortschritt/kategorien"),l.get(`/badges/mitglied/${t}`)]);a(e.data),d(r.data),c(n.data),v(i.data),h(s.data||[])}catch(e){console.error("âŒ Fehler beim Laden der Fortschritts-Daten:",e)}finally{S(!1)}},G=()=>{W({kategorie_id:"",skill_name:"",beschreibung:"",fortschritt_prozent:0,status:"nicht_gestartet",prioritaet:"mittel",schwierigkeit:"anfaenger"})},H=()=>{$({titel:"",beschreibung:"",start_datum:(new Date).toISOString().split("T")[0],ziel_datum:"",prioritaet:"mittel"})},U=()=>{V({titel:"",beschreibung:"",typ:"achievement",ziel_datum:""})},O=e=>({nicht_gestartet:"#6B7280",in_arbeit:"#3B82F6",gemeistert:"#10B981",auf_eis:"#F59E0B"}[e]||"#6B7280");return k?e.jsxs("div",{className:"fortschritt-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Lade Fortschritts-Daten..."})]}):e.jsxs("div",{className:"mitglied-fortschritt",children:[e.jsxs("div",{className:"fortschritt-header",children:[e.jsxs("div",{className:"fortschritt-tabs",children:[e.jsxs("button",{className:"tab-btn "+("skills"===z?"active":""),onClick:()=>w("skills"),children:[e.jsx(m,{size:18}),e.jsx("span",{children:"Skills & Techniken"}),e.jsx("span",{className:"tab-badge",children:i.length})]}),e.jsxs("button",{className:"tab-btn "+("ziele"===z?"active":""),onClick:()=>w("ziele"),children:[e.jsx(x,{size:18}),e.jsx("span",{children:"Ziele"}),e.jsx("span",{className:"tab-badge",children:s.filter(e=>"aktiv"===e.status).length})]}),e.jsxs("button",{className:"tab-btn "+("meilensteine"===z?"active":""),onClick:()=>w("meilensteine"),children:[e.jsx(p,{size:18}),e.jsx("span",{children:"Meilensteine"}),e.jsx("span",{className:"tab-badge",children:o.filter(e=>e.erreicht).length})]}),e.jsxs("button",{className:"tab-btn "+("badges"===z?"active":""),onClick:()=>w("badges"),children:[e.jsx(b,{size:18}),e.jsx("span",{children:"Auszeichnungen"}),e.jsx("span",{className:"tab-badge",children:g.length})]})]}),!r&&e.jsxs("button",{className:"add-btn",onClick:()=>N(!0),children:[e.jsx(f,{size:18}),e.jsx("span",{children:"HinzufÃ¼gen"})]})]}),e.jsxs("div",{className:"fortschritt-content",children:["skills"===z&&e.jsx("div",{className:"skills-grid",children:0===i.length?e.jsxs("div",{className:"empty-state",children:[e.jsx(m,{size:48}),e.jsx("p",{children:"Noch keine Skills erfasst"}),!r&&e.jsx("button",{className:"btn-primary",onClick:()=>N(!0),children:"Ersten Skill hinzufÃ¼gen"})]}):i.map(t=>{return e.jsxs("div",{className:"skill-card",children:[e.jsxs("div",{className:"skill-header",children:[e.jsx("div",{className:"skill-kategorie",style:{color:t.kategorie_farbe},children:t.kategorie_name}),!r&&e.jsx("div",{className:"skill-actions",children:e.jsx("button",{className:"icon-btn",onClick:()=>(async e=>{if(confirm("MÃ¶chten Sie diesen Fortschritt wirklich lÃ¶schen?"))try{await l.delete(`/fortschritt/${e}`),K()}catch(t){console.error("âŒ Fehler beim LÃ¶schen:",t)}})(t.fortschritt_id),children:e.jsx(j,{size:16})})})]}),e.jsx("h3",{className:"skill-name",children:t.skill_name}),t.beschreibung&&e.jsx("p",{className:"skill-desc",children:t.beschreibung}),e.jsxs("div",{className:"skill-progress",children:[e.jsx("div",{className:"progress-bar",children:e.jsx("div",{className:"progress-fill",style:{width:`${t.fortschritt_prozent}%`,backgroundColor:O(t.status)}})}),e.jsxs("span",{className:"progress-text",children:[t.fortschritt_prozent,"%"]})]}),e.jsxs("div",{className:"skill-footer",children:[e.jsxs("div",{className:"skill-badges",children:[e.jsx("span",{className:"badge badge-status",style:{backgroundColor:O(t.status)},children:t.status.replace("_"," ")}),e.jsx("span",{className:"badge badge-priority",style:{backgroundColor:(n=t.prioritaet,{niedrig:"#10B981",mittel:"#3B82F6",hoch:"#F59E0B",kritisch:"#EF4444"}[n]||"#3B82F6")},children:t.prioritaet}),e.jsx("span",{className:"badge badge-diff",children:t.schwierigkeit})]}),!r&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginTop:"8px",flexWrap:"wrap"},children:[e.jsxs("span",{style:{fontSize:"12px",color:"#ffd700",fontWeight:"bold",minWidth:"35px"},children:[t.fortschritt_prozent,"%"]}),e.jsx("input",{type:"range",min:"0",max:"100",value:t.fortschritt_prozent,onChange:e=>{const r=parseInt(e.target.value);a(e=>e.map(e=>e.fortschritt_id===t.fortschritt_id?{...e,fortschritt_prozent:r}:e))},onMouseUp:e=>{const r=parseInt(e.target.value);(async(e,t)=>{var r;try{console.log("Updating skill:",e,t);const r={...t,updated_by:localStorage.getItem("userId")||"unknown",updated_by_name:localStorage.getItem("userName")||"Unbekannt",update_reason:"slider_change"};console.log("Sending update:",r);const n=await l.put(`/fortschritt/${e}`,r);console.log("Update response:",n.data),a(r=>r.map(r=>r.fortschritt_id===e?{...r,...t}:r))}catch(n){console.error("âŒ Fehler beim Aktualisieren:",n),console.error("Error details:",null==(r=n.response)?void 0:r.data)}})(t.fortschritt_id,{...t,fortschritt_prozent:r,status:100===r?"gemeistert":"in_arbeit"})},className:"skill-slider",style:{flex:1,minWidth:"200px"}}),e.jsx("button",{onClick:()=>(async e=>{try{const t=await l.get(`/fortschritt/${e}/history`);A(t.data),M(e),B(!0)}catch(t){console.error("âŒ Fehler beim Laden der Historie:",t)}})(t.fortschritt_id),style:{padding:"6px 10px",fontSize:"12px",background:"rgba(255, 215, 0, 0.2)",border:"1px solid rgba(255, 215, 0, 0.5)",borderRadius:"6px",color:"#ffd700",cursor:"pointer",fontWeight:"bold",transition:"all 0.2s",minWidth:"80px",flexShrink:0},onMouseEnter:e=>{e.target.style.background="rgba(255, 215, 0, 0.3)",e.target.style.borderColor="rgba(255, 215, 0, 0.7)"},onMouseLeave:e=>{e.target.style.background="rgba(255, 215, 0, 0.2)",e.target.style.borderColor="rgba(255, 215, 0, 0.5)"},children:"ğŸ“Š Historie"})]})]})]},t.fortschritt_id);var n})}),"ziele"===z&&e.jsx("div",{className:"ziele-list",children:0===s.length?e.jsxs("div",{className:"empty-state",children:[e.jsx(x,{size:48}),e.jsx("p",{children:"Noch keine Ziele definiert"}),!r&&e.jsx("button",{className:"btn-primary",onClick:()=>N(!0),children:"Erstes Ziel erstellen"})]}):s.map(t=>e.jsxs("div",{className:`ziel-card ziel-${t.status}`,children:[e.jsxs("div",{className:"ziel-header",children:[e.jsx("h3",{children:t.titel}),e.jsx("span",{className:`ziel-status status-${t.status}`,children:t.status})]}),t.beschreibung&&e.jsx("p",{className:"ziel-desc",children:t.beschreibung}),e.jsxs("div",{className:"ziel-dates",children:[e.jsxs("span",{children:["Start: ",new Date(t.start_datum).toLocaleDateString("de-DE")]}),e.jsxs("span",{children:["Ziel: ",new Date(t.ziel_datum).toLocaleDateString("de-DE")]})]}),t.fortschritt_prozent>0&&e.jsxs("div",{className:"ziel-progress",children:[e.jsx("div",{className:"progress-bar",children:e.jsx("div",{className:"progress-fill",style:{width:`${t.fortschritt_prozent}%`}})}),e.jsxs("span",{children:[t.fortschritt_prozent,"%"]})]})]},t.ziel_id))}),"meilensteine"===z&&e.jsx("div",{className:"meilensteine-grid",children:0===o.length?e.jsxs("div",{className:"empty-state",children:[e.jsx(p,{size:48}),e.jsx("p",{children:"Noch keine Meilensteine erreicht"}),!r&&e.jsx("button",{className:"btn-primary",onClick:()=>N(!0),children:"Ersten Meilenstein erstellen"})]}):o.map(t=>e.jsxs("div",{className:"meilenstein-card "+(t.erreicht?"erreicht":""),children:[e.jsx("div",{className:"meilenstein-icon",children:t.erreicht?e.jsx(p,{size:32,color:"#ffd700"}):e.jsx(x,{size:32})}),e.jsx("h3",{children:t.titel}),t.beschreibung&&e.jsx("p",{children:t.beschreibung}),e.jsxs("div",{className:"meilenstein-footer",children:[e.jsx("span",{className:"meilenstein-typ",children:t.typ}),t.erreicht&&t.erreicht_am&&e.jsx("span",{className:"meilenstein-date",children:new Date(t.erreicht_am).toLocaleDateString("de-DE")})]}),!r&&e.jsx("button",{className:"meilenstein-toggle "+(t.erreicht?"btn-undo":"btn-complete"),onClick:()=>(async(e,t)=>{try{await l.put(`/fortschritt/meilensteine/${e}/erreicht`,{erreicht:!t}),K()}catch(r){console.error("âŒ Fehler beim Aktualisieren:",r)}})(t.meilenstein_id,t.erreicht),children:t.erreicht?"ZurÃ¼cksetzen":"Als erreicht markieren"})]},t.meilenstein_id))}),"badges"===z&&e.jsx("div",{className:"badges-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"16px",padding:"8px 0"},children:0===g.length?e.jsxs("div",{className:"empty-state",children:[e.jsx(b,{size:48}),e.jsx("p",{children:"Noch keine Auszeichnungen erhalten"}),e.jsx("p",{style:{fontSize:"14px",color:"#888",marginTop:"8px"},children:"Auszeichnungen werden fÃ¼r besondere Leistungen vergeben."})]}):g.map(t=>{const r={award:"ğŸ…",star:"â­",trophy:"ğŸ†",medal:"ğŸ–ï¸",crown:"ğŸ‘‘",flame:"ğŸ”¥",target:"ğŸ¯",heart:"â¤ï¸",users:"ğŸ‘¥",swords:"âš”ï¸",zap:"âš¡","trending-up":"ğŸ“ˆ",footprints:"ğŸ‘£",layers:"ğŸ“š",brain:"ğŸ§ ",shield:"ğŸ›¡ï¸"}[t.icon]||"ğŸ…";return e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",border:`2px solid ${t.farbe||"#ffd700"}`,borderRadius:"12px",padding:"20px",textAlign:"center",transition:"all 0.3s ease",cursor:"default"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-4px)",e.currentTarget.style.boxShadow=`0 8px 24px ${t.farbe||"#ffd700"}40`},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none"},children:[e.jsx("div",{style:{width:"64px",height:"64px",margin:"0 auto 12px",background:`linear-gradient(135deg, ${t.farbe||"#ffd700"}40, ${t.farbe||"#ffd700"}20)`,border:`2px solid ${t.farbe||"#ffd700"}`,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"32px",boxShadow:`0 4px 12px ${t.farbe||"#ffd700"}30`},children:r}),e.jsx("h3",{style:{color:t.farbe||"#ffd700",fontSize:"16px",fontWeight:"bold",margin:"0 0 8px 0"},children:t.name}),t.beschreibung&&e.jsx("p",{style:{color:"#ccc",fontSize:"13px",margin:"0 0 12px 0",lineHeight:"1.4"},children:t.beschreibung}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",flexWrap:"wrap"},children:[t.kategorie&&e.jsx("span",{style:{background:"rgba(255, 255, 255, 0.1)",padding:"4px 8px",borderRadius:"12px",fontSize:"11px",color:"#aaa"},children:t.kategorie}),t.verliehen_am&&e.jsx("span",{style:{background:"rgba(34, 197, 94, 0.2)",color:"#22c55e",padding:"4px 8px",borderRadius:"12px",fontSize:"11px"},children:new Date(t.verliehen_am).toLocaleDateString("de-DE")})]})]},t.badge_id)})})]}),_&&e.jsx("div",{ref:R,style:{position:"fixed !important",top:"0 !important",left:"0 !important",right:"0 !important",bottom:"0 !important",width:"100vw !important",height:"100vh !important",background:"rgba(0, 0, 0, 0.9) !important",backdropFilter:"blur(12px) !important",display:"flex !important",alignItems:"center !important",justifyContent:"center !important",zIndex:"2147483647 !important",padding:"20px !important",margin:"0 !important",boxSizing:"border-box !important",isolation:"isolate !important",transform:"none !important",overflow:"hidden !important"},onClick:()=>N(!1),children:e.jsxs("div",{style:{position:"relative",background:"#1a1a2e",border:"3px solid #ffd700",borderRadius:"16px",padding:0,width:"450px",maxWidth:"450px",minWidth:"450px",height:"auto",maxHeight:"80vh",overflow:"hidden",zIndex:2147483647,boxShadow:"0 20px 60px rgba(0, 0, 0, 0.8), 0 0 40px rgba(255, 215, 0, 0.3)",display:"flex",flexDirection:"column",boxSizing:"border-box",margin:0,transform:"none",top:"auto",left:"auto",right:"auto",bottom:"auto"},onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",background:"rgba(255, 215, 0, 0.1)",borderBottom:"1px solid rgba(255, 215, 0, 0.3)",flexShrink:0,boxSizing:"border-box"},children:[e.jsxs("h2",{style:{margin:0,color:"#ffd700",fontSize:"16px",fontWeight:700,lineHeight:1.2},children:["skills"===z&&"Neuer Skill","ziele"===z&&"Neues Ziel","meilensteine"===z&&"Neuer Meilenstein"]}),e.jsx("button",{style:{width:"24px",height:"24px",padding:0,background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:"4px",color:"#fff",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px",fontWeight:"bold",transition:"all 0.2s",boxSizing:"border-box"},onClick:()=>N(!1),onMouseEnter:e=>{e.target.style.background="rgba(239, 68, 68, 0.3)",e.target.style.borderColor="#ef4444",e.target.style.color="#ef4444"},onMouseLeave:e=>{e.target.style.background="rgba(255, 255, 255, 0.1)",e.target.style.borderColor="rgba(255, 255, 255, 0.3)",e.target.style.color="#fff"},children:e.jsx(y,{size:16})})]}),e.jsxs("div",{style:{padding:"24px",overflowY:"auto",overflowX:"hidden",flex:1,maxHeight:"calc(80vh - 120px)",boxSizing:"border-box"},children:["skills"===z&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",margin:0},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px",margin:0},children:[e.jsx("label",{style:{margin:0,fontSize:"13px",fontWeight:600,color:"#ffd700",lineHeight:1.3},children:"Kategorie"}),e.jsxs("select",{style:{padding:"10px 12px",background:"rgba(0, 0, 0, 0.3)",border:"1px solid rgba(255, 215, 0, 0.3)",borderRadius:"6px",color:"#fff",fontSize:"14px",fontFamily:"inherit",height:"36px",minHeight:"36px",maxHeight:"36px",boxSizing:"border-box",transition:"all 0.2s"},value:L.kategorie_id,onChange:e=>W({...L,kategorie_id:e.target.value}),children:[e.jsx("option",{value:"",style:{background:"#1a1a2e",color:"#fff"},children:"WÃ¤hlen..."}),u.map(t=>e.jsx("option",{value:t.kategorie_id,style:{background:"#1a1a2e",color:"#fff"},children:t.name},t.kategorie_id))]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px",margin:0},children:[e.jsx("label",{style:{margin:0,fontSize:"13px",fontWeight:600,color:"#ffd700",lineHeight:1.3},children:"Skill Name *"}),e.jsx("input",{type:"text",style:{padding:"10px 12px",background:"rgba(0, 0, 0, 0.3)",border:"1px solid rgba(255, 215, 0, 0.3)",borderRadius:"6px",color:"#fff",fontSize:"14px",fontFamily:"inherit",height:"36px",minHeight:"36px",maxHeight:"36px",boxSizing:"border-box",transition:"all 0.2s"},value:L.skill_name,onChange:e=>W({...L,skill_name:e.target.value}),placeholder:"z.B. Frontkick"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px",margin:0,gridColumn:"1 / -1"},children:[e.jsx("label",{style:{margin:0,fontSize:"13px",fontWeight:600,color:"#ffd700",lineHeight:1.3},children:"Beschreibung"}),e.jsx("textarea",{style:{padding:"10px 12px",background:"rgba(0, 0, 0, 0.3)",border:"1px solid rgba(255, 215, 0, 0.3)",borderRadius:"6px",color:"#fff",fontSize:"14px",fontFamily:"inherit",height:"70px",minHeight:"70px",maxHeight:"100px",boxSizing:"border-box",transition:"all 0.2s",resize:"vertical"},value:L.beschreibung,onChange:e=>W({...L,beschreibung:e.target.value}),rows:3})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px",margin:0},children:[e.jsx("label",{style:{margin:0,fontSize:"13px",fontWeight:600,color:"#ffd700",lineHeight:1.3},children:"PrioritÃ¤t"}),e.jsxs("select",{style:{padding:"10px 12px",background:"rgba(0, 0, 0, 0.3)",border:"1px solid rgba(255, 215, 0, 0.3)",borderRadius:"6px",color:"#fff",fontSize:"14px",fontFamily:"inherit",height:"36px",minHeight:"36px",maxHeight:"36px",boxSizing:"border-box",transition:"all 0.2s"},value:L.prioritaet,onChange:e=>W({...L,prioritaet:e.target.value}),children:[e.jsx("option",{value:"niedrig",style:{background:"#1a1a2e",color:"#fff"},children:"Niedrig"}),e.jsx("option",{value:"mittel",style:{background:"#1a1a2e",color:"#fff"},children:"Mittel"}),e.jsx("option",{value:"hoch",style:{background:"#1a1a2e",color:"#fff"},children:"Hoch"}),e.jsx("option",{value:"kritisch",style:{background:"#1a1a2e",color:"#fff"},children:"Kritisch"})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px",margin:0},children:[e.jsx("label",{style:{margin:0,fontSize:"13px",fontWeight:600,color:"#ffd700",lineHeight:1.3},children:"Schwierigkeit"}),e.jsxs("select",{style:{padding:"10px 12px",background:"rgba(0, 0, 0, 0.3)",border:"1px solid rgba(255, 215, 0, 0.3)",borderRadius:"6px",color:"#fff",fontSize:"14px",fontFamily:"inherit",height:"36px",minHeight:"36px",maxHeight:"36px",boxSizing:"border-box",transition:"all 0.2s"},value:L.schwierigkeit,onChange:e=>W({...L,schwierigkeit:e.target.value}),children:[e.jsx("option",{value:"anfaenger",style:{background:"#1a1a2e",color:"#fff"},children:"AnfÃ¤nger"}),e.jsx("option",{value:"fortgeschritten",style:{background:"#1a1a2e",color:"#fff"},children:"Fortgeschritten"}),e.jsx("option",{value:"experte",style:{background:"#1a1a2e",color:"#fff"},children:"Experte"}),e.jsx("option",{value:"meister",style:{background:"#1a1a2e",color:"#fff"},children:"Meister"})]})]})]}),"ziele"===z&&e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group full-width",children:[e.jsx("label",{children:"Titel *"}),e.jsx("input",{type:"text",value:I.titel,onChange:e=>$({...I,titel:e.target.value})})]}),e.jsxs("div",{className:"form-group full-width",children:[e.jsx("label",{children:"Beschreibung"}),e.jsx("textarea",{value:I.beschreibung,onChange:e=>$({...I,beschreibung:e.target.value}),rows:3})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Startdatum"}),e.jsx("input",{type:"date",value:I.start_datum,onChange:e=>$({...I,start_datum:e.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Zieldatum *"}),e.jsx("input",{type:"date",value:I.ziel_datum,onChange:e=>$({...I,ziel_datum:e.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"PrioritÃ¤t"}),e.jsxs("select",{value:I.prioritaet,onChange:e=>$({...I,prioritaet:e.target.value}),children:[e.jsx("option",{value:"niedrig",children:"Niedrig"}),e.jsx("option",{value:"mittel",children:"Mittel"}),e.jsx("option",{value:"hoch",children:"Hoch"})]})]})]}),"meilensteine"===z&&e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group full-width",children:[e.jsx("label",{children:"Titel *"}),e.jsx("input",{type:"text",value:P.titel,onChange:e=>V({...P,titel:e.target.value})})]}),e.jsxs("div",{className:"form-group full-width",children:[e.jsx("label",{children:"Beschreibung"}),e.jsx("textarea",{value:P.beschreibung,onChange:e=>V({...P,beschreibung:e.target.value}),rows:3})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Typ"}),e.jsxs("select",{value:P.typ,onChange:e=>V({...P,typ:e.target.value}),children:[e.jsx("option",{value:"achievement",children:"Achievement"}),e.jsx("option",{value:"pruefung",children:"PrÃ¼fung"}),e.jsx("option",{value:"turnier",children:"Turnier"}),e.jsx("option",{value:"persoenlich",children:"PersÃ¶nlich"}),e.jsx("option",{value:"sonstiges",children:"Sonstiges"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Zieldatum"}),e.jsx("input",{type:"date",value:P.ziel_datum,onChange:e=>V({...P,ziel_datum:e.target.value})})]})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",padding:"16px 20px",background:"rgba(0, 0, 0, 0.2)",borderTop:"1px solid rgba(255, 215, 0, 0.3)",flexShrink:0,boxSizing:"border-box"},children:[e.jsx("button",{style:{padding:"8px 16px",borderRadius:"4px",fontSize:"13px",fontWeight:600,cursor:"pointer",border:"1px solid rgba(255, 255, 255, 0.3)",background:"rgba(255, 255, 255, 0.1)",color:"#fff",transition:"all 0.2s",boxSizing:"border-box",minWidth:"60px"},onClick:()=>N(!1),onMouseEnter:e=>{e.target.style.background="rgba(255, 255, 255, 0.2)",e.target.style.borderColor="rgba(255, 255, 255, 0.5)"},onMouseLeave:e=>{e.target.style.background="rgba(255, 255, 255, 0.1)",e.target.style.borderColor="rgba(255, 255, 255, 0.3)"},children:"Abbrechen"}),e.jsx("button",{style:{padding:"8px 16px",borderRadius:"4px",fontSize:"13px",fontWeight:600,cursor:"pointer",border:"none",background:"#ffd700",color:"#1a1a2e",transition:"all 0.2s",boxSizing:"border-box",minWidth:"60px"},onClick:()=>{"skills"===z?(async()=>{try{await l.post(`/fortschritt/mitglied/${t}`,L),K(),N(!1),G()}catch(e){console.error("âŒ Fehler beim Erstellen des Skills:",e)}})():"ziele"===z?(async()=>{try{await l.post(`/fortschritt/mitglied/${t}/ziele`,I),K(),N(!1),H()}catch(e){console.error("âŒ Fehler beim Erstellen des Ziels:",e)}})():"meilensteine"===z&&(async()=>{try{await l.post(`/fortschritt/mitglied/${t}/meilensteine`,P),K(),N(!1),U()}catch(e){console.error("âŒ Fehler beim Erstellen des Meilensteins:",e)}})()},onMouseEnter:e=>{e.target.style.background="#ffed4e",e.target.style.transform="translateY(-1px)"},onMouseLeave:e=>{e.target.style.background="#ffd700",e.target.style.transform="translateY(0)"},children:"HinzufÃ¼gen"})]})]})}),F&&e.jsx("div",{"data-history-modal":!0,style:{position:"fixed",top:0,left:0,right:0,bottom:0,width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.9)",backdropFilter:"blur(12px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2147483647,padding:"20px",margin:0,boxSizing:"border-box",isolation:"isolate"},onClick:()=>B(!1),children:e.jsxs("div",{style:{position:"relative",background:"#1a1a2e",border:"3px solid #ffd700",borderRadius:"16px",padding:0,width:"600px",maxWidth:"90vw",height:"auto",maxHeight:"80vh",overflow:"hidden",zIndex:2147483647,boxShadow:"0 20px 60px rgba(0, 0, 0, 0.8), 0 0 40px rgba(255, 215, 0, 0.3)",display:"flex",flexDirection:"column",boxSizing:"border-box",margin:0,transform:"none",top:"auto",left:"auto",right:"auto",bottom:"auto"},onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px 20px",background:"rgba(255, 215, 0, 0.1)",borderBottom:"1px solid rgba(255, 215, 0, 0.3)",flexShrink:0,boxSizing:"border-box"},children:[e.jsx("h2",{style:{margin:0,color:"#ffd700",fontSize:"18px",fontWeight:700,lineHeight:1.2},children:"ğŸ“Š Ã„nderungshistorie"}),e.jsx("button",{style:{width:"24px",height:"24px",padding:0,background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:"4px",color:"#fff",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px",fontWeight:"bold",transition:"all 0.2s",boxSizing:"border-box"},onClick:()=>B(!1),children:e.jsx(y,{size:16})})]}),e.jsx("div",{style:{padding:"20px",overflowY:"auto",overflowX:"hidden",flex:1,maxHeight:"calc(80vh - 120px)",boxSizing:"border-box"},children:0===T.length?e.jsx("p",{style:{color:"#fff",textAlign:"center",margin:"20px 0"},children:"Keine Ã„nderungen vorhanden"}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:T.map((t,r)=>e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 215, 0, 0.2)",borderRadius:"8px",padding:"12px",color:"#fff"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[e.jsx("span",{style:{fontWeight:"bold",color:"#ffd700"},children:t.skill_name}),e.jsx("span",{style:{fontSize:"12px",color:"#ccc"},children:new Date(t.update_timestamp).toLocaleString("de-DE")})]}),e.jsx("div",{style:{display:"flex",gap:"16px",fontSize:"14px"},children:e.jsxs("div",{children:[e.jsx("span",{style:{color:"#ccc"},children:"Fortschritt: "}),e.jsxs("span",{style:{color:"#ff6b35"},children:[t.alter_fortschritt,"%"]}),e.jsx("span",{style:{color:"#fff",margin:"0 8px"},children:"â†’"}),e.jsxs("span",{style:{color:"#22c55e"},children:[t.neuer_fortschritt,"%"]})]})}),e.jsx("div",{style:{display:"flex",gap:"16px",fontSize:"14px",marginTop:"4px"},children:e.jsxs("div",{children:[e.jsx("span",{style:{color:"#ccc"},children:"Status: "}),e.jsx("span",{style:{color:"#ff6b35"},children:t.alter_status}),e.jsx("span",{style:{color:"#fff",margin:"0 8px"},children:"â†’"}),e.jsx("span",{style:{color:"#22c55e"},children:t.neuer_status})]})}),t.notiz&&e.jsxs("div",{style:{marginTop:"8px",fontSize:"13px",color:"#ccc"},children:[e.jsx("span",{style:{color:"#ffd700"},children:"Notiz: "}),t.notiz]}),t.aktualisiert_von_name&&e.jsxs("div",{style:{marginTop:"8px",fontSize:"13px",color:"#ccc"},children:[e.jsx("span",{style:{color:"#ffd700"},children:"GeÃ¤ndert von: "}),t.aktualisiert_von_name]})]},r))})})]})})]})},O=({mitgliedId:t,readOnly:r=!1})=>{const[i,a]=n.useState([]),[s,d]=n.useState(!0),[o,c]=n.useState(null),[g,h]=n.useState(!1),[u,m]=n.useState(""),[x,p]=n.useState(""),[b,f]=n.useState(!1),[j,w]=n.useState({stil_name:"",graduierung_name:"",pruefungsdatum:"",bemerkung:""}),[_,N]=n.useState([]);n.useEffect(()=>{t&&(D(),T())},[t]);const D=async()=>{var e,r;try{d(!0),c(null),console.log("ğŸ”„ Lade PrÃ¼fungsdaten fÃ¼r Mitglied:",t);const n=(null==(e=(await l.get(`/mitglieder/${t}/stile`)).data)?void 0:e.stile)||[];if(console.log("ğŸ“Œ Dem Mitglied zugewiesene Stile:",n),0===n.length)return console.log("âš ï¸ Keine Stile zugewiesen"),a([]),void d(!1);const i=await l.get(`/pruefungen/mitglied/${t}/historie`),s=(null==(r=i.data)?void 0:r.historie)||i.data||[],o=(await l.get(`/anwesenheitProtokoll/pruefung/${t}`)).data||{};console.log("ğŸ“Š Geladene Daten:",{zugewieseneStile:null==n?void 0:n.length,zugewieseneStileNamen:null==n?void 0:n.map(e=>e.stil_name),historie:null==s?void 0:s.length,trainings:o,trainingsKeys:Object.keys(o||{}),trainingsType:typeof o,trainingsStile:o.stile,trainingsStatistiken:o.statistiken});const g=n.map(e=>{var t;const r=s.filter(t=>t.stil_id===e.stil_id),n=(null==(t=o.stile)?void 0:t[e.stil_name])||o.statistiken||o||{};console.log(`ğŸ” Stil ${e.stil_name} (ID: ${e.stil_id}):`,{historie:r.length,trainings:n,trainingsKeys:Object.keys(n||{}),stileDaten:o.stile});const i=r.filter(e=>!0===e.bestanden||"bestanden"===e.status).sort((e,t)=>new Date(t.pruefungsdatum)-new Date(e.pruefungsdatum))[0],a=r.find(e=>"geplant"===e.status);return{stil_id:e.stil_id,stil_name:e.stil_name,stil_farbe:"#FFD700",historie:r,trainingsstunden:n,letztePruefung:i,naechstePruefung:a,aktuelleGraduierung:(null==i?void 0:i.graduierung_nachher)||e.graduierung_name||"AnfÃ¤nger",graduierungFarbe:(null==i?void 0:i.farbe_nachher)||e.farbe||"#FFFFFF"}});console.log("ğŸ¯ Verarbeitete Stildaten:",g.map(e=>({stil_id:e.stil_id,stil_name:e.stil_name,historie_anzahl:e.historie.length,aktuelle_graduierung:e.aktuelleGraduierung,trainingsstunden_vorhanden:!!e.trainingsstunden}))),a(g)}catch(n){console.error("Fehler beim Laden der PrÃ¼fungsdaten:",n),c("Fehler beim Laden der Daten")}finally{d(!1)}},C=e=>e?new Date(e).toLocaleDateString("de-DE"):"-",F=e=>{var t;if(!e.trainingsstunden)return 0;const r=parseInt(e.trainingsstunden.anwesend_stunden||e.trainingsstunden.total_stunden||0),n=parseInt((null==(t=e.trainingsstunden.requirements)?void 0:t.min_stunden)||20);return Math.round(r/n*100)},B=async e=>{try{const t=await l.get(`/pruefungen/${e}/urkunde/download`,{responseType:"blob"}),r=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a");n.href=r,n.setAttribute("download",`urkunde_${e}.pdf`),document.body.appendChild(n),n.click(),n.remove()}catch(t){console.error("Fehler beim Download der Urkunde:",t)}},T=async()=>{var e;try{const r=await l.get("/pruefungen-historisch/mitglied/"+t);N((null==(e=r.data)?void 0:e.data)||[])}catch(r){console.error("Fehler beim Laden historischer PrÃ¼fungen:",r)}},A=async e=>{if(window.confirm("Wirklich lÃ¶schen?"))try{await l.delete("/pruefungen-historisch/"+e),T()}catch(t){console.error("Fehler beim LÃ¶schen:",t)}};return s?e.jsx("div",{className:"pruefungsstatus-container",children:e.jsxs("div",{className:"loading-spinner",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"Lade PrÃ¼fungsdaten..."})]})}):o?e.jsx("div",{className:"pruefungsstatus-container",children:e.jsxs("div",{className:"error-message",children:[e.jsx(v,{size:24}),e.jsx("p",{children:o})]})}):e.jsxs("div",{className:"pruefungsstatus-wrapper",children:[0===i.length?e.jsx("div",{className:"grid-container",children:e.jsxs("div",{className:"field-group card",children:[e.jsx("h3",{children:"ğŸ“ PrÃ¼fungsstatus"}),e.jsx("p",{style:{textAlign:"center",color:"#999",padding:"2rem"},children:r?"Ihnen wurden noch keine Stile zugewiesen.":'Diesem Mitglied wurden noch keine Stile zugewiesen. Weisen Sie im Tab "Stile" einen Stil zu.'})]})}):i.map(t=>{var n,i,a,s,l,d,o,c,g,h,u,m,x;return e.jsxs("div",{className:"stil-pruefung-section",children:[e.jsx("div",{className:"stil-titel-header",children:e.jsxs("h2",{style:{color:"#FFD700",fontSize:"1.5rem",marginBottom:"1.5rem"},children:["ğŸ¥‹ ",t.stil_name]})}),e.jsxs("div",{className:"grid-container zwei-spalten",children:[e.jsxs("div",{className:"field-group card",children:[e.jsx("h3",{children:"ğŸ–ï¸ Aktuelle Graduierung"}),e.jsxs("div",{children:[e.jsx("label",{children:"Gurtfarbe:"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginTop:"0.5rem"},children:[e.jsx("div",{style:{width:"80px",height:"24px",backgroundColor:t.graduierungFarbe,borderRadius:"4px",border:"2px solid rgba(255, 255, 255, 0.2)",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.3)"}}),e.jsx("span",{style:{fontSize:"1rem",fontWeight:"600",color:"#fff"},children:t.aktuelleGraduierung})]})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Letzte PrÃ¼fung:"}),e.jsx("span",{children:C(null==(n=t.letztePruefung)?void 0:n.pruefungsdatum)})]}),"bestanden"===(null==(i=t.letztePruefung)?void 0:i.status)&&e.jsx("div",{children:e.jsxs("button",{className:"download-urkunde-btn",onClick:()=>B(t.letztePruefung.pruefung_id),style:{background:"linear-gradient(135deg, #FFD700, #FFA500)",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",color:"#000",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",marginTop:"0.5rem"},children:[e.jsx(k,{size:16}),"Urkunde herunterladen"]})})]}),e.jsxs("div",{className:"field-group card",children:[e.jsx("h3",{children:"ğŸ“Š Trainingsstunden"}),e.jsxs("div",{children:[e.jsx("label",{children:"Absolviert:"}),e.jsxs("span",{style:{fontSize:"1.1rem",fontWeight:"600",color:"#22c55e"},children:[(null==(a=t.trainingsstunden)?void 0:a.anwesend_stunden)||(null==(s=t.trainingsstunden)?void 0:s.total_stunden)||0," Stunden"]})]}),e.jsxs("div",{children:[e.jsx("label",{children:"BenÃ¶tigt fÃ¼r nÃ¤chste PrÃ¼fung:"}),e.jsxs("span",{style:{fontSize:"1.1rem",fontWeight:"600",color:"#3b82f6"},children:[(null==(d=null==(l=t.trainingsstunden)?void 0:l.requirements)?void 0:d.min_stunden)||20," Stunden"]})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Noch benÃ¶tigt:"}),e.jsxs("span",{style:{fontSize:"1.1rem",fontWeight:"600",color:"#ef4444"},children:[Math.max(0,((null==(c=null==(o=t.trainingsstunden)?void 0:o.requirements)?void 0:c.min_stunden)||20)-parseInt((null==(g=t.trainingsstunden)?void 0:g.anwesend_stunden)||(null==(h=t.trainingsstunden)?void 0:h.total_stunden)||0))," Stunden"]})]}),e.jsxs("div",{style:{marginTop:"1rem"},children:[e.jsx("label",{children:"Fortschritt:"}),e.jsx("div",{style:{width:"100%",height:"24px",background:"rgba(255, 255, 255, 0.1)",borderRadius:"12px",overflow:"hidden",position:"relative",marginTop:"0.5rem"},children:e.jsx("div",{style:{height:"100%",width:`${F(t)}%`,background:F(t)>=80?"linear-gradient(90deg, #22c55e, #16a34a)":F(t)>=60?"linear-gradient(90deg, #f59e0b, #d97706)":"linear-gradient(90deg, #ef4444, #dc2626)",borderRadius:"12px",display:"flex",alignItems:"center",justifyContent:"center",transition:"width 0.3s ease",minWidth:"40px"},children:e.jsxs("span",{style:{color:"#fff",fontWeight:"700",fontSize:"0.85rem",textShadow:"0 1px 2px rgba(0, 0, 0, 0.5)"},children:[F(t),"%"]})})}),e.jsx("div",{style:{textAlign:"center",marginTop:"0.5rem",fontSize:"0.9rem",fontWeight:"600",color:"#FFD700"},children:(x=F(t),x>=80?"Bereit fÃ¼r PrÃ¼fung":x>=60?"Gut auf dem Weg":x>=40?"Fortschritt sichtbar":"Mehr Training nÃ¶tig")})]})]}),e.jsxs("div",{className:"field-group card",children:[e.jsx("h3",{children:"ğŸ“… NÃ¤chste PrÃ¼fung"}),e.jsxs("div",{children:[e.jsx("label",{children:"Geplantes Datum:"}),e.jsx("span",{style:{fontSize:"1rem",fontWeight:"600"},children:C(null==(u=t.naechstePruefung)?void 0:u.pruefungsdatum)||"Keine PrÃ¼fung geplant"})]}),t.naechstePruefung&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{children:"Ziel-Graduierung:"}),e.jsx("span",{children:(null==(m=t.naechstePruefung)?void 0:m.graduierung)||"-"})]}),e.jsx("div",{children:e.jsxs("button",{className:"edit-pruefung-btn",onClick:()=>setShowPruefungModal(!0),style:{background:"rgba(255, 215, 0, 0.2)",border:"1px solid #FFD700",padding:"0.5rem 1rem",borderRadius:"6px",color:"#FFD700",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",marginTop:"0.5rem"},children:[e.jsx(S,{size:16}),"PrÃ¼fung bearbeiten"]})})]})]}),e.jsxs("div",{className:"field-group card",style:{gridColumn:"1 / -1"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h3",{style:{margin:0},children:"ğŸ“‹ PrÃ¼fungshistorie"}),!r&&e.jsx("button",{onClick:()=>(w({stil_name:"",graduierung_name:"",pruefungsdatum:"",bemerkung:""}),void f(!0)),style:{padding:"0.5rem 1rem",background:"linear-gradient(135deg, #3b82f6, #2563eb)",border:"none",borderRadius:"6px",color:"#fff",fontSize:"0.85rem",fontWeight:"600",cursor:"pointer"},children:"+ Historische PrÃ¼fung"})]}),t.historie.length>0?e.jsx("div",{style:{overflowX:"auto",marginTop:"1rem"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.9rem"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"2px solid rgba(255, 215, 0, 0.3)",backgroundColor:"rgba(255, 255, 255, 0.02)"},children:[e.jsx("th",{style:{padding:"0.75rem",textAlign:"left",color:"#FFD700"},children:"Datum"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"left",color:"#FFD700"},children:"Graduierung"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"left",color:"#FFD700"},children:"Status"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"left",color:"#FFD700"},children:"Punkte"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"center",color:"#FFD700"},children:"Aktion"})]})}),e.jsx("tbody",{children:t.historie.map((t,n)=>e.jsxs("tr",{style:{borderBottom:"1px solid rgba(255, 255, 255, 0.1)",backgroundColor:n%2==0?"transparent":"rgba(255, 255, 255, 0.02)"},children:[e.jsx("td",{style:{padding:"0.75rem"},children:C(t.pruefungsdatum)}),e.jsx("td",{style:{padding:"0.75rem"},children:t.graduierung_nachher}),e.jsx("td",{style:{padding:"0.75rem"},children:e.jsxs("span",{style:{padding:"0.25rem 0.75rem",borderRadius:"12px",fontSize:"0.8rem",fontWeight:"600",background:"bestanden"===t.status?"rgba(34, 197, 94, 0.2)":"geplant"===t.status?"rgba(59, 130, 246, 0.2)":"rgba(239, 68, 68, 0.2)",color:"bestanden"===t.status?"#22c55e":"geplant"===t.status?"#3b82f6":"#ef4444"},children:[t.status,t.ist_historisch&&" (hist.)"]})}),e.jsx("td",{style:{padding:"0.75rem"},children:t.punktzahl||"-"}),e.jsx("td",{style:{padding:"0.75rem",textAlign:"center"},children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"center"},children:["bestanden"===t.status&&!t.ist_historisch&&e.jsx("button",{onClick:()=>B(t.pruefung_id),style:{background:"rgba(255, 215, 0, 0.2)",border:"1px solid #FFD700",padding:"0.25rem 0.5rem",borderRadius:"4px",color:"#FFD700",cursor:"pointer",fontSize:"0.8rem"},title:"Urkunde herunterladen",children:e.jsx(k,{size:14})}),t.ist_historisch&&!r&&e.jsx("button",{onClick:()=>A(t.pruefung_id),style:{background:"rgba(239, 68, 68, 0.2)",border:"1px solid #ef4444",padding:"0.25rem 0.5rem",borderRadius:"4px",color:"#ef4444",cursor:"pointer",fontSize:"0.8rem"},title:"Historische PrÃ¼fung lÃ¶schen",children:e.jsx(y,{size:14})})]})})]},t.pruefung_id))})]})}):e.jsx("p",{style:{color:"rgba(255,255,255,0.6)",textAlign:"center",padding:"1rem"},children:'Noch keine PrÃ¼fungen dokumentiert. Klicken Sie auf "+ Historische PrÃ¼fung" um vergangene PrÃ¼fungen zu erfassen.'})]})]})]},t.stil_id)}),g&&e.jsx("div",{className:"modal-overlay",onClick:()=>h(!1),children:e.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"1rem 1.5rem",borderBottom:"1px solid rgba(255, 215, 0, 0.2)"},children:[e.jsx("h3",{children:"PrÃ¼fungsanmerkungen bearbeiten"}),e.jsx("button",{className:"close-btn",onClick:()=>h(!1),children:e.jsx(y,{size:20})})]}),e.jsx("div",{className:"modal-body",children:e.jsx("textarea",{value:x,onChange:e=>p(e.target.value),placeholder:"Anmerkungen zur PrÃ¼fung...",rows:4})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn-secondary",onClick:()=>h(!1),children:"Abbrechen"}),e.jsxs("button",{className:"btn-primary",onClick:async()=>{var e;try{const t=null==(e=i.find(e=>e.letztePruefung))?void 0:e.letztePruefung;t&&(await l.put(`/pruefungen/${t.pruefung_id}`,{anmerkungen:x}),m(x),h(!1),D())}catch(t){console.error("Fehler beim Speichern der Anmerkungen:",t)}},children:[e.jsx(z,{size:16}),"Speichern"]})]})]})}),b&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},onClick:()=>f(!1),children:e.jsxs("div",{onClick:e=>e.stopPropagation(),style:{background:"linear-gradient(145deg, #1a1a2e 0%, #16213e 100%)",borderRadius:"16px",width:"90%",maxWidth:"450px",maxHeight:"80vh",overflowY:"auto",border:"1px solid rgba(255, 215, 0, 0.3)",boxShadow:"0 20px 60px rgba(0,0,0,0.5)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"1rem 1.5rem",borderBottom:"1px solid rgba(255, 215, 0, 0.2)"},children:[e.jsx("h3",{style:{color:"#FFD700"},children:"ğŸ“œ Historische PrÃ¼fung"}),e.jsx("button",{onClick:()=>f(!1),style:{background:"transparent",border:"none",color:"#fff",cursor:"pointer",padding:"0.5rem"},children:e.jsx(y,{size:20})})]}),e.jsxs("div",{className:"modal-body",style:{padding:"1.5rem"},children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"rgba(255,255,255,0.8)"},children:"Stil *"}),e.jsx("input",{type:"text",value:j.stil_name,onChange:e=>w({...j,stil_name:e.target.value}),placeholder:"z.B. Karate, Judo, Taekwondo...",style:{width:"100%",padding:"0.75rem",background:"#1a1a1a",border:"1px solid rgba(255, 215, 0, 0.3)",borderRadius:"8px",color:"#fff"}})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"rgba(255,255,255,0.8)"},children:"Graduierung *"}),e.jsx("input",{type:"text",value:j.graduierung_name,onChange:e=>w({...j,graduierung_name:e.target.value}),placeholder:"z.B. Gelbgurt, 5. Kyu, 1. Dan...",style:{width:"100%",padding:"0.75rem",background:"#1a1a1a",border:"1px solid rgba(255, 215, 0, 0.3)",borderRadius:"8px",color:"#fff"}})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"rgba(255,255,255,0.8)"},children:"Datum *"}),e.jsx("input",{type:"date",value:j.pruefungsdatum,onChange:e=>w({...j,pruefungsdatum:e.target.value}),style:{width:"100%",padding:"0.75rem",background:"#1a1a1a",border:"1px solid rgba(255, 215, 0, 0.3)",borderRadius:"8px",color:"#fff"}})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"rgba(255,255,255,0.8)"},children:"Bemerkung (optional)"}),e.jsx("input",{type:"text",value:j.bemerkung,onChange:e=>w({...j,bemerkung:e.target.value}),placeholder:"Optional...",style:{width:"100%",padding:"0.75rem",background:"#1a1a1a",border:"1px solid rgba(255, 215, 0, 0.3)",borderRadius:"8px",color:"#fff"}})]})]}),e.jsxs("div",{className:"modal-footer",style:{display:"flex",gap:"1rem",justifyContent:"flex-end",padding:"1rem 1.5rem"},children:[e.jsx("button",{onClick:()=>f(!1),style:{padding:"0.75rem 1.5rem",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",color:"#fff",cursor:"pointer"},children:"Abbrechen"}),e.jsx("button",{onClick:async()=>{if(j.stil_name&&j.graduierung_name&&j.pruefungsdatum)try{await l.post("/pruefungen-historisch",{mitglied_id:t,...j}),f(!1),T()}catch(e){console.error("Fehler beim Speichern:",e),alert("Fehler beim Speichern")}else alert("Bitte Stil, Graduierung und Datum eingeben")},style:{padding:"0.75rem 1.5rem",background:"linear-gradient(135deg, #FFD700, #FFA500)",border:"none",borderRadius:"8px",color:"#000",fontWeight:"600",cursor:"pointer"},children:"Speichern"})]})]})}),_.length>0&&e.jsxs("div",{className:"field-group card",style:{marginTop:"1rem"},children:[e.jsx("h3",{children:"ğŸ“œ Vergangene PrÃ¼fungen (vor SystemeinfÃ¼hrung)"}),e.jsx("div",{style:{overflowX:"auto",marginTop:"1rem"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.9rem"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"2px solid rgba(255, 215, 0, 0.3)"},children:[e.jsx("th",{style:{padding:"0.75rem",textAlign:"left",color:"#FFD700"},children:"Datum"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"left",color:"#FFD700"},children:"Stil"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"left",color:"#FFD700"},children:"Graduierung"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"left",color:"#FFD700"},children:"Bemerkung"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"center",color:"#FFD700"},children:"Aktion"})]})}),e.jsx("tbody",{children:_.map(t=>e.jsxs("tr",{style:{borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("td",{style:{padding:"0.75rem"},children:new Date(t.pruefungsdatum).toLocaleDateString("de-DE")}),e.jsx("td",{style:{padding:"0.75rem"},children:t.stil_name}),e.jsx("td",{style:{padding:"0.75rem"},children:t.graduierung_name}),e.jsx("td",{style:{padding:"0.75rem",color:"rgba(255,255,255,0.6)"},children:t.bemerkung||"-"}),e.jsx("td",{style:{padding:"0.75rem",textAlign:"center"},children:!r&&e.jsx("button",{onClick:()=>A(t.id),style:{background:"rgba(239, 68, 68, 0.2)",border:"1px solid #ef4444",padding:"0.25rem 0.5rem",borderRadius:"4px",color:"#ef4444",cursor:"pointer",fontSize:"0.8rem"},children:e.jsx(y,{size:14})})})]},t.id))})]})})]})]})},Y=({mitgliedId:t,mitglied:r,isAdmin:i=!1})=>{const[a,s]=n.useState([]),[d,o]=n.useState([]),[c,g]=n.useState(!0),[h,u]=n.useState(!1),[m,x]=n.useState(null),[p,b]=n.useState([]),[f,y]=n.useState(!1),[v,k]=n.useState(!1),[S,z]=n.useState(!1),[B,T]=n.useState(null),[A,E]=n.useState(null),[M,R]=n.useState({tarif_id:"",gekauft_am:(new Date).toISOString().split("T")[0],einheiten_gesamt:10});n.useEffect(()=>{t&&(L(),W())},[t]);const L=async()=>{try{g(!0);const e=await l.get(`/mitglieder/${t}/zehnerkarten`);e.data.success&&s(e.data.data||[])}catch(e){console.error("Fehler beim Laden der 10er-Karten:",e)}finally{g(!1)}},W=async()=>{var e;try{const t=await l.get("/tarife"),r=((null==(e=t.data)?void 0:e.data)||t.data||[]).filter(e=>e.name&&e.name.toLowerCase().includes("10er karte"));o(r)}catch(t){console.error("Fehler beim Laden der Tarife:",t)}},I=async e=>{try{y(!0);const t=await l.get(`/zehnerkarten/${e}/buchungen`);t.data.success&&b(t.data.data||[])}catch(t){console.error("Fehler beim Laden der Buchungen:",t)}finally{y(!1)}},$=t=>{switch(t){case"aktiv":return e.jsx(_,{size:20,color:"#10b981"});case"aufgebraucht":return e.jsx(F,{size:20,color:"#ef4444"});case"abgelaufen":return e.jsx(C,{size:20,color:"#f59e0b"});default:return e.jsx(w,{size:20})}},P=e=>{switch(e){case"aktiv":return"#10b981";case"aufgebraucht":return"#ef4444";case"abgelaufen":return"#f59e0b";default:return"#6b7280"}},V=e=>{if(!e)return"N/A";return new Date(e).toLocaleDateString("de-DE")};return c?e.jsxs("div",{style:{padding:"2rem",textAlign:"center"},children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Lade 10er-Karten..."})]}):e.jsxs("div",{style:{marginBottom:"2rem",background:"linear-gradient(135deg, rgba(30, 30, 40, 0.95) 0%, rgba(20, 20, 30, 0.98) 100%)",borderRadius:"16px",padding:"2rem",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.3)",border:"1px solid rgba(255, 255, 255, 0.05)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem",paddingBottom:"1rem",borderBottom:"2px solid rgba(255, 215, 0, 0.2)"},children:[e.jsx("h3",{style:{margin:0,fontSize:"1.8rem",fontWeight:"700",background:"linear-gradient(135deg, #FFD700 0%, #FFA500 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"10er-Karten Verwaltung"}),i&&e.jsx("button",{className:"neue-zehnerkarte-button",onClick:()=>u(!0),children:"â• Neue 10er-Karte"})]}),h&&i&&e.jsxs("div",{style:{background:"rgba(16, 185, 129, 0.08)",border:"2px solid rgba(16, 185, 129, 0.3)",borderRadius:"12px",padding:"1.5rem",marginBottom:"2rem"},children:[e.jsx("h4",{style:{color:"#10B981",marginTop:0,marginBottom:"1rem"},children:"Neue 10er-Karte erstellen"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",color:"rgba(255, 255, 255, 0.9)"},children:"Tarif *"}),e.jsxs("select",{value:M.tarif_id,onChange:e=>R({...M,tarif_id:e.target.value}),style:{width:"100%",padding:"0.5rem",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.2)",background:"rgba(255, 255, 255, 0.05)",color:"white",fontSize:"0.9rem"},children:[e.jsx("option",{value:"",children:"Tarif auswÃ¤hlen"}),d.map(t=>e.jsxs("option",{value:t.id,children:[t.name," - â‚¬",(t.price_cents/100).toFixed(2)]},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",color:"rgba(255, 255, 255, 0.9)"},children:"Kaufdatum"}),e.jsx("input",{type:"date",value:M.gekauft_am,onChange:e=>R({...M,gekauft_am:e.target.value}),style:{width:"100%",padding:"0.5rem",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.2)",background:"rgba(255, 255, 255, 0.05)",color:"white",fontSize:"0.9rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",color:"rgba(255, 255, 255, 0.9)"},children:"Anzahl Einheiten"}),e.jsx("input",{type:"number",value:M.einheiten_gesamt,onChange:e=>R({...M,einheiten_gesamt:parseInt(e.target.value)||10}),min:"1",style:{width:"100%",padding:"0.5rem",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.2)",background:"rgba(255, 255, 255, 0.05)",color:"white",fontSize:"0.9rem"}})]})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("button",{onClick:async()=>{if(M.tarif_id)try{(await l.post(`/mitglieder/${t}/zehnerkarten`,M)).data.success&&(await L(),u(!1),R({tarif_id:"",gekauft_am:(new Date).toISOString().split("T")[0],einheiten_gesamt:10}),alert("âœ… 10er-Karte erfolgreich erstellt!"))}catch(e){console.error("Fehler beim Erstellen der 10er-Karte:",e),alert("âŒ Fehler beim Erstellen der 10er-Karte")}else alert("Bitte wÃ¤hlen Sie einen Tarif aus")},style:{background:"#10B981",color:"white",border:"none",borderRadius:"8px",padding:"0.75rem 1.5rem",fontSize:"0.9rem",fontWeight:"600",cursor:"pointer"},children:"Erstellen"}),e.jsx("button",{onClick:()=>u(!1),style:{background:"transparent",color:"#ef4444",border:"1px solid #ef4444",borderRadius:"8px",padding:"0.75rem 1.5rem",fontSize:"0.9rem",fontWeight:"600",cursor:"pointer"},children:"Abbrechen"})]})]}),0===a.length?e.jsxs("div",{style:{textAlign:"center",padding:"3rem",color:"rgba(255, 255, 255, 0.6)"},children:[e.jsx(w,{size:64,style:{opacity:.3,marginBottom:"1rem"}}),e.jsx("p",{style:{fontSize:"1.1rem",margin:0},children:"Keine 10er-Karten vorhanden"}),i&&e.jsx("p",{style:{fontSize:"0.9rem",marginTop:"0.5rem"},children:'Klicken Sie auf "Neue 10er-Karte", um eine zu erstellen'})]}):e.jsx("div",{style:{display:"grid",gap:"1.5rem"},children:a.map(t=>{const r=(t.einheiten_gesamt-t.einheiten_verbleibend)/t.einheiten_gesamt*100;new Date(t.gueltig_bis);const n=m===t.id;return e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.03)",border:`2px solid ${P(t.status)}`,borderRadius:"12px",padding:"1.5rem",transition:"all 0.3s ease"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[$(t.status),e.jsxs("div",{children:[e.jsx("h4",{style:{margin:0,fontSize:"1.2rem",color:"#10B981",fontWeight:"700"},children:t.tarif_name||"Unbekannter Tarif"}),e.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",color:"rgba(255, 255, 255, 0.6)"},children:["Gekauft am ",V(t.gekauft_am)," â€¢ GÃ¼ltig bis ",V(t.gueltig_bis)]})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("span",{style:{padding:"0.4rem 1rem",borderRadius:"20px",fontSize:"0.85rem",fontWeight:"600",background:`${P(t.status)}20`,color:P(t.status),border:`1px solid ${P(t.status)}`},children:t.status.toUpperCase()}),i&&"aktiv"===t.status&&e.jsxs("button",{onClick:()=>(async e=>{var t,r;if(window.confirm("MÃ¶chten Sie einen Check-in fÃ¼r heute durchfÃ¼hren?"))try{const t=await l.post(`/zehnerkarten/${e}/checkin`,{buchungsdatum:(new Date).toISOString().split("T")[0],notiz:"Check-in"});if(t.data.success)if(await L(),m===e&&await I(e),t.data.isLastUnit){const t=a.find(t=>t.id===e);t&&(T(t.tarif_id),k(!0))}else alert(t.data.message||"âœ… Check-in erfolgreich!")}catch(n){console.error("Fehler beim Check-in:",n),alert((null==(r=null==(t=n.response)?void 0:t.data)?void 0:r.error)||"âŒ Fehler beim Check-in")}})(t.id),title:"Check-in durchfÃ¼hren",style:{background:"#10B981",color:"white",border:"none",borderRadius:"8px",padding:"0.5rem 1rem",fontSize:"0.85rem",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(_,{size:16}),"Check-in"]}),e.jsxs("button",{onClick:()=>(async e=>{m===e?(x(null),b([])):(x(e),await I(e))})(t.id),style:{background:"transparent",color:"#10B981",border:"1px solid #10B981",borderRadius:"8px",padding:"0.5rem 1rem",fontSize:"0.85rem",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(N,{size:16}),n?"Verbergen":"Historie"]}),i&&e.jsx("button",{onClick:()=>(async e=>{var t,r;if(window.confirm("MÃ¶chten Sie diese 10er-Karte wirklich lÃ¶schen? Dies ist nur mÃ¶glich, wenn noch keine Buchungen vorhanden sind."))try{(await l.delete(`/zehnerkarten/${e}`)).data.success&&(await L(),m===e&&(x(null),b([])),alert("âœ… 10er-Karte erfolgreich gelÃ¶scht"))}catch(n){console.error("Fehler beim LÃ¶schen:",n),alert((null==(r=null==(t=n.response)?void 0:t.data)?void 0:r.error)||"âŒ Fehler beim LÃ¶schen der 10er-Karte")}})(t.id),title:"LÃ¶schen",style:{background:"transparent",color:"#ef4444",border:"1px solid #ef4444",borderRadius:"8px",padding:"0.5rem",cursor:"pointer"},children:e.jsx(j,{size:16})})]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[e.jsxs("span",{style:{fontSize:"0.9rem",color:"rgba(255, 255, 255, 0.8)"},children:["Verbleibend: ",t.einheiten_verbleibend," / ",t.einheiten_gesamt]}),e.jsxs("span",{style:{fontSize:"0.9rem",color:"#10B981",fontWeight:"600"},children:[Math.round(r),"% genutzt"]})]}),e.jsx("div",{style:{width:"100%",height:"12px",background:"rgba(255, 255, 255, 0.1)",borderRadius:"6px",overflow:"hidden"},children:e.jsx("div",{style:{width:`${r}%`,height:"100%",background:"aktiv"===t.status?"linear-gradient(90deg, #10B981 0%, #34D399 100%)":"aufgebraucht"===t.status?"linear-gradient(90deg, #ef4444 0%, #f87171 100%)":"linear-gradient(90deg, #f59e0b 0%, #fbbf24 100%)",transition:"width 0.5s ease",borderRadius:"6px"}})})]}),n&&e.jsxs("div",{style:{marginTop:"1.5rem",paddingTop:"1.5rem",borderTop:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("h5",{style:{margin:"0 0 1rem 0",fontSize:"1rem",color:"#10B981",fontWeight:"600"},children:"ğŸ“… Check-in Historie"}),f?e.jsx("div",{style:{textAlign:"center",padding:"1rem"},children:"Lade Buchungen..."}):0===p.length?e.jsx("div",{style:{textAlign:"center",padding:"1rem",color:"rgba(255, 255, 255, 0.6)",fontSize:"0.9rem"},children:"Noch keine Check-ins durchgefÃ¼hrt"}):e.jsx("div",{style:{maxHeight:"300px",overflowY:"auto",background:"rgba(0, 0, 0, 0.2)",borderRadius:"8px",padding:"0.5rem"},children:p.map((t,r)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.75rem",background:r%2==0?"rgba(255, 255, 255, 0.03)":"transparent",borderRadius:"6px",fontSize:"0.9rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(D,{size:16,color:"#10B981"}),e.jsx("span",{style:{color:"rgba(255, 255, 255, 0.9)"},children:V(t.buchungsdatum)}),t.notiz&&e.jsxs("span",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.6)",fontStyle:"italic"},children:["(",t.notiz,")"]})]}),e.jsxs("span",{style:{padding:"0.25rem 0.75rem",borderRadius:"12px",background:"rgba(16, 185, 129, 0.2)",color:"#10B981",fontSize:"0.8rem",fontWeight:"600"},children:["-",t.einheiten," Einheit"]})]},t.id))})]})]},t.id)})}),v&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:e.jsxs("div",{style:{background:"linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%)",borderRadius:"16px",padding:"2.5rem",maxWidth:"500px",width:"90%",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.5)",border:"2px solid rgba(16, 185, 129, 0.3)",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"4rem",marginBottom:"1rem"},children:"ğŸ«"}),e.jsx("h2",{style:{color:"#10B981",fontSize:"1.8rem",marginBottom:"1rem",fontWeight:"700"},children:"10er-Karte aufgebraucht!"}),e.jsxs("p",{style:{color:"rgba(255, 255, 255, 0.9)",fontSize:"1.1rem",marginBottom:"2rem",lineHeight:"1.6"},children:["Ihre 10er-Karte ist nun vollstÃ¤ndig verbraucht.",e.jsx("br",{}),"MÃ¶chten Sie eine neue 10er-Karte kaufen?"]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"center"},children:[e.jsx("button",{onClick:()=>{k(!1),z(!0)},style:{background:"linear-gradient(135deg, #10B981 0%, #34D399 100%)",color:"white",border:"none",borderRadius:"12px",padding:"1rem 2.5rem",fontSize:"1.1rem",fontWeight:"700",cursor:"pointer",boxShadow:"0 4px 15px rgba(16, 185, 129, 0.4)",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 20px rgba(16, 185, 129, 0.5)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 15px rgba(16, 185, 129, 0.4)"},children:"âœ… Ja, neue Karte kaufen"}),e.jsx("button",{onClick:()=>{k(!1),T(null)},style:{background:"transparent",color:"#ef4444",border:"2px solid #ef4444",borderRadius:"12px",padding:"1rem 2.5rem",fontSize:"1.1rem",fontWeight:"700",cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.background="#ef4444",e.currentTarget.style.color="white"},onMouseLeave:e=>{e.currentTarget.style.background="transparent",e.currentTarget.style.color="#ef4444"},children:"âŒ Nein, danke"})]})]})}),S&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10001},children:e.jsxs("div",{style:{background:"linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%)",borderRadius:"16px",padding:"2.5rem",maxWidth:"600px",width:"90%",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.5)",border:"2px solid rgba(16, 185, 129, 0.3)"},children:[e.jsx("h2",{style:{color:"#10B981",fontSize:"1.8rem",marginBottom:"1.5rem",fontWeight:"700",textAlign:"center"},children:"ğŸ’³ Zahlungsart wÃ¤hlen"}),e.jsxs("div",{style:{display:"grid",gap:"1rem",marginBottom:"2rem"},children:[e.jsx("div",{onClick:()=>E("bar"),style:{background:"bar"===A?"linear-gradient(135deg, rgba(16, 185, 129, 0.2) 0%, rgba(52, 211, 153, 0.2) 100%)":"rgba(255, 255, 255, 0.03)",border:"bar"===A?"2px solid #10B981":"2px solid rgba(255, 255, 255, 0.1)",borderRadius:"12px",padding:"1.5rem",cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:e=>{"bar"!==A&&(e.currentTarget.style.borderColor="rgba(16, 185, 129, 0.5)")},onMouseLeave:e=>{"bar"!==A&&(e.currentTarget.style.borderColor="rgba(255, 255, 255, 0.1)")},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx("div",{style:{fontSize:"2.5rem"},children:"ğŸ’µ"}),e.jsxs("div",{style:{flex:1},children:[e.jsx("h4",{style:{margin:0,fontSize:"1.2rem",color:"#10B981",fontWeight:"700"},children:"Barzahlung"}),e.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.9rem",color:"rgba(255, 255, 255, 0.7)"},children:"Der Admin wird informiert, dass Sie bar bezahlen mÃ¶chten"})]}),"bar"===A&&e.jsx(_,{size:32,color:"#10B981"})]})}),e.jsx("div",{onClick:()=>E("lastschrift"),style:{background:"lastschrift"===A?"linear-gradient(135deg, rgba(16, 185, 129, 0.2) 0%, rgba(52, 211, 153, 0.2) 100%)":"rgba(255, 255, 255, 0.03)",border:"lastschrift"===A?"2px solid #10B981":"2px solid rgba(255, 255, 255, 0.1)",borderRadius:"12px",padding:"1.5rem",cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:e=>{"lastschrift"!==A&&(e.currentTarget.style.borderColor="rgba(16, 185, 129, 0.5)")},onMouseLeave:e=>{"lastschrift"!==A&&(e.currentTarget.style.borderColor="rgba(255, 255, 255, 0.1)")},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx("div",{style:{fontSize:"2.5rem"},children:"ğŸ¦"}),e.jsxs("div",{style:{flex:1},children:[e.jsx("h4",{style:{margin:0,fontSize:"1.2rem",color:"#10B981",fontWeight:"700"},children:"SEPA-Lastschrift"}),e.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.9rem",color:"rgba(255, 255, 255, 0.7)"},children:"Der Betrag wird bei der nÃ¤chsten Lastschrift eingezogen"})]}),"lastschrift"===A&&e.jsx(_,{size:32,color:"#10B981"})]})}),e.jsx("div",{onClick:()=>E("rechnung"),style:{background:"rechnung"===A?"linear-gradient(135deg, rgba(16, 185, 129, 0.2) 0%, rgba(52, 211, 153, 0.2) 100%)":"rgba(255, 255, 255, 0.03)",border:"rechnung"===A?"2px solid #10B981":"2px solid rgba(255, 255, 255, 0.1)",borderRadius:"12px",padding:"1.5rem",cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:e=>{"rechnung"!==A&&(e.currentTarget.style.borderColor="rgba(16, 185, 129, 0.5)")},onMouseLeave:e=>{"rechnung"!==A&&(e.currentTarget.style.borderColor="rgba(255, 255, 255, 0.1)")},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx("div",{style:{fontSize:"2.5rem"},children:"ğŸ“§"}),e.jsxs("div",{style:{flex:1},children:[e.jsx("h4",{style:{margin:0,fontSize:"1.2rem",color:"#10B981",fontWeight:"700"},children:"Rechnung per E-Mail"}),e.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.9rem",color:"rgba(255, 255, 255, 0.7)"},children:"Sie erhalten eine Rechnung per E-Mail"})]}),"rechnung"===A&&e.jsx(_,{size:32,color:"#10B981"})]})})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"center"},children:[e.jsx("button",{onClick:async()=>{var e,r;if(A)try{if((await l.post("/zehnerkarten/nachkauf",{mitglied_id:t,tarif_id:B,zahlungsart:A,einheiten_gesamt:10})).data.success){await L(),z(!1),k(!1),E(null),T(null);let e="âœ… 10er-Karte erfolgreich erstellt!\n\n";"bar"===A?e+="ğŸ’µ Hinweis: Der Admin wurde Ã¼ber die Barzahlung informiert.":"lastschrift"===A?e+="ğŸ¦ Der Betrag wird bei der nÃ¤chsten SEPA-Buchung eingezogen.":"rechnung"===A&&(e+="ğŸ“§ Die Rechnung wird per E-Mail versendet."),alert(e)}}catch(n){console.error("Fehler beim Nachkauf:",n),alert((null==(r=null==(e=n.response)?void 0:e.data)?void 0:r.error)||"âŒ Fehler beim Erstellen der 10er-Karte")}else alert("Bitte wÃ¤hlen Sie eine Zahlungsart aus")},disabled:!A,style:{background:A?"linear-gradient(135deg, #10B981 0%, #34D399 100%)":"rgba(255, 255, 255, 0.1)",color:A?"white":"rgba(255, 255, 255, 0.5)",border:"none",borderRadius:"12px",padding:"1rem 2.5rem",fontSize:"1.1rem",fontWeight:"700",cursor:A?"pointer":"not-allowed",boxShadow:A?"0 4px 15px rgba(16, 185, 129, 0.4)":"none",transition:"all 0.3s ease"},onMouseEnter:e=>{A&&(e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 20px rgba(16, 185, 129, 0.5)")},onMouseLeave:e=>{A&&(e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 15px rgba(16, 185, 129, 0.4)")},children:"âœ… BestÃ¤tigen"}),e.jsx("button",{onClick:()=>{z(!1),E(null),T(null)},style:{background:"transparent",color:"#ef4444",border:"2px solid #ef4444",borderRadius:"12px",padding:"1rem 2.5rem",fontSize:"1.1rem",fontWeight:"700",cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.background="#ef4444",e.currentTarget.style.color="white"},onMouseLeave:e=>{e.currentTarget.style.background="transparent",e.currentTarget.style.color="#ef4444"},children:"âŒ Abbrechen"})]})]})})]})},Z=({mitgliedId:t})=>e.jsxs("div",{className:"referral-code-verwaltung",children:[e.jsx("h3",{children:"Empfehlungscode"}),e.jsx("p",{children:"Empfehlen Sie Freunde und erhalten Sie Boni"})]}),q=[{value:"Wie lautet der MÃ¤dchen- oder Jungenname Ihrer Mutter?",label:"Wie lautet der MÃ¤dchen- oder Jungenname Ihrer Mutter?"},{value:"Wie heiÃŸt Ihr erstes Haustier?",label:"Wie heiÃŸt Ihr erstes Haustier?"},{value:"In welcher Stadt wurden Sie geboren?",label:"In welcher Stadt wurden Sie geboren?"},{value:"Wie lautet der Name Ihrer Grundschule?",label:"Wie lautet der Name Ihrer Grundschule?"},{value:"Wie lautet der zweite Vorname Ihres Vaters?",label:"Wie lautet der zweite Vorname Ihres Vaters?"}],J=({CustomSelect:t,onError:r})=>{const[i,a]=n.useState(""),[s,d]=n.useState(""),[o,c]=n.useState(""),[g,h]=n.useState(!1),[u,m]=n.useState(!1),[x,p]=n.useState(!1),[b,f]=n.useState(q[0].value),[j,y]=n.useState(""),[v,k]=n.useState(!1),[S,z]=n.useState(null),w=t||(({value:t,onChange:r,options:n})=>e.jsx("select",{className:"mitglied-detail-input",value:t,onChange:r,children:n.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))}));return e.jsx("div",{className:"grid-container",children:e.jsxs("div",{className:"field-group card mitglied-detail-card",style:{borderRadius:"16px",padding:"2rem"},children:[e.jsx("h3",{children:"Passwort & Sicherheitsfrage"}),e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("label",{children:"Aktuelles Passwort:"}),e.jsxs("div",{className:"password-wrapper",style:{position:"relative"},children:[e.jsx("input",{className:"mitglied-detail-input",type:g?"text":"password",value:i,onChange:e=>a(e.target.value),placeholder:"Aktuelles Passwort",disabled:v}),e.jsx("button",{type:"button",className:"password-toggle-btn",onClick:()=>h(!g),children:g?"ğŸ‘ï¸":"â€¢â€¢â€¢â€¢â€¢â€¢â€¢"})]})]}),e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("label",{children:"Neues Passwort:"}),e.jsxs("div",{className:"password-wrapper",style:{position:"relative"},children:[e.jsx("input",{className:"mitglied-detail-input "+(i?"":"disabled"),type:u?"text":"password",value:s,onChange:e=>d(e.target.value),placeholder:"Neues Passwort",disabled:!i||v}),e.jsx("button",{type:"button",className:"password-toggle-btn",onClick:()=>m(!u),children:u?"ğŸ‘ï¸":"â€¢â€¢â€¢â€¢â€¢â€¢â€¢"})]}),!i&&e.jsx("small",{className:"input-hint mitglied-detail-hint-warning",children:"â„¹ï¸ Bitte zuerst das aktuelle Passwort eingeben"}),i&&e.jsx("small",{className:"input-hint",children:"Mind. 8 Zeichen, mindestens 1 Zahl und 1 Sonderzeichen."})]}),e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("label",{children:"Neues Passwort bestÃ¤tigen:"}),e.jsxs("div",{className:"password-wrapper",style:{position:"relative"},children:[e.jsx("input",{className:"mitglied-detail-input "+(i?"":"disabled"),type:x?"text":"password",value:o,onChange:e=>c(e.target.value),placeholder:"Passwort bestÃ¤tigen",disabled:!i||v}),e.jsx("button",{type:"button",className:"password-toggle-btn",onClick:()=>p(!x),children:x?"ğŸ‘ï¸":"â€¢â€¢â€¢â€¢â€¢â€¢â€¢"})]})]}),e.jsxs("div",{style:{marginBottom:"1.25rem"},children:[e.jsx("label",{children:"Sicherheitsfrage:"}),e.jsx(w,{value:b,onChange:e=>f(e.target.value),options:q})]}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("label",{children:"Antwort auf Sicherheitsfrage:"}),e.jsx("input",{className:"mitglied-detail-input",type:"text",value:j,onChange:e=>y(e.target.value),placeholder:"Antwort",disabled:v})]}),e.jsxs("div",{className:"mitglied-detail-actions",style:{display:"flex",flexWrap:"wrap",gap:"0.75rem",marginTop:"1.5rem"},children:[e.jsxs("button",{className:"mitglied-detail-btn mitglied-detail-btn-primary "+(i&&s&&o&&!v?"":"disabled"),onClick:async()=>{var e,t,n;if(z(null),(e=>{const t=/\d/.test(e),r=/[!@#$%^&*(),.?":{}|<>_+\-=/\\\[\];'`~]/.test(e);return e&&e.length>=8&&t&&r})(s))if(s===o){k(!0);try{const t=await l.post("/auth/change-password",{currentPassword:i,newPassword:s});z({type:"success",text:(null==(e=t.data)?void 0:e.message)||"Passwort geÃ¤ndert."}),a(""),d(""),c("")}catch(g){const e=(null==(n=null==(t=g.response)?void 0:t.data)?void 0:n.message)||"Ã„nderung fehlgeschlagen.";z({type:"error",text:e}),null==r||r(e)}finally{k(!1)}}else z({type:"error",text:"Die PasswÃ¶rter stimmen nicht Ã¼berein."});else z({type:"error",text:"Neues Passwort entspricht nicht der Richtlinie."})},disabled:!i||!s||!o||v,children:[v?"â³":"ğŸ”’"," Passwort Ã„ndern"]}),e.jsx("button",{className:"mitglied-detail-btn mitglied-detail-btn-secondary "+(v?"disabled":""),onClick:async()=>{var e,t,n;if(z(null),j.trim()){k(!0);try{const t=await l.post("/auth/security",{securityQuestion:b,securityAnswer:j});z({type:"success",text:(null==(e=t.data)?void 0:e.message)||"Sicherheitsfrage gespeichert."})}catch(i){const e=(null==(n=null==(t=i.response)?void 0:t.data)?void 0:n.message)||"Speichern fehlgeschlagen.";z({type:"error",text:e}),null==r||r(e)}finally{k(!1)}}else z({type:"error",text:"Bitte eine Antwort auf die Sicherheitsfrage angeben."})},disabled:v,children:"ğŸ‘ï¸ Sicherheitsfrage speichern"})]}),S&&e.jsxs("div",{className:"mitglied-detail-message "+("error"===S.type?"error":"success"),style:{marginTop:"1.25rem",padding:"1rem",borderRadius:"10px",display:"flex",alignItems:"center",gap:"0.75rem",fontSize:"0.95rem"},children:[e.jsx("span",{style:{fontSize:"1.2rem"},children:"error"===S.type?"âŒ":"âœ…"}),S.text]})]})})},X=({mitgliedId:t,dojoId:r,editMode:i,onError:a})=>{const[s,d]=n.useState([]),[o,c]=n.useState(!1),[g,h]=n.useState(null),[u,m]=n.useState({art:"Lehrgang",bezeichnung:"",datum:"",lizenz:""}),[x,p]=n.useState(!1);n.useEffect(()=>{t&&b()},[t]);const b=async()=>{p(!0);try{const e=await l.get(`/ehrungen-lehrgaenge/mitglied/${t}`);e.data.success&&d(e.data.data||[])}catch(e){console.error("Fehler beim Laden der Zusatzdaten:",e),null==a||a("Fehler beim Laden der Zusatzdaten")}finally{p(!1)}},f=()=>{c(!1),h(null),m({art:"Lehrgang",bezeichnung:"",datum:"",lizenz:""})};return e.jsxs("div",{className:"zusatzdaten-content",style:{padding:"1rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem",paddingBottom:"1rem",borderBottom:"2px solid rgba(255, 215, 0, 0.2)"},children:[e.jsx("h2",{style:{margin:0,color:"#FFD700",fontSize:"1.5rem",fontWeight:"700"},children:"LehrgÃ¤nge & Ehrungen"}),i&&e.jsx("button",{onClick:()=>{h(null),m({art:"Lehrgang",bezeichnung:"",datum:"",lizenz:""}),c(!0)},style:{padding:"0.6rem 1.2rem",background:"linear-gradient(135deg, #FFD700, #FFA500)",border:"none",borderRadius:"8px",color:"#000",fontWeight:"600",cursor:"pointer",fontSize:"0.9rem"},children:"+ Neuer Eintrag"})]}),x&&e.jsx("div",{style:{textAlign:"center",padding:"2rem",color:"rgba(255, 255, 255, 0.6)"},children:"Lade Daten..."}),!x&&0===s.length&&e.jsxs("div",{style:{textAlign:"center",padding:"3rem",color:"rgba(255, 255, 255, 0.6)"},children:[e.jsx("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"ğŸ“‹"}),e.jsx("p",{children:"Noch keine LehrgÃ¤nge oder Ehrungen erfasst."}),i&&e.jsx("p",{style:{fontSize:"0.9rem"},children:'Klicken Sie auf "Neuer Eintrag" um einen hinzuzufÃ¼gen.'})]}),!x&&s.length>0&&e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.9rem"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"2px solid rgba(255, 215, 0, 0.3)"},children:[e.jsx("th",{style:{padding:"0.75rem",textAlign:"left",color:"#FFD700"},children:"Datum"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"left",color:"#FFD700"},children:"Art"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"left",color:"#FFD700"},children:"Bezeichnung"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"left",color:"#FFD700"},children:"Lizenz"}),i&&e.jsx("th",{style:{padding:"0.75rem",textAlign:"center",color:"#FFD700"},children:"Aktion"})]})}),e.jsx("tbody",{children:s.map(t=>{const r=(e=>{switch(e){case"Ehrung":return{background:"rgba(255, 215, 0, 0.2)",color:"#FFD700"};case"Seminar":return{background:"rgba(59, 130, 246, 0.2)",color:"#3b82f6"};case"Lehrgang":return{background:"rgba(16, 185, 129, 0.2)",color:"#10b981"};default:return{background:"rgba(139, 92, 246, 0.2)",color:"#8b5cf6"}}})(t.art);return e.jsxs("tr",{style:{borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("td",{style:{padding:"0.75rem"},children:new Date(t.datum).toLocaleDateString("de-DE")}),e.jsx("td",{style:{padding:"0.75rem"},children:e.jsx("span",{style:{padding:"0.2rem 0.6rem",borderRadius:"4px",fontSize:"0.8rem",...r},children:t.art})}),e.jsx("td",{style:{padding:"0.75rem"},children:t.bezeichnung}),e.jsx("td",{style:{padding:"0.75rem",color:"rgba(255,255,255,0.6)"},children:t.lizenz||"-"}),i&&e.jsx("td",{style:{padding:"0.75rem",textAlign:"center"},children:e.jsx("button",{onClick:()=>(async e=>{var t,r;if(window.confirm(`"${e.bezeichnung}" wirklich lÃ¶schen?`))try{await l.delete(`/ehrungen-lehrgaenge/${e.id}`),d(s.filter(t=>t.id!==e.id))}catch(n){console.error("Fehler beim LÃ¶schen:",n);const e="Fehler beim LÃ¶schen: "+((null==(r=null==(t=n.response)?void 0:t.data)?void 0:r.error)||n.message);alert(e),null==a||a(e)}})(t),style:{background:"rgba(239, 68, 68, 0.2)",border:"1px solid #ef4444",padding:"0.25rem 0.5rem",borderRadius:"4px",color:"#ef4444",cursor:"pointer",fontSize:"0.8rem"},children:"LÃ¶schen"})})]},t.id)})})]})}),o&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},onClick:f,children:e.jsxs("div",{onClick:e=>e.stopPropagation(),style:{background:"linear-gradient(145deg, #1a1a2e 0%, #16213e 100%)",borderRadius:"16px",width:"90%",maxWidth:"450px",border:"1px solid rgba(255, 215, 0, 0.3)",boxShadow:"0 20px 60px rgba(0,0,0,0.5)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"1rem 1.5rem",borderBottom:"1px solid rgba(255, 215, 0, 0.2)"},children:[e.jsx("h3",{style:{color:"#FFD700",margin:0},children:g?"Eintrag bearbeiten":"Neuer Eintrag"}),e.jsx("button",{onClick:f,style:{background:"transparent",border:"none",color:"#fff",cursor:"pointer",fontSize:"1.5rem"},children:"Ã—"})]}),e.jsxs("div",{style:{padding:"1.5rem"},children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"rgba(255,255,255,0.8)"},children:"Datum *"}),e.jsx("input",{type:"date",value:u.datum,onChange:e=>m({...u,datum:e.target.value}),style:{width:"100%",padding:"0.75rem",background:"#1a1a1a",border:"1px solid rgba(255, 215, 0, 0.3)",borderRadius:"8px",color:"#fff"}})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"rgba(255,255,255,0.8)"},children:"Art *"}),e.jsxs("select",{value:u.art,onChange:e=>m({...u,art:e.target.value}),style:{width:"100%",padding:"0.75rem",background:"#1a1a1a",border:"1px solid rgba(255, 215, 0, 0.3)",borderRadius:"8px",color:"#fff"},children:[e.jsx("option",{value:"Lehrgang",children:"Lehrgang"}),e.jsx("option",{value:"Seminar",children:"Seminar"}),e.jsx("option",{value:"Ehrung",children:"Ehrung"})]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"rgba(255,255,255,0.8)"},children:"Bezeichnung *"}),e.jsx("input",{type:"text",value:u.bezeichnung,onChange:e=>m({...u,bezeichnung:e.target.value}),placeholder:"z.B. Dan-Lehrgang, Trainer C-Lizenz...",style:{width:"100%",padding:"0.75rem",background:"#1a1a1a",border:"1px solid rgba(255, 215, 0, 0.3)",borderRadius:"8px",color:"#fff"}})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"rgba(255,255,255,0.8)"},children:"Lizenz (optional)"}),e.jsx("input",{type:"text",value:u.lizenz,onChange:e=>m({...u,lizenz:e.target.value}),placeholder:"z.B. Trainer C, Ãœbungsleiter B...",style:{width:"100%",padding:"0.75rem",background:"#1a1a1a",border:"1px solid rgba(255, 215, 0, 0.3)",borderRadius:"8px",color:"#fff"}})]})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"flex-end",padding:"1rem 1.5rem",borderTop:"1px solid rgba(255, 215, 0, 0.2)"},children:[e.jsx("button",{onClick:f,style:{padding:"0.75rem 1.5rem",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",color:"#fff",cursor:"pointer"},children:"Abbrechen"}),e.jsx("button",{onClick:async()=>{var e,n;try{g?await l.put(`/ehrungen-lehrgaenge/${g.id}`,u):await l.post("/ehrungen-lehrgaenge",{...u,mitglied_id:t,dojo_id:r}),await b(),f()}catch(i){console.error("Fehler beim Speichern:",i);const t="Fehler beim Speichern: "+((null==(n=null==(e=i.response)?void 0:e.data)?void 0:n.error)||i.message);alert(t),null==a||a(t)}},style:{padding:"0.75rem 1.5rem",background:"linear-gradient(135deg, #FFD700, #FFA500)",border:"none",borderRadius:"8px",color:"#000",fontWeight:"600",cursor:"pointer"},children:"Speichern"})]})]})})]})},Q=["NÃ¼sse/ErdnÃ¼sse","Milch/Laktose","Gluten/Weizen","Eier","Fisch/MeeresfrÃ¼chte","Soja","Insektenstiche (Bienen/Wespen)","Medikamente (Penicillin etc.)","Latex","Pollen/Heuschnupfen","Hausstaub/Milben","Tierhaare","Sonstiges"],ee=[{value:"",label:"Bitte wÃ¤hlen"},{value:"Elternteil",label:"Elternteil"},{value:"Partner/in",label:"Partner/in"},{value:"Geschwister",label:"Geschwister"},{value:"Freund/in",label:"Freund/in"},{value:"Arzt",label:"Hausarzt"},{value:"Sonstiges",label:"Sonstiges"}],te=({mitglied:t,updatedData:r,editMode:n,handleChange:i,CustomSelect:a,allergien:s=[],allergienArchiv:l=[],newAllergie:d={type:"",custom:""},setNewAllergie:o,addAllergie:c,removeAllergie:g})=>{const h=a||(({value:t,onChange:r,options:n,className:i})=>e.jsx("select",{className:i,value:t,onChange:r,children:n.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))}));return e.jsxs("div",{className:"medizinisch-container",children:[e.jsxs("div",{className:"field-group card",children:[e.jsx("h3",{children:"Medizinische Informationen"}),e.jsxs("div",{className:"allergie-management",children:[e.jsx("label",{children:"Allergien:"}),n?e.jsxs("div",{className:"allergien-editor",children:[e.jsx("div",{className:"allergien-liste",children:0===s.length?e.jsx("p",{className:"no-allergien",children:"Keine Allergien erfasst"}):s.map(t=>e.jsxs("div",{className:"allergie-tag",children:[e.jsx("span",{className:"allergie-name",children:t.value}),e.jsx("button",{type:"button",className:"allergie-remove",onClick:()=>g(t.id),title:"Allergie archivieren",children:"x"})]},t.id))}),e.jsx("div",{className:"allergie-add-form",children:e.jsxs("div",{className:"add-form-controls",children:[e.jsx(h,{value:d.type,onChange:e=>o({...d,type:e.target.value}),className:"allergie-select",options:[{value:"",label:"Allergie auswÃ¤hlen..."},...Q.map(e=>({value:e,label:e}))]}),"Sonstiges"===d.type&&e.jsx("input",{type:"text",value:d.custom,onChange:e=>o({...d,custom:e.target.value}),placeholder:"Eigene Allergie eingeben...",className:"allergie-custom-input"}),e.jsx("button",{type:"button",onClick:c,className:"allergie-add-btn",disabled:!d.type||"Sonstiges"===d.type&&!d.custom.trim(),title:"Allergie hinzufÃ¼gen",children:"+ Hinzufuegen"})]})})]}):e.jsx("div",{className:"allergien-anzeige",children:0===s.length?e.jsx("span",{className:"no-allergien-display",children:"Keine Allergien bekannt"}):e.jsx("div",{className:"allergien-tags-readonly",children:s.map(t=>e.jsx("span",{className:"allergie-tag-readonly",children:t.value},t.id))})})]}),l&&l.length>0&&e.jsxs("div",{className:"allergie-archiv",style:{marginTop:"1rem",padding:"1rem",background:"rgba(255, 165, 0, 0.05)",borderRadius:"8px",border:"1px solid rgba(255, 165, 0, 0.2)"},children:[e.jsx("label",{style:{fontSize:"0.85rem",color:"rgba(255, 165, 0, 0.8)",fontWeight:"600",display:"block",marginBottom:"0.5rem"},children:"Archivierte Allergien (geloescht):"}),e.jsx("div",{className:"allergien-archiv-liste",style:{display:"flex",flexWrap:"wrap",gap:"0.5rem"},children:l.map((t,r)=>e.jsxs("div",{style:{background:"rgba(255, 165, 0, 0.1)",padding:"0.5rem 0.75rem",borderRadius:"4px",border:"1px solid rgba(255, 165, 0, 0.3)",fontSize:"0.85rem"},children:[e.jsx("span",{style:{color:"rgba(255, 255, 255, 0.7)"},children:t.value}),t.geloescht_am_readable&&e.jsxs("span",{style:{marginLeft:"0.5rem",fontSize:"0.75rem",color:"rgba(255, 165, 0, 0.6)",fontStyle:"italic"},children:["(geloescht: ",t.geloescht_am_readable,")"]})]},r))})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Medizinische Hinweise:"}),n?e.jsx("textarea",{rows:"3",value:r.medizinische_hinweise||"",onChange:e=>i(e,"medizinische_hinweise"),placeholder:"z.B. Asthma, Herzprobleme, Medikamente..."}):e.jsx("span",{children:t.medizinische_hinweise||"Keine"})]})]}),e.jsxs("div",{className:"field-group card",children:[e.jsx("h3",{children:"Notfallkontakte"}),e.jsx("div",{className:"emergency-contact-section",children:e.jsxs("div",{className:"contact-grid",children:[e.jsx("div",{className:"contact-header",children:e.jsxs("h4",{children:["Notfallkontakt 1 ",e.jsx("span",{className:"primary-badge",children:"Primaer"})]})}),e.jsxs("div",{children:[e.jsx("label",{children:"Name:"}),n?e.jsx("input",{type:"text",value:r.notfallkontakt_name||"",onChange:e=>i(e,"notfallkontakt_name"),placeholder:"Max Mustermann"}):e.jsx("span",{children:t.notfallkontakt_name||"Nicht angegeben"})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Telefon:"}),n?e.jsx("input",{type:"tel",value:r.notfallkontakt_telefon||"",onChange:e=>i(e,"notfallkontakt_telefon"),placeholder:"+49 123 456789"}):e.jsx("span",{children:t.notfallkontakt_telefon||"Nicht angegeben"})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Verhaeltnis:"}),n?e.jsx(h,{value:r.notfallkontakt_verhaeltnis||"",onChange:e=>i(e,"notfallkontakt_verhaeltnis"),options:ee}):e.jsx("span",{children:t.notfallkontakt_verhaeltnis||"Nicht angegeben"})]})]})}),e.jsx("div",{className:"emergency-contact-section",children:e.jsxs("div",{className:"contact-grid",children:[e.jsx("div",{className:"contact-header",children:e.jsx("h4",{children:"Notfallkontakt 2"})}),e.jsxs("div",{children:[e.jsx("label",{children:"Name:"}),n?e.jsx("input",{type:"text",value:r.notfallkontakt2_name||"",onChange:e=>i(e,"notfallkontakt2_name"),placeholder:"Maria Musterfrau"}):e.jsx("span",{children:t.notfallkontakt2_name||"Nicht angegeben"})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Telefon:"}),n?e.jsx("input",{type:"tel",value:r.notfallkontakt2_telefon||"",onChange:e=>i(e,"notfallkontakt2_telefon"),placeholder:"+49 123 456789"}):e.jsx("span",{children:t.notfallkontakt2_telefon||"Nicht angegeben"})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Verhaeltnis:"}),n?e.jsx(h,{value:r.notfallkontakt2_verhaeltnis||"",onChange:e=>i(e,"notfallkontakt2_verhaeltnis"),options:ee}):e.jsx("span",{children:t.notfallkontakt2_verhaeltnis||"Nicht angegeben"})]})]})}),e.jsx("div",{className:"emergency-contact-section",children:e.jsxs("div",{className:"contact-grid",children:[e.jsx("div",{className:"contact-header",children:e.jsx("h4",{children:"Notfallkontakt 3"})}),e.jsxs("div",{children:[e.jsx("label",{children:"Name:"}),n?e.jsx("input",{type:"text",value:r.notfallkontakt3_name||"",onChange:e=>i(e,"notfallkontakt3_name"),placeholder:"Dr. med. Beispiel"}):e.jsx("span",{children:t.notfallkontakt3_name||"Nicht angegeben"})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Telefon:"}),n?e.jsx("input",{type:"tel",value:r.notfallkontakt3_telefon||"",onChange:e=>i(e,"notfallkontakt3_telefon"),placeholder:"+49 123 456789"}):e.jsx("span",{children:t.notfallkontakt3_telefon||"Nicht angegeben"})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Verhaeltnis:"}),n?e.jsx(h,{value:r.notfallkontakt3_verhaeltnis||"",onChange:e=>i(e,"notfallkontakt3_verhaeltnis"),options:ee}):e.jsx("span",{children:t.notfallkontakt3_verhaeltnis||"Nicht angegeben"})]})]})}),e.jsx("div",{className:"info-box",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Hinweis:"})," Es wird empfohlen, mindestens einen Primaerkontakt anzugeben. Zusaetzliche Kontakte bieten mehr Sicherheit im Notfall."]})})]})]})},re=[{value:"",label:"Bitte waehlen"},{value:"Vater",label:"Vater"},{value:"Mutter",label:"Mutter"},{value:"Opa",label:"Opa"},{value:"Oma",label:"Oma"},{value:"sonstiger gesetzl. Vertreter",label:"Sonstiger gesetzl. Vertreter"}],ne=[{value:"",label:"Kein Rabatt"},{value:"Familie",label:"Familienrabatt"},{value:"Student",label:"Studenten-Rabatt"},{value:"Senior",label:"Senioren-Rabatt"},{value:"Geschwister",label:"Geschwister-Rabatt"},{value:"Sonstiges",label:"Sonstiges"}],ie={width:"100%",padding:"0.6rem",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"4px",color:"#fff",fontSize:"0.9rem"},ae={color:"rgba(255, 255, 255, 0.7)",fontWeight:"500",fontSize:"0.9rem"},se={display:"grid",gridTemplateColumns:"200px 1fr 250px 1fr",gap:"1rem",alignItems:"center",padding:"1rem",background:"rgba(255, 255, 255, 0.02)",borderRadius:"8px",border:"1px solid rgba(255, 255, 255, 0.1)"},le=({mitglied:t,updatedData:r,editMode:n,handleChange:i,CustomSelect:a})=>{const s=a||(({value:t,onChange:r,options:n})=>e.jsx("select",{value:t,onChange:r,style:ie,children:n.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))}));return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[e.jsxs("div",{className:"field-group card",children:[e.jsx("h3",{children:"Familienmanagement"}),e.jsxs("div",{children:[e.jsx("label",{children:"Familien-ID:"}),n?e.jsx("input",{type:"number",value:r.familien_id||"",onChange:e=>i(e,"familien_id"),placeholder:"z.B. 1001 (fuer Familienzuordnung)"}):e.jsx("span",{children:t.familien_id||"Keine Familienzuordnung"})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Rabatt (%):"}),n?e.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",value:r.rabatt_prozent||"",onChange:e=>i(e,"rabatt_prozent"),placeholder:"z.B. 15.50"}):e.jsx("span",{children:t.rabatt_prozent&&parseFloat(t.rabatt_prozent)>0?`${t.rabatt_prozent}%`:"Kein Rabatt"})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Rabatt-Grund:"}),n?e.jsx(s,{value:r.rabatt_grund||"",onChange:e=>i(e,"rabatt_grund"),options:ne}):e.jsx("span",{children:t.rabatt_grund||"Kein Rabatt"})]}),t.familien_id&&e.jsx("div",{className:"info-box",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Hinweis:"})," Dieses Mitglied ist der Familie ",t.familien_id," zugeordnet."]})})]}),e.jsxs("div",{className:"field-group card",style:{marginBottom:"1.5rem"},children:[e.jsx("h3",{style:{marginBottom:"1.5rem"},children:"Gesetzliche Vertreter"}),n?e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[e.jsxs("div",{style:se,children:[e.jsx("label",{style:ae,children:"Vertreter:"}),e.jsx("select",{value:r.vertreter1_typ||"",onChange:e=>i(e,"vertreter1_typ"),style:ie,children:re.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))}),e.jsx("label",{style:ae,children:"Telefon:"}),e.jsx("input",{type:"tel",value:r.vertreter1_telefon||"",onChange:e=>i(e,"vertreter1_telefon"),placeholder:"+49 123 456789",style:ie}),e.jsx("label",{style:ae,children:"Name:"}),e.jsx("input",{type:"text",value:r.vertreter1_name||"",onChange:e=>i(e,"vertreter1_name"),placeholder:"Vor- und Nachname",style:ie}),e.jsx("label",{style:ae,children:"E-Mail:"}),e.jsx("input",{type:"email",value:r.vertreter1_email||"",onChange:e=>i(e,"vertreter1_email"),placeholder:"vertreter@example.com",style:ie})]}),e.jsxs("div",{style:se,children:[e.jsx("label",{style:ae,children:"Vertreter:"}),e.jsx("select",{value:r.vertreter2_typ||"",onChange:e=>i(e,"vertreter2_typ"),style:ie,children:re.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))}),e.jsx("label",{style:ae,children:"Telefon:"}),e.jsx("input",{type:"tel",value:r.vertreter2_telefon||"",onChange:e=>i(e,"vertreter2_telefon"),placeholder:"+49 123 456789",style:ie}),e.jsx("label",{style:ae,children:"Name:"}),e.jsx("input",{type:"text",value:r.vertreter2_name||"",onChange:e=>i(e,"vertreter2_name"),placeholder:"Vor- und Nachname (optional)",style:ie}),e.jsx("label",{style:ae,children:"E-Mail:"}),e.jsx("input",{type:"email",value:r.vertreter2_email||"",onChange:e=>i(e,"vertreter2_email"),placeholder:"vertreter2@example.com",style:ie})]})]}):e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.9rem",minWidth:"600px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"2px solid rgba(255, 215, 0, 0.3)",background:"rgba(255, 215, 0, 0.05)"},children:[e.jsx("th",{style:{padding:"1rem",textAlign:"left",color:"#FFD700",fontWeight:"600",fontSize:"0.9rem",minWidth:"200px"},children:"Vertreter"}),e.jsx("th",{style:{padding:"1rem",textAlign:"left",color:"#FFD700",fontWeight:"600",fontSize:"0.9rem",minWidth:"200px"},children:"Name"}),e.jsx("th",{style:{padding:"1rem",textAlign:"left",color:"#FFD700",fontWeight:"600",fontSize:"0.9rem",minWidth:"180px"},children:"Telefon"}),e.jsx("th",{style:{padding:"1rem",textAlign:"left",color:"#FFD700",fontWeight:"600",fontSize:"0.9rem",minWidth:"250px"},children:"E-Mail"})]})}),e.jsxs("tbody",{children:[(t.vertreter1_name||t.vertreter1_typ)&&e.jsxs("tr",{style:{borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("td",{style:{padding:"1rem",color:"rgba(255, 255, 255, 0.9)"},children:t.vertreter1_typ||"Nicht angegeben"}),e.jsx("td",{style:{padding:"1rem",color:"rgba(255, 255, 255, 0.9)"},children:t.vertreter1_name||"Nicht angegeben"}),e.jsx("td",{style:{padding:"1rem",color:"rgba(255, 255, 255, 0.9)"},children:t.vertreter1_telefon||"Nicht angegeben"}),e.jsx("td",{style:{padding:"1rem",color:"rgba(255, 255, 255, 0.9)"},children:t.vertreter1_email||"Nicht angegeben"})]}),(t.vertreter2_name||t.vertreter2_typ)&&e.jsxs("tr",{style:{borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("td",{style:{padding:"1rem",color:"rgba(255, 255, 255, 0.9)"},children:t.vertreter2_typ||"Nicht angegeben"}),e.jsx("td",{style:{padding:"1rem",color:"rgba(255, 255, 255, 0.9)"},children:t.vertreter2_name||"Nicht angegeben"}),e.jsx("td",{style:{padding:"1rem",color:"rgba(255, 255, 255, 0.9)"},children:t.vertreter2_telefon||"Nicht angegeben"}),e.jsx("td",{style:{padding:"1rem",color:"rgba(255, 255, 255, 0.9)"},children:t.vertreter2_email||"Nicht angegeben"})]}),!t.vertreter1_name&&!t.vertreter1_typ&&!t.vertreter2_name&&!t.vertreter2_typ&&e.jsx("tr",{children:e.jsx("td",{colSpan:"4",style:{padding:"2rem",textAlign:"center",color:"rgba(255, 255, 255, 0.5)",fontStyle:"italic"},children:"Keine Vertreter eingetragen"})})]})]})}),e.jsx("div",{className:"info-box",style:{marginTop:"1rem"},children:e.jsxs("p",{children:[e.jsx("strong",{children:"Hinweis:"})," Vertreter-Informationen sind nur fuer minderjaehrige Mitglieder erforderlich oder wenn eine gesetzliche Vertretung vorliegt."]})})]})]})},de={award:p,star:V,trophy:B,medal:b,crown:P,flame:$,target:x,heart:I,users:W,swords:L,zap:R,"trending-up":m,footprints:M,layers:E,brain:A,shield:T},oe=({mitgliedId:t,compact:r=!1})=>{const[i,a]=n.useState([]),[s,l]=n.useState(!0);n.useEffect(()=>{t&&d()},[t]);const d=async()=>{try{const e=await fetch(`/api/badges/mitglied/${t}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(e.ok){const t=await e.json();a(t)}}catch(e){console.error("Fehler beim Laden der Badges:",e)}finally{l(!1)}},o=e=>de[e]||p;return s?e.jsx("div",{style:{padding:"1rem",textAlign:"center",color:"rgba(255,255,255,0.5)"},children:"Lade Badges..."}):0===i.length?r?null:e.jsx("div",{style:{padding:"1rem",textAlign:"center",color:"rgba(255,255,255,0.5)",background:"rgba(255,255,255,0.03)",borderRadius:"8px",border:"1px dashed rgba(255,255,255,0.1)"},children:"Noch keine Auszeichnungen erhalten"}):r?e.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[i.slice(0,6).map(t=>{const r=o(t.icon);return e.jsx("div",{title:`${t.name}: ${t.beschreibung||""}`,style:{width:"32px",height:"32px",borderRadius:"50%",background:`linear-gradient(135deg, ${t.farbe}40, ${t.farbe}20)`,border:`2px solid ${t.farbe}`,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"transform 0.2s ease, box-shadow 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.transform="scale(1.1)",e.currentTarget.style.boxShadow=`0 0 12px ${t.farbe}60`},onMouseLeave:e=>{e.currentTarget.style.transform="scale(1)",e.currentTarget.style.boxShadow="none"},children:e.jsx(r,{size:16,color:t.farbe})},t.id)}),i.length>6&&e.jsxs("div",{style:{width:"32px",height:"32px",borderRadius:"50%",background:"rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.7rem",color:"rgba(255,255,255,0.7)"},children:["+",i.length-6]})]}):e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",borderRadius:"12px",padding:"1rem",border:"1px solid rgba(255, 215, 0, 0.2)"},children:[e.jsxs("h3",{style:{fontSize:"0.9rem",color:"#ffd700",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(B,{size:18}),"Auszeichnungen (",i.length,")"]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(140px, 1fr))",gap:"0.75rem"},children:i.map(t=>{const r=o(t.icon);return e.jsxs("div",{style:{background:`linear-gradient(135deg, ${t.farbe}15, transparent)`,borderRadius:"10px",padding:"0.75rem",border:`1px solid ${t.farbe}40`,display:"flex",flexDirection:"column",alignItems:"center",gap:"0.5rem",transition:"transform 0.2s ease, box-shadow 0.2s ease",cursor:"default"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow=`0 4px 16px ${t.farbe}30`},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none"},children:[e.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"50%",background:`linear-gradient(135deg, ${t.farbe}40, ${t.farbe}20)`,border:`2px solid ${t.farbe}`,display:"flex",alignItems:"center",justifyContent:"center",boxShadow:`0 0 16px ${t.farbe}40`},children:e.jsx(r,{size:24,color:t.farbe})}),e.jsx("div",{style:{fontSize:"0.8rem",fontWeight:600,color:"rgba(255,255,255,0.9)",textAlign:"center"},children:t.name}),e.jsx("div",{style:{fontSize:"0.65rem",color:"rgba(255,255,255,0.5)",textAlign:"center"},children:new Date(t.verliehen_am).toLocaleDateString("de-DE")})]},t.id)})})]})},ce={background:"rgba(255, 255, 255, 0.08)",backdropFilter:"blur(10px)",borderRadius:"10px",padding:"0.75rem 1rem",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.2)",border:"1px solid rgba(255, 215, 0, 0.2)",position:"relative",transition:"transform 0.2s ease"},ge=e=>({position:"absolute",top:0,left:0,right:0,height:"2px",background:e,borderRadius:"10px 10px 0 0"}),he=({statistikDaten:t={},mitglied:r,memberStile:n=[],stile:i=[],styleSpecificData:a={}})=>e.jsxs("div",{className:"statistiken-content",style:{padding:"1rem",background:"transparent"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0, 1fr))",gap:"0.75rem",marginBottom:"1rem"},className:"stats-grid-responsive",children:[e.jsxs("div",{style:ce,children:[e.jsx("div",{style:ge("linear-gradient(90deg, #28a745, #20c997)")}),e.jsx("div",{style:{fontSize:"0.7rem",color:"rgba(255, 255, 255, 0.7)",marginBottom:"0.25rem"},children:"Trainings"}),e.jsx("div",{style:{color:"#ffffff",fontSize:"1.5rem",fontWeight:700,textShadow:"0 0 10px rgba(255, 215, 0, 0.3)"},children:t.totalAnwesenheiten||0})]}),e.jsxs("div",{style:ce,children:[e.jsx("div",{style:ge("linear-gradient(90deg, #3b82f6, #8b5cf6)")}),e.jsx("div",{style:{fontSize:"0.7rem",color:"rgba(255, 255, 255, 0.7)",marginBottom:"0.25rem"},children:"Quote"}),e.jsxs("div",{style:{color:"#ffffff",fontSize:"1.5rem",fontWeight:700,textShadow:"0 0 10px rgba(255, 215, 0, 0.3)"},children:[t.anwesenheitsquote||0,"%"]}),e.jsx("div",{style:{width:"100%",height:"4px",background:"rgba(255,255,255,0.1)",borderRadius:"2px",marginTop:"0.5rem",overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",width:`${t.anwesenheitsquote||0}%`,background:"linear-gradient(90deg, #3b82f6, #8b5cf6)",borderRadius:"2px",transition:"width 0.3s ease"}})})]}),e.jsxs("div",{style:ce,children:[e.jsx("div",{style:ge("linear-gradient(90deg, #f59e0b, #ef4444)")}),e.jsx("div",{style:{fontSize:"0.7rem",color:"rgba(255, 255, 255, 0.7)",marginBottom:"0.25rem"},children:"Streak"}),e.jsx("div",{style:{color:"#ffffff",fontSize:"1.5rem",fontWeight:700,textShadow:"0 0 10px rgba(255, 215, 0, 0.3)"},children:t.currentStreak||0}),e.jsx("div",{style:{fontSize:"0.65rem",color:"rgba(255, 255, 255, 0.6)",marginTop:"0.25rem"},children:"Trainings in Folge"})]}),e.jsxs("div",{style:ce,children:[e.jsx("div",{style:ge("linear-gradient(90deg, #10b981, #14b8a6)")}),e.jsx("div",{style:{fontSize:"0.7rem",color:"rgba(255, 255, 255, 0.7)",marginBottom:"0.25rem"},children:"Dieser Monat"}),e.jsx("div",{style:{color:"#ffffff",fontSize:"1.5rem",fontWeight:700,textShadow:"0 0 10px rgba(255, 215, 0, 0.3)"},children:t.thisMonthAttendances||0})]}),e.jsxs("div",{style:ce,children:[e.jsx("div",{style:ge("linear-gradient(90deg, #8b5cf6, #d946ef)")}),e.jsx("div",{style:{fontSize:"0.7rem",color:"rgba(255, 255, 255, 0.7)",marginBottom:"0.25rem"},children:"Monat (6M)"}),e.jsx("div",{style:{color:"#ffffff",fontSize:"1.5rem",fontWeight:700,textShadow:"0 0 10px rgba(255, 215, 0, 0.3)"},children:t.avgPerMonth||0})]}),e.jsxs("div",{style:ce,children:[e.jsx("div",{style:ge("linear-gradient(90deg, #06b6d4, #3b82f6)")}),e.jsx("div",{style:{fontSize:"0.7rem",color:"rgba(255, 255, 255, 0.7)",marginBottom:"0.25rem"},children:"Letzte Woche"}),e.jsx("div",{style:{color:"#ffffff",fontSize:"1.5rem",fontWeight:700,textShadow:"0 0 10px rgba(255, 215, 0, 0.3)"},children:t.lastWeekAttendances||0})]}),e.jsxs("div",{style:ce,children:[e.jsx("div",{style:ge("linear-gradient(90deg, #f59e0b, #fbbf24)")}),e.jsx("div",{style:{fontSize:"0.7rem",color:"rgba(255, 255, 255, 0.7)",marginBottom:"0.25rem"},children:"Konsistenz"}),e.jsx("div",{style:{color:"#ffffff",fontSize:"1.5rem",fontWeight:700,textShadow:"0 0 10px rgba(255, 215, 0, 0.3)"},children:t.consecutiveMonths||0}),e.jsx("div",{style:{fontSize:"0.65rem",color:"rgba(255, 255, 255, 0.6)",marginTop:"0.25rem"},children:"Monate aktiv"})]}),e.jsxs("div",{style:ce,children:[e.jsx("div",{style:ge("linear-gradient(90deg, #10b981, #059669)")}),e.jsx("div",{style:{fontSize:"0.7rem",color:"rgba(255, 255, 255, 0.7)",marginBottom:"0.25rem"},children:"Kontostand"}),e.jsx("div",{style:{color:(null==r?void 0:r.kontostand)>=0?"#10b981":"#ef4444",fontSize:"1.2rem",fontWeight:700,textShadow:"0 0 10px rgba(255, 215, 0, 0.3)"},children:(null==r?void 0:r.kontostand)?`${r.kontostand.toFixed(2)} EUR`:"0,00 EUR"})]})]}),t.monthlyStats&&t.monthlyStats.length>0&&e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(10px)",borderRadius:"12px",padding:"1rem",marginBottom:"1rem",border:"1px solid rgba(255, 215, 0, 0.2)"},children:[e.jsx("h3",{style:{fontSize:"0.9rem",color:"#ffd700",marginBottom:"1rem",fontWeight:600},children:"Trainings pro Monat (12 Monate)"}),e.jsx("div",{style:{display:"flex",alignItems:"flex-end",gap:"6px",height:"140px",position:"relative"},children:t.monthlyStats.slice(-12).map((r,n)=>{const i=t.monthlyStats.slice(-12),a=Math.max(...i.map(e=>e.count),1),s=a>0?r.count/a*110:2,l=a>0?r.count/a:0,{color1:d,color2:o}=((e,t)=>0===t?{color1:"rgba(255, 255, 255, 0.1)",color2:"rgba(255, 255, 255, 0.1)"}:e>=.8?{color1:"#10b981",color2:"#059669"}:e>=.6?{color1:"#84cc16",color2:"#65a30d"}:e>=.4?{color1:"#fbbf24",color2:"#f59e0b"}:e>=.2?{color1:"#fb923c",color2:"#f97316"}:{color1:"#ef4444",color2:"#dc2626"})(l,r.count);return e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-end",height:"100%",gap:"0.25rem"},children:[e.jsx("div",{style:{fontSize:"0.7rem",color:r.count>0?"rgba(255, 255, 255, 0.9)":"rgba(255, 255, 255, 0.4)",fontWeight:700,minHeight:"16px"},children:r.count>0?r.count:""}),e.jsx("div",{style:{width:"100%",height:`${s}px`,background:r.count>0?`linear-gradient(180deg, ${d}, ${o})`:d,borderRadius:"4px 4px 0 0",minHeight:r.count>0?"8px":"2px",transition:"all 0.3s ease",boxShadow:r.count>0?`0 0 8px ${d}40`:"none"}}),e.jsx("div",{style:{fontSize:"0.6rem",color:"rgba(255, 255, 255, 0.5)",marginTop:"0.25rem",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},children:r.month.substring(0,3)})]},n)})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem"},children:[t.bestMonth&&e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(10px)",borderRadius:"10px",padding:"1rem",border:"1px solid rgba(255, 215, 0, 0.2)"},children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.7)",marginBottom:"0.5rem"},children:"Bester Monat"}),e.jsx("div",{style:{color:"#10b981",fontSize:"1.3rem",fontWeight:700},children:t.bestMonth.month}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"rgba(255, 255, 255, 0.6)",marginTop:"0.25rem"},children:[t.bestMonth.count," Trainings"]})]}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(10px)",borderRadius:"10px",padding:"1rem",border:"1px solid rgba(255, 215, 0, 0.2)"},children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.7)",marginBottom:"0.5rem"},children:"Letzte Anwesenheit"}),e.jsx("div",{style:{color:"#ffffff",fontSize:"1.1rem",fontWeight:600},children:t.letzteAnwesenheit?new Date(t.letzteAnwesenheit).toLocaleDateString("de-DE"):"-"})]}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(10px)",borderRadius:"10px",padding:"1rem",border:"1px solid rgba(255, 215, 0, 0.2)"},children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.7)",marginBottom:"0.5rem"},children:"Mitgliedschaft"}),e.jsxs("div",{style:{color:"#ffffff",fontSize:"1.3rem",fontWeight:700},children:[(null==r?void 0:r.eintrittsdatum)?Math.floor((new Date-new Date(r.eintrittsdatum))/2630016e3):0," Monate"]}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"rgba(255, 255, 255, 0.6)",marginTop:"0.25rem"},children:["seit ",(null==r?void 0:r.eintrittsdatum)?new Date(r.eintrittsdatum).toLocaleDateString("de-DE"):"-"]})]}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(10px)",borderRadius:"10px",padding:"1rem",border:"1px solid rgba(255, 215, 0, 0.2)"},children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.7)",marginBottom:"0.5rem"},children:"Graduierungen"}),n&&n.length>0?e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:n.map((t,r)=>{var n;const s=i.find(e=>e.stil_id===t.stil_id),l=a[t.stil_id],d=null==(n=null==s?void 0:s.graduierungen)?void 0:n.find(e=>e.graduierung_id===(null==l?void 0:l.current_graduierung_id));return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("span",{style:{fontSize:"0.75rem",color:"rgba(255, 255, 255, 0.7)"},children:[t.stil_name,":"]}),e.jsx("span",{style:{fontSize:"0.85rem",color:"#ffd700",fontWeight:600},children:(null==d?void 0:d.name)||"Nicht definiert"})]},r)})}):e.jsx("div",{style:{color:"#ffd700",fontSize:"1.1rem",fontWeight:600},children:"Keine Stile"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"aktiv"===(null==r?void 0:r.status)?"#10b981":"#ef4444",marginTop:"0.5rem",fontWeight:600,paddingTop:"0.5rem",borderTop:"1px solid rgba(255, 255, 255, 0.1)"},children:"aktiv"===(null==r?void 0:r.status)?"Aktiv":"ruhepause"===(null==r?void 0:r.status)?"Ruhepause":"gekuendigt"===(null==r?void 0:r.status)?"Gekuendigt":"Aktiv"})]})]}),t.weekdayStats&&t.weekdayStats.length>0&&e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(10px)",borderRadius:"12px",padding:"1rem",marginTop:"1rem",border:"1px solid rgba(255, 215, 0, 0.2)"},children:[e.jsx("h3",{style:{fontSize:"0.9rem",color:"#ffd700",marginBottom:"1rem",fontWeight:600},children:"Trainingstage nach Wochentag"}),e.jsx("div",{style:{display:"flex",gap:"8px",justifyContent:"space-between"},children:t.weekdayStats.map((r,n)=>{const i=Math.max(...t.weekdayStats.map(e=>e.count),1),a=r.count/i;let s;return s=a>=.8?"#10b981":a>=.6?"#84cc16":a>=.4?"#fbbf24":a>=.2?"#fb923c":a>0?"#ef4444":"rgba(255, 255, 255, 0.1)",e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:"0.5rem"},children:[e.jsx("div",{style:{fontSize:"0.7rem",color:"rgba(255, 255, 255, 0.9)",fontWeight:700},children:r.count}),e.jsx("div",{style:{width:"100%",aspectRatio:"1",background:s,borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:700,color:r.count>0?"#ffffff":"rgba(255, 255, 255, 0.3)",boxShadow:r.count>0?`0 0 12px ${s}60`:"none",transition:"all 0.3s ease"},children:r.dayShort})]},n)})})]}),t.yearlyStats&&t.yearlyStats.length>1&&e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(10px)",borderRadius:"12px",padding:"1rem",marginTop:"1rem",border:"1px solid rgba(255, 215, 0, 0.2)"},children:[e.jsx("h3",{style:{fontSize:"0.9rem",color:"#ffd700",marginBottom:"1rem",fontWeight:600},children:"Jahresvergleich"}),e.jsx("div",{style:{display:"flex",alignItems:"flex-end",gap:"12px",height:"100px"},children:t.yearlyStats.map((r,n)=>{const i=Math.max(...t.yearlyStats.map(e=>e.count),1),a=r.count/i*80,s=r.year===(new Date).getFullYear();return e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-end",height:"100%",gap:"0.5rem"},children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.9)",fontWeight:700},children:r.count}),e.jsx("div",{style:{width:"100%",height:`${a}px`,background:s?"linear-gradient(180deg, #ffd700, #f59e0b)":"linear-gradient(180deg, #3b82f6, #2563eb)",borderRadius:"8px 8px 0 0",minHeight:"8px",boxShadow:s?"0 0 12px rgba(255, 215, 0, 0.5)":"0 0 8px rgba(59, 130, 246, 0.3)",transition:"all 0.3s ease"}}),e.jsx("div",{style:{fontSize:"0.75rem",color:s?"#ffd700":"rgba(255, 255, 255, 0.7)",fontWeight:s?700:600},children:r.year})]},n)})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0, 1fr))",gap:"0.75rem",marginTop:"1rem"},className:"stats-grid-responsive",children:[t.bestWeekday&&t.bestWeekday.count>0&&e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(10px)",borderRadius:"10px",padding:"0.75rem 1rem",border:"1px solid rgba(16, 185, 129, 0.3)",position:"relative"},children:[e.jsx("div",{style:ge("linear-gradient(90deg, #10b981, #059669)")}),e.jsx("div",{style:{fontSize:"0.7rem",color:"rgba(255, 255, 255, 0.7)",marginBottom:"0.25rem"},children:"Bester Wochentag"}),e.jsx("div",{style:{color:"#10b981",fontSize:"1.2rem",fontWeight:700},children:t.bestWeekday.day}),e.jsxs("div",{style:{fontSize:"0.65rem",color:"rgba(255, 255, 255, 0.6)",marginTop:"0.25rem"},children:[t.bestWeekday.count," Trainings"]})]}),t.avgPerWeek>0&&e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(10px)",borderRadius:"10px",padding:"0.75rem 1rem",border:"1px solid rgba(139, 92, 246, 0.3)",position:"relative"},children:[e.jsx("div",{style:ge("linear-gradient(90deg, #8b5cf6, #7c3aed)")}),e.jsx("div",{style:{fontSize:"0.7rem",color:"rgba(255, 255, 255, 0.7)",marginBottom:"0.25rem"},children:"pro Woche"}),e.jsx("div",{style:{color:"#8b5cf6",fontSize:"1.5rem",fontWeight:700},children:t.avgPerWeek}),e.jsx("div",{style:{fontSize:"0.65rem",color:"rgba(255, 255, 255, 0.6)",marginTop:"0.25rem"},children:"Trainings/Woche"})]}),t.longestPause>0&&e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(10px)",borderRadius:"10px",padding:"0.75rem 1rem",border:"1px solid rgba(239, 68, 68, 0.3)",position:"relative"},children:[e.jsx("div",{style:ge("linear-gradient(90deg, #ef4444, #dc2626)")}),e.jsx("div",{style:{fontSize:"0.7rem",color:"rgba(255, 255, 255, 0.7)",marginBottom:"0.25rem"},children:"Laengste Pause"}),e.jsx("div",{style:{color:"#ef4444",fontSize:"1.5rem",fontWeight:700},children:t.longestPause}),e.jsx("div",{style:{fontSize:"0.65rem",color:"rgba(255, 255, 255, 0.6)",marginTop:"0.25rem"},children:"Tage ohne Training"})]}),t.bestStreak>0&&e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(10px)",borderRadius:"10px",padding:"0.75rem 1rem",border:"1px solid rgba(255, 215, 0, 0.3)",position:"relative"},children:[e.jsx("div",{style:ge("linear-gradient(90deg, #ffd700, #f59e0b)")}),e.jsx("div",{style:{fontSize:"0.7rem",color:"rgba(255, 255, 255, 0.7)",marginBottom:"0.25rem"},children:"Bester Streak"}),e.jsx("div",{style:{color:"#ffd700",fontSize:"1.5rem",fontWeight:700},children:t.bestStreak}),e.jsx("div",{style:{fontSize:"0.65rem",color:"rgba(255, 255, 255, 0.6)",marginTop:"0.25rem"},children:"Trainings in Folge"})]})]}),(null==r?void 0:r.mitglied_id)&&e.jsx("div",{style:{marginTop:"1rem"},children:e.jsx(oe,{mitgliedId:r.mitglied_id,compact:!1})})]});function ue(e){if(!e)return"";const t=new Date(e);return`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getDate().toString().padStart(2,"0")}`}function me(e){if(!e)return"";return new Date(e).toISOString().split("T")[0]}function xe(e){if(!e)return"";return{monthly:"Monatlich",monatlich:"Monatlich",quarterly:"VierteljÃ¤hrlich",vierteljaehrlich:"VierteljÃ¤hrlich","semi-annually":"HalbjÃ¤hrlich",halbjaehrlich:"HalbjÃ¤hrlich",annually:"JÃ¤hrlich",jaehrlich:"JÃ¤hrlich",yearly:"JÃ¤hrlich"}[e.toLowerCase()]||e}function pe({value:t,onChange:r,options:i,className:a="",style:l={},disabled:d=!1}){const[o,c]=n.useState(!1),[g,h]=n.useState(""),u=s.useRef(null);n.useEffect(()=>{const e=i.find(e=>e.value===t);h(e?e.label:"")},[t,i]),n.useEffect(()=>{function e(e){u.current&&!u.current.contains(e.target)&&c(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);return e.jsxs("div",{className:`custom-select ${a} ${d?"disabled":""}`,ref:u,style:l,children:[e.jsxs("div",{className:"custom-select-trigger",onClick:()=>!d&&c(!o),children:[e.jsx("span",{children:g||"Bitte wÃ¤hlen..."}),e.jsx("span",{className:"custom-select-arrow",children:o?"â–²":"â–¼"})]}),o&&!d&&e.jsx("div",{className:"custom-select-options mitglied-detail-dropdown",children:i.map(n=>e.jsx("div",{className:"custom-select-option mitglied-detail-dropdown-option "+(n.value===t?"selected":""),onClick:()=>{return e=n.value,r({target:{value:e}}),void c(!1);var e},children:n.label},n.value))})]})}const be=({primaer:t,sekundaer:r,size:n="normal",className:i=""})=>{const a={small:"belt-preview-small",normal:"belt-preview",large:"belt-preview-large"}[n]||"belt-preview";return e.jsx("div",{className:`${a} ${i}`,children:e.jsx("div",{className:"belt-base",style:{backgroundColor:t||"#CCCCCC"},children:r&&e.jsx("div",{className:"belt-stripe",style:{backgroundColor:r}})})})},fe=({isAdmin:m=!1,memberIdProp:x=null})=>{var p,b,f;const{id:j}=i(),y=a(),{activeDojo:v,dojos:k}=d(),{user:S,token:z}=o(),w=e=>{if(!e)return"Kein Dojo";const t=k.find(t=>t.id===parseInt(e));return t?t.dojoname:`Dojo ${e}`},[_,N]=n.useState(null),D=m?x||j:_;h();const{data:C,isLoading:F,error:B,refetch:T}=u({queryKey:["mitglied",D],queryFn:async()=>(await l.get(`/mitglieddetail/${D}`)).data,enabled:!!D,staleTime:9e5,gcTime:18e5}),{data:A}=u({queryKey:["tarife"],queryFn:async()=>{var e;const t=await l.get("/tarife");return(null==(e=t.data)?void 0:e.data)||t.data||[]},staleTime:18e5}),{data:E}=u({queryKey:["zahlungszyklen"],queryFn:async()=>{var e;const t=await l.get("/zahlungszyklen");return(null==(e=t.data)?void 0:e.data)||t.data||[]},staleTime:36e5}),{data:M}=u({queryKey:["stile"],queryFn:async()=>(await l.get("/stile")).data||[],staleTime:36e5}),[R,L]=n.useState(null),[W,I]=n.useState({}),[$,P]=n.useState(!0),[V,G]=n.useState(""),[q,Q]=n.useState(!1),[ee,re]=n.useState([]),[ne,ie]=n.useState(!1),[ae,se]=n.useState("allgemein"),[de,oe]=n.useState("stile"),[ce,ge]=n.useState(0),[fe,je]=n.useState(0),[ye,ve]=n.useState("finanzÃ¼bersicht"),[ke,Se]=n.useState(!0),[ze,we]=n.useState(!1),[_e,Ne]=n.useState("monat"),[De,Ce]=n.useState({}),[Fe,Be]=n.useState({}),[Te,Ae]=n.useState(null),[Ee,Me]=n.useState(!1),[Re,Le]=n.useState([]),[We,Ie]=n.useState([]),[$e,Pe]=n.useState([]),[Ve,Ke]=n.useState({type:"",custom:""}),[Ge,He]=n.useState({}),[Ue,Oe]=n.useState({}),[Ye,Ze]=n.useState(!1),[qe,Je]=n.useState(0),[Xe,Qe]=n.useState(!1),[et,tt]=n.useState([]),[rt,nt]=n.useState([]),[it,at]=n.useState({}),[st,lt]=n.useState([]),[dt,ot]=n.useState([]),[ct,gt]=n.useState(!1),[ht,ut]=n.useState([]),[mt,xt]=n.useState(!1),[pt,bt]=n.useState(null),[ft,jt]=n.useState(!1),[yt,vt]=n.useState(null),[kt,St]=n.useState(!1),[zt,wt]=n.useState(!1),[_t,Nt]=n.useState(null),[Dt,Ct]=n.useState(!1),[Ft,Bt]=n.useState(!1),[Tt,At]=n.useState(""),[Et,Mt]=n.useState(()=>{const e=new Date,t=new Date(e);return t.setMonth(e.getMonth()+12),{tarif_id:"",status:"aktiv",billing_cycle:"",payment_method:"direct_debit",vertragsbeginn:e.toISOString().split("T")[0],vertragsende:t.toISOString().split("T")[0],kuendigungsfrist_monate:3,mindestlaufzeit_monate:12,automatische_verlaengerung:!0,verlaengerung_monate:12,faelligkeit_tag:1,sepa_mandat_id:null,agb_akzeptiert:!1,agb_version:"1.0",datenschutz_akzeptiert:!1,datenschutz_version:"1.0",hausordnung_akzeptiert:!1,haftungsausschluss_akzeptiert:!1,gesundheitserklaerung:!1,foto_einverstaendnis:!1}}),[Rt,Lt]=n.useState(!1),[Wt,It]=n.useState(!1),[$t,Pt]=n.useState(!1),[Vt,Kt]=n.useState(null),[Gt,Ht]=n.useState(!1),[Ut,Ot]=n.useState(null),[Yt,Zt]=n.useState(!1),[qt,Jt]=n.useState([]),[Xt,Qt]=n.useState([]),[er,tr]=n.useState(""),[rr,nr]=n.useState(null),[ir,ar]=n.useState(null),[sr,lr]=n.useState(""),[dr,or]=n.useState(null),[cr,gr]=n.useState(1),[hr,ur]=n.useState(""),[mr,xr]=n.useState(!1),[pr,br]=n.useState(""),[fr,jr]=n.useState([]),[yr,vr]=n.useState([]),[kr,Sr]=n.useState([]);n.useEffect(()=>{C&&(L(C),I(C),P(!1)),B&&(G("Fehler beim Abrufen der Mitgliedsdaten."),P(!1))},[C,B]),n.useEffect(()=>{A&&jr(Array.isArray(A)?A:[])},[A]),n.useEffect(()=>{E&&vr(Array.isArray(E)?E:[])},[E]),n.useEffect(()=>{M&&Jt(Array.isArray(M)?M:[])},[M]);const[zr,wr]=n.useState(""),[_r,Nr]=n.useState(""),[Dr,Cr]=n.useState(""),[Fr,Br]=n.useState(!0),[Tr,Ar]=n.useState(!1),[Er,Mr]=n.useState(!1),[Rr,Lr]=n.useState("Wie lautet der MÃ¤dchen- oder Jungenname Ihrer Mutter?"),[Wr,Ir]=n.useState(""),[$r,Pr]=n.useState(null),[Vr,Kr]=n.useState([]),[Gr,Hr]=n.useState(!1),[Ur,Or]=n.useState([]),[Yr,Zr]=n.useState([]),[qr,Jr]=n.useState([]),[Xr,Qr]=n.useState(null),[en,tn]=n.useState(!1),rn=Number(null==R?void 0:R.dokumente_offen)||0,nn=Number(null==R?void 0:R.nachrichten_offen)||0,an=Array.isArray(rt)?rt.filter(e=>{const t=(e.status||"").toString().toLowerCase(),r=0===e.bezahlt||!1===e.bezahlt;return"offen"===t||"Ã¼berfÃ¤llig"===t||"Ã¼berfÃ¤llig"===t||r}).length:0,sn=async(e=null)=>{P(!0);try{const t=await l.get(`/mitglieddetail/${D}`,e?{signal:e}:{});L(t.data),I(t.data)}catch(t){if("AbortError"===t.name||"ERR_CANCELED"===t.code)return;console.error("ğŸ” Fetch-Error:",t),G("Fehler beim Abrufen der Mitgliedsdaten.")}finally{P(!1)}},ln=async(e=null,t=null)=>{var r;try{const r={};e&&(r.params={stil_id:e}),t&&(r.signal=t);const n=await l.get(`/anwesenheit/${D}`,r);tt(n.data)}catch(n){if("AbortError"===n.name||"ERR_CANCELED"===n.code)return;if(404===(null==(r=n.response)?void 0:r.status))return void tt([]);console.error("Fehler beim Laden der Anwesenheitsdaten:",n)}},dn=async(e=null)=>{try{const t={params:{mitglied_id:D}};e&&(t.signal=e);const r=await l.get("/beitraege",t);nt(r.data)}catch(t){if("AbortError"===t.name||"ERR_CANCELED"===t.code)return;console.error("âŒ Fehler beim Laden der Finanzdaten:",t),console.error("ğŸ” Error Details:",t.response||t)}},on=async(e=null)=>{if(R&&R.mitglied_id)try{const t={params:{mitglied_id:null==R?void 0:R.mitglied_id}};e&&(t.signal=e);const r=(await l.get("/vertraege",t)).data;if(r.success&&r.data){const e=r.data.filter(e=>e.mitglied_id===(null==R?void 0:R.mitglied_id)).sort((e,t)=>e.id-t.id).map((e,t)=>({...e,personenVertragNr:t+1})).sort((e,t)=>e.kuendigung_eingegangen&&!t.kuendigung_eingegangen?1:!e.kuendigung_eingegangen&&t.kuendigung_eingegangen?-1:e.id-t.id);lt(e)}else console.log("âš ï¸ Backend lieferte keine Daten oder Fehler:",r),lt([])}catch(t){if("AbortError"===t.name||"ERR_CANCELED"===t.code)return;console.error("Fehler beim Laden der VertrÃ¤ge:",t),lt([])}},cn=async e=>{try{const t=await l.post(`/mitglieder/${D}/stile`,{stile:e});console.log("âœ… Stile erfolgreich gespeichert:",t.data)}catch(t){console.error("âŒ Fehler beim Speichern der Stile:",t)}},gn=async(e=null)=>{try{const t=(await l.get(`/mitglieder/${D}/stile`,e?{signal:e}:{})).data;if(t.success&&t.stile){if(Qt(t.stile),console.log("âœ… Mitglied-Stile geladen:",t.stile),t.stile.forEach(async e=>{await(async e=>{try{const t=(await l.get(`/mitglieder/${D}/stil/${e}/data`)).data;He(r=>({...r,[e]:t.data}))}catch(t){console.error(`âŒ Fehler beim Laden stilspezifischer Daten fÃ¼r Stil ${e}:`,t.message)}})(e.stil_id),await(async e=>{try{const t=(await l.get(`/mitglieder/${D}/stil/${e}/training-analysis`)).data;Oe(r=>({...r,[e]:t.analysis}))}catch(t){console.error(`âŒ Fehler beim Laden der Trainingsstunden-Analyse fÃ¼r Stil ${e}:`,t.message)}})(e.stil_id)}),t.stile.length>0&&!er){const e=t.stile[0];tr(e.stil_id.toString());const r=qt.find(t=>t.stil_id===e.stil_id);r&&(nr(r),r.graduierungen&&r.graduierungen.length>0&&ar(r.graduierungen[0]))}}else Qt([])}catch(t){if("AbortError"===t.name||"ERR_CANCELED"===t.code)return;console.error("âŒ Fehler beim Laden der Mitglied-Stile:",t),Qt([])}},hn=async()=>{try{const e=(await l.get(`/mitglieder/${D}/sepa-mandate/download`,{responseType:"blob"})).data,t=window.URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download=`SEPA-Mandat_${null==R?void 0:R.nachname}_${null==R?void 0:R.vorname}.pdf`,document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(t),document.body.removeChild(r)}catch(e){console.error("Fehler beim Download des SEPA-Mandats:",e)}},un=async(e=null)=>{try{const t=await l.get(`/mitglieder/${D}/sepa-mandate/archiv`,e?{signal:e}:{});Le(t.data),console.log("âœ… Archivierte Mandate geladen:",t.data)}catch(t){if("AbortError"===t.name||"ERR_CANCELED"===t.code)return;console.error("âŒ Fehler beim Laden archivierter Mandate:",t)}},mn=async(e=null)=>{try{const t=await l.get("/rechnungen",{params:{mitglied_id:D},signal:e||void 0});t.data.success&&Jr(t.data.data||[])}catch(t){if("AbortError"===t.name||"ERR_CANCELED"===t.code)return;console.error("Fehler beim Laden der Rechnungen:",t)}},xn=async(e,t)=>{var r;if(console.log("ğŸ”˜ handleGraduationArrowChange aufgerufen:",{graduationId:e,direction:t}),console.log("ğŸ” selectedStil:",rr),console.log("ğŸ” selectedStil.graduierungen:",null==rr?void 0:rr.graduierungen),console.log("ğŸ” Anzahl Graduierungen:",null==(r=null==rr?void 0:rr.graduierungen)?void 0:r.length),!rr||!rr.graduierungen)return console.error("âŒ Kein Stil oder keine Graduierungen vorhanden"),console.error("âŒ selectedStil:",rr),void console.error("âŒ selectedStil.graduierungen:",null==rr?void 0:rr.graduierungen);let n;if("number"==typeof t){if(n=rr.graduierungen.find(e=>e.graduierung_id===t),!n)return void console.error("âŒ Graduierung mit ID",t,"nicht gefunden");console.log("ğŸ¯ Direkt ausgewÃ¤hlte Graduierung:",n.name,"ID:",n.graduierung_id)}else{const r=rr.graduierungen.findIndex(t=>t.graduierung_id===e);let i;if(console.log("ğŸ“ Aktueller Index:",r,"Direction:",t),"up"===t&&r>0)i=r-1;else{if(!("down"===t&&r<rr.graduierungen.length-1))return void console.log("âš ï¸ Keine Ã„nderung mÃ¶glich");i=r+1}n=rr.graduierungen[i],console.log("ğŸ¯ Neue Graduierung:",n.name,"ID:",n.graduierung_id)}ar(n);const i=rr.stil_id,a={...Ge[i],current_graduierung_id:n.graduierung_id};He(e=>({...e,[i]:a})),console.log("ğŸ’¾ Speichere Graduierung...");try{await(async(e,t)=>{if(!Ye){Ze(!0);try{const r=await l.post(`/mitglieder/${D}/stil/${e}/data`,t);console.log(`âœ… Stilspezifische Daten fÃ¼r Stil ${e} gespeichert:`,r.data)}catch(r){console.error(`âŒ Fehler beim Speichern stilspezifischer Daten fÃ¼r Stil ${e}:`,r.message),G("Fehler beim Speichern der stilspezifischen Daten")}finally{Ze(!1)}}})(i,a),console.log("âœ… Graduierung gespeichert in styleSpecificData")}catch(s){console.error("âŒ Fehler beim Speichern in styleSpecificData:",s)}try{console.log("ğŸ’¾ Speichere auch in Mitglieder-Tabelle..."),await l.put(`/mitglieder/${D}`,{gurtfarbe:n.name,letzte_pruefung:(new Date).toISOString().split("T")[0]}),L(e=>({...e,gurtfarbe:n.name,letzte_pruefung:(new Date).toISOString()})),lr((new Date).toISOString().split("T")[0]),console.log("âœ… Gurt-Graduierung in Mitglied aktualisiert")}catch(s){console.error("âŒ Fehler beim Aktualisieren der Graduierung im Mitglied:",s)}console.log("ğŸ”„ UI wird aktualisiert mit:",n.name)},pn=async(e,t)=>{P(!0);try{const n=st.find(t=>t.id===e);switch(or(n),t){case"kÃ¼ndigen":br((new Date).toISOString().split("T")[0]),It(!0);break;case"ruhepause":Lt(!0);break;case"reaktivieren":if(window.confirm("MÃ¶chten Sie den Vertrag reaktivieren?"))try{await l.put(`/vertraege/${e}`,{status:"aktiv",ruhepause_von:null,ruhepause_bis:null,ruhepause_dauer_monate:null,dojo_id:null==R?void 0:R.dojo_id}),await on()}catch(r){console.error("Fehler beim Reaktivieren des Vertrags:",r),alert("Fehler beim Reaktivieren des Vertrags. Bitte versuchen Sie es erneut.")}break;default:return}}catch(r){console.error("Fehler bei Vertragsaktion:",r)}finally{P(!1)}},bn=async()=>{var e,t,r,n,i,a,s;P(!0);try{const e=yt||Et;if(!R||!R.dojo_id)return alert("? Fehler: Mitgliedsdaten nicht geladen. Bitte laden Sie die Seite neu."),void P(!1);if(!e.tarif_id)return alert("Bitte wÃ¤hlen Sie einen Tarif aus."),void P(!1);if(!(yt||Et.agb_akzeptiert&&Et.datenschutz_akzeptiert))return alert("Bitte akzeptieren Sie die AGB und DatenschutzerklÃ¤rung."),void P(!1);if(!e.sepa_mandat_id)return alert("Bitte wÃ¤hlen Sie ein SEPA-Mandat aus. Ohne gÃ¼ltiges SEPA-Mandat kann keine Lastschrift eingezogen werden."),void P(!1);if(yt){(await l.put(`/vertraege/${yt.id}`,{...yt,dojo_id:null==R?void 0:R.dojo_id})).data.success&&(await on(),vt(null),alert("? Vertrag erfolgreich aktualisiert!"))}else{const e=(new Date).toISOString().replace("T"," ").substring(0,19),{agb_akzeptiert:t,datenschutz_akzeptiert:r,hausordnung_akzeptiert:n,...i}=Et,a={mitglied_id:parseInt(D),dojo_id:null==R?void 0:R.dojo_id,...i,agb_akzeptiert_am:Et.agb_akzeptiert?e:null,datenschutz_akzeptiert_am:Et.datenschutz_akzeptiert?e:null,hausordnung_akzeptiert_am:Et.hausordnung_akzeptiert?e:null,haftungsausschluss_datum:Et.haftungsausschluss_akzeptiert?e:null,gesundheitserklaerung_datum:Et.gesundheitserklaerung?e:null,foto_einverstaendnis_datum:Et.foto_einverstaendnis?e:null,unterschrift_datum:e,unterschrift_ip:window.location.hostname};console.log("ğŸ“¤ Sende Vertragsdaten:",a);if((await l.post("/vertraege",a)).data.success){await on();const e=new Date,t=new Date(e);t.setMonth(e.getMonth()+12),Mt({tarif_id:"",status:"aktiv",billing_cycle:"",payment_method:"direct_debit",vertragsbeginn:e.toISOString().split("T")[0],vertragsende:t.toISOString().split("T")[0],kuendigungsfrist_monate:3,mindestlaufzeit_monate:12,automatische_verlaengerung:!0,verlaengerung_monate:12,faelligkeit_tag:1,sepa_mandat_id:null,agb_akzeptiert:!1,agb_version:"1.0",datenschutz_akzeptiert:!1,datenschutz_version:"1.0",hausordnung_akzeptiert:!1,haftungsausschluss_akzeptiert:!1,gesundheitserklaerung:!1,foto_einverstaendnis:!1}),jt(!1),alert("? Vertrag erfolgreich erstellt!")}}}catch(d){console.error("? Fehler beim Speichern des Vertrags:",d),console.error("? Fehlerdetails:",null==(e=d.response)?void 0:e.data);const l=(null==(r=null==(t=d.response)?void 0:t.data)?void 0:r.sqlError)||(null==(i=null==(n=d.response)?void 0:n.data)?void 0:i.details)||(null==(s=null==(a=d.response)?void 0:a.data)?void 0:s.error)||d.message;alert("Fehler beim Speichern des Vertrags: "+l)}finally{P(!1)}};n.useEffect(()=>{const e=new AbortController;return(async()=>{if(!m&&S)S.mitglied_id?(console.log("âœ… Member ID aus JWT-Token geladen:",S.mitglied_id),N(S.mitglied_id)):(console.error("âŒ Keine mitglied_id im JWT-Token gefunden!",S),G("Kein Mitgliedsprofil mit diesem Account verknÃ¼pft. Bitte kontaktieren Sie den Administrator."),P(!1));else if(m||S)m&&P(!1);else try{const t=await l.get(`/mitglieder/by-email/${encodeURIComponent(S.email)}`,{signal:e.signal});t.data&&t.data.mitglied_id?(console.log("ğŸ“§ Member ID per E-Mail geladen:",t.data.mitglied_id),N(t.data.mitglied_id)):(console.error("âŒ No member found with email:",S.email),G("Kein Mitglied mit dieser E-Mail gefunden."),P(!1))}catch(t){if("AbortError"===t.name||"ERR_CANCELED"===t.code)return;console.error("âŒ Error loading member ID:",t),G("Fehler beim Laden der Mitgliedsdaten."),P(!1)}})(),()=>{e.abort()}},[m,S]),n.useEffect(()=>{if(!D)return;const e=new AbortController;return ln(null,e.signal),dn(e.signal),gn(e.signal),(async(e=null)=>{var t;try{const t=await l.get(`/mitglieder/${D}/sepa-mandate`,e?{signal:e}:{});Ae(t.data)}catch(r){if("AbortError"===r.name||"ERR_CANCELED"===r.code)return;404!==(null==(t=r.response)?void 0:t.status)&&console.error("Fehler beim Laden des SEPA-Mandats:",r)}})(e.signal),un(e.signal),()=>{e.abort()}},[D]),n.useEffect(()=>{if(R){const e=new AbortController;return on(e.signal),()=>{e.abort()}}},[R]),n.useEffect(()=>{(()=>{var e;if(!et.length)return;const t=et.filter(e=>e.anwesend).length,r=et.length,n=r>0?(t/r*100).toFixed(1):0,i=new Date,a=[];for(let C=0;C<12;C++){const e=new Date(i.getFullYear(),i.getMonth()-C,1),t=e.toLocaleDateString("de-DE",{month:"long",year:"numeric"}),r=e.toLocaleDateString("de-DE",{month:"long"}),n=et.filter(t=>{const r=new Date(t.datum);return r.getMonth()===e.getMonth()&&r.getFullYear()===e.getFullYear()&&t.anwesend});n.length>0&&a.push({month:r,fullMonth:t,count:n.length,year:e.getFullYear()})}const s=(new Date).getMonth(),l=(new Date).getFullYear(),d=et.filter(e=>{const t=new Date(e.datum);return t.getMonth()===s&&t.getFullYear()===l&&e.anwesend}).length,o=a.slice(0,6),c=o.length>0?(o.reduce((e,t)=>e+t.count,0)/o.length).toFixed(1):0,g=et.filter(e=>{const t=new Date(e.datum),r=new Date(i);return r.setDate(r.getDate()-7),t>=r&&e.anwesend}).length,h=a.filter(e=>e.count>0),u=h.length>0?h.reduce((e,t)=>t.count>e.count?t:e):null;let m=0;for(const C of a){if(!(C.count>0))break;m++}let x=0;const p=et.filter(e=>e.anwesend).sort((e,t)=>new Date(t.datum)-new Date(e.datum));if(p.length>0){const e=new Date(p[0].datum);if(Math.floor((i-e)/864e5)<=14){x=1;for(let e=1;e<p.length;e++){const t=new Date(p[e].datum),r=new Date(p[e-1].datum);if(!(Math.floor((r-t)/864e5)<=14))break;x++}}}const b=[{day:"Montag",dayShort:"Mo",count:0},{day:"Dienstag",dayShort:"Di",count:0},{day:"Mittwoch",dayShort:"Mi",count:0},{day:"Donnerstag",dayShort:"Do",count:0},{day:"Freitag",dayShort:"Fr",count:0},{day:"Samstag",dayShort:"Sa",count:0},{day:"Sonntag",dayShort:"So",count:0}];et.filter(e=>e.anwesend).forEach(e=>{const t=(new Date(e.datum).getDay()+6)%7;b[t].count++});const f=b.reduce((e,t)=>t.count>e.count?t:e),j=b.filter(e=>e.count>0).reduce((e,t)=>t.count<e.count?t:e,b[0]),y=[...new Set(et.map(e=>new Date(e.datum).getFullYear()))].map(e=>{const t=et.filter(t=>new Date(t.datum).getFullYear()===e&&t.anwesend).length;return{year:e,count:t}}).sort((e,t)=>e.year-t.year),v=et.filter(e=>e.anwesend).sort((e,t)=>new Date(e.datum)-new Date(t.datum));let k=0;for(let C=1;C<v.length;C++){const e=new Date(v[C-1].datum),t=new Date(v[C].datum),r=Math.floor((t-e)/864e5);r>k&&(k=r)}const S=v.length>0?new Date(v[0].datum):null,z=S?Math.ceil((i-S)/6048e5):0,w=z>0?(t/z).toFixed(1):0;let _=0,N=0;const D=et.filter(e=>e.anwesend).sort((e,t)=>new Date(t.datum)-new Date(e.datum));for(let C=0;C<D.length;C++)if(0===C)N=1;else{const e=new Date(D[C].datum),t=new Date(D[C-1].datum);Math.floor((t-e)/864e5)<=14?N++:(N>_&&(_=N),N=1)}N>_&&(_=N),at({totalAnwesenheiten:t,"totalMÃ¶glicheAnwesenheiten":r,anwesenheitsquote:n,letzteAnwesenheit:et.length>0?null==(e=et.sort((e,t)=>new Date(t.datum)-new Date(e.datum))[0])?void 0:e.datum:null,monthlyStats:a,thisMonthAttendances:d,avgPerMonth:c,lastWeekAttendances:g,bestMonth:u,consecutiveMonths:m,currentStreak:x,weekdayStats:b,bestWeekday:f,worstWeekday:j,yearlyStats:y,longestPause:k,avgPerWeek:w,bestStreak:_})})()},[et]),n.useEffect(()=>{var e;if(R&&Xt.length>0&&qt.length>0){if(!er&&Xt.length>0){const t=Xt[0].stil_id.toString(),r=qt.find(e=>e.stil_id===parseInt(t));if(tr(t),nr(r),(null==R?void 0:R.gurtfarbe)&&(null==r?void 0:r.graduierungen)){const e=r.graduierungen.find(e=>e.name.toLowerCase().includes(R.gurtfarbe.toLowerCase()));ar(e||r.graduierungen[0])}else(null==(e=null==r?void 0:r.graduierungen)?void 0:e.length)>0&&ar(r.graduierungen[0])}if(ce>=Xt.length&&ge(0),fe>=Xt.length&&je(0),(null==R?void 0:R.letzte_pruefung)&&lr(me(R.letzte_pruefung)),(null==R?void 0:R.allergien)&&Ie(jn(R.allergien)),null==R?void 0:R.allergien_archiv)try{const e="string"==typeof R.allergien_archiv?JSON.parse(R.allergien_archiv):R.allergien_archiv;Pe(e||[])}catch(t){console.error("Fehler beim Parsen von allergien_archiv:",t),Pe([])}}},[R,Xt,qt]),n.useEffect(()=>{if("anwesenheit"===ae){const e=new AbortController;return ln(null,e.signal),()=>{e.abort()}}},[ae]),n.useEffect(()=>{if("finanzen"===ae&&D){const e=new AbortController;return dn(e.signal),(async(e=null)=>{try{const t=e?{signal:e}:{},[r,n]=await Promise.all([l.get("/tarife",t).catch(()=>null),l.get("/zahlungszyklen",t).catch(()=>null)]);if(null==r?void 0:r.data){const e=r.data;e.success&&jr(e.data||[])}if(null==n?void 0:n.data){const e=n.data;vr(e.data||[])}}catch(t){if("AbortError"===t.name||"ERR_CANCELED"===t.code)return;console.error("Fehler beim Laden der Tarife und Zahlungszyklen:",t)}})(e.signal),on(e.signal),()=>{e.abort()}}},[ae,D]),n.useEffect(()=>{if("stile"===ae&&Xt.length>0&&ce<Xt.length){const e=Xt[ce];if(e&&e.stil_name){const t=new AbortController;return ln(e.stil_name,t.signal),()=>{t.abort()}}}},[ae,ce,Xt]),n.useEffect(()=>{if(Xt.length>0&&ce<Xt.length&&qt.length>0){const e=Xt[ce],t=qt.find(t=>t.stil_id===e.stil_id);if(console.log("ğŸ¨ Setze selectedStil fÃ¼r Tab:",ce,"Stil:",e.stil_name),t){nr(t);const r=Ge[e.stil_id];if(r&&r.current_graduierung_id&&t.graduierungen){const e=t.graduierungen.find(e=>e.graduierung_id===r.current_graduierung_id);e&&(console.log("ğŸ–ï¸ Setze currentGraduation:",e.name),ar(e))}else t.graduierungen&&t.graduierungen.length>0&&(console.log("ğŸ–ï¸ Setze Fallback-Graduierung:",t.graduierungen[0].name),ar(t.graduierungen[0]))}}},[ce,Xt,qt,Ge]),n.useEffect(()=>{if("dokumente"===ae&&(null==R?void 0:R.dojo_id)){const e=new AbortController;if(m){(async()=>{try{const t=await l.get(`/vertragsvorlagen?dojo_id=${null==R?void 0:R.dojo_id}`,{signal:e.signal});Kr(t.data.data||[])}catch(t){if("AbortError"===t.name||"ERR_CANCELED"===t.code)return;console.error("Fehler beim Laden der Vorlagen:",t)}})()}(async()=>{try{const t=await l.get(`/mitglieder/${D}/dokumente`,{signal:e.signal});Or(t.data.data||[])}catch(t){if("AbortError"===t.name||"ERR_CANCELED"===t.code)return;console.error("Fehler beim Laden der Dokumente:",t)}})(),mn(e.signal);return(async()=>{try{const t=await l.get(`/notifications/member/${R.id}/confirmed`,{signal:e.signal});Zr(t.data.data||[])}catch(t){if("AbortError"===t.name||"ERR_CANCELED"===t.code)return;console.error("Fehler beim Laden der bestÃ¤tigten Benachrichtigungen:",t)}})(),()=>{e.abort()}}},[ae,null==R?void 0:R.dojo_id,null==R?void 0:R.id,m,D]),n.useEffect(()=>{if("nachrichten"===ae){const e=new AbortController;return(null==R?void 0:R.email)&&(async(e=null)=>{var t;if(null==R?void 0:R.email){gt(!0);try{const r=await l.get("/notifications/history",{params:{recipient:R.email,limit:100},signal:e||void 0});r.data.success&&(ot(r.data.notifications||[]),console.log("âœ… Mitglieder-Benachrichtigungen geladen:",null==(t=r.data.notifications)?void 0:t.length))}catch(r){if("AbortError"===r.name||"ERR_CANCELED"===r.code)return;console.error("âŒ Fehler beim Laden der Benachrichtigungen:",r)}finally{gt(!1)}}})(e.signal),(async(e=null)=>{var t;xt(!0);try{const r=await l.get("/news/public",{signal:e||void 0});r.data.news&&(ut(r.data.news||[]),console.log("âœ… News-Artikel geladen:",null==(t=r.data.news)?void 0:t.length))}catch(r){if("AbortError"===r.name||"ERR_CANCELED"===r.code)return;console.error("âŒ Fehler beim Laden der News:",r)}finally{xt(!1)}})(e.signal),()=>{e.abort()}}},[ae,null==R?void 0:R.email]),n.useEffect(()=>{if("buddy_gruppen"===ae&&(null==R?void 0:R.mitglied_id)&&z){const e=new AbortController;return(async()=>{try{ie(!0);const t=await fetch(`${g.apiBaseUrl}/buddy/member/${R.mitglied_id}/gruppen`,{headers:{Authorization:`Bearer ${z}`},signal:e.signal});if(t.ok){const e=await t.json();re(e||[])}else re([])}catch(t){"AbortError"!==t.name&&(console.error("Fehler beim Laden der Buddy-Gruppen:",t),re([]))}finally{ie(!1)}})(),()=>{e.abort()}}},[ae,null==R?void 0:R.mitglied_id,z]);const fn=(e,t)=>{let r=e.target.value;"gewicht"!==t&&"kontostand"!==t&&"rabatt_prozent"!==t||(r=parseFloat(r),isNaN(r)&&(r=0)),"checkbox"===e.target.type&&(r=e.target.checked),t.includes("vertreter")&&console.log(`ğŸ”„ handleChange: ${t} = ${r}`),I(e=>({...e,[t]:r}))},jn=e=>e?e.split(";").filter(e=>e.trim()).map((e,t)=>({id:t,value:e.trim()})):[],yn=async e=>{var t,r;const n=e.target.files[0];if(!n)return;if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(n.type))return void alert("Nur Bilddateien (JPEG, PNG, GIF, WebP) sind erlaubt!");if(n.size>5242880)return void alert("Datei ist zu groÃŸ! Maximum 5MB erlaubt.");Ht(!0);const i=new FormData;i.append("foto",n);try{const e=await l.post(`/mitglieddetail/${D}/foto`,i,{headers:{"Content-Type":"multipart/form-data"}});if(e.data.success){const t=e.data.fotoPfad;L(e=>({...e,foto_pfad:t})),I(e=>({...e,foto_pfad:t}));const r=new FileReader;r.onload=e=>{Ot(e.target.result),console.log("ğŸ“· PhotoPreview gesetzt")},r.readAsDataURL(n),setTimeout(()=>{sn()},100),alert("? Foto erfolgreich hochgeladen!")}}catch(a){console.error("Fehler beim Hochladen des Fotos:",a),alert("? Fehler beim Hochladen des Fotos: "+((null==(r=null==(t=a.response)?void 0:t.data)?void 0:r.error)||a.message))}finally{Ht(!1)}};if($)return e.jsx("div",{className:"mitglied-detail-container",style:{padding:"2rem"},children:e.jsx(H,{})});if(V)return e.jsx("p",{className:"error",children:V});if(!R)return e.jsx("p",{children:"Keine Daten gefunden."});const vn=[{key:"allgemein",label:"Allgemein",icon:"ğŸ‘¤"},{key:"medizinisch",label:"Medizinisch",icon:"ğŸ¥"},{key:"fortschritt",label:"Fortschritt",icon:"ğŸ“ˆ"},{key:"anwesenheit",label:"Anwesenheit",icon:"ğŸ“…"},{key:"finanzen",label:"Finanzen",icon:"ğŸ’°"},{key:"vertrag",label:"Vertrag",icon:"ğŸ“„"},{key:"dokumente",label:"Dokumente",icon:"ğŸ“"},{key:"familie",label:"Familie & Vertreter",icon:"ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦"},{key:"gurt_stil",label:"Gurt & Stil / PrÃ¼fung",icon:"ğŸ¥‹"},{key:"buddy_gruppen",label:"Buddy-Gruppen",icon:"ğŸ‘¥"},{key:"nachrichten",label:"Nachrichten",icon:"ğŸ“¬"},{key:"statistiken",label:"Statistiken",icon:"ğŸ“Š"},{key:"zusatzdaten",label:"LehrgÃ¤nge & Ehrungen",icon:"ğŸ†"},{key:"sicherheit",label:"Sicherheit",icon:"ğŸ”’"}];return e.jsxs("div",{className:"mitglied-detail-container",children:[e.jsxs("div",{className:"mitglied-layout",children:[e.jsxs("aside",{className:"mitglied-sidebar "+(ze?"collapsed":""),children:[e.jsx("button",{className:"tab-vertical-btn sidebar-toggle-btn active",onClick:()=>we(!ze),title:ze?"Sidebar Ã¶ffnen":"Sidebar schlieÃŸen",children:e.jsx("span",{className:"tab-icon",children:ze?"Â»":"Â«"})}),e.jsxs("div",{className:"mitglied-header",children:[e.jsx("div",{className:"mitglied-avatar "+(q?"":"avatar-loading"),style:{position:"relative"},children:e.jsx("img",{src:(null==R?void 0:R.foto_pfad)?`http://localhost:3000/${R.foto_pfad}`:'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100"%3E%3Crect fill="%232a2a4e" width="100" height="100"/%3E%3Ctext fill="%23ffd700" font-family="sans-serif" font-size="50" dy=".35em" x="50%25" y="50%25" text-anchor="middle"%3EğŸ‘¤%3C/text%3E%3C/svg%3E',alt:`${null==R?void 0:R.vorname} ${null==R?void 0:R.nachname}`,className:"avatar-image",style:{opacity:q?1:0,transition:"opacity 0.3s ease-in-out"},onLoad:()=>{console.log("ğŸ–¼ï¸ Avatar onLoad gefeuert fÃ¼r:",null==R?void 0:R.foto_pfad),Q(!0)},onError:e=>{console.log("âŒ Avatar onError gefeuert fÃ¼r:",null==R?void 0:R.foto_pfad,"Event:",e),e.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100"%3E%3Crect fill="%232a2a4e" width="100" height="100"/%3E%3Ctext fill="%23ffd700" font-family="sans-serif" font-size="50" dy=".35em" x="50%25" y="50%25" text-anchor="middle"%3EğŸ‘¤%3C/text%3E%3C/svg%3E',Q(!0)}},null==R?void 0:R.mitglied_id)}),!ze&&e.jsxs("div",{className:"mitglied-name",children:[null==R?void 0:R.vorname," ",null==R?void 0:R.nachname,m&&(null==R?void 0:R.dojo_id)&&e.jsx("div",{className:"mitglied-dojo-name",style:{fontSize:"0.85rem",marginTop:"4px",fontWeight:"normal"},children:w(R.dojo_id)})]})]}),e.jsx("nav",{className:"tabs-vertical","aria-label":"Mitglied Tabs",children:vn.map((t,r)=>e.jsxs("button",{className:"tab-vertical-btn "+(ae===t.key?"active":""),onClick:()=>((e,t)=>{se(e),Je(t)})(t.key,r),title:ze?t.label:"",children:[e.jsx("span",{className:"tab-icon",children:t.icon}),!ze&&e.jsx("span",{className:"tab-label",children:t.label})]},t.key))})]}),e.jsxs("div",{className:"mitglied-content "+(ze?"sidebar-collapsed":""),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1rem",gap:"1rem",paddingRight:"1rem",paddingTop:"0.5rem"},children:[e.jsxs("div",{style:{display:"flex",gap:"1rem",flex:1,alignItems:"center",flexWrap:"wrap"},children:[m&&e.jsx("button",{className:"back-button mitglied-detail-back-btn",onClick:()=>y("/dashboard/mitglieder"),children:"â† ZurÃ¼ck"}),e.jsxs("div",{className:"mitglied-detail-status-badges",children:[e.jsxs("div",{className:"mitglied-detail-badge",title:"Offene Dokumente",children:[e.jsx("span",{className:"badge-icon",children:"ğŸ“„"}),e.jsx("span",{className:"badge-label",children:"Dokumente:"}),e.jsx("span",{className:"badge-value",children:rn})]}),e.jsxs("div",{className:"mitglied-detail-badge",title:"Offene Nachrichten",children:[e.jsx("span",{className:"badge-icon",children:"âœ‰ï¸"}),e.jsx("span",{className:"badge-label",children:"Nachrichten:"}),e.jsx("span",{className:"badge-value",children:nn})]}),e.jsxs("div",{className:"mitglied-detail-badge "+(an>0?"badge-warning":""),title:"Offene BeitrÃ¤ge",children:[e.jsx("span",{className:"badge-icon",children:"ğŸ’°"}),e.jsx("span",{className:"badge-label",children:"BeitrÃ¤ge:"}),e.jsx("span",{className:"badge-value "+(an>0?"warning":""),children:an})]})]})]}),m&&e.jsxs("div",{style:{position:"relative",flexShrink:0},children:[e.jsx("button",{className:"mitglied-detail-actions-btn",onClick:()=>Ct(!Dt),title:"Aktionen",children:"â‹®"}),Dt&&e.jsxs(e.Fragment,{children:[e.jsx("div",{onClick:()=>Ct(!1),style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:998}}),e.jsxs("div",{className:"mitglied-detail-actions-menu",children:[e.jsxs("button",{className:"mitglied-detail-menu-item",onClick:()=>{Qe(!Xe),Ct(!1)},children:[e.jsx("span",{className:"menu-item-icon",children:"âœï¸"}),e.jsx("span",{children:Xe?"Bearbeiten beenden":"Bearbeiten"})]}),e.jsxs("button",{className:"mitglied-detail-menu-item "+(Xe?"":"disabled"),onClick:()=>{(async()=>{P(!0);try{const e={...W};delete e.id,delete e.mitglied_id,e.geburtsdatum&&(e.geburtsdatum=ue(e.geburtsdatum)),e.eintrittsdatum&&(e.eintrittsdatum=ue(e.eintrittsdatum)),e.gekuendigt_am&&(e.gekuendigt_am=ue(e.gekuendigt_am)),e.nÃ¤chste_pruefung_datum&&(e.nÃ¤chste_pruefung_datum=ue(e.nÃ¤chste_pruefung_datum)),e.vereinsordnung_datum&&(e.vereinsordnung_datum=ue(e.vereinsordnung_datum)),(e.vertreter1_typ||e.vertreter2_typ)&&console.log("ğŸ’¾ Speichere Vertreter-Daten:",{vertreter1_typ:e.vertreter1_typ,vertreter2_typ:e.vertreter2_typ,vertreter1_name:e.vertreter1_name,vertreter2_name:e.vertreter2_name});const t=(await l.put(`/mitglieddetail/${D}`,e)).data;console.log("âœ… Speichern erfolgreich:",t),L(t&&Object.keys(t).length?t:e),I(t&&Object.keys(t).length?t:e),Qe(!1),await sn()}catch{G("Fehler beim Speichern.")}finally{P(!1)}})(),Ct(!1)},disabled:!Xe,children:[e.jsx("span",{className:"menu-item-icon",children:"ğŸ’¾"}),e.jsx("span",{children:"Speichern"})]}),e.jsxs("button",{className:"mitglied-detail-menu-item "+(Yt?"disabled":""),onClick:()=>{(async()=>{var e;if(!Yt){Zt(!0);try{console.log(`ğŸ“„ Starte PDF-Download fÃ¼r Mitglied ${R.mitglied_id}...`);const e=await l.post(`/mitglieddetail/${R.mitglied_id}/pdf`,{save_to_db:!1},{responseType:"blob",timeout:3e4}),t=window.URL.createObjectURL(new Blob([e.data],{type:"application/pdf"})),r=document.createElement("a");r.href=t,r.download=`Mitglied_${R.mitgliedsnummer||R.mitglied_id}_Details.pdf`,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(t),console.log("âœ… PDF erfolgreich heruntergeladen"),alert("âœ… PDF erfolgreich erstellt und heruntergeladen!")}catch(t){console.error("âŒ Fehler bei PDF-Generierung:",t);let r="Fehler bei PDF-Generierung";if(null==(e=t.response)?void 0:e.data)try{const e=new FileReader;e.onload=()=>{const t=JSON.parse(e.result);alert(`âŒ ${r}: ${t.details||t.error||"Unbekannter Fehler"}`)},e.readAsText(t.response.data)}catch{alert(`âŒ ${r}: ${t.message}`)}else alert(`âŒ ${r}: ${t.message}`)}finally{Zt(!1)}}})(),Ct(!1)},disabled:Yt,children:[e.jsx("span",{className:"menu-item-icon",children:Yt?"â³":"ğŸ“„"}),e.jsx("span",{children:Yt?"Generiere PDF...":"PDF exportieren"})]}),e.jsx("div",{className:"mitglied-detail-menu-divider"}),e.jsxs("button",{className:"mitglied-detail-menu-item danger",onClick:()=>{Bt(!0),Ct(!1)},children:[e.jsx("span",{className:"menu-item-icon",children:"ğŸ—‘ï¸"}),e.jsx("span",{children:"Ins Archiv verschieben"})]})]})]})]})]}),e.jsx(t,{mode:"wait",children:e.jsxs(r.div,{className:"tab-content",initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},children:["sicherheit"===ae&&e.jsx(J,{CustomSelect:pe}),"allgemein"===ae&&e.jsxs("div",{className:"grid-container",children:[e.jsxs("div",{className:"field-group card",children:[e.jsx("h3",{children:"Allgemeine Informationen"}),e.jsxs("div",{children:[e.jsx("label",{children:"Mitgliedsnummer:"}),e.jsx("span",{children:R.mitglied_id})]}),e.jsx("div",{className:"foto-upload-section",children:e.jsxs("div",{className:"foto-container",children:[e.jsx("label",{className:"foto-label",children:"Foto:"}),(null==R?void 0:R.foto_pfad)||Ut?e.jsxs("div",{className:"foto-preview",children:[e.jsx("img",{src:Ut||((null==R?void 0:R.foto_pfad)?`http://localhost:3000/${R.foto_pfad}`:"/src/assets/default-avatar.png"),alt:`${null==R?void 0:R.vorname} ${null==R?void 0:R.nachname}`,className:"mitglied-foto-small",onClick:()=>{window.open().document.write(`\n                              <html>\n                                <head><title>${null==R?void 0:R.vorname} ${null==R?void 0:R.nachname}</title></head>\n                                <body style="margin:0; background:#000; display:flex; justify-content:center; align-items:center; min-height:100vh;">\n                                  <img src="${Ut||((null==R?void 0:R.foto_pfad)?`http://localhost:3000/${R.foto_pfad}`:"/src/assets/default-avatar.png")}"\n                                       style="max-width:90vw; max-height:90vh; object-fit:contain;" />\n                                </body>\n                              </html>\n                            `)},style:{cursor:"pointer"}}),e.jsxs("div",{className:"foto-actions",children:[e.jsx("input",{type:"file",id:"photo-upload",accept:"image/*",onChange:yn,style:{display:"none"},disabled:Gt}),e.jsx("button",{onClick:()=>document.getElementById("photo-upload").click(),disabled:Gt,style:{background:"rgba(42, 42, 78, 0.6)",border:"1px solid rgba(255, 215, 0, 0.3)",color:"#ffd700",padding:"8px 16px",fontSize:"0.85rem",fontWeight:600,borderRadius:"8px",cursor:Gt?"not-allowed":"pointer",opacity:Gt?.5:1,transition:"all 0.3s ease"},onMouseEnter:e=>{Gt||(e.target.style.background="rgba(255, 215, 0, 0.15)",e.target.style.borderColor="rgba(255, 215, 0, 0.6)",e.target.style.color="#ffed4e")},onMouseLeave:e=>{e.target.style.background="rgba(42, 42, 78, 0.6)",e.target.style.borderColor="rgba(255, 215, 0, 0.3)",e.target.style.color="#ffd700"},children:Gt?"â³ Hochladen...":"ğŸ“· Foto Ã¤ndern"}),e.jsx("button",{onClick:async()=>{var e,t;if(window.confirm("MÃ¶chten Sie das Foto wirklich lÃ¶schen?")){P(!0);try{(await l.delete(`/mitglieddetail/${D}/foto`)).data.success&&(L(e=>({...e,foto_pfad:null})),I(e=>({...e,foto_pfad:null})),Ot(null),alert("? Foto erfolgreich gelÃ¶scht!"))}catch(r){console.error("Fehler beim LÃ¶schen des Fotos:",r),alert("? Fehler beim LÃ¶schen des Fotos: "+((null==(t=null==(e=r.response)?void 0:e.data)?void 0:t.error)||r.message))}finally{P(!1)}}},className:"btn btn-sm",disabled:Gt,style:{background:"transparent",border:"1px solid rgba(239, 68, 68, 0.5)",color:"#ef4444",padding:"8px 16px",fontSize:"0.85rem",borderRadius:"8px",cursor:Gt?"not-allowed":"pointer",transition:"all 0.3s ease",display:"inline-flex",alignItems:"center",gap:"0.5rem",fontWeight:600,textTransform:"none",opacity:Gt?.5:1},onMouseEnter:e=>{Gt||(e.target.style.background="rgba(239, 68, 68, 0.15)",e.target.style.borderColor="rgba(239, 68, 68, 0.7)",e.target.style.color="#ff6b6b")},onMouseLeave:e=>{e.target.style.background="transparent",e.target.style.borderColor="rgba(239, 68, 68, 0.5)",e.target.style.color="#ef4444"},children:"ğŸ—‘ï¸ LÃ¶schen"})]})]}):e.jsx("div",{className:"foto-placeholder",children:e.jsxs("div",{className:"foto-upload-area",children:[e.jsx("input",{type:"file",id:"photo-upload",accept:"image/*",onChange:yn,style:{display:"none"},disabled:Gt}),e.jsx("label",{htmlFor:"photo-upload",className:"btn",style:{cursor:"pointer",background:"transparent",border:"1px solid rgba(255, 215, 0, 0.2)",color:"rgba(255, 255, 255, 0.7)",padding:"12px 20px",fontSize:"0.9rem",borderRadius:"8px",transition:"all 0.3s ease",display:"inline-flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",fontWeight:600},onMouseEnter:e=>{e.target.style.background="rgba(255, 255, 255, 0.1)",e.target.style.borderColor="rgba(255, 215, 0, 0.4)",e.target.style.color="rgba(255, 255, 255, 0.9)"},onMouseLeave:e=>{e.target.style.background="transparent",e.target.style.borderColor="rgba(255, 215, 0, 0.2)",e.target.style.color="rgba(255, 255, 255, 0.7)"},children:Gt?e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("div",{className:"spinner"}),e.jsx("span",{children:"Hochladen..."})]}):e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("span",{children:"ğŸ“·"}),e.jsx("span",{children:"Foto hochladen"})]})})]})})]})}),e.jsxs("div",{children:[e.jsx("label",{children:"Vorname:"}),Xe?e.jsx("input",{type:"text",value:W.vorname||"",onChange:e=>fn(e,"vorname")}):e.jsx("span",{children:R.vorname})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Nachname:"}),Xe?e.jsx("input",{type:"text",value:W.nachname||"",onChange:e=>fn(e,"nachname")}):e.jsx("span",{children:R.nachname})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Geburtsdatum:"}),Xe&&m?e.jsx("input",{type:"date",value:me(W.geburtsdatum),onChange:e=>fn(e,"geburtsdatum")}):e.jsx("span",{children:R.geburtsdatum?new Date(R.geburtsdatum).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"}):"Nicht angegeben"})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Geschlecht:"}),Xe?e.jsxs("select",{value:W.geschlecht||"",onChange:e=>fn(e,"geschlecht"),children:[e.jsx("option",{value:"m",children:"mÃ¤nnlich"}),e.jsx("option",{value:"w",children:"weiblich"}),e.jsx("option",{value:"d",children:"divers"})]}):e.jsx("span",{children:"m"===R.geschlecht?"mÃ¤nnlich":"w"===R.geschlecht?"weiblich":"divers"})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Gewicht:"}),Xe?e.jsx("input",{type:"number",step:"0.01",value:W.gewicht||"",onChange:e=>fn(e,"gewicht")}):e.jsxs("span",{children:[R.gewicht," kg"]})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Aktuelle Graduierung(en):"}),Xe&&m?e.jsx("input",{type:"text",value:W.gurtfarbe||"",onChange:e=>fn(e,"gurtfarbe"),placeholder:"Legacy-Feld (wird nicht mehr verwendet)",disabled:!0,style:{opacity:.5,cursor:"not-allowed"}}):e.jsx("span",{children:R.aktuelle_graduierungen||R.gurtfarbe||"Keine Graduierung zugeordnet"})]})]}),e.jsxs("div",{className:"field-group card",children:[e.jsx("h3",{children:"Kontaktdaten"}),e.jsxs("div",{children:[e.jsx("label",{children:"E-Mail:"}),Xe?e.jsx("input",{type:"email",value:W.email||"",onChange:e=>fn(e,"email"),className:"input-transparent"}):e.jsx("span",{children:R.email||"Nicht angegeben"})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Telefon:"}),Xe?e.jsx("input",{type:"text",value:W.telefon||"",onChange:e=>fn(e,"telefon"),className:"input-transparent"}):e.jsx("span",{children:R.telefon||"Nicht angegeben"})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Mobil:"}),Xe?e.jsx("input",{type:"text",value:W.telefon_mobil||"",onChange:e=>fn(e,"telefon_mobil"),className:"input-transparent"}):e.jsx("span",{children:R.telefon_mobil||"Nicht angegeben"})]}),e.jsxs("div",{children:[e.jsx("label",{children:"StraÃŸe:"}),Xe?e.jsx("input",{type:"text",value:W.strasse||"",onChange:e=>fn(e,"strasse"),className:"input-transparent"}):e.jsx("span",{children:R.strasse||"Nicht angegeben"})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Hausnummer:"}),Xe?e.jsx("input",{type:"text",value:W.hausnummer||"",onChange:e=>fn(e,"hausnummer"),className:"input-transparent"}):e.jsx("span",{children:R.hausnummer||"Nicht angegeben"})]}),e.jsxs("div",{children:[e.jsx("label",{children:"PLZ:"}),Xe?e.jsx("input",{type:"text",value:W.plz||"",onChange:e=>fn(e,"plz")}):e.jsx("span",{children:R.plz||"Nicht angegeben"})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Ort:"}),Xe?e.jsx("input",{type:"text",value:W.ort||"",onChange:e=>fn(e,"ort")}):e.jsx("span",{children:R.ort||"Nicht angegeben"})]})]}),e.jsxs("div",{className:"field-group card",children:[e.jsx("h3",{children:"Erweiterte Informationen"}),m&&e.jsxs("div",{children:[e.jsx("label",{children:"Interne Notizen:"}),Xe?e.jsx("textarea",{value:W.notizen||"",onChange:e=>fn(e,"notizen"),placeholder:"Interne Notizen Ã¼ber das Mitglied...",rows:3}):e.jsx("span",{children:R.notizen||"Keine Notizen vorhanden"})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Newsletter-Abonnement:"}),Xe?e.jsx(pe,{value:W.newsletter_abo||"1",onChange:e=>fn(e,"newsletter_abo"),options:[{value:"1",label:"Ja, Newsletter erhalten"},{value:"0",label:"Nein, kein Newsletter"}]}):e.jsx("span",{children:R.newsletter_abo?"? Abonniert":"? Nicht abonniert"})]}),m&&e.jsxs("div",{children:[e.jsx("label",{children:"Marketing-Quelle:"}),Xe?e.jsx(pe,{value:W.marketing_quelle||"",onChange:e=>fn(e,"marketing_quelle"),options:[{value:"",label:"Bitte auswÃ¤hlen..."},{value:"Google",label:"Google-Suche"},{value:"Facebook",label:"Facebook"},{value:"Instagram",label:"Instagram"},{value:"Empfehlung",label:"Empfehlung von Freunden"},{value:"Flyer",label:"Flyer/Werbung"},{value:"Website",label:"Eigene Website"},{value:"Vorbeikommen",label:"Vorbeigelaufen"},{value:"Sonstiges",label:"Sonstiges"}]}):e.jsx("span",{children:R.marketing_quelle||"Nicht angegeben"})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Bevorzugte Trainingszeiten:"}),Xe?e.jsx("input",{type:"text",value:W.bevorzugte_trainingszeiten||"",onChange:e=>fn(e,"bevorzugte_trainingszeiten"),placeholder:"z.B. Montag/Mittwoch 19:00"}):e.jsx("span",{children:R.bevorzugte_trainingszeiten||"Nicht angegeben"})]}),m&&e.jsxs("div",{children:[e.jsx("label",{children:"Online-Portal:"}),Xe?e.jsx(pe,{value:W.online_portal_aktiv||"0",onChange:e=>fn(e,"online_portal_aktiv"),options:[{value:"1",label:"Aktiv"},{value:"0",label:"Inaktiv"}]}):e.jsx("span",{children:R.online_portal_aktiv?"âœ… Aktiv":"? Inaktiv"})]}),R.letzter_login&&e.jsxs("div",{children:[e.jsx("label",{children:"Letzter Login:"}),e.jsx("span",{children:new Date(R.letzter_login).toLocaleString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),m&&e.jsxs("div",{className:"field-group card kontostand-card",children:[e.jsx("h3",{children:"Kontostand"}),Xe?e.jsxs("div",{children:[e.jsx("label",{children:"Aktueller Kontostand:"}),e.jsx("input",{type:"number",step:"0.01",value:W.kontostand??0,onChange:e=>fn(e,"kontostand")})]}):e.jsxs("div",{className:"kontostand-details",style:{display:"grid",gap:"1rem",marginTop:"1rem"},children:[e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",padding:"1rem",borderRadius:"8px",border:"1px solid rgba(255, 215, 0, 0.2)"},children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"rgba(255, 255, 255, 0.6)",marginBottom:"0.5rem",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Aktueller offener Betrag"}),e.jsx("div",{style:{color:rt.filter(e=>!e.bezahlt).reduce((e,t)=>e+(parseFloat(t.betrag)||0),0)>0?"#ef4444":"#10b981",fontSize:"1.2rem",fontWeight:"600"},children:`${rt.filter(e=>!e.bezahlt).reduce((e,t)=>e+(parseFloat(t.betrag)||0),0).toFixed(2)} â‚¬`}),e.jsx("div",{style:{fontSize:"0.75rem",color:"rgba(255, 255, 255, 0.4)",marginTop:"0.5rem"},children:`${rt.filter(e=>!e.bezahlt).length} offen, ${rt.filter(e=>e.bezahlt).length} bezahlt`})]}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",padding:"1rem",borderRadius:"8px",border:"1px solid rgba(255, 215, 0, 0.2)"},children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"rgba(255, 255, 255, 0.6)",marginBottom:"0.5rem",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Letzter bezahlter Betrag"}),e.jsx("div",{style:{color:"#ffffff",fontSize:"1.1rem",fontWeight:"600"},children:(()=>{const t=rt.filter(e=>e.bezahlt&&e.zahlungsdatum).sort((e,t)=>new Date(t.zahlungsdatum)-new Date(e.zahlungsdatum))[0];return t?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{fontSize:"1.2rem",marginBottom:"0.25rem"},children:[parseFloat(t.betrag).toFixed(2)," â‚¬"]}),e.jsxs("div",{style:{fontSize:"0.85rem",color:"rgba(255, 255, 255, 0.5)"},children:["am ",new Date(t.zahlungsdatum).toLocaleDateString("de-DE")]})]}):e.jsx("div",{style:{color:"rgba(255, 255, 255, 0.5)"},children:"Keine Zahlungen vorhanden"})})()})]}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",padding:"1rem",borderRadius:"8px",border:"1px solid rgba(255, 215, 0, 0.2)"},children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"rgba(255, 255, 255, 0.6)",marginBottom:"0.5rem",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Kommender Betrag"}),e.jsx("div",{style:{color:"#ffffff",fontSize:"1.1rem",fontWeight:"600"},children:(()=>{const t=st.filter(e=>"aktiv"===e.status);if(t.length>0){const r=t.reduce((e,t)=>e+(parseFloat(t.monatsbeitrag)||0),0);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{fontSize:"1.2rem",marginBottom:"0.25rem"},children:[r.toFixed(2)," â‚¬"]}),e.jsxs("div",{style:{fontSize:"0.85rem",color:"rgba(255, 255, 255, 0.5)"},children:["monatlich (",t.length," ",1===t.length?"Vertrag":"VertrÃ¤ge",")"]})]})}return e.jsx("div",{style:{color:"rgba(255, 255, 255, 0.5)"},children:"Kein aktiver Vertrag"})})()})]})]})]})]}),"medizinisch"===ae&&e.jsx(te,{mitglied:R,updatedData:W,editMode:Xe,handleChange:fn,CustomSelect:pe,allergien:We,allergienArchiv:$e,newAllergie:Ve,setNewAllergie:Ke,addAllergie:()=>{if(!Ve.type)return;const e="Sonstiges"===Ve.type?Ve.custom:Ve.type;if(!e.trim())return;const t=Math.max(0,...We.map(e=>e.id))+1,r=[...We,{id:t,value:e.trim()}];Ie(r);const n=r.map(e=>e.value).join("; ");I({...W,allergien:n}),Ke({type:"",custom:""})},removeAllergie:async e=>{try{const t=await fetch(`http://localhost:3000/api/mitglieddetail/${R.id}/archive-allergie`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({allergieId:e})});if(!t.ok)throw new Error("Fehler beim Archivieren der Allergie");const r=await t.json();Ie(r.allergien),Pe(r.allergien_archiv);const n=r.allergien.length>0?r.allergien.map(e=>e.value).join("; "):"";I({...W,allergien:n}),console.log("âœ… Allergie archiviert:",r.message)}catch(t){console.error("Fehler beim Archivieren der Allergie:",t),alert("Fehler beim Archivieren der Allergie")}}}),"fortschritt"===ae&&e.jsx("div",{className:"fortschritt-tab-container",children:e.jsx(U,{mitgliedId:D})}),"dokumente"===ae&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[e.jsxs("div",{className:"field-group card",children:[e.jsx("h3",{style:{marginBottom:"1.5rem",fontSize:"1.1rem"},children:"Dokumente & EinverstÃ¤ndnisse"}),(()=>{const t=st.find(e=>"aktiv"===e.status)||st[0],r=t||R,n=!!r.hausordnung_akzeptiert_am||(R.hausordnung_akzeptiert||!1),i=r.hausordnung_akzeptiert_am||R.hausordnung_akzeptiert_am,a=!!r.datenschutz_akzeptiert_am||(R.datenschutz_akzeptiert||!1),s=r.datenschutz_akzeptiert_am||R.datenschutz_akzeptiert_am,l=r.foto_einverstaendnis_datum?r.foto_einverstaendnis:R.foto_einverstaendnis,d=r.foto_einverstaendnis_datum||R.foto_einverstaendnis_datum,o=!!r.agb_akzeptiert_am||(R.agb_akzeptiert||!1),c=r.agb_akzeptiert_am||R.agb_akzeptiert_am,g=r.haftungsausschluss_datum?r.haftungsausschluss_akzeptiert:R.haftungsausschluss_akzeptiert,h=r.haftungsausschluss_datum||R.haftungsausschluss_datum,u=r.gesundheitserklaerung_datum?r.gesundheitserklaerung:R.gesundheitserklaerung,x=r.gesundheitserklaerung_datum||R.gesundheitserklaerung_datum;return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[t&&e.jsxs("div",{style:{padding:"0.75rem",background:"rgba(33, 150, 243, 0.1)",borderRadius:"6px",border:"1px solid rgba(33, 150, 243, 0.3)",fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.7)"},children:["â„¹ï¸ Daten werden aus dem aktiven Vertrag #",t.personenVertragNr||t.id," geladen"]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.5rem 0.75rem",background:"rgba(255, 255, 255, 0.02)",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("label",{style:{fontWeight:500,fontSize:"0.75rem",margin:0,textTransform:"uppercase"},children:"Hausordnung akzeptiert:"}),Xe&&m?e.jsx("input",{type:"checkbox",checked:W.hausordnung_akzeptiert||!1,onChange:e=>fn(e,"hausordnung_akzeptiert"),style:{width:"18px",height:"18px"}}):e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("span",{className:"status-badge "+(n?"accepted":"missing"),style:{fontSize:"0.75rem",padding:"0.35rem 0.75rem",textTransform:"uppercase"},children:n?"âœ… Akzeptiert":"âŒ Fehlt"}),i&&e.jsxs("span",{style:{fontSize:"0.75rem",color:"rgba(255, 255, 255, 0.6)",whiteSpace:"nowrap"},children:["am ",new Date(i).toLocaleDateString("de-DE")]})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.5rem 0.75rem",background:"rgba(255, 255, 255, 0.02)",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("label",{style:{fontWeight:500,fontSize:"0.75rem",margin:0,textTransform:"uppercase"},children:"Datenschutz akzeptiert:"}),Xe&&m?e.jsx("input",{type:"checkbox",checked:W.datenschutz_akzeptiert||!1,onChange:e=>fn(e,"datenschutz_akzeptiert"),style:{width:"18px",height:"18px"}}):e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("span",{className:"status-badge "+(a?"accepted":"missing"),style:{fontSize:"0.75rem",padding:"0.35rem 0.75rem",textTransform:"uppercase"},children:a?"âœ… Akzeptiert":"âŒ Fehlt"}),s&&e.jsxs("span",{style:{fontSize:"0.75rem",color:"rgba(255, 255, 255, 0.6)",whiteSpace:"nowrap"},children:["am ",new Date(s).toLocaleDateString("de-DE")]})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.5rem 0.75rem",background:"rgba(255, 255, 255, 0.02)",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("label",{style:{fontWeight:500,fontSize:"0.75rem",margin:0,textTransform:"uppercase"},children:"Foto-EinverstÃ¤ndnis:"}),Xe&&m?e.jsx("input",{type:"checkbox",checked:W.foto_einverstaendnis||!1,onChange:e=>fn(e,"foto_einverstaendnis"),style:{width:"18px",height:"18px"}}):e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("span",{className:"status-badge "+(l?"accepted":"missing"),style:{fontSize:"0.75rem",padding:"0.35rem 0.75rem",textTransform:"uppercase"},children:l?"âœ… Erteilt":"âŒ Fehlt"}),d&&e.jsxs("span",{style:{fontSize:"0.75rem",color:"rgba(255, 255, 255, 0.6)",whiteSpace:"nowrap"},children:["am ",new Date(d).toLocaleDateString("de-DE")]})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.5rem 0.75rem",background:"rgba(255, 255, 255, 0.02)",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("label",{style:{fontWeight:500,fontSize:"0.75rem",margin:0,textTransform:"uppercase"},children:"AGB akzeptiert:"}),Xe&&m?e.jsx("input",{type:"checkbox",checked:W.agb_akzeptiert||!1,onChange:e=>fn(e,"agb_akzeptiert"),style:{width:"18px",height:"18px"}}):e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("span",{className:"status-badge "+(o?"accepted":"missing"),style:{fontSize:"0.75rem",padding:"0.35rem 0.75rem",textTransform:"uppercase"},children:o?"âœ… Akzeptiert":"âŒ Fehlt"}),c&&e.jsxs("span",{style:{fontSize:"0.75rem",color:"rgba(255, 255, 255, 0.6)",whiteSpace:"nowrap"},children:["am ",new Date(c).toLocaleDateString("de-DE")]})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.5rem 0.75rem",background:"rgba(255, 255, 255, 0.02)",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("label",{style:{fontWeight:500,fontSize:"0.75rem",margin:0,textTransform:"uppercase"},children:"Haftungsausschluss:"}),Xe&&m?e.jsx("input",{type:"checkbox",checked:W.haftungsausschluss_akzeptiert||!1,onChange:e=>fn(e,"haftungsausschluss_akzeptiert"),style:{width:"18px",height:"18px"}}):e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("span",{className:"status-badge "+(g?"accepted":"missing"),style:{fontSize:"0.75rem",padding:"0.35rem 0.75rem",textTransform:"uppercase"},children:g?"âœ… Akzeptiert":"âŒ Fehlt"}),h&&e.jsxs("span",{style:{fontSize:"0.75rem",color:"rgba(255, 255, 255, 0.6)",whiteSpace:"nowrap"},children:["am ",new Date(h).toLocaleDateString("de-DE")]})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.5rem 0.75rem",background:"rgba(255, 255, 255, 0.02)",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("label",{style:{fontWeight:500,fontSize:"0.75rem",margin:0,textTransform:"uppercase"},children:"GesundheitserklÃ¤rung:"}),Xe&&m?e.jsx("input",{type:"checkbox",checked:W.gesundheitserklaerung||!1,onChange:e=>fn(e,"gesundheitserklaerung"),style:{width:"18px",height:"18px"}}):e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("span",{className:"status-badge "+(u?"accepted":"missing"),style:{fontSize:"0.75rem",padding:"0.35rem 0.75rem",textTransform:"uppercase"},children:u?"âœ… Abgegeben":"âŒ Fehlt"}),x&&e.jsxs("span",{style:{fontSize:"0.75rem",color:"rgba(255, 255, 255, 0.6)",whiteSpace:"nowrap"},children:["am ",new Date(x).toLocaleDateString("de-DE")]})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.5rem 0.75rem",background:"rgba(255, 255, 255, 0.02)",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("label",{style:{fontWeight:500,fontSize:"0.75rem",margin:0,textTransform:"uppercase"},children:"Vereinsordnung Datum:"}),Xe&&m?e.jsx("input",{type:"date",value:me(W.vereinsordnung_datum),onChange:e=>fn(e,"vereinsordnung_datum"),style:{padding:"0.35rem",fontSize:"0.75rem"}}):e.jsx("span",{style:{fontSize:"0.75rem",fontWeight:600,color:"#FFD700"},children:R.vereinsordnung_datum?new Date(R.vereinsordnung_datum).toLocaleDateString("de-DE"):"15.1.2023"})]})]})})()," "]}),Yr.length>0&&e.jsxs("div",{className:"field-group card",children:[e.jsx("h3",{style:{marginBottom:"1.5rem",fontSize:"1.1rem"},children:"âœ… BestÃ¤tigte Dokumente"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:Yr.map(t=>{const r=t.metadata||{};return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.75rem",background:"rgba(34, 197, 94, 0.1)",borderRadius:"6px",border:"1px solid rgba(34, 197, 94, 0.3)"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:600,fontSize:"0.85rem",marginBottom:"0.25rem"},children:t.subject}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"rgba(255, 255, 255, 0.6)"},children:[r.document_title&&`${r.document_title} `,r.document_version&&`(Version ${r.document_version})`]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"0.25rem"},children:[e.jsx("span",{style:{fontSize:"0.7rem",color:"rgba(34, 197, 94, 0.9)",fontWeight:600,textTransform:"uppercase"},children:"âœ“ BestÃ¤tigt"}),e.jsx("span",{style:{fontSize:"0.7rem",color:"rgba(255, 255, 255, 0.5)",whiteSpace:"nowrap"},children:new Date(t.confirmed_at).toLocaleString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})]},t.id)})}),e.jsx("div",{className:"info-box",style:{marginTop:"1rem"},children:e.jsxs("p",{children:["â„¹ï¸ ",e.jsx("strong",{children:"Hinweis:"})," Hier werden alle vom Mitglied bestÃ¤tigten Dokumente mit Datum und Uhrzeit der BestÃ¤tigung angezeigt."]})})]}),m&&Te&&e.jsxs("div",{className:"field-group card bank-sub-tab-content",children:[e.jsx("h3",{style:{fontSize:"0.8rem",color:"#FFD700",marginBottom:"1rem",textTransform:"uppercase",fontWeight:"700",letterSpacing:"0.5px",borderBottom:"1px solid rgba(255, 215, 0, 0.3)",paddingBottom:"0.75rem"},children:"Aktuelles SEPA-Lastschriftmandat"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:"1.5rem",padding:"1.25rem",background:"rgba(255, 255, 255, 0.02)",borderRadius:"8px",border:"1px solid rgba(255, 255, 255, 0.1)",marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"0.75rem"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[e.jsx("span",{style:{fontSize:"0.8rem",color:"#e74c3c",fontWeight:"600"},children:Te.mandatsreferenz}),e.jsx("span",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.7)"},children:"STATUS: AKTIV"})]})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr",gap:"0.75rem 1rem",fontSize:"0.8rem"},children:[e.jsx("span",{style:{color:"rgba(255, 255, 255, 0.7)",fontWeight:"500"},children:"Erstellt:"}),e.jsx("span",{style:{color:"rgba(255, 255, 255, 0.9)"},children:new Date(Te.erstellungsdatum).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"})}),e.jsx("span",{style:{color:"rgba(255, 255, 255, 0.7)",fontWeight:"500"},children:"GlÃ¤ubiger-ID:"}),e.jsx("span",{style:{color:"rgba(255, 255, 255, 0.9)",wordBreak:"break-word"},children:Te.glaeubiger_id||"N/A"}),e.jsx("span",{style:{color:"rgba(255, 255, 255, 0.7)",fontWeight:"500"},children:"IBAN:"}),e.jsx("span",{style:{color:"rgba(255, 255, 255, 0.9)",fontFamily:"monospace"},children:Te.iban?`${Te.iban.slice(0,4)} **** ${Te.iban.slice(-4)}`:"N/A"}),e.jsx("span",{style:{color:"rgba(255, 255, 255, 0.7)",fontWeight:"500"},children:"Kontoinhaber:"}),e.jsx("span",{style:{color:"rgba(255, 255, 255, 0.9)"},children:Te.kontoinhaber||"N/A"}),e.jsx("span",{style:{color:"rgba(255, 255, 255, 0.7)",fontWeight:"500"},children:"BIC:"}),e.jsx("span",{style:{color:"rgba(255, 255, 255, 0.9)",fontFamily:"monospace"},children:Te.bic||"N/A"})]})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",justifyContent:"flex-start",gap:"0.5rem"},children:e.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>hn(),title:"PDF herunterladen",style:{padding:"0.5rem 1rem",fontSize:"0.8rem",whiteSpace:"nowrap",background:"transparent",border:"1px solid rgba(255, 215, 0, 0.2)",color:"rgba(255, 255, 255, 0.7)",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.1)",e.currentTarget.style.borderColor="rgba(255, 215, 0, 0.4)",e.currentTarget.style.color="rgba(255, 255, 255, 0.9)"},onMouseLeave:e=>{e.currentTarget.style.background="transparent",e.currentTarget.style.borderColor="rgba(255, 215, 0, 0.2)",e.currentTarget.style.color="rgba(255, 255, 255, 0.7)"},children:"PDF"})})]}),e.jsx("div",{className:"info-box",style:{marginTop:"1rem"},children:e.jsxs("p",{style:{fontSize:"0.8rem",margin:0},children:[e.jsx("strong",{children:"Hinweis:"})," Dieses Mandat ist derzeit aktiv und wird fÃ¼r SEPA-Lastschriften verwendet."]})})]}),m&&Re.length>0&&e.jsxs("div",{className:"field-group card",children:[e.jsx("h3",{children:"Archivierte & Widerrufene SEPA-Mandate"}),e.jsx("div",{className:"archivierte-mandate-liste",children:Re.map((t,r)=>e.jsxs("div",{className:"archiviertes-mandat-item",children:[e.jsxs("div",{className:"mandat-info",children:[e.jsxs("div",{className:"mandat-header",children:[e.jsxs("span",{className:"mandatsreferenz",children:["ğŸ”– ",t.mandatsreferenz]}),e.jsx("span",{className:"archiviert-datum",children:t.archiviert_am?`Archiviert: ${new Date(t.archiviert_am).toLocaleDateString("de-DE")}`:t.widerruf_datum?`Widerrufen: ${new Date(t.widerruf_datum).toLocaleDateString("de-DE")}`:"Nicht mehr aktiv"})]}),e.jsxs("div",{className:"mandat-details",children:[e.jsxs("span",{children:["Erstellt: ",new Date(t.erstellungsdatum).toLocaleDateString("de-DE")]}),e.jsxs("span",{children:["Status: ","widerrufen"===t.status?"ğŸš« Widerrufen":"ğŸ“¦ Archiviert"]}),t.archiviert_grund&&e.jsxs("span",{children:["Grund: ",t.archiviert_grund]})]}),e.jsxs("div",{className:"mandat-banking",children:[e.jsxs("span",{children:["IBAN: ",t.iban?`${t.iban.slice(0,4)}****${t.iban.slice(-4)}`:"N/A"]}),e.jsxs("span",{children:["Kontoinhaber: ",t.kontoinhaber]})]})]}),e.jsx("div",{className:"mandat-actions",children:e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>(async(e,t,r,n)=>{try{const i=(await l.get(`/mitglieder/${D}/sepa-mandate/download`,{params:{mandate_id:e},responseType:"blob"})).data,a=window.URL.createObjectURL(i),s=document.createElement("a"),d=new Date(n).toLocaleDateString("de-DE").replace(/\./g,"-");s.href=a,s.download=`SEPA-Mandat_${r}_${t}_${d}.pdf`,document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(a),document.body.removeChild(s)}catch(i){console.error("Fehler beim Download des archivierten SEPA-Mandats:",i)}})(t.mandat_id,t.vorname,t.nachname,t.erstellungsdatum),title:"PDF herunterladen",children:"ğŸ“„ PDF"})})]},t.mandat_id))}),e.jsx("div",{className:"info-box",children:e.jsxs("p",{children:["â„¹ï¸ ",e.jsx("strong",{children:"Hinweis:"})," Archivierte und widerrufene SEPA-Mandate bleiben dauerhaft gespeichert und kÃ¶nnen jederzeit als PDF heruntergeladen werden."]})})]}),m&&e.jsxs("div",{className:"field-group card",children:[e.jsx("h3",{style:{fontSize:"1.1rem",marginBottom:"1rem"},children:"Dokumente aus Vorlagen generieren"}),0===Vr.length?e.jsx("div",{className:"info-box",children:e.jsx("p",{children:'â„¹ï¸ Keine Vorlagen verfÃ¼gbar. Erstellen Sie zuerst Vorlagen im Bereich "Vertragsdokumente".'})}):e.jsxs("div",{children:[e.jsx("div",{className:"info-box",style:{marginBottom:"1rem"},children:e.jsx("p",{children:"â„¹ï¸ WÃ¤hlen Sie eine Vorlage aus, um ein PDF mit den aktuellen Daten dieses Mitglieds zu erstellen."})}),e.jsx("div",{style:{display:"grid",gap:"1rem",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))"},children:Vr.map(t=>e.jsxs("div",{style:{padding:"1rem",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",background:"rgba(255, 255, 255, 0.02)",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.05)",e.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.02)",e.currentTarget.style.transform="translateY(0)"},children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.75rem"},children:e.jsxs("div",{style:{flex:1},children:[e.jsx("h4",{style:{margin:"0 0 0.5rem 0",fontSize:"1.1rem",color:"#FFD700"},children:t.name}),t.beschreibung&&e.jsx("p",{style:{margin:0,fontSize:"0.85rem",color:"rgba(255, 255, 255, 0.6)"},children:t.beschreibung}),e.jsxs("div",{style:{marginTop:"0.5rem",fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)"},children:[e.jsx("span",{style:{padding:"0.2rem 0.5rem",background:"rgba(255, 215, 0, 0.1)",borderRadius:"4px",marginRight:"0.5rem"},children:t.template_type||"vertrag"}),t.is_default&&e.jsx("span",{style:{padding:"0.2rem 0.5rem",background:"rgba(34, 197, 94, 0.1)",borderRadius:"4px",color:"#22c55e"},children:"â­ Standard"})]})]})}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.75rem"},children:[e.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>(async(e,t,r=null)=>{try{if(Hr(!0),(await l.post(`/mitglieder/${D}/dokumente/generate`,{vorlage_id:e,vertrag_id:r})).data.success){alert("? Dokument erfolgreich erstellt und gespeichert!");const e=await l.get(`/mitglieder/${D}/dokumente`);Or(e.data.data||[])}}catch(n){console.error("Fehler beim Generieren des Dokuments:",n),alert("âŒ Fehler beim Generieren des Dokuments")}finally{Hr(!1)}})(t.id,t.name),disabled:Gr,style:{flex:1,background:"transparent",border:"1px solid rgba(255, 215, 0, 0.2)",color:"rgba(255, 255, 255, 0.7)",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.disabled||(e.currentTarget.style.background="rgba(255, 255, 255, 0.1)",e.currentTarget.style.borderColor="rgba(255, 215, 0, 0.4)",e.currentTarget.style.color="rgba(255, 255, 255, 0.9)")},onMouseLeave:e=>{e.currentTarget.disabled||(e.currentTarget.style.background="transparent",e.currentTarget.style.borderColor="rgba(255, 215, 0, 0.2)",e.currentTarget.style.color="rgba(255, 255, 255, 0.7)")},children:Gr?"Generiere...":"PDF erstellen"}),e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>(async(e,t)=>{try{const r=await l.get(`/vertragsvorlagen/${e}/download`,{responseType:"blob"}),n=window.URL.createObjectURL(new Blob([r.data])),i=document.createElement("a");i.href=n,i.setAttribute("download",`${t.replace(/[^a-zA-Z0-9]/g,"_")}_Vorlage.pdf`),document.body.appendChild(i),i.click(),i.remove(),window.URL.revokeObjectURL(n)}catch(r){console.error("Fehler beim Download der Vorlage:",r),alert("âŒ Fehler beim Download der Vorlage")}})(t.id,t.name),style:{flex:1,background:"transparent",border:"1px solid rgba(255, 215, 0, 0.2)",color:"rgba(255, 255, 255, 0.7)",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.1)",e.currentTarget.style.borderColor="rgba(255, 215, 0, 0.4)",e.currentTarget.style.color="rgba(255, 255, 255, 0.9)"},onMouseLeave:e=>{e.currentTarget.style.background="transparent",e.currentTarget.style.borderColor="rgba(255, 215, 0, 0.2)",e.currentTarget.style.color="rgba(255, 255, 255, 0.7)"},title:"Vorlage als PDF herunterladen",children:"Vorlage"})]})]},t.id))})]})]}),e.jsxs("div",{className:"field-group card",children:[e.jsx("h3",{style:{fontSize:"1.1rem",marginBottom:"1rem"},children:"Gespeicherte Dokumente"}),0===Ur.length?e.jsx("div",{className:"info-box",children:e.jsxs("p",{children:["â„¹ï¸ Keine Dokumente vorhanden. ",m?"Generieren Sie Dokumente aus den Vorlagen oben.":"Es wurden noch keine Dokumente fÃ¼r Sie erstellt."]})}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:Ur.filter(e=>!e.dokumentname.startsWith("Rechnung")).map(t=>e.jsxs("div",{style:{padding:"1rem",border:"1px solid #e5e7eb",borderRadius:"8px",background:"#f9fafb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:600,marginBottom:"0.25rem"},children:t.dokumentname}),e.jsxs("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:["Erstellt: ",new Date(t.erstellt_am).toLocaleDateString("de-DE",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),t.erstellt_von_name&&` von ${t.erstellt_von_name}`]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"dashboard-button",onClick:()=>(async(e,t)=>{try{const r=(await l.get(`/mitglieder/${D}/dokumente/${e}/download`,{responseType:"blob"})).data,n=window.URL.createObjectURL(r),i=document.createElement("a");i.href=n,i.download=t,document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(n),document.body.removeChild(i)}catch(r){console.error("Fehler beim Download des Dokuments:",r),alert("âŒ Fehler beim Download")}})(t.id,t.dokumentname),title:"Dokument herunterladen",children:"Download"}),m&&e.jsx("button",{className:"dashboard-button",onClick:()=>(async e=>{var t,r;const n=new Date(e.erstellt_am).getFullYear()+10,i=new Date(n,11,31,23,59,59);if(new Date<=i){const t=`31.12.${n}`;return void alert(`âš ï¸ Dieses Dokument kann noch nicht gelÃ¶scht werden.\n\nGrund: Gesetzliche Aufbewahrungspflicht nach Â§ 147 AO\nAufbewahrungsfrist: 10 Jahre\nErstellt am: ${new Date(e.erstellt_am).toLocaleDateString("de-DE")}\nLÃ¶schung mÃ¶glich ab: ${t}\n\nDas Dokument wird automatisch nach Ablauf der Frist gelÃ¶scht.`)}if(confirm("MÃ¶chten Sie dieses Dokument wirklich lÃ¶schen?"))try{await l.delete(`/mitglieder/${D}/dokumente/${e.id}`),alert("âœ… Dokument gelÃ¶scht");const t=await l.get(`/mitglieder/${D}/dokumente`);Or(t.data.data||[])}catch(a){console.error("Fehler beim LÃ¶schen des Dokuments:",a),alert("âŒ Fehler beim LÃ¶schen: "+((null==(r=null==(t=a.response)?void 0:t.data)?void 0:r.error)||a.message))}})(t),title:"Dokument lÃ¶schen",children:"LÃ¶schen"})]})]},t.id))})]}),e.jsxs("div",{className:"field-group card",children:[e.jsx("h3",{style:{fontSize:"1.1rem",marginBottom:"1rem"},children:"Rechnungen"}),0===qr.length?e.jsx("div",{className:"info-box",children:e.jsx("p",{children:"â„¹ï¸ Keine Rechnungen vorhanden."})}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:qr.map(t=>e.jsxs("div",{style:{padding:"1rem",border:"1px solid #e5e7eb",borderRadius:"8px",background:"#f9fafb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:600,marginBottom:"0.25rem"},children:t.rechnungsnummer}),e.jsxs("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:["Datum: ",new Date(t.datum).toLocaleDateString("de-DE")," | Betrag: ",Number(t.betrag).toFixed(2)," â‚¬ | Status: ",t.status_text||t.status]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"dashboard-button",onClick:()=>window.open(`/api/rechnungen/${t.rechnung_id}/pdf`,"_blank"),title:"Rechnung als PDF anzeigen",children:"PDF anzeigen"}),m&&e.jsx("button",{className:"dashboard-button",onClick:()=>(async e=>{const t=new Date(e.datum).getFullYear()+10,r=new Date(t,11,31,23,59,59);if(new Date<=r){const r=`31.12.${t}`;return void alert(`âš ï¸ Diese Rechnung kann noch nicht gelÃ¶scht werden.\n\nGrund: Gesetzliche Aufbewahrungspflicht nach Â§ 147 AO\nAufbewahrungsfrist: 10 Jahre\nRechnungsnummer: ${e.rechnungsnummer}\nRechnungsdatum: ${new Date(e.datum).toLocaleDateString("de-DE")}\nLÃ¶schung mÃ¶glich ab: ${r}\n\nDie Rechnung wird automatisch nach Ablauf der Frist gelÃ¶scht.`)}if(window.confirm("MÃ¶chten Sie diese Rechnung wirklich lÃ¶schen?"))try{await l.delete(`/rechnungen/${e.rechnung_id}`),alert("âœ… Rechnung gelÃ¶scht"),await mn()}catch(n){console.error("Fehler beim LÃ¶schen der Rechnung:",n),alert("âŒ Fehler beim LÃ¶schen der Rechnung")}})(t),title:"Rechnung lÃ¶schen",children:"LÃ¶schen"})]})]},t.rechnung_id))})]})]}),en&&Xr&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.75)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},onClick:()=>tn(!1),children:e.jsxs("div",{style:{background:"#1a1a1a",borderRadius:"12px",padding:"2rem",maxWidth:"600px",width:"90%",maxHeight:"80vh",overflow:"auto",border:"1px solid rgba(255, 215, 0, 0.3)"},onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[e.jsx("h2",{style:{margin:0,fontSize:"1.3rem",color:"#FFD700"},children:"ğŸ¦ SEPA-Mandat Details"}),e.jsx("button",{onClick:()=>tn(!1),style:{background:"transparent",border:"none",fontSize:"1.5rem",cursor:"pointer",color:"#fff",padding:"0.25rem 0.5rem"},children:"â†’"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.6)",marginBottom:"0.25rem"},children:"MANDATSREFERENZ"}),e.jsx("div",{style:{fontSize:"1rem",fontWeight:600,color:"#FFD700"},children:Xr.mandatsreferenz})]}),Xr.status&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.6)",marginBottom:"0.25rem"},children:"STATUS"}),e.jsx("div",{style:{fontSize:"0.9rem",color:"aktiv"===Xr.status?"#28a745":"#6c757d"},children:"aktiv"===Xr.status?"âœ… Aktiv":"widerrufen"===Xr.status?"ğŸš« Widerrufen":"ğŸ“¦ Archiviert"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.6)",marginBottom:"0.25rem"},children:"ERSTELLT AM"}),e.jsx("div",{style:{fontSize:"0.9rem"},children:new Date(Xr.erstellungsdatum).toLocaleDateString("de-DE")})]}),Xr.glaeubiger_id&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.6)",marginBottom:"0.25rem"},children:"GLÃ„UBIGER-ID"}),e.jsx("div",{style:{fontSize:"0.9rem",fontFamily:"monospace"},children:Xr.glaeubiger_id})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.6)",marginBottom:"0.25rem"},children:"KONTOINHABER"}),e.jsx("div",{style:{fontSize:"0.9rem"},children:Xr.kontoinhaber||"N/A"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.6)",marginBottom:"0.25rem"},children:"IBAN"}),e.jsx("div",{style:{fontSize:"0.9rem",fontFamily:"monospace"},children:Xr.iban||"N/A"})]}),Xr.bic&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.6)",marginBottom:"0.25rem"},children:"BIC"}),e.jsx("div",{style:{fontSize:"0.9rem",fontFamily:"monospace"},children:Xr.bic})]}),Xr.archiviert_am&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.6)",marginBottom:"0.25rem"},children:"ARCHIVIERT AM"}),e.jsx("div",{style:{fontSize:"0.9rem"},children:new Date(Xr.archiviert_am).toLocaleDateString("de-DE")})]}),Xr.widerruf_datum&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.6)",marginBottom:"0.25rem"},children:"WIDERRUFEN AM"}),e.jsx("div",{style:{fontSize:"0.9rem"},children:new Date(Xr.widerruf_datum).toLocaleDateString("de-DE")})]}),Xr.archiviert_grund&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.6)",marginBottom:"0.25rem"},children:"GRUND"}),e.jsx("div",{style:{fontSize:"0.9rem"},children:Xr.archiviert_grund})]})]}),e.jsx("div",{style:{marginTop:"2rem",display:"flex",justifyContent:"flex-end",gap:"0.75rem"},children:e.jsx("button",{className:"btn btn-secondary",onClick:()=>tn(!1),style:{fontSize:"0.9rem"},children:"SchlieÃŸen"})})]})}),"familie"===ae&&e.jsx(le,{mitglied:R,updatedData:W,editMode:Xe,handleChange:fn,CustomSelect:pe}),"vertrag"===ae&&e.jsxs("div",{style:{width:"100%",maxWidth:"1400px",margin:"0 auto",padding:"1rem"},children:[e.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(30, 30, 40, 0.95) 0%, rgba(20, 20, 30, 0.98) 100%)",borderRadius:"16px",padding:"2rem",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.3)",border:"1px solid rgba(255, 255, 255, 0.05)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem",paddingBottom:"1rem",borderBottom:"2px solid rgba(255, 215, 0, 0.2)"},children:[e.jsx("h3",{style:{margin:0,fontSize:"1.8rem",fontWeight:"700",background:"linear-gradient(135deg, #FFD700 0%, #FFA500 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"Vertragsverwaltung"}),m&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"vertragsfrei-button "+((null==R?void 0:R.vertragsfrei)?"vertragsfrei-button-active":""),onClick:async()=>{const e=!(null==R?void 0:R.vertragsfrei),t=e?prompt("Grund fÃ¼r Vertragsfreistellung:\n(z.B. Ehrenmitglied, Familie, Sponsor, etc.)"):null;if(!e||t)try{await l.put(`/mitglieddetail/${R.mitglied_id}`,{vertragsfrei:e?1:0,vertragsfrei_grund:t||null}),L(r=>({...r,vertragsfrei:e?1:0,vertragsfrei_grund:t||null})),alert(e?"âœ… Mitglied wurde als vertragsfrei markiert":"âœ… Vertragsfreistellung wurde aufgehoben")}catch(r){console.error("Fehler beim Aktualisieren:",r),alert("âŒ Fehler beim Speichern der Vertragsfreistellung")}},children:(null==R?void 0:R.vertragsfrei)?"âœ… Vertragsfrei":"ğŸ“ Vertragsfrei stellen"}),e.jsx("button",{className:"neuer-vertrag-button",onClick:()=>jt(!0),children:"â• Neuer Vertrag"})]})]}),m&&(null==R?void 0:R.vertragsfrei)&&(null==R?void 0:R.vertragsfrei_grund)&&e.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1rem 1.5rem",background:"rgba(52, 152, 219, 0.1)",borderRadius:"8px",border:"1px solid rgba(52, 152, 219, 0.3)"},children:[e.jsx("div",{style:{fontSize:"1rem",fontWeight:"600",color:"#5dade2",marginBottom:"0.5rem"},children:"Mitglied ist aus folgendem Grund Beitrags- bzw. Vertragsfrei"}),e.jsxs("div",{style:{fontSize:"0.9rem",color:"#5dade2"},children:[e.jsx("strong",{children:"Grund:"})," ",R.vertragsfrei_grund]})]}),st.length>0?e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(450px, 1fr))",gap:"1.5rem"},children:st.map(t=>e.jsxs("div",{className:"vertrag-card",style:{background:"linear-gradient(135deg, rgba(40, 40, 50, 0.6) 0%, rgba(30, 30, 40, 0.8) 100%)",borderRadius:"12px",padding:"1.5rem",border:"1px solid rgba(255, 255, 255, 0.08)",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.2)",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-4px)",e.currentTarget.style.boxShadow="0 8px 24px rgba(0, 0, 0, 0.3)",e.currentTarget.style.borderColor="rgba(255, 215, 0, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 16px rgba(0, 0, 0, 0.2)",e.currentTarget.style.borderColor="rgba(255, 255, 255, 0.08)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsxs("div",{children:[e.jsxs("h4",{style:{margin:"0 0 0.25rem 0",fontSize:"1.2rem",fontWeight:"600",color:"#FFD700"},children:["ğŸ“„ Vertrag #",t.personenVertragNr]}),e.jsxs("span",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)"},children:["Erstellt: ",new Date(t.created_at||t.vertragsbeginn).toLocaleDateString("de-DE")]})]}),e.jsx("span",{style:{padding:"0.4rem 0.8rem",borderRadius:"20px",fontSize:"0.75rem",fontWeight:"600",whiteSpace:"nowrap",background:t.geloescht?"rgba(128, 128, 128, 0.15)":"aktiv"===t.status?"rgba(46, 213, 115, 0.15)":"gekuendigt"===t.status?"rgba(255, 193, 7, 0.15)":"ruhepause"===t.status?"rgba(52, 152, 219, 0.15)":"rgba(231, 76, 60, 0.15)",color:t.geloescht?"#808080":"aktiv"===t.status?"#2ed573":"gekuendigt"===t.status?"#ffc107":"ruhepause"===t.status?"#3498db":"#e74c3c",border:"1px solid "+(t.geloescht?"rgba(128, 128, 128, 0.3)":"aktiv"===t.status?"rgba(46, 213, 115, 0.3)":"gekuendigt"===t.status?"rgba(255, 193, 7, 0.3)":"ruhepause"===t.status?"rgba(52, 152, 219, 0.3)":"rgba(231, 76, 60, 0.3)")},children:t.geloescht?"ğŸ—‘ï¸ GELÃ–SCHT":"aktiv"===t.status?"âœ… AKTIV":"gekuendigt"===t.status?"âŒ GEKÃœNDIGT":"ruhepause"===t.status?"â¸ï¸ RUHEPAUSE":"â¹ï¸ BEENDET"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.6rem",marginBottom:"1.25rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.9rem"},children:[e.jsx("span",{style:{fontSize:"1.1rem"},children:"ğŸ“„"}),e.jsx("span",{style:{color:"rgba(255, 255, 255, 0.6)",minWidth:"80px"},children:"TARIF:"}),e.jsxs("strong",{style:{color:"#fff"},children:[t.tarif_name||"Keine Angabe",t.monatsbeitrag&&` - â‚¬${parseFloat(t.monatsbeitrag).toFixed(2)}/Monat`]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.9rem"},children:[e.jsx("span",{style:{fontSize:"1.1rem"},children:"ğŸ“„"}),e.jsx("span",{style:{color:"rgba(255, 255, 255, 0.6)",minWidth:"80px"},children:"LAUFZEIT:"}),e.jsx("strong",{style:{color:"#fff"},children:t.vertragsbeginn&&t.vertragsende?`${new Date(t.vertragsbeginn).toLocaleDateString("de-DE")} bis ${new Date(t.vertragsende).toLocaleDateString("de-DE")}`:"Keine Angabe"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.9rem"},children:[e.jsx("span",{style:{fontSize:"1.1rem"},children:"ğŸ“„"}),e.jsx("span",{style:{color:"rgba(255, 255, 255, 0.6)",minWidth:"80px"},children:"ZAHLUNG:"}),e.jsx("strong",{style:{color:"#fff"},children:t.billing_cycle?xe(t.billing_cycle):"Keine Angabe"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.9rem"},children:[e.jsx("span",{style:{fontSize:"1.1rem"},children:"ğŸ’³"}),e.jsx("span",{style:{color:"rgba(255, 255, 255, 0.6)",minWidth:"80px"},children:"ZAHLART:"}),e.jsx("strong",{style:{color:"#fff"},children:"direct_debit"===t.payment_method?"ğŸ¦ Lastschrift":"bank_transfer"===t.payment_method?"ğŸ’³ Ãœberweisung":"cash"===t.payment_method?"ğŸ’µ Bar":t.payment_method||"Keine Angabe"})]}),t.aufnahmegebuehr_cents&&t.aufnahmegebuehr_cents>0&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.9rem"},children:[e.jsx("span",{style:{fontSize:"1.1rem"},children:"ğŸ’µ"}),e.jsx("span",{style:{color:"rgba(255, 255, 255, 0.6)",minWidth:"80px"},children:"AUFNAHME:"}),e.jsxs("strong",{style:{color:"#ff9800"},children:["â‚¬",(t.aufnahmegebuehr_cents/100).toFixed(2)]})]}),t.kuendigungsfrist_monate&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.9rem"},children:[e.jsx("span",{style:{fontSize:"1.1rem"},children:"â°"}),e.jsx("span",{style:{color:"rgba(255, 255, 255, 0.6)",minWidth:"80px"},children:"KÃœNDIGUNG:"}),e.jsxs("strong",{style:{color:"#fff"},children:[t.kuendigungsfrist_monate," ",1===t.kuendigungsfrist_monate?"Monat":"Monate"," Frist"]})]}),t.mindestlaufzeit_monate&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.9rem"},children:[e.jsx("span",{style:{fontSize:"1.1rem"},children:"â±ï¸"}),e.jsx("span",{style:{color:"rgba(255, 255, 255, 0.6)",minWidth:"80px"},children:"MIN.LAUFZEIT:"}),e.jsxs("strong",{style:{color:"#fff"},children:[t.mindestlaufzeit_monate," ",1===t.mindestlaufzeit_monate?"Monat":"Monate"]})]}),t.kuendigung_eingegangen&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.9rem",padding:"0.5rem",background:"rgba(255, 193, 7, 0.1)",borderRadius:"6px",border:"1px solid rgba(255, 193, 7, 0.3)"},children:[e.jsx("span",{style:{fontSize:"1.1rem"},children:"ğŸ“„"}),e.jsx("span",{style:{color:"#ffc107"},children:"KÃ¼ndigung eingegangen:"}),e.jsx("strong",{style:{color:"#ffc107"},children:new Date(t.kuendigung_eingegangen).toLocaleDateString("de-DE")})]}),"ruhepause"===t.status&&t.ruhepause_von&&t.ruhepause_bis&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.9rem",padding:"0.5rem",background:"rgba(52, 152, 219, 0.15)",borderRadius:"6px",border:"1px solid rgba(52, 152, 219, 0.4)"},children:[e.jsx("span",{style:{fontSize:"1.1rem"},children:"â¸ï¸"}),e.jsx("span",{style:{color:"#3498db"},children:"Ruhepause:"}),e.jsxs("strong",{style:{color:"#3498db"},children:[new Date(t.ruhepause_von).toLocaleDateString("de-DE")," bis ",new Date(t.ruhepause_bis).toLocaleDateString("de-DE")]})]})]}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem"},children:[e.jsx("button",{onClick:()=>{Nt(t),St(!0)},onMouseEnter:e=>{e.currentTarget.style.background="rgba(244, 67, 54, 0.3)",e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 4px 12px rgba(244, 67, 54, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(244, 67, 54, 0.15)",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none"},style:{background:"rgba(244, 67, 54, 0.15)",color:"#f44336",border:"1px solid rgba(244, 67, 54, 0.4)",borderRadius:"8px",padding:"0.6rem 1rem",fontSize:"0.85rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",display:"inline-flex",alignItems:"center",gap:"0.4rem"},children:"ğŸ“„ PDF"}),e.jsx("button",{onClick:()=>{Nt(t),wt(!0)},onMouseEnter:e=>{e.currentTarget.style.background="rgba(33, 150, 243, 0.3)",e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 4px 12px rgba(33, 150, 243, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(33, 150, 243, 0.15)",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none"},style:{background:"rgba(33, 150, 243, 0.15)",color:"#2196F3",border:"1px solid rgba(33, 150, 243, 0.4)",borderRadius:"8px",padding:"0.6rem 1rem",fontSize:"0.85rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",display:"inline-flex",alignItems:"center",gap:"0.4rem"},children:"ğŸ” Details"}),m&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>vt(t),onMouseEnter:e=>{e.currentTarget.style.background="rgba(255, 215, 0, 0.3)",e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 4px 12px rgba(255, 215, 0, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(255, 215, 0, 0.15)",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none"},style:{background:"rgba(255, 215, 0, 0.15)",color:"#FFD700",border:"1px solid rgba(255, 215, 0, 0.4)",borderRadius:"8px",padding:"0.6rem 1rem",fontSize:"0.85rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",display:"inline-flex",alignItems:"center",gap:"0.4rem"},children:"âœï¸ Bearbeiten"}),"aktiv"===t.status&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>pn(t.id,"ruhepause"),onMouseEnter:e=>{e.currentTarget.style.background="rgba(255, 193, 7, 0.3)",e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 4px 12px rgba(255, 193, 7, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(255, 193, 7, 0.15)",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none"},style:{background:"rgba(255, 193, 7, 0.15)",color:"#ffc107",border:"1px solid rgba(255, 193, 7, 0.4)",borderRadius:"8px",padding:"0.6rem 1rem",fontSize:"0.85rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",display:"inline-flex",alignItems:"center",gap:"0.4rem"},children:"â¸ï¸ Ruhepause"}),e.jsx("button",{onClick:()=>pn(t.id,"kÃ¼ndigen"),onMouseEnter:e=>{e.currentTarget.style.background="rgba(231, 76, 60, 0.3)",e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 4px 12px rgba(231, 76, 60, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(231, 76, 60, 0.15)",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none"},style:{background:"rgba(231, 76, 60, 0.15)",color:"#e74c3c",border:"1px solid rgba(231, 76, 60, 0.4)",borderRadius:"8px",padding:"0.6rem 1rem",fontSize:"0.85rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",display:"inline-flex",alignItems:"center",gap:"0.4rem"},children:"âŒ KÃ¼ndigen"})]}),"ruhepause"===t.status&&e.jsx("button",{onClick:()=>pn(t.id,"reaktivieren"),onMouseEnter:e=>{e.currentTarget.style.background="rgba(46, 213, 115, 0.3)",e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 4px 12px rgba(46, 213, 115, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(46, 213, 115, 0.15)",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none"},style:{background:"rgba(46, 213, 115, 0.15)",color:"#2ed573",border:"1px solid rgba(46, 213, 115, 0.4)",borderRadius:"8px",padding:"0.6rem 1rem",fontSize:"0.85rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",display:"inline-flex",alignItems:"center",gap:"0.4rem"},children:"â–¶ï¸ Reaktivieren"}),"gekuendigt"===t.status&&!t.geloescht&&e.jsx("button",{onClick:()=>(async e=>{if(window.confirm(`MÃ¶chten Sie die KÃ¼ndigung von Vertrag #${e.personenVertragNr} wirklich aufheben?\n\nDer Vertrag wird wieder auf "aktiv" gesetzt und ist im regulÃ¤ren Zahlungslauf.`))try{await l.put(`/vertraege/${e.id}`,{status:"aktiv",kuendigung_eingegangen:null,kuendigungsgrund:null,kuendigungsdatum:null,dojo_id:null==R?void 0:R.dojo_id}),await on()}catch(t){console.error("Fehler beim Aufheben der KÃ¼ndigung:",t),alert("Fehler beim Aufheben der KÃ¼ndigung. Bitte versuchen Sie es erneut.")}})(t),onMouseEnter:e=>{e.currentTarget.style.background="rgba(46, 213, 115, 0.3)",e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 4px 12px rgba(46, 213, 115, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(46, 213, 115, 0.15)",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none"},style:{background:"rgba(46, 213, 115, 0.15)",color:"#2ed573",border:"1px solid rgba(46, 213, 115, 0.4)",borderRadius:"8px",padding:"0.6rem 1rem",fontSize:"0.85rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",display:"inline-flex",alignItems:"center",gap:"0.4rem"},children:"ğŸ”„ KÃ¼ndigung aufheben"}),m&&!t.geloescht&&e.jsx("button",{onClick:()=>(async e=>{const t=new Date;t.setHours(0,0,0,0);let r=!1;if(e.vertragsende){const n=new Date(e.vertragsende);n.setHours(0,0,0,0),r=n<t}if(r=r||"aktiv"!==e.status||e.kuendigung_eingegangen||e.kuendigungsdatum,!r)return Kt(e),void Pt(!0);const n=window.prompt(`âš ï¸ Vertrag #${e.personenVertragNr} lÃ¶schen?\n\nDer Vertrag wird archiviert und kann nicht wiederhergestellt werden.\nEr bleibt zur Ansicht sichtbar.\n\nBitte Grund fÃ¼r LÃ¶schung eingeben (optional):`);if(null!==n)try{await l.delete(`/vertraege/${e.id}`,{data:{dojo_id:null==R?void 0:R.dojo_id,geloescht_von:(null==S?void 0:S.username)||"Admin",geloescht_grund:n||"Kein Grund angegeben"}}),alert("âœ… Vertrag wurde erfolgreich archiviert."),await on()}catch(i){console.error("Fehler beim LÃ¶schen des Vertrags:",i),alert("Fehler beim LÃ¶schen des Vertrags. Bitte versuchen Sie es erneut.")}})(t),onMouseEnter:e=>{e.currentTarget.style.background="rgba(231, 76, 60, 0.3)",e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 4px 12px rgba(231, 76, 60, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(231, 76, 60, 0.15)",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none"},style:{background:"rgba(231, 76, 60, 0.15)",color:"#e74c3c",border:"1px solid rgba(231, 76, 60, 0.4)",borderRadius:"8px",padding:"0.6rem 1rem",fontSize:"0.85rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",display:"inline-flex",alignItems:"center",gap:"0.4rem"},children:"ğŸ—‘ï¸ LÃ¶schen"})]}),!m&&"aktiv"===t.status&&e.jsx("button",{onClick:()=>pn(t.id,"ruhepause"),onMouseEnter:e=>{e.currentTarget.style.background="rgba(255, 193, 7, 0.3)",e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 4px 12px rgba(255, 193, 7, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(255, 193, 7, 0.15)",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none"},style:{background:"rgba(255, 193, 7, 0.15)",color:"#ffc107",border:"1px solid rgba(255, 193, 7, 0.4)",borderRadius:"8px",padding:"0.6rem 1rem",fontSize:"0.85rem",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",display:"inline-flex",alignItems:"center",gap:"0.4rem"},children:"â¸ï¸ Ruhepause beantragen"})]})]},t.id))}):e.jsxs("div",{style:{textAlign:"center",padding:"3rem 1rem",background:"rgba(255, 255, 255, 0.02)",borderRadius:"12px",border:"2px dashed rgba(255, 255, 255, 0.1)"},children:[e.jsx("p",{style:{fontSize:"1.1rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"1.5rem"},children:"Keine VertrÃ¤ge vorhanden"}),m&&e.jsx("button",{className:"neuer-vertrag-button",onClick:()=>jt(!0),children:"â• Ersten Vertrag erstellen"})]})]}),e.jsx(Y,{mitgliedId:null==R?void 0:R.mitglied_id,mitglied:R,isAdmin:m})]}),"anwesenheit"===ae&&e.jsxs("div",{className:"anwesenheit-container",children:[e.jsxs("div",{className:"anwesenheit-stats-grid",children:[e.jsxs("div",{className:"stat-card primary",children:[e.jsx("div",{className:"stat-icon",children:"ğŸ“Š"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-label",children:"Gesamte Anwesenheiten"}),e.jsx("div",{className:"stat-value",children:it.totalAnwesenheiten||0})]})]}),e.jsxs("div",{className:"stat-card secondary",children:[e.jsx("div",{className:"stat-icon",children:"ğŸ“Š"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-label",children:"MÃ¶gliche Trainings"}),e.jsx("div",{className:"stat-value",children:it.totalMÃ¶glicheAnwesenheiten||0})]})]}),e.jsxs("div",{className:"stat-card accent",children:[e.jsx("div",{className:"stat-icon",children:"ğŸ“Š"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-label",children:"Anwesenheitsquote"}),e.jsxs("div",{className:"stat-value "+(it.anwesenheitsquote>=75?"success":it.anwesenheitsquote>=50?"warning":"error"),children:[it.anwesenheitsquote||0,"%"]})]})]}),e.jsxs("div",{className:"stat-card info",children:[e.jsx("div",{className:"stat-icon",children:"ğŸ“Š"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-label",children:"Letzte Anwesenheit"}),e.jsx("div",{className:"stat-value",children:it.letzteAnwesenheit?new Date(it.letzteAnwesenheit).toLocaleDateString("de-DE"):"-"})]})]})]}),e.jsxs("div",{className:"anwesenheit-details",children:[e.jsxs("div",{className:"detail-row",children:[e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"Diesen Monat"}),e.jsx("span",{className:"detail-value highlight",children:it.thisMonthAttendances||0})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"â†’ Pro Monat (6M)"}),e.jsx("span",{className:"detail-value",children:it.avgPerMonth||0})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"Letzte Woche"}),e.jsx("span",{className:"detail-value",children:it.lastWeekAttendances||0})]})]}),e.jsxs("div",{className:"detail-row",children:[e.jsxs("div",{className:"detail-item streak",children:[e.jsx("span",{className:"detail-label",children:"ğŸ”¥ Streak"}),e.jsxs("span",{className:"detail-value "+(it.currentStreak>=5?"excellent":it.currentStreak>=3?"good":"normal"),children:[it.currentStreak||0," Trainings in Folge"]})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"ğŸ“ˆ Konsistenz"}),e.jsxs("span",{className:"detail-value",children:[it.consecutiveMonths||0," Monate"]})]}),it.bestMonth&&e.jsxs("div",{className:"detail-item best",children:[e.jsx("span",{className:"detail-label",children:"ğŸ† Bester Monat"}),e.jsxs("span",{className:"detail-value excellent",children:[it.bestMonth.month," (",it.bestMonth.count,")"]})]})]})]}),it.monthlyStats&&it.monthlyStats.length>0&&e.jsxs("div",{className:"monthly-overview",children:[e.jsx("h3",{children:"Monatliche Ãœbersicht"}),e.jsx("div",{className:"monthly-grid",children:it.monthlyStats.map((t,r)=>e.jsxs("div",{className:"month-item "+(0===t.count?"no-data":""),children:[e.jsx("span",{className:"month-name",children:t.month}),e.jsx("span",{className:"month-count "+(t.count>=8?"excellent":t.count>=4?"good":t.count>0?"ok":"poor"),children:t.count})]},r))})]}),e.jsxs("div",{className:"anwesenheit-liste",children:[e.jsx("h3",{children:"Letzte Anwesenheiten"}),e.jsx("div",{className:"attendance-grid",children:et.filter(e=>e.anwesend).length>0?et.filter(e=>e.anwesend).sort((e,t)=>new Date(t.datum)-new Date(e.datum)).slice(0,24).map((t,r)=>e.jsx("div",{className:"attendance-item",children:e.jsx("span",{className:"attendance-date",children:new Date(t.datum).toLocaleDateString("de-DE")})},r)):e.jsx("div",{className:"no-data-message",children:e.jsx("span",{children:"Keine Anwesenheitsdaten verfÃ¼gbar"})})})]})]}),"finanzen"===ae&&e.jsxs("div",{className:"finance-management-container",children:[e.jsxs("div",{className:"finance-sub-tabs",style:{display:"flex",gap:"0.5rem",marginBottom:"1.5rem",flexWrap:"wrap"},children:[e.jsx("button",{className:"finance-sub-tab-btn "+("finanzÃ¼bersicht"===ye?"active":""),onClick:()=>ve("finanzÃ¼bersicht"),children:"ğŸ’° FinanzÃ¼bersicht"}),e.jsx("button",{className:"finance-sub-tab-btn "+("zahlungshistorie"===ye?"active":""),onClick:()=>ve("zahlungshistorie"),children:"ğŸ“Š Zahlungshistorie"}),e.jsx("button",{className:"finance-sub-tab-btn "+("beitraege"===ye?"active":""),onClick:()=>ve("beitraege"),children:"ğŸ’³ BeitrÃ¤ge"}),e.jsx("button",{className:"finance-sub-tab-btn "+("bank"===ye?"active":""),onClick:()=>ve("bank"),children:"ğŸ¦ Bank & SEPA"})]}),"finanzÃ¼bersicht"===ye&&e.jsx("div",{className:"finanzÃ¼bersicht-sub-tab-content",children:(()=>{const t=rt.filter(e=>e.bezahlt),r=rt.filter(e=>!e.bezahlt),n=t.reduce((e,t)=>e+parseFloat(t.betrag||0),0),i=r.reduce((e,t)=>e+parseFloat(t.betrag||0),0),a=n+i,s=rt.length>0?a/rt.length:0,l=st&&st.length>0?st.reduce((e,t)=>e+(t.aufnahmegebuehr_cents||0),0)/100:0,d=t.length>0?t.sort((e,t)=>new Date(t.zahlungsdatum||t.datum)-new Date(e.zahlungsdatum||e.datum))[0]:null,o=r.length>0?r.sort((e,t)=>new Date(e.datum||e.zahlungsdatum)-new Date(t.datum||t.zahlungsdatum))[0]:null,c=(new Date).getFullYear();t.filter(e=>new Date(e.zahlungsdatum||e.datum).getFullYear()===c).reduce((e,t)=>e+parseFloat(t.betrag||0),0);const g=t.filter(e=>e.datum&&e.zahlungsdatum&&e.generiert).map(e=>{const t=new Date(e.datum),r=new Date(e.zahlungsdatum);return Math.max(0,Math.floor((r-t)/864e5))}),h=g.length>0?Math.round(g.reduce((e,t)=>e+t,0)/g.length):0;return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.25rem"},children:[e.jsxs("div",{className:"finance-kpi-card",style:{background:"linear-gradient(135deg, rgba(239, 68, 68, 0.15) 0%, rgba(239, 68, 68, 0.05) 100%)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:"12px",padding:"1.5rem",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.2)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("span",{style:{fontSize:"2rem"},children:"âš ï¸"}),e.jsx("h4",{style:{margin:0,color:"rgba(255, 255, 255, 0.9)",fontSize:"0.9rem",fontWeight:"600"},children:"Offene BetrÃ¤ge"})]}),e.jsxs("div",{style:{fontSize:"2rem",fontWeight:"700",color:"#ef4444",marginBottom:"0.25rem"},children:[i.toFixed(2)," â‚¬"]}),e.jsxs("div",{style:{fontSize:"0.85rem",color:"rgba(255, 255, 255, 0.6)"},children:[r.length," ausstehende BeitrÃ¤ge"]})]}),e.jsxs("div",{className:"finance-kpi-card",style:{background:"linear-gradient(135deg, rgba(255, 215, 0, 0.15) 0%, rgba(255, 215, 0, 0.05) 100%)",border:"1px solid rgba(255, 215, 0, 0.3)",borderRadius:"12px",padding:"1.5rem",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.2)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("span",{style:{fontSize:"2rem"},children:"ğŸ“Š"}),e.jsx("h4",{style:{margin:0,color:"rgba(255, 255, 255, 0.9)",fontSize:"0.9rem",fontWeight:"600"},children:"Ã˜ Beitrag"})]}),e.jsxs("div",{style:{fontSize:"2rem",fontWeight:"700",color:"#ffd700",marginBottom:"0.25rem"},children:[s.toFixed(2)," â‚¬"]}),e.jsx("div",{style:{fontSize:"0.85rem",color:"rgba(255, 255, 255, 0.6)"},children:"Pro Zahlung"})]}),d&&e.jsxs("div",{className:"finance-kpi-card",style:{background:"linear-gradient(135deg, rgba(34, 197, 94, 0.15) 0%, rgba(34, 197, 94, 0.05) 100%)",border:"1px solid rgba(34, 197, 94, 0.3)",borderRadius:"12px",padding:"1.5rem",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.2)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("span",{style:{fontSize:"2rem"},children:"âœ…"}),e.jsx("h4",{style:{margin:0,color:"rgba(255, 255, 255, 0.9)",fontSize:"0.9rem",fontWeight:"600"},children:"Letzte Zahlung"})]}),e.jsxs("div",{style:{fontSize:"2rem",fontWeight:"700",color:"#22c55e",marginBottom:"0.25rem"},children:[parseFloat(d.betrag||0).toFixed(2)," â‚¬"]}),e.jsx("div",{style:{fontSize:"0.85rem",color:"rgba(255, 255, 255, 0.6)"},children:new Date(d.zahlungsdatum||d.datum).toLocaleDateString("de-DE")})]}),e.jsxs("div",{className:"finance-kpi-card",style:{background:"linear-gradient(135deg, rgba(59, 130, 246, 0.15) 0%, rgba(59, 130, 246, 0.05) 100%)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"12px",padding:"1.5rem",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.2)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[e.jsx("span",{style:{fontSize:"2rem"},children:"ğŸ“…"}),e.jsx("h4",{style:{margin:0,color:"rgba(255, 255, 255, 0.9)",fontSize:"0.9rem",fontWeight:"600"},children:"NÃ¤chste Zahlung"})]}),o?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{fontSize:"2rem",fontWeight:"700",color:"#3b82f6",marginBottom:"0.25rem"},children:[parseFloat(o.betrag||0).toFixed(2)," â‚¬"]}),e.jsx("div",{style:{fontSize:"0.85rem",color:"rgba(255, 255, 255, 0.6)"},children:new Date(o.datum||o.zahlungsdatum).toLocaleDateString("de-DE")})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{fontSize:"2rem",fontWeight:"700",color:"#3b82f6",marginBottom:"0.25rem"},children:"-"}),e.jsx("div",{style:{fontSize:"0.85rem",color:"rgba(255, 255, 255, 0.6)"},children:"Keine ausstehenden Zahlungen"})]})]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.25rem"},children:e.jsxs("div",{className:"field-group card",children:[e.jsx("h3",{style:{marginTop:0,marginBottom:"1rem",background:"linear-gradient(135deg, #FFD700 0%, #FFA500 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"Zahlungsinformationen"}),e.jsxs("div",{className:"finance-stats",children:[e.jsxs("div",{className:"stat-item",children:[e.jsx("label",{children:"Zahlungsmethode:"}),e.jsx("span",{className:"stat-value",children:(null==R?void 0:R.zahlungsmethode)||"Nicht angegeben"})]}),d&&e.jsxs("div",{className:"stat-item",children:[e.jsx("label",{children:"Letzter Zahlungseingang:"}),e.jsx("span",{className:"stat-value",children:new Date(d.zahlungsdatum||d.datum).toLocaleDateString("de-DE")})]}),h>0&&e.jsxs("div",{className:"stat-item",children:[e.jsx("label",{children:"Ã˜ Zahlungsdauer:"}),e.jsxs("span",{className:"stat-value",children:[h," Tage"]})]}),l>0&&e.jsxs("div",{className:"stat-item",children:[e.jsx("label",{children:"AufnahmegebÃ¼hren:"}),e.jsxs("span",{className:"stat-value",style:{color:"#ff9800"},children:[l.toFixed(2)," â‚¬"]})]})]})]})})]})})()}),"zahlungshistorie"===ye&&e.jsx("div",{className:"zahlungshistorie-sub-tab-content",children:e.jsxs("div",{className:"field-group card",style:{width:"100%"},children:[e.jsx("h3",{children:"Zahlungshistorie"}),rt.length>0?e.jsx("div",{className:"zahlungshistorie-table-wrapper",children:e.jsxs("table",{className:"zahlungshistorie-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Zahlungsdatum"}),e.jsx("th",{children:"FÃ¤lligkeitsdatum"}),e.jsx("th",{children:"Betrag"}),e.jsx("th",{children:"Zahlungsart"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:rt.sort((e,t)=>new Date(t.zahlungsdatum||t.datum)-new Date(e.zahlungsdatum||e.datum)).map((t,r)=>{var n,i,a,s,l;const d=!0===t.bezahlt||1===t.bezahlt||"1"===t.bezahlt||"1"===String(t.bezahlt);return e.jsxs("tr",{className:d?"paid-row":"unpaid-row",children:[e.jsx("td",{children:t.zahlungsdatum?new Date(t.zahlungsdatum).toLocaleDateString("de-DE"):"-"}),e.jsx("td",{children:t.datum?new Date(t.datum).toLocaleDateString("de-DE"):t.zahlungsdatum?new Date(t.zahlungsdatum).toLocaleDateString("de-DE"):"-"}),e.jsx("td",{className:"betrag",children:t.betrag?`${parseFloat(t.betrag).toFixed(2)} â‚¬`:"0,00 â‚¬"}),e.jsx("td",{children:"Ã¼berweisung"===(null==(n=t.zahlungsart)?void 0:n.toLowerCase())||"Ãœberweisung"===(null==(i=t.zahlungsart)?void 0:i.toLowerCase())?"ğŸ’³ Ãœberweisung":"lastschrift"===(null==(a=t.zahlungsart)?void 0:a.toLowerCase())||"direct_debit"===(null==(s=t.zahlungsart)?void 0:s.toLowerCase())?"ğŸ¦ Lastschrift":"bar"===(null==(l=t.zahlungsart)?void 0:l.toLowerCase())?"ğŸ’µ Bar":t.zahlungsart||"Unbekannt"}),e.jsx("td",{children:e.jsx("span",{className:"status-badge "+(d?"status-paid":"status-unpaid"),children:d?"âœ… Bezahlt":"â³ Ausstehend"})})]},t.beitrag_id||r)})})]})}):e.jsxs("div",{className:"no-data-message",children:[e.jsx("p",{children:"â„¹ï¸ Keine Zahlungshistorie verfÃ¼gbar"}),e.jsx("small",{children:"Es wurden noch keine Zahlungen erfasst."})]})]})}),"beitraege"===ye&&e.jsx("div",{className:"beitraege-sub-tab-content",children:(()=>{const t=(e,t)=>{const r={};return[...e].sort((e,t)=>{const r=new Date(e.datum||e.zahlungsdatum);return new Date(t.datum||t.zahlungsdatum)-r}).forEach(e=>{const n=new Date(e.datum||e.zahlungsdatum);let i="";if("monat"===t)i=`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`;else if("quartal"===t){const e=Math.floor(n.getMonth()/3)+1;i=`${n.getFullYear()}-Q${e}`}else"jahr"===t&&(i=`${n.getFullYear()}`);r[i]||(r[i]=[]),r[i].push(e)}),r},r=(e,t)=>{if("monat"===t){const[t,r]=e.split("-");return new Date(t,r-1).toLocaleDateString("de-DE",{year:"numeric",month:"long"})}return"quartal"===t?e.replace("-Q",". Quartal "):e},n=()=>{const e=[],t=new Date;t.setHours(0,0,0,0);return st.filter(e=>"aktiv"===e.status&&!!e.vertragsbeginn).forEach(r=>{const n=new Date(r.vertragsbeginn);n.setHours(0,0,0,0);let i=null,a=null,s=null;if(r.kuendigung_eingegangen||r.kuendigungsdatum?(a=r.kuendigungsdatum?new Date(r.kuendigungsdatum):r.kuendigung_eingegangen?new Date(r.kuendigung_eingegangen):null,a&&(s=new Date(a),i=new Date(a))):r.vertragsende&&(s=new Date(r.vertragsende),i=new Date(r.vertragsende)),i&&r.automatische_verlaengerung&&!r.kuendigung_eingegangen){const e=new Date;if(e.setHours(0,0,0,0),e>i){const e=r.verlaengerung_monate||12;i=new Date(i),i.setMonth(i.getMonth()+e),s=new Date(i)}}i||(i=new Date,i.setMonth(i.getMonth()+12),s=new Date(i)),i.setHours(23,59,59,999);const l=parseFloat(r.monatsbeitrag||r.monatlicher_beitrag||0);if(l<=0)return;const d=r.faelligkeit_tag||1;let o=new Date(n);for(o.setDate(d),o<t&&(o=new Date(t),o.setDate(d),o<t&&o.setMonth(o.getMonth()+1));o<=i;){const t=o.getMonth(),n=o.getFullYear();if(!rt.some(e=>{if(e.magicline_description)return!1;const r=e.zahlungsdatum?new Date(e.zahlungsdatum):null;return!(!r||isNaN(r.getTime()))&&(r.getMonth()===t&&r.getFullYear()===n)})){let t=l;const n=a||s,i=n&&o.getMonth()===n.getMonth()&&o.getFullYear()===n.getFullYear();if(i&&a){new Date(o.getFullYear(),o.getMonth(),1);const e=new Date(o.getFullYear(),o.getMonth()+1,0).getDate(),r=a.getDate(),n=Math.min(r,e)/e;t=Math.round(l*n*100)/100}const d=`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}-${String(o.getDate()).padStart(2,"0")}`;e.push({beitrag_id:`generated_${r.id}_${o.getTime()}`,betrag:t.toFixed(2),zahlungsdatum:null,faelligkeitsdatum:d,datum:d,zahlungsart:"direct_debit"===r.payment_method?"Lastschrift":"transfer"===r.payment_method?"Ãœberweisung":r.payment_method||"Unbekannt",bezahlt:0,generiert:!0,vertrag_id:r.id,anteilig:i&&null!==a})}o.setMonth(o.getMonth()+1)}}),e},i=n(),a=[...rt,...i];a.sort((e,t)=>{const r=new Date(e.datum||e.zahlungsdatum);return new Date(t.datum||t.zahlungsdatum)-r});const d=t(a,_e),o=Object.keys(d).sort().reverse();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"beitraege-view-filter",style:{marginBottom:"1rem"},children:[e.jsx("button",{className:"view-filter-btn "+("monat"===_e?"active":""),onClick:()=>Ne("monat"),children:"ğŸ“… Monat"}),e.jsx("button",{className:"view-filter-btn "+("quartal"===_e?"active":""),onClick:()=>Ne("quartal"),children:"ğŸ“Š Quartal"}),e.jsx("button",{className:"view-filter-btn "+("jahr"===_e?"active":""),onClick:()=>Ne("jahr"),children:"ğŸ“† Jahr"}),e.jsx("button",{className:"view-filter-btn",onClick:()=>{const e=n(),r=[...rt,...e],i=t(r,_e),a=Object.keys(i).sort().reverse(),s=a.length>0&&a.every(e=>!0===De[e]),l={};a.forEach(e=>{l[e]=!s}),Ce(l)},style:{whiteSpace:"nowrap"},children:(()=>{const e=n(),r=[...rt,...e],i=t(r,_e),a=Object.keys(i).sort().reverse();return a.length>0&&a.every(e=>!0===De[e])?"ğŸ“‚ Alle ausklappen":"ğŸ“ Alle einklappen"})()})]}),e.jsxs("div",{className:"field-group card",style:{width:"100%"},children:[e.jsx("h3",{children:"BeitrÃ¤ge & Zahlungen"}),0===a.length?e.jsxs("div",{className:"no-data-message",children:[e.jsx("p",{children:"ğŸ“­ Keine BeitrÃ¤ge vorhanden"}),e.jsx("small",{children:"Es wurden noch keine BeitrÃ¤ge erfasst und es gibt keinen aktiven Vertrag."})]}):e.jsx("div",{className:"beitraege-grouped-view",children:o.map(t=>{const n=d[t],i=(e=>{let t=0,r=0,n=0;return e.forEach(e=>{const i=parseFloat(e.betrag||0);isNaN(i)||(t+=i,!0===e.bezahlt||1===e.bezahlt||"1"===e.bezahlt||"1"===String(e.bezahlt)?r+=i:n+=i)}),{total:t,paid:r,unpaid:n}})(n),a=De[t];return e.jsxs("div",{className:"period-group",children:[e.jsxs("div",{className:"period-header",onClick:()=>{Ce(e=>({...e,[t]:!e[t]}))},children:[e.jsxs("div",{className:"period-header-left",children:[e.jsx("span",{className:"collapse-icon",children:a?"â–¶":"â–¼"}),e.jsx("span",{className:"period-label",children:r(t,_e)}),e.jsxs("span",{className:"period-count",children:["(",n.length," BeitrÃ¤ge)"]})]}),e.jsxs("div",{className:"period-summary",children:[e.jsxs("span",{className:"summary-item total",children:["Gesamt: ",i.total.toFixed(2)," â‚¬"]}),e.jsxs("span",{className:"summary-item paid",children:["Bezahlt: ",i.paid.toFixed(2)," â‚¬"]}),e.jsxs("span",{className:"summary-item unpaid",children:["Offen: ",i.unpaid.toFixed(2)," â‚¬"]})]})]}),!a&&e.jsx("div",{className:"period-content",children:e.jsxs("table",{className:"beitraege-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"1px",padding:"0.5rem 0"}}),e.jsx("th",{children:"Datum"}),e.jsx("th",{children:"Betrag"}),e.jsx("th",{children:"Zahlungsart"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Aktionen"})]})}),e.jsx("tbody",{children:n.map(t=>{var r,n,i,a;const d=Fe[t.beitrag_id];return e.jsxs(s.Fragment,{children:[e.jsxs("tr",{className:t.bezahlt?"paid":"unpaid",style:{opacity:t.generiert?.8:1},children:[e.jsx("td",{style:{textAlign:"center",padding:"0.5rem 0.1rem",whiteSpace:"nowrap",width:"1px"},children:!t.generiert&&t.beitrag_id&&e.jsx("button",{onClick:()=>Be(e=>({...e,[t.beitrag_id]:!e[t.beitrag_id]})),style:{background:"none",border:"none",cursor:"pointer",fontSize:"0.65rem",color:"rgba(255, 215, 0, 0.8)",transition:"transform 0.2s",transform:d?"rotate(90deg)":"rotate(0deg)",padding:0,lineHeight:1,display:"inline-block",width:"auto"},title:"Details anzeigen",children:"â–¶"})}),e.jsxs("td",{children:[new Date(t.datum||t.zahlungsdatum).toLocaleDateString("de-DE"),t.generiert&&e.jsx("span",{style:{fontSize:"0.75rem",color:"rgba(255, 215, 0, 0.7)",marginLeft:"0.5rem"},title:"Automatisch generiert basierend auf Vertragsdaten",children:"ğŸ”®"})]}),e.jsxs("td",{className:"betrag",children:[parseFloat(t.betrag).toFixed(2)," â‚¬",t.anteilig&&e.jsx("span",{style:{fontSize:"0.75rem",color:"rgba(255, 215, 0, 0.7)",marginLeft:"0.5rem",fontStyle:"italic"},title:"Anteiliger Beitrag fÃ¼r letzten Monat bei KÃ¼ndigung",children:"(anteilig)"})]}),e.jsx("td",{children:"Ã¼berweisung"===(null==(r=t.zahlungsart)?void 0:r.toLowerCase())||"Ãœberweisung"===(null==(n=t.zahlungsart)?void 0:n.toLowerCase())?"ğŸ’³ Ãœberweisung":"lastschrift"===(null==(i=t.zahlungsart)?void 0:i.toLowerCase())?"ğŸ¦ Lastschrift":"bar"===(null==(a=t.zahlungsart)?void 0:a.toLowerCase())?"ğŸ’µ Bar":t.zahlungsart||"Unbekannt"}),e.jsx("td",{children:e.jsx("span",{className:"status-badge "+(t.bezahlt?"status-paid":"status-unpaid"),children:t.bezahlt?"âœ… Bezahlt":"â³ Ausstehend"})}),e.jsx("td",{children:m&&e.jsx("button",{className:"btn-toggle-payment "+(t.bezahlt?"btn-mark-unpaid":"btn-mark-paid"),onClick:async()=>{var e;try{if(t.generiert){const e=t.bezahlt?null:(new Date).toISOString().split("T")[0],r={mitglied_id:R.mitglied_id,betrag:parseFloat(t.betrag),zahlungsart:t.zahlungsart,zahlungsdatum:e,bezahlt:t.bezahlt?0:1};await l.post("/beitraege",r),dn()}else{const e=t.zahlungsdatum?new Date(t.zahlungsdatum).toISOString().split("T")[0]:t.bezahlt?null:(new Date).toISOString().split("T")[0],r={betrag:parseFloat(t.betrag),zahlungsart:t.zahlungsart,zahlungsdatum:e,bezahlt:t.bezahlt?0:1};await l.put(`/beitraege/${t.beitrag_id}`,r),dn()}}catch(r){console.error("âŒ Fehler beim Aktualisieren:",r),console.error("âŒ Error Details:",(null==(e=r.response)?void 0:e.data)||r.message)}},children:t.bezahlt?"âŒ Als unbezahlt markieren":"âœ… Als bezahlt markieren"})})]}),d&&!t.generiert&&e.jsx("tr",{className:"beitrag-details-row",children:e.jsx("td",{colSpan:"6",style:{padding:"1rem 1.5rem",background:"rgba(255, 215, 0, 0.05)",borderLeft:"3px solid rgba(255, 215, 0, 0.5)"},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"0.75rem",fontSize:"0.85rem",color:"rgba(255, 255, 255, 0.9)"},children:[e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#ffd700",display:"block",marginBottom:"0.25rem"},children:"Beitrags-ID:"}),e.jsxs("span",{children:["#",t.beitrag_id]})]}),t.magicline_description&&e.jsxs("div",{style:{gridColumn:"1 / -1"},children:[e.jsx("strong",{style:{color:"#ffd700",display:"block",marginBottom:"0.25rem"},children:"Beschreibung:"}),e.jsx("span",{children:t.magicline_description})]}),(t.datum||t.zahlungsdatum)&&e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#ffd700",display:"block",marginBottom:"0.25rem"},children:"Datum:"}),e.jsx("span",{children:new Date(t.datum||t.zahlungsdatum).toLocaleDateString("de-DE")})]}),t.zahlungsdatum&&e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#ffd700",display:"block",marginBottom:"0.25rem"},children:"Zahlungsdatum:"}),e.jsx("span",{children:new Date(t.zahlungsdatum).toLocaleDateString("de-DE")})]}),e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#ffd700",display:"block",marginBottom:"0.25rem"},children:"Betrag (brutto):"}),e.jsxs("span",{children:[parseFloat(t.betrag).toFixed(2)," â‚¬"]})]}),e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#ffd700",display:"block",marginBottom:"0.25rem"},children:"Zahlungsart:"}),e.jsx("span",{children:t.zahlungsart||"Nicht angegeben"})]}),e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#ffd700",display:"block",marginBottom:"0.25rem"},children:"Status:"}),e.jsx("span",{style:{color:t.bezahlt?"#4caf50":"#ff9800"},children:t.bezahlt?"Bezahlt":"Ausstehend"})]}),t.dojo_id&&e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#ffd700",display:"block",marginBottom:"0.25rem"},children:"Dojo-ID:"}),e.jsxs("span",{children:["#",t.dojo_id]})]})]})})})]},t.beitrag_id)})})]})})]},t)})})]})]})})()}),"bank"===ye&&e.jsx("div",{className:"bank-sub-tab-content",children:e.jsxs("div",{className:"grid-container",children:[e.jsxs("div",{className:"field-group card bank-sepa-card",children:[e.jsx("h3",{className:"bank-sepa-heading",children:"Bankdaten"}),e.jsxs("div",{children:[e.jsx("label",{children:"IBAN:"}),Xe?e.jsx("input",{type:"text",value:W.iban||"",onChange:e=>fn(e,"iban"),placeholder:"DE89 3704 0044 0532 0130 00"}):e.jsx("span",{children:R.iban||"Nicht angegeben"})]}),e.jsxs("div",{children:[e.jsx("label",{children:"BIC:"}),Xe?e.jsx("input",{type:"text",value:W.bic||"",onChange:e=>fn(e,"bic"),placeholder:"COBADEFFXXX"}):e.jsx("span",{children:R.bic||"Nicht angegeben"})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Bankname:"}),Xe?e.jsx("input",{type:"text",value:W.bankname||"",onChange:e=>fn(e,"bankname"),placeholder:"Commerzbank AG"}):e.jsx("span",{children:R.bankname||"Nicht angegeben"})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Kontoinhaber:"}),Xe?e.jsx("input",{type:"text",value:W.kontoinhaber||"",onChange:e=>fn(e,"kontoinhaber"),placeholder:"Max Mustermann"}):e.jsx("span",{children:R.kontoinhaber||`${R.vorname} ${R.nachname}`})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Zahlungsmethode:"}),Xe?e.jsx(pe,{value:W.zahlungsmethode||"",onChange:e=>fn(e,"zahlungsmethode"),options:[{value:"SEPA-Lastschrift",label:"SEPA-Lastschrift"},{value:"Lastschrift",label:"Lastschrift"},{value:"Bar",label:"Bar"},{value:"Ãœberweisung",label:"Ãœberweisung"}]}):e.jsx("span",{children:R.zahlungsmethode||"Nicht angegeben"})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Zahllaufgruppe:"}),Xe?e.jsx("input",{type:"text",value:W.zahllaufgruppe||"",onChange:e=>fn(e,"zahllaufgruppe"),placeholder:"01"}):e.jsx("span",{children:R.zahllaufgruppe||"Nicht angegeben"})]})]}),e.jsxs("div",{className:"field-group card bank-sepa-card",children:[e.jsx("h3",{className:"bank-sepa-heading",children:"SEPA-Lastschriftmandat"}),Te?e.jsxs("div",{className:"sepa-mandate-info",children:[e.jsxs("div",{className:"mandate-status",children:[e.jsx("span",{className:"status-badge active",children:"âœ… Aktiv"}),e.jsxs("span",{children:["Mandat-Referenz: ",Te.mandatsreferenz]})]}),e.jsxs("div",{className:"mandate-details",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Erstellt am:"})," ",new Date(Te.erstellungsdatum).toLocaleDateString("de-DE")]}),e.jsxs("p",{children:[e.jsx("strong",{children:"GÃ¼ltig bis:"})," ",Te.ablaufdatum?new Date(Te.ablaufdatum).toLocaleDateString("de-DE"):"Unbefristet"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"GlÃ¤ubiger-Identifikation:"})," ",Te.glaeubiger_id]}),Te.widerruf_datum&&e.jsxs("p",{children:[e.jsx("strong",{children:"Widerrufen am:"})," ",e.jsx("span",{className:"widerruf-datum",children:new Date(Te.widerruf_datum).toLocaleDateString("de-DE")})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"IBAN:"})," ",Te.iban?`${Te.iban.slice(0,4)}****${Te.iban.slice(-4)}`:"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Kontoinhaber:"})," ",Te.kontoinhaber]})]}),e.jsxs("div",{className:"mandate-actions",children:[e.jsx("button",{className:"bank-sepa-button",onClick:()=>hn(),children:"ğŸ“¥ Mandat herunterladen"}),e.jsx("button",{className:"bank-sepa-button bank-sepa-button-warning",onClick:()=>(async()=>{if(confirm("MÃ¶chten Sie das SEPA-Mandat wirklich widerrufen? Diese Aktion kann nicht rÃ¼ckgÃ¤ngig gemacht werden."))try{await l.delete(`/mitglieder/${D}/sepa-mandate`),Ae(null),un(),console.log("âœ… SEPA-Mandat wurde archiviert")}catch(e){console.error("âŒ Fehler beim Widerrufen des SEPA-Mandats:",e)}})(),children:"? Mandat widerrufen"})]})]}):e.jsxs("div",{className:"no-sepa-mandate",children:[e.jsx("p",{children:"Kein SEPA-Lastschriftmandat vorhanden."}),(null==R?void 0:R.iban)&&(null==R?void 0:R.bic)?e.jsx("button",{className:"bank-sepa-button bank-sepa-button-primary",onClick:()=>(async()=>{if((null==R?void 0:R.iban)&&(null==R?void 0:R.bic)){Me(!0);try{const e=await l.post(`/mitglieder/${D}/sepa-mandate`,{iban:null==R?void 0:R.iban,bic:null==R?void 0:R.bic,kontoinhaber:(null==R?void 0:R.kontoinhaber)||`${null==R?void 0:R.vorname} ${null==R?void 0:R.nachname}`,bankname:null==R?void 0:R.bankname});Ae(e.data),console.log("âœ… SEPA-Mandat erfolgreich erstellt")}catch(e){console.error("âŒ Fehler beim Erstellen des SEPA-Mandats:",e)}Me(!1)}else alert("Bitte vervollstÃ¤ndigen Sie zuerst die Bankdaten (IBAN und BIC).")})(),disabled:Ee,children:Ee?"â³ Erstelle Mandat...":"ğŸ“ SEPA-Mandat erstellen"}):e.jsx("div",{className:"info-box warning",children:e.jsx("p",{children:"â„¹ï¸ Bitte vervollstÃ¤ndigen Sie zuerst die Bankdaten (IBAN und BIC), um ein SEPA-Mandat zu erstellen."})})]}),e.jsxs("div",{className:"sepa-legal-info",children:[e.jsx("h4",{children:"Rechtliche Grundlagen"}),e.jsx("p",{className:"legal-text",children:"Das SEPA-Lastschriftmandat berechtigt den ZahlungsempfÃ¤nger, Zahlungen vom Konto des Zahlungspflichtigen mittels Lastschrift einzuziehen. Zugleich wird die Bank des Zahlungspflichtigen zur EinlÃ¶sung der Lastschrift angewiesen."}),e.jsxs("p",{className:"legal-text",children:[e.jsx("strong",{children:"Hinweis:"})," Der Zahlungspflichtige kann innerhalb von acht Wochen, beginnend mit dem Belastungsdatum, die Erstattung des belasteten Betrages verlangen. Es gelten dabei die mit der Bank vereinbarten Bedingungen."]})]})]})]})})]}),"buddy_gruppen"===ae&&e.jsxs("div",{className:"buddy-gruppen-content",style:{padding:"1.5rem",background:"transparent"},children:[e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("h3",{style:{color:"#ffd700",marginBottom:"0.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:"ğŸ‘¥ Buddy-Gruppen"}),e.jsxs("p",{style:{color:"rgba(255, 255, 255, 0.7)",fontSize:"0.9rem"},children:["Gruppen, in denen ",null==R?void 0:R.vorname," ",null==R?void 0:R.nachname," Mitglied ist"]})]}),ne?e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 215, 0, 0.2)",borderRadius:"12px",padding:"2rem",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"2rem",marginBottom:"1rem"},children:"â³"}),e.jsx("p",{style:{color:"rgba(255, 255, 255, 0.7)",fontSize:"1rem"},children:"Buddy-Gruppen werden geladen..."})]}):0===ee.length?e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 215, 0, 0.2)",borderRadius:"12px",padding:"2rem",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"2.5rem",marginBottom:"1rem"},children:"ğŸ‘¥"}),e.jsx("p",{style:{color:"rgba(255, 255, 255, 0.7)",fontSize:"1rem",marginBottom:"0.5rem"},children:"Keine Buddy-Gruppen gefunden"}),e.jsxs("p",{style:{color:"rgba(255, 255, 255, 0.5)",fontSize:"0.85rem"},children:[null==R?void 0:R.vorname," ist noch in keiner Buddy-Gruppe."]})]}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginBottom:"2rem"},children:ee.map(t=>e.jsx("div",{style:{background:"rgba(255, 255, 255, 0.08)",border:"1px solid rgba(255, 215, 0, 0.2)",borderRadius:"12px",padding:"1.5rem",transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.12)",e.currentTarget.style.borderColor="rgba(255, 215, 0, 0.4)",e.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.08)",e.currentTarget.style.borderColor="rgba(255, 215, 0, 0.2)",e.currentTarget.style.transform="translateY(0)"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsxs("h4",{style:{color:"#ffd700",fontSize:"1.2rem",margin:"0 0 0.5rem 0",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("span",{children:"ğŸ‘¥"}),t.gruppe_name||`Gruppe #${t.id}`]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap",fontSize:"0.9rem",color:"rgba(255, 255, 255, 0.7)"},children:[e.jsxs("span",{children:["ğŸ“… Erstellt: ",new Date(t.erstellt_am).toLocaleDateString("de-DE")]}),e.jsxs("span",{children:["ğŸ‘¥ Mitglieder: ",t.aktive_mitglieder||0,"/",t.max_mitglieder||"âˆ"]}),t.gesamt_einladungen>0&&e.jsxs("span",{children:["ğŸ“§ Einladungen: ",t.gesamt_einladungen]})]})]}),e.jsx("span",{style:{padding:"0.4rem 0.8rem",borderRadius:"8px",fontSize:"0.8rem",fontWeight:"600",background:"aktiv"===t.status?"rgba(34, 197, 94, 0.2)":"rgba(107, 114, 128, 0.2)",color:"aktiv"===t.status?"#22c55e":"#6b7280",border:"1px solid "+("aktiv"===t.status?"rgba(34, 197, 94, 0.3)":"rgba(107, 114, 128, 0.3)")},children:"aktiv"===t.status?"Aktiv":t.status})]})},t.id))}),(null==R?void 0:R.mitglied_id)&&e.jsx("div",{style:{marginTop:"2rem",paddingTop:"2rem",borderTop:"1px solid rgba(255, 215, 0, 0.2)"},children:e.jsx(Z,{mitgliedId:R.mitglied_id,buddyGruppeId:(null==(p=ee[0])?void 0:p.id)||null,marketingAktionId:null})}),e.jsxs("div",{style:{marginTop:"2rem",paddingTop:"2rem",borderTop:"1px solid rgba(255, 215, 0, 0.2)"},children:[e.jsx("h4",{style:{color:"#ffd700",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:"ğŸ“… Marketing-Aktionen"}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",border:"1px dashed rgba(255, 215, 0, 0.3)",borderRadius:"12px",padding:"1.5rem",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"2rem",marginBottom:"0.75rem"},children:"ğŸ“…"}),e.jsx("p",{style:{color:"rgba(255, 255, 255, 0.7)",fontSize:"0.95rem"},children:"Teilnahme an Marketing-Aktionen wird hier angezeigt"}),e.jsx("p",{style:{color:"rgba(255, 255, 255, 0.5)",fontSize:"0.85rem",marginTop:"0.5rem"},children:"Diese Funktion wird in KÃ¼rze verfÃ¼gbar sein."})]})]})]}),"nachrichten"===ae&&e.jsxs("div",{className:"nachrichten-content",style:{padding:"1.5rem",background:"transparent"},children:[e.jsxs("div",{style:{marginBottom:"2.5rem"},children:[e.jsx("h3",{style:{color:"#ffd700",marginBottom:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:"ğŸ“° Aktuelle News"}),mt?e.jsx("div",{style:{textAlign:"center",padding:"1.5rem",color:"rgba(255, 255, 255, 0.7)"},children:"Lade News..."}):0===ht.length?e.jsx("div",{style:{textAlign:"center",padding:"1.5rem",background:"rgba(255, 255, 255, 0.03)",borderRadius:"10px",border:"1px solid rgba(255, 215, 0, 0.1)"},children:e.jsx("p",{style:{color:"rgba(255, 255, 255, 0.5)",fontSize:"0.9rem",margin:0},children:"Keine aktuellen News vorhanden"})}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:ht.map(t=>e.jsxs("div",{style:{background:"rgba(30, 30, 45, 0.8)",border:"1px solid rgba(255, 215, 0, 0.2)",borderRadius:"10px",padding:"1rem",backdropFilter:"blur(10px)",cursor:"pointer",transition:"all 0.2s"},onClick:()=>bt(pt===t.id?null:t.id),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"1rem"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("h4",{style:{color:"#ffd700",margin:"0 0 0.5rem 0",fontSize:"1rem",fontWeight:"600"},children:t.titel}),t.kurzbeschreibung&&pt!==t.id&&e.jsx("p",{style:{color:"rgba(255, 255, 255, 0.7)",margin:0,fontSize:"0.9rem",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:t.kurzbeschreibung})]}),e.jsx("div",{style:{color:"#808090",fontSize:"0.8rem",whiteSpace:"nowrap"},children:new Date(t.veroeffentlicht_am||t.created_at).toLocaleDateString("de-DE")})]}),pt===t.id&&e.jsx("div",{style:{marginTop:"1rem",paddingTop:"1rem",borderTop:"1px solid rgba(255, 215, 0, 0.1)"},children:e.jsx("div",{style:{color:"#e0e0e0",fontSize:"0.9rem",lineHeight:"1.6",whiteSpace:"pre-wrap"},children:t.inhalt})}),e.jsx("div",{style:{marginTop:"0.75rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:e.jsx("span",{style:{color:"#ffd700",fontSize:"0.8rem",cursor:"pointer"},children:pt===t.id?"â–² Weniger anzeigen":"â–¼ Mehr lesen"})})]},t.id))})]}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("h3",{style:{color:"#ffd700",marginBottom:"0.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:"ğŸ“¬ Nachrichtenarchiv"}),e.jsxs("p",{style:{color:"rgba(255, 255, 255, 0.7)",fontSize:"0.9rem"},children:["Alle Benachrichtigungen die an ",null==R?void 0:R.vorname," ",null==R?void 0:R.nachname," (",null==R?void 0:R.email,") gesendet wurden"]})]}),ct?e.jsx("div",{style:{textAlign:"center",padding:"2rem",color:"rgba(255, 255, 255, 0.7)"},children:"Lade Benachrichtigungen..."}):0===dt.length?e.jsxs("div",{style:{textAlign:"center",padding:"3rem",background:"rgba(255, 255, 255, 0.05)",borderRadius:"12px",border:"1px solid rgba(255, 215, 0, 0.2)"},children:[e.jsx("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"ğŸ“­"}),e.jsx("p",{style:{color:"rgba(255, 255, 255, 0.7)",fontSize:"1.1rem"},children:"Noch keine Benachrichtigungen erhalten"})]}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:dt.map((t,r)=>e.jsxs("div",{style:{background:"rgba(30, 30, 45, 0.8)",border:"1px solid rgba(255, 215, 0, 0.2)",borderRadius:"10px",padding:"1rem",backdropFilter:"blur(10px)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.8rem",marginBottom:"0.8rem"},children:[e.jsx("div",{style:{fontSize:"1.5rem"},children:"email"===t.type?"ğŸ“§":"ğŸ“±"}),e.jsxs("div",{style:{flex:1},children:[e.jsx("h4",{style:{color:"#ffd700",margin:0,fontSize:"1rem",fontWeight:"600"},children:t.subject}),e.jsx("div",{style:{color:"#808090",fontSize:"0.85rem",marginTop:"0.2rem"},children:new Date(t.created_at).toLocaleString("de-DE")})]}),e.jsx("div",{style:{background:"sent"===t.status?"rgba(34, 197, 94, 0.2)":"rgba(239, 68, 68, 0.2)",color:"sent"===t.status?"#22c55e":"#ef4444",padding:"0.3rem 0.8rem",borderRadius:"20px",fontSize:"0.85rem",fontWeight:"600"},children:"sent"===t.status?"âœ… Gesendet":"failed"===t.status?"âŒ Fehlgeschlagen":"â³ Ausstehend"})]}),t.message&&e.jsxs("div",{style:{padding:"0.8rem",background:"rgba(20, 20, 30, 0.5)",borderRadius:"8px",borderLeft:"3px solid #ffd700",marginTop:"0.8rem"},children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"#a0a0b0",marginBottom:"0.4rem",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Nachricht"}),e.jsx("div",{style:{color:"#e0e0e0",fontSize:"0.9rem",lineHeight:"1.5",maxHeight:"150px",overflowY:"auto"},dangerouslySetInnerHTML:K(t.message)})]})]},r))})]}),"statistiken"===ae&&e.jsx(he,{statistikDaten:it,mitglied:R,memberStile:Xt,stile:qt,styleSpecificData:Ge}),"zusatzdaten"===ae&&e.jsx(X,{mitgliedId:D,dojoId:null==R?void 0:R.dojo_id,editMode:Xe}),"gurt_stil"===ae&&e.jsxs("div",{className:"style-management-container",children:[e.jsxs("div",{className:"sub-tabs-sidebar-style",children:[e.jsxs("button",{className:"tab-vertical-btn "+("stile"===de?"active":""),onClick:()=>oe("stile"),children:[e.jsx("span",{className:"tab-icon",children:"ğŸ¥‹"}),e.jsx("span",{className:"tab-label",children:"Stile"})]}),e.jsxs("button",{className:"tab-vertical-btn "+("pruefung"===de?"active":""),onClick:()=>oe("pruefung"),children:[e.jsx("span",{className:"tab-icon",children:"ğŸ“"}),e.jsx("span",{className:"tab-label",children:"PrÃ¼fung"})]})]}),"stile"===de&&e.jsxs("div",{className:"stile-sub-tab-content",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem",gap:"1rem",flexWrap:"wrap"},children:[Xt.length>0?e.jsx("div",{className:"stil-tabs-row",children:Xt.map((t,r)=>e.jsxs("button",{onClick:()=>ge(r),className:"tab-vertical-btn "+(ce===r?"active":""),children:[e.jsx("span",{className:"tab-icon",children:"ğŸ¥‹"}),e.jsx("span",{className:"tab-label",children:t.stil_name})]},t.stil_id))}):e.jsx("div",{style:{flex:1}}),m&&e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center",visibility:"visible !important",opacity:"1 !important"},children:[e.jsxs("select",{value:er,onChange:e=>(e=>{tr(e);const t=qt.find(t=>t.stil_id===parseInt(e));nr(t),ar(null),t&&t.graduierungen&&t.graduierungen.length>0&&ar(t.graduierungen[0])})(e.target.value),disabled:!Xe,style:{padding:"0.6rem 1rem",background:"#1a1a1a",border:"1px solid rgba(255, 215, 0, 0.3)",borderRadius:"6px",color:"#fff",fontSize:"0.9rem",minWidth:"180px",opacity:Xe?"1":"0.5",cursor:Xe?"pointer":"not-allowed"},children:[e.jsx("option",{value:"",style:{background:"#1a1a1a",color:"#fff"},children:"â• Stil wÃ¤hlen..."}),qt.filter(e=>1===e.aktiv||!0===e.aktiv).filter(e=>!Xt.find(t=>t.stil_id===e.stil_id)).map(t=>e.jsx("option",{value:t.stil_id,style:{background:"#1a1a1a",color:"#fff"},children:t.stil_name||t.name},t.stil_id))]}),e.jsx("button",{onClick:async()=>{if(!er||Xt.find(e=>e.stil_id===parseInt(er)))return;const e=qt.find(e=>e.stil_id===parseInt(er)),t=[...Xt,e];await cn(t.map(e=>e.stil_id)),await gn(),ge(t.length-1),console.log("âœ… Stil hinzugefÃ¼gt:",e.name)},disabled:!er||!Xe,style:{padding:"0.6rem 1.2rem",background:er&&Xe?"linear-gradient(135deg, #FFD700, #FFA500)":"rgba(255, 255, 255, 0.1)",border:er&&Xe?"none":"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"6px",color:er&&Xe?"#000":"#999",fontWeight:"600",cursor:er&&Xe?"pointer":"not-allowed",fontSize:"0.9rem",whiteSpace:"nowrap",visibility:"visible !important",opacity:Xe?"1":"0.5"},children:"HinzufÃ¼gen"})]})]}),Xt.length>0?(()=>{var t;const r=Xt[ce];if(!r)return null;const n=qt.find(e=>e.stil_id===r.stil_id);return console.log("ğŸ” RENDER DEBUG:"),console.log("  - selectedStil:",(null==rr?void 0:rr.name)||"NULL"),console.log("  - selectedStil.graduierungen:",(null==(t=null==rr?void 0:rr.graduierungen)?void 0:t.length)||0),console.log("  - currentGraduation:",(null==ir?void 0:ir.name)||"NULL"),console.log("  - editMode:",Xe),console.log("  - isAdmin:",m),console.log("  - fullStilData:",(null==n?void 0:n.name)||"NULL"),e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem",paddingBottom:"1rem",borderBottom:"2px solid rgba(255, 215, 0, 0.2)"},children:[e.jsxs("h2",{style:{margin:0,color:"#FFD700",fontSize:"1.5rem",fontWeight:"700"},children:["ğŸ¥‹ ",r.stil_name]}),Xe&&e.jsx("button",{onClick:()=>(async e=>{const t=Xt.filter(t=>t.stil_id!==e);await cn(t.map(e=>e.stil_id)),await gn(),ce>=t.length&&t.length>0?ge(t.length-1):0===t.length&&ge(0),console.log("? Stil entfernt")})(r.stil_id),style:{padding:"0.5rem 1rem",background:"rgba(239, 68, 68, 0.2)",border:"1px solid #ef4444",borderRadius:"6px",color:"#ef4444",fontWeight:"600",cursor:"pointer",fontSize:"0.9rem"},children:"ğŸ—‘ï¸ Stil entfernen"})]}),e.jsxs("div",{className:"grid-container zwei-spalten",children:[e.jsxs("div",{className:"field-group card",children:[e.jsx("h3",{children:"Aktuelle Graduierung"}),e.jsxs("div",{children:[e.jsx("label",{style:{textTransform:"none",fontSize:"0.9rem"},children:"Gurtfarbe:"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginTop:"0.5rem",marginBottom:"1rem"},children:[e.jsx(be,{primaer:(null==ir?void 0:ir.farbe_hex)||"#666",sekundaer:null==ir?void 0:ir.farbe_sekundaer,size:"normal"}),e.jsx("span",{style:{fontSize:"1rem",fontWeight:"600",color:"#fff"},children:(null==ir?void 0:ir.name)||"Keine Graduierung"})]}),m&&e.jsxs("div",{className:"graduierung-buttons",style:{display:"flex",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx("button",{className:"grad-btn grad-btn-down",onClick:()=>{console.log("ğŸ”˜ Niedriger-Button geklickt! CurrentGrad:",null==ir?void 0:ir.name),xn(null==ir?void 0:ir.graduierung_id,"up")},disabled:!ir||!rr.graduierungen||0===rr.graduierungen.findIndex(e=>e.graduierung_id===ir.graduierung_id),style:{flex:1,padding:"0.5rem",background:ir&&rr.graduierungen&&rr.graduierungen.findIndex(e=>e.graduierung_id===ir.graduierung_id)>0?"rgba(239, 68, 68, 0.2)":"rgba(255, 255, 255, 0.05)",border:"1px solid #ef4444",borderRadius:"6px",color:"#ef4444",fontWeight:"600",cursor:ir&&rr.graduierungen&&rr.graduierungen.findIndex(e=>e.graduierung_id===ir.graduierung_id)>0?"pointer":"not-allowed",fontSize:"0.9rem",opacity:ir&&rr.graduierungen&&0!==rr.graduierungen.findIndex(e=>e.graduierung_id===ir.graduierung_id)?1:.3},children:"â¬‡ï¸ Niedriger"}),e.jsx("button",{className:"grad-btn grad-btn-up",onClick:()=>{console.log("ğŸ”˜ HÃ¶her-Button geklickt! CurrentGrad:",null==ir?void 0:ir.name),xn(null==ir?void 0:ir.graduierung_id,"down")},disabled:!ir||!rr.graduierungen||rr.graduierungen.findIndex(e=>e.graduierung_id===ir.graduierung_id)===rr.graduierungen.length-1,style:{flex:1,padding:"0.5rem",background:ir&&rr.graduierungen&&rr.graduierungen.findIndex(e=>e.graduierung_id===ir.graduierung_id)<rr.graduierungen.length-1?"rgba(34, 197, 94, 0.2)":"rgba(255, 255, 255, 0.05)",border:"1px solid #22c55e",borderRadius:"6px",color:"#22c55e",fontWeight:"600",cursor:ir&&rr.graduierungen&&rr.graduierungen.findIndex(e=>e.graduierung_id===ir.graduierung_id)<rr.graduierungen.length-1?"pointer":"not-allowed",fontSize:"0.9rem",opacity:ir&&rr.graduierungen&&rr.graduierungen.findIndex(e=>e.graduierung_id===ir.graduierung_id)!==rr.graduierungen.length-1?1:.3},children:"â¬†ï¸ HÃ¶her"})]})]}),ir&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{style:{textTransform:"none",fontSize:"0.9rem"},children:"Mindest-Trainingsstunden:"}),e.jsxs("span",{children:[ir.trainingsstunden_min||0," Stunden"]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{textTransform:"none",fontSize:"0.9rem"},children:"Mindestzeit:"}),e.jsxs("span",{children:[ir.mindestzeit_monate||0," Monate"]})]}),ir.kategorie&&e.jsxs("div",{children:[e.jsx("label",{style:{textTransform:"none",fontSize:"0.9rem"},children:"Kategorie:"}),e.jsx("span",{style:{display:"inline-block",padding:"0.25rem 0.75rem",background:"rgba(255, 215, 0, 0.2)",border:"1px solid #FFD700",borderRadius:"12px",color:"#FFD700",fontSize:"0.85rem",fontWeight:"600"},children:ir.kategorie})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{textTransform:"none",fontSize:"0.9rem"},children:"Letzte PrÃ¼fung:"}),Xe?e.jsx("input",{type:"date",value:sr,onChange:e=>lr(e.target.value)}):e.jsx("span",{children:sr?new Date(sr).toLocaleDateString("de-DE"):"Keine PrÃ¼fung dokumentiert"})]})]}),e.jsxs("div",{className:"field-group card",children:[e.jsx("h3",{children:"Beschreibung"}),e.jsxs("div",{children:[e.jsx("label",{style:{textTransform:"none",fontSize:"0.9rem"},children:"Ãœber diesen Stil:"}),e.jsx("p",{style:{color:"#ccc",fontSize:"0.95rem",lineHeight:"1.6",marginTop:"0.5rem"},children:r.beschreibung||(null==n?void 0:n.beschreibung)||"Keine Beschreibung verfÃ¼gbar"})]})]})]}),e.jsx("div",{className:"grid-container",style:{marginTop:"1.5rem"},children:e.jsxs("div",{className:"field-group card",children:[e.jsxs("div",{onClick:()=>{Se(!ke)},style:{display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",padding:"0.5rem",margin:"-0.5rem -0.5rem 0.5rem -0.5rem",borderRadius:"6px",transition:"background 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background="rgba(255, 215, 0, 0.05)"},onMouseLeave:e=>{e.currentTarget.style.background="transparent"},children:[e.jsxs("h3",{style:{margin:0},children:["ğŸ“Š Alle Graduierungen - ",r.stil_name]}),e.jsx("span",{style:{fontSize:"1.5rem",color:"#FFD700",transform:ke?"rotate(0deg)":"rotate(180deg)",transition:"transform 0.3s ease",display:"inline-block"},children:"â–¼"})]}),!ke&&e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",marginTop:"1rem"},children:n&&n.graduierungen&&n.graduierungen.length>0?n.graduierungen.sort((e,t)=>e.reihenfolge-t.reihenfolge).map((t,r)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",padding:"0.75rem",background:(null==ir?void 0:ir.graduierung_id)===t.graduierung_id?"rgba(255, 215, 0, 0.15)":"rgba(255, 255, 255, 0.03)",border:(null==ir?void 0:ir.graduierung_id)===t.graduierung_id?"2px solid #FFD700":"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",transition:"all 0.2s ease"},children:[e.jsx(be,{primaer:t.farbe_hex,sekundaer:t.farbe_sekundaer,size:"small"}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{fontWeight:(null==ir?void 0:ir.graduierung_id)===t.graduierung_id?"700":"600",color:(null==ir?void 0:ir.graduierung_id)===t.graduierung_id?"#FFD700":"#fff",fontSize:"0.95rem"},children:[t.name,(null==ir?void 0:ir.graduierung_id)===t.graduierung_id&&e.jsx("span",{style:{marginLeft:"0.5rem",color:"#FFD700",fontSize:"0.85rem"},children:"â­ Aktuell"})]}),e.jsxs("div",{style:{color:"#999",fontSize:"0.85rem",marginTop:"0.25rem"},children:[t.reihenfolge||r+1,". Kyu Â· ",t.trainingsstunden_min,"h Â· ",t.mindestzeit_monate," Monate"]})]})]},t.graduierung_id)):e.jsx("p",{style:{textAlign:"center",color:"#999",padding:"1rem"},children:"Keine Graduierungen verfÃ¼gbar"})})]})})]},r.stil_id)})():e.jsx("div",{className:"grid-container",children:e.jsxs("div",{className:"field-group card",children:[e.jsx("h3",{children:"Stil-Verwaltung"}),e.jsx("p",{style:{textAlign:"center",color:"#999",padding:"2rem"},children:"Keine Stile zugeordnet"}),e.jsx("p",{style:{textAlign:"center",color:"#999",fontSize:"0.9rem"},children:"Verwenden Sie das Auswahlfeld oben, um einen Stil hinzuzufÃ¼gen."})]})})]}),"pruefung"===de&&e.jsx("div",{className:"pruefung-sub-tab-content",children:e.jsx(O,{mitgliedId:D,readOnly:!m})})]})]},ae)})]})]}),ft&&e.jsx("div",{className:"modal-overlay",onClick:()=>jt(!1),"data-version":"2.0-vertragformular",children:e.jsxs("div",{className:"modal-content vertrag-modal-custom",onClick:e=>e.stopPropagation(),style:{width:"750px",maxWidth:"90vw",minWidth:"auto"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"Neuer Vertrag"}),e.jsx("button",{className:"close-btn",onClick:()=>jt(!1),children:"?"})]}),e.jsx(c,{vertrag:{tarif_id:Et.tarif_id,billing_cycle:Et.billing_cycle,payment_method:Et.payment_method,vertragsbeginn:Et.vertragsbeginn,vertragsende:Et.vertragsende,kuendigungsfrist_monate:Et.kuendigungsfrist_monate,mindestlaufzeit_monate:Et.mindestlaufzeit_monate,agb_akzeptiert:Et.agb_akzeptiert,datenschutz_akzeptiert:Et.datenschutz_akzeptiert,hausordnung_akzeptiert:Et.hausordnung_akzeptiert,haftungsausschluss_akzeptiert:Et.haftungsausschluss_akzeptiert,gesundheitserklaerung:Et.gesundheitserklaerung,foto_einverstaendnis:Et.foto_einverstaendnis,agb_version:Et.agb_version,datenschutz_version:Et.datenschutz_version,sepa_mandat_id:Et.sepa_mandat_id},onChange:e=>{Mt({...Et,tarif_id:e.tarif_id,billing_cycle:e.billing_cycle,payment_method:e.payment_method,vertragsbeginn:e.vertragsbeginn,vertragsende:e.vertragsende,kuendigungsfrist_monate:e.kuendigungsfrist_monate,mindestlaufzeit_monate:e.mindestlaufzeit_monate,agb_akzeptiert:e.agb_akzeptiert,datenschutz_akzeptiert:e.datenschutz_akzeptiert,hausordnung_akzeptiert:e.hausordnung_akzeptiert,haftungsausschluss_akzeptiert:e.haftungsausschluss_akzeptiert,gesundheitserklaerung:e.gesundheitserklaerung,foto_einverstaendnis:e.foto_einverstaendnis,agb_version:e.agb_version,datenschutz_version:e.datenschutz_version,sepa_mandat_id:e.sepa_mandat_id})},geburtsdatum:null==R?void 0:R.geburtsdatum,schuelerStudent:null==R?void 0:R.schueler_student,mode:"create",mitgliedId:D}),e.jsxs("div",{className:"form-actions",style:{marginTop:"1.5rem"},children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>jt(!1),children:"Abbrechen"}),e.jsx("button",{type:"submit",className:"btn btn-primary",onClick:bn,disabled:!(Et.agb_akzeptiert&&Et.datenschutz_akzeptiert&&Et.hausordnung_akzeptiert&&Et.tarif_id&&(null==R?void 0:R.dojo_id)),children:"âœ… Vertrag erstellen"})]})]})}),yt&&e.jsx("div",{className:"modal-overlay",onClick:()=>vt(null),children:e.jsxs("div",{className:"modal-content vertrag-modal-custom",onClick:e=>e.stopPropagation(),style:{width:"800px",maxWidth:"90vw",minWidth:"auto"},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"Vertrag bearbeiten"}),e.jsx("button",{className:"close-btn",onClick:()=>vt(null),children:"?"})]}),e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status"}),e.jsx(pe,{value:yt.status,onChange:e=>vt({...yt,status:e.target.value}),options:[{value:"aktiv",label:"Aktiv"},{value:"ruhepause",label:"Ruhepause"},{value:"gekuendigt",label:"GekÃ¼ndigt"},{value:"beendet",label:"Beendet"}]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Vertragsbeginn"}),e.jsx("input",{type:"date",value:yt.vertragsbeginn,onChange:e=>vt({...yt,vertragsbeginn:e.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Vertragsende"}),e.jsx("input",{type:"date",value:yt.vertragsende,onChange:e=>vt({...yt,vertragsende:e.target.value})})]}),"gekuendigt"===yt.status&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"KÃ¼ndigung eingegangen"}),e.jsx("input",{type:"date",value:yt.kuendigung_eingegangen||"",onChange:e=>vt({...yt,kuendigung_eingegangen:e.target.value})})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>vt(null),children:"Abbrechen"}),e.jsx("button",{type:"submit",className:"btn btn-primary",onClick:bn,children:"ğŸ’¾ Ã„nderungen speichern"})]})]})}),Rt&&e.jsx("div",{className:"modal-overlay",onClick:()=>Lt(!1),children:e.jsxs("div",{className:"modal-content large",onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"Ruhepause einrichten"}),e.jsx("button",{className:"close-btn",onClick:()=>Lt(!1),children:"âœ•"})]}),e.jsxs("div",{className:"info-section",children:[e.jsx("h4",{children:"â„¹ï¸ Was bedeutet Ruhepause?"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Das Training wird temporÃ¤r ausgesetzt"}),e.jsx("li",{children:"Die Mitgliedschaft bleibt bestehen"}),e.jsx("li",{children:"Keine Beitragszahlungen wÃ¤hrend der Ruhepause"}),e.jsx("li",{children:"Vertrag wird nicht im Lastschriftlauf berÃ¼cksichtigt"}),e.jsx("li",{children:"Nach der Ruhepause automatische Reaktivierung"}),e.jsx("li",{children:"Maximale Ruhepause: 12 Monate pro Jahr"})]})]}),e.jsxs("div",{className:"ruhepause-config-container",children:[e.jsxs("div",{className:"ruhepause-duration-selection",children:[e.jsx("label",{children:"Dauer der Ruhepause *"}),e.jsx(pe,{value:cr,onChange:e=>gr(parseInt(e.target.value)),options:[{value:1,label:"1 Monat"},{value:2,label:"2 Monate"},{value:3,label:"3 Monate"},{value:4,label:"4 Monate"},{value:5,label:"5 Monate"},{value:6,label:"6 Monate"},{value:9,label:"9 Monate"},{value:12,label:"12 Monate"}]}),e.jsx("small",{children:"Ruhepausen gelten immer fÃ¼r volle Monate"})]}),e.jsxs("div",{className:"date-info",children:[e.jsx("h5",{children:"ğŸ“… Zeitraum"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Von:"})," ",(()=>{const e=new Date;return e.setMonth(e.getMonth()+1),e.setDate(1),e.toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"})})()]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Bis:"})," ",(()=>{const e=new Date;return e.setMonth(e.getMonth()+1+cr),e.setDate(0),e.toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"})})()]})]}),e.jsxs("div",{className:"warning-section",children:[e.jsx("h5",{children:"âš ï¸ Wichtiger Hinweis"}),e.jsx("p",{children:"Die Ruhepause beginnt am 1. des nÃ¤chsten Monats (aktueller Monat ist bereits abgebucht). Das Training kann fÃ¼r die gewÃ¤hlte Dauer nicht besucht werden. Keine LastschrifteinzÃ¼ge wÃ¤hrend der Ruhepause."})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>Lt(!1),children:"Abbrechen"}),e.jsxs("button",{type:"submit",className:"btn btn-warning",onClick:async()=>{if(dr){P(!0);try{const e=new Date;e.setMonth(e.getMonth()+1),e.setDate(1);const t=new Date;t.setMonth(t.getMonth()+1+cr),t.setDate(0),await l.put(`/vertraege/${dr.id}`,{status:"ruhepause",ruhepause_von:e.toISOString().split("T")[0],ruhepause_bis:t.toISOString().split("T")[0],ruhepause_dauer_monate:cr,dojo_id:null==R?void 0:R.dojo_id}),Lt(!1),or(null),gr(1),await on()}catch(e){console.error("Fehler beim Setzen der Ruhepause:",e),alert("Fehler beim Setzen der Ruhepause. Bitte versuchen Sie es erneut.")}finally{P(!1)}}},children:["â¸ï¸ Ruhepause fÃ¼r ",cr," Monat",cr>1?"e":""," einrichten"]})]})]})}),Wt&&e.jsx("div",{className:"modal-overlay",onClick:()=>It(!1),children:e.jsxs("div",{className:"modal-content extra-large",onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"Vertrag kÃ¼ndigen"}),e.jsx("button",{className:"close-btn",onClick:()=>It(!1),children:"âœ•"})]}),e.jsxs("div",{className:"cancellation-terms",children:[e.jsx("h4",{children:"ğŸ“‹ KÃ¼ndigungsbestimmungen"}),e.jsxs("div",{className:"terms-sections-container",children:[e.jsxs("div",{className:"terms-section",children:[e.jsx("h5",{children:"â° KÃ¼ndigungsfristen:"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Erstlaufzeit:"})," KÃ¼ndigung bis 3 Monate vor Vertragsende mÃ¶glich"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Nach VerlÃ¤ngerung:"})," KÃ¼ndigung mit 1 Monat Frist zum Monatsende"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"SonderkÃ¼ndigungsrecht:"})," Bei Umzug Ã¼ber 25km Entfernung (Nachweis erforderlich)"]})]})]}),e.jsxs("div",{className:"terms-section",children:[e.jsx("h5",{children:"ğŸ“‹ KÃ¼ndigungsregelungen:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Bei vorzeitiger KÃ¼ndigung: Zahlung der Restlaufzeit"}),e.jsx("li",{children:"Keine RÃ¼ckerstattung bereits gezahlter BeitrÃ¤ge"})]})]}),e.jsxs("div",{className:"current-contract-info",children:[e.jsx("h5",{children:"ğŸ“„ Aktueller Vertrag:"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Vertragslaufzeit:"})," ",(null==dr?void 0:dr.vertragsbeginn)?new Date(dr.vertragsbeginn).toLocaleDateString("de-DE"):"-"," - ",(null==dr?void 0:dr.vertragsende)?new Date(dr.vertragsende).toLocaleDateString("de-DE"):"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"FrÃ¼heste KÃ¼ndigung:"})," ",(()=>{if(!dr)return"Berechnung nicht mÃ¶glich";const e=new Date(dr.vertragsende),t=new Date(e);return t.setMonth(e.getMonth()-3),t.toLocaleDateString("de-DE")})()]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Vertragsende:"})," ",new Date((null==dr?void 0:dr.vertragsende)||"").toLocaleDateString("de-DE")]})]})]})]}),e.jsxs("div",{className:"kuendigung-form-container",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"KÃ¼ndigungsdatum *"}),e.jsx("input",{type:"date",value:pr,onChange:e=>br(e.target.value),min:(new Date).toISOString().split("T")[0]}),e.jsx("small",{children:"Das Datum, an dem die KÃ¼ndigung eingegangen ist"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"KÃ¼ndigungsgrund (Optional)"}),e.jsx(pe,{value:hr,onChange:e=>ur(e.target.value),options:[{value:"",label:"Bitte wÃ¤hlen..."},{value:"umzug",label:"Umzug"},{value:"finanzielle-gruende",label:"Finanzielle GrÃ¼nde"},{value:"zeitmangel",label:"Zeitmangel"},{value:"krankheit",label:"Krankheit/Verletzung"},{value:"unzufriedenheit",label:"Unzufriedenheit mit Service"},{value:"anderer-verein",label:"Wechsel zu anderem Verein"},{value:"sonstiges",label:"Sonstiges"}]})]}),e.jsx("div",{className:"confirmation-section-inline",children:e.jsxs("label",{className:"checkbox-container",children:[e.jsx("input",{type:"checkbox",checked:mr,onChange:e=>xr(e.target.checked)}),e.jsx("span",{className:"checkmark"}),e.jsxs("div",{className:"confirmation-text",children:[e.jsx("strong",{children:"âš ï¸ BestÃ¤tigung erforderlich:"}),e.jsx("p",{children:"Ich habe die KÃ¼ndigungsbestimmungen gelesen und verstanden. Mir ist bewusst, dass bei vorzeitiger KÃ¼ndigung die Restlaufzeit zu zahlen ist und keine RÃ¼ckerstattung bereits gezahlter BeitrÃ¤ge erfolgt."})]})]})})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>It(!1),children:"Abbrechen"}),e.jsx("button",{type:"submit",className:"btn btn-danger",onClick:async()=>{if(dr&&mr){P(!0);try{const e=pr||(new Date).toISOString().split("T")[0];await l.put(`/vertraege/${dr.id}`,{status:"gekuendigt",kuendigung_eingegangen:e,kuendigungsgrund:hr,dojo_id:null==R?void 0:R.dojo_id}),It(!1),or(null),ur(""),xr(!1),br(""),await on()}catch(e){console.error("Fehler beim KÃ¼ndigen des Vertrags:",e),alert("Fehler beim KÃ¼ndigen des Vertrags. Bitte versuchen Sie es erneut.")}finally{P(!1)}}},disabled:!mr,children:"âŒ Vertrag kÃ¼ndigen"})]})]})}),kt&&_t&&e.jsx("div",{className:"modal-overlay",onClick:()=>St(!1),style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"2rem"},children:e.jsxs("div",{className:"vertrag-dokument",onClick:e=>e.stopPropagation(),style:{maxWidth:"800px",width:"100%",maxHeight:"95vh",overflowY:"auto",background:"white",borderRadius:"8px",boxShadow:"0 10px 40px rgba(0,0,0,0.3)",position:"relative",color:"#333"},children:[e.jsx("style",{children:"\n              .vertrag-dokument .detail-item {\n                color: #333;\n                margin-bottom: 0.5rem;\n              }\n              .vertrag-dokument .detail-item strong {\n                color: #555;\n              }\n              .vertrag-dokument * {\n                color: #333;\n              }\n            "}),e.jsx("button",{onClick:()=>St(!1),style:{position:"absolute",top:"-12px",right:"-12px",width:"36px",height:"36px",borderRadius:"50%",background:"#d32f2f",color:"white",border:"none",fontSize:"20px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",zIndex:1e3},children:"?"}),e.jsxs("div",{style:{padding:"3rem 2.5rem"},children:[e.jsxs("div",{style:{borderBottom:"3px solid #1976d2",paddingBottom:"1.5rem",marginBottom:"2rem",textAlign:"center"},children:[e.jsx("h1",{style:{fontSize:"1.8rem",fontWeight:"600",color:"#1976d2",margin:"0 0 0.5rem 0",letterSpacing:"0.5px"},children:"VERTRAGSDETAILS"}),e.jsxs("div",{style:{fontSize:"1rem",color:"#666",fontWeight:"500"},children:["Vertragsnummer: ",_t.vertragsnummer||`VTR-${_t.id}`]})]}),e.jsx("div",{style:{marginBottom:"2rem",textAlign:"center",padding:"1rem",background:"aktiv"===_t.status?"#e8f5e9":"gekuendigt"===_t.status?"#fff3e0":"ruhepause"===_t.status?"#e3f2fd":"#ffebee",borderRadius:"6px",border:"2px solid "+("aktiv"===_t.status?"#4caf50":"gekuendigt"===_t.status?"#ff9800":"ruhepause"===_t.status?"#2196f3":"#f44336")},children:e.jsx("span",{style:{fontSize:"1.2rem",fontWeight:"600",color:"aktiv"===_t.status?"#2e7d32":"gekuendigt"===_t.status?"#e65100":"ruhepause"===_t.status?"#1565c0":"#c62828"},children:"aktiv"===_t.status?"? VERTRAG AKTIV":"gekuendigt"===_t.status?"? VERTRAG GEKÃœNDIGT":"ruhepause"===_t.status?"? VERTRAG IN RUHEPAUSE":"? VERTRAG BEENDET"})}),e.jsxs("div",{style:{marginBottom:"2rem",padding:"1.5rem",background:"#f8f9fa",borderRadius:"6px",border:"1px solid #dee2e6"},children:[e.jsx("h3",{style:{fontSize:"1.1rem",fontWeight:"600",color:"#1976d2",marginTop:"0",marginBottom:"1.5rem",paddingBottom:"0.75rem",borderBottom:"2px solid #1976d2"},children:"ğŸ“‹ Grunddaten"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem",fontSize:"0.95rem",color:"#333"},children:[e.jsxs("div",{style:{marginBottom:"0.5rem"},children:[e.jsx("strong",{style:{color:"#555"},children:"Vertrags-ID:"})," #",_t.id]}),_t.vertragsnummer&&e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Vertragsnummer:"})," ",_t.vertragsnummer]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Mitglied-ID:"})," #",_t.mitglied_id]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Dojo:"})," ",w(_t.dojo_id)]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Status:"})," ","aktiv"===_t.status?"âœ… Aktiv":"gekuendigt"===_t.status?"âŒ GekÃ¼ndigt":"ruhepause"===_t.status?"â¸ï¸ Ruhepause":"â¹ï¸ Beendet"]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Erstellt am:"})," ",new Date(_t.created_at||_t.unterschrift_datum).toLocaleString("de-DE")]}),_t.created_by&&e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Erstellt von (User-ID):"})," #",_t.created_by]}),_t.updated_at&&e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Zuletzt geÃ¤ndert:"})," ",new Date(_t.updated_at).toLocaleString("de-DE")]}),_t.updated_by&&e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"GeÃ¤ndert von (User-ID):"})," #",_t.updated_by]}),_t.tarif_id&&e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Tarif-ID:"})," #",_t.tarif_id]}),_t.tarif_name&&e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"ğŸ“‹ Tarif-Name:"})," ",_t.tarif_name]}),_t.monatsbeitrag&&e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"ğŸ’° Monatsbeitrag:"})," â‚¬",parseFloat(_t.monatsbeitrag).toFixed(2)]}),_t.aufnahmegebuehr_cents&&e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"ğŸ’µ AufnahmegebÃ¼hr:"})," â‚¬",(_t.aufnahmegebuehr_cents/100).toFixed(2)]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"ğŸ“„ Vertrags-PDF:"})," ",e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>(async e=>{try{console.log("ğŸ“¥ Lade vollstÃ¤ndigen Vertrag herunter...");const t=(await l.get(`/vertraege/${e}/pdf`,{responseType:"blob"})).data,r=window.URL.createObjectURL(t),n=window.open("","_blank");n&&(n.location.href=r);const i=document.createElement("a");i.href=r,i.download=`Vertrag_${null==R?void 0:R.nachname}_${null==R?void 0:R.vorname}.pdf`,document.body.appendChild(i),i.click(),document.body.removeChild(i),console.log("âœ… Vertrag erfolgreich heruntergeladen und angezeigt")}catch(t){console.error("âŒ Fehler beim Download des Vertrags:",t),alert("Fehler beim Download des Vertrags. Bitte versuchen Sie es erneut.")}})(_t.id),style:{padding:"0.25rem 0.75rem",fontSize:"0.875rem",marginLeft:"0.5rem"},children:"ğŸ“„ PDF"})]})]})]}),(_t.vertragsbeginn||_t.vertragsende)&&e.jsxs("div",{style:{marginBottom:"2rem",padding:"1.5rem",background:"#f8f9fa",borderRadius:"6px",border:"1px solid #dee2e6"},children:[e.jsx("h3",{style:{fontSize:"1.1rem",fontWeight:"600",color:"#1976d2",marginTop:"0",marginBottom:"1.5rem",paddingBottom:"0.75rem",borderBottom:"2px solid #1976d2"},children:"ğŸ“… Laufzeit"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem",fontSize:"0.95rem"},children:[_t.vertragsbeginn&&e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Vertragsbeginn:"})," ",new Date(_t.vertragsbeginn).toLocaleDateString("de-DE")]}),_t.vertragsende&&e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Vertragsende:"})," ",new Date(_t.vertragsende).toLocaleDateString("de-DE")]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Mindestlaufzeit:"})," ",_t.mindestlaufzeit_monate," Monate"]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"KÃ¼ndigungsfrist:"})," ",_t.kuendigungsfrist_monate," Monate vor Vertragsende"]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Autom. VerlÃ¤ngerung:"})," ",_t.automatische_verlaengerung?`Ja (um ${_t.verlaengerung_monate} Monate)`:"Nein"]})]})]}),e.jsxs("div",{style:{marginBottom:"2rem",padding:"1.5rem",background:"#f8f9fa",borderRadius:"6px",border:"1px solid #dee2e6"},children:[e.jsx("h3",{style:{fontSize:"1.1rem",fontWeight:"600",color:"#1976d2",marginTop:"0",marginBottom:"1.5rem",paddingBottom:"0.75rem",borderBottom:"2px solid #1976d2"},children:"ğŸ’³ Zahlungsinformationen"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem",fontSize:"0.95rem"},children:[_t.billing_cycle&&e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Zahlungsintervall:"})," ",xe(_t.billing_cycle)]}),_t.payment_method&&e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Zahlungsmethode:"})," ","direct_debit"===_t.payment_method?"SEPA-Lastschrift":"transfer"===_t.payment_method?"Ãœberweisung":"bar"===_t.payment_method?"Bar":_t.payment_method]}),_t.sepa_mandat_id&&e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"SEPA-Mandat-ID:"})," #",_t.sepa_mandat_id]}),_t.faelligkeit_tag&&e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"FÃ¤lligkeitstag:"})," ",_t.faelligkeit_tag,". des Monats"]}),_t.monatsbeitrag&&e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Monatsbeitrag:"})," â‚¬",parseFloat(_t.monatsbeitrag).toFixed(2)]}),_t.aufnahmegebuehr_cents&&e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"AufnahmegebÃ¼hr:"})," â‚¬",(_t.aufnahmegebuehr_cents/100).toFixed(2)]}),_t.rabatt_prozent>0&&e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Rabatt:"})," ",_t.rabatt_prozent,"%",_t.rabatt_grund&&` (${_t.rabatt_grund})`]})]})]}),e.jsxs("div",{style:{marginBottom:"2rem",padding:"1.5rem",background:"#f8f9fa",borderRadius:"6px",border:"1px solid #dee2e6"},children:[e.jsx("h3",{style:{fontSize:"1.1rem",fontWeight:"600",color:"#1976d2",marginTop:"0",marginBottom:"1.5rem",paddingBottom:"0.75rem",borderBottom:"2px solid #1976d2"},children:"? Rechtliche Akzeptanzen"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem",fontSize:"0.95rem"},children:[_t.agb_akzeptiert_am&&e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"AGB:"})," âœ… Akzeptiert am ",new Date(_t.agb_akzeptiert_am).toLocaleString("de-DE"),_t.agb_version&&` (v${_t.agb_version})`]}),_t.datenschutz_akzeptiert_am&&e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Datenschutz:"})," ? Akzeptiert am ",new Date(_t.datenschutz_akzeptiert_am).toLocaleString("de-DE"),_t.datenschutz_version&&` (v${_t.datenschutz_version})`]}),_t.hausordnung_akzeptiert_am&&e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Hausordnung:"})," ? Akzeptiert am ",new Date(_t.hausordnung_akzeptiert_am).toLocaleString("de-DE")]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Haftungsausschluss (boolean):"})," ",_t.haftungsausschluss_akzeptiert?"? Ja":"? Nein"]}),_t.haftungsausschluss_datum&&e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Haftungsausschluss Datum:"})," ? Akzeptiert am ",new Date(_t.haftungsausschluss_datum).toLocaleString("de-DE")]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"GesundheitserklÃ¤rung (boolean):"})," ",_t.gesundheitserklaerung?"? Ja":"? Nein"]}),_t.gesundheitserklaerung_datum&&e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"GesundheitserklÃ¤rung Datum:"})," ? Abgegeben am ",new Date(_t.gesundheitserklaerung_datum).toLocaleString("de-DE")]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Foto-EinverstÃ¤ndnis (boolean):"})," ",_t.foto_einverstaendnis?"? Ja":"? Nein"]}),_t.foto_einverstaendnis_datum&&e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Foto-EinverstÃ¤ndnis Datum:"})," ? Erteilt am ",new Date(_t.foto_einverstaendnis_datum).toLocaleString("de-DE")]}),_t.widerruf_akzeptiert_am&&e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Widerrufsbelehrung:"})," ? Zur Kenntnis genommen am ",new Date(_t.widerruf_akzeptiert_am).toLocaleString("de-DE")]})]})]}),_t.unterschrift_datum&&e.jsxs("div",{style:{marginBottom:"2rem",padding:"1.5rem",background:"#f8f9fa",borderRadius:"6px",border:"1px solid #dee2e6"},children:[e.jsx("h3",{style:{fontSize:"1.1rem",fontWeight:"600",color:"#1976d2",marginTop:"0",marginBottom:"1.5rem",paddingBottom:"0.75rem",borderBottom:"2px solid #1976d2"},children:"âœï¸ Unterschrift"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem",fontSize:"0.95rem"},children:[e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"Unterschrieben am:"})," ",new Date(_t.unterschrift_datum).toLocaleString("de-DE")]}),_t.unterschrift_ip&&e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"IP-Adresse:"})," ",_t.unterschrift_ip]})]}),_t.unterschrift_digital&&e.jsxs("div",{style:{marginTop:"1rem"},children:[e.jsx("strong",{children:"Digitale Unterschrift:"}),e.jsx("div",{style:{marginTop:"0.5rem",border:"1px solid rgba(255, 215, 0, 0.3)",borderRadius:"4px",padding:"1rem",background:"white",display:"inline-block"},children:e.jsx("img",{src:_t.unterschrift_digital,alt:"Digitale Unterschrift",style:{maxWidth:"400px",maxHeight:"200px",display:"block"}})})]})]}),_t.kuendigung_eingegangen&&e.jsxs("div",{style:{marginBottom:"2rem",padding:"1.5rem",background:"#fff3e0",borderRadius:"6px",border:"2px solid #ff9800"},children:[e.jsx("h3",{style:{fontSize:"1.1rem",fontWeight:"600",color:"#e65100",marginTop:"0",marginBottom:"1.5rem",paddingBottom:"0.75rem",borderBottom:"2px solid #ff9800"},children:"â„¹ï¸ KÃ¼ndigungsinformationen"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem",fontSize:"0.95rem"},children:[e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"KÃ¼ndigung eingegangen:"})," ",new Date(_t.kuendigung_eingegangen).toLocaleString("de-DE")]}),_t.kuendigungsgrund&&e.jsxs("div",{className:"detail-item",children:[e.jsx("strong",{children:"KÃ¼ndigungsgrund:"})," ",_t.kuendigungsgrund]})]})]}),e.jsxs("div",{style:{marginTop:"2rem",paddingTop:"2rem",borderTop:"2px solid #1976d2",display:"flex",gap:"1rem",justifyContent:"center"},children:[e.jsx("button",{onClick:()=>window.print(),style:{padding:"0.75rem 2rem",background:"#1976d2",color:"white",border:"none",borderRadius:"6px",fontSize:"1rem",fontWeight:"500",cursor:"pointer",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:"ğŸ–¨ï¸ Drucken"}),e.jsx("button",{onClick:()=>St(!1),style:{padding:"0.75rem 2rem",background:"#757575",color:"white",border:"none",borderRadius:"6px",fontSize:"1rem",fontWeight:"500",cursor:"pointer",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:"SchlieÃŸen"})]})]})]})}),zt&&_t&&e.jsx("div",{className:"modal-overlay",onClick:()=>wt(!1),style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem",zIndex:1e3},children:e.jsxs("div",{onClick:e=>e.stopPropagation(),style:{maxWidth:"900px",width:"100%",maxHeight:"95vh",overflowY:"auto",background:"linear-gradient(135deg, #1a1a2e 0%, #16213e 100%)",borderRadius:"16px",boxShadow:"0 20px 60px rgba(0,0,0,0.5)",position:"relative",color:"#fff",border:"1px solid rgba(255, 215, 0, 0.3)"},children:[e.jsx("button",{onClick:()=>wt(!1),style:{position:"absolute",top:"16px",right:"16px",width:"40px",height:"40px",borderRadius:"50%",background:"rgba(244, 67, 54, 0.9)",color:"white",border:"none",fontSize:"24px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 12px rgba(244, 67, 54, 0.4)",transition:"all 0.2s ease",zIndex:10,display:"flex",alignItems:"center",justifyContent:"center"},onMouseEnter:e=>{e.currentTarget.style.background="#d32f2f",e.currentTarget.style.transform="scale(1.1)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(244, 67, 54, 0.9)",e.currentTarget.style.transform="scale(1)"},children:"Ã—"}),e.jsxs("div",{style:{padding:"2rem",borderBottom:"2px solid rgba(255, 215, 0, 0.3)",background:"linear-gradient(135deg, rgba(255, 215, 0, 0.1) 0%, rgba(255, 165, 0, 0.05) 100%)"},children:[e.jsx("h2",{style:{margin:"0 0 0.5rem 0",fontSize:"1.8rem",fontWeight:"700",background:"linear-gradient(135deg, #FFD700 0%, #FFA500 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"ğŸ” Vertragsdetails"}),e.jsxs("p",{style:{margin:0,fontSize:"1rem",color:"rgba(255, 255, 255, 0.7)"},children:["Vertrag #",_t.personenVertragNr," â€¢ ",null==R?void 0:R.vorname," ",null==R?void 0:R.nachname]})]}),e.jsxs("div",{style:{padding:"2rem"},children:[e.jsx("div",{style:{display:"inline-flex",padding:"0.5rem 1.5rem",borderRadius:"24px",fontSize:"0.9rem",fontWeight:"600",marginBottom:"2rem",background:"aktiv"===_t.status?"rgba(76, 175, 80, 0.2)":"gekuendigt"===_t.status?"rgba(255, 152, 0, 0.2)":"ruhepause"===_t.status?"rgba(33, 150, 243, 0.2)":"rgba(244, 67, 54, 0.2)",border:"2px solid "+("aktiv"===_t.status?"#4caf50":"gekuendigt"===_t.status?"#ff9800":"ruhepause"===_t.status?"#2196F3":"#f44336"),color:"aktiv"===_t.status?"#4caf50":"gekuendigt"===_t.status?"#ff9800":"ruhepause"===_t.status?"#2196F3":"#f44336"},children:"aktiv"===_t.status?"âœ… AKTIV":"gekuendigt"===_t.status?"âš ï¸ GEKÃœNDIGT":"ruhepause"===_t.status?"â¸ï¸ RUHEPAUSE":"abgelaufen"===_t.status?"âŒ ABGELAUFEN":null==(b=_t.status)?void 0:b.toUpperCase()}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem",marginBottom:"2rem"},children:[e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"12px",padding:"1.5rem",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",color:"#FFD700",display:"flex",alignItems:"center",gap:"0.5rem"},children:"ğŸ“‹ Grunddaten"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"0.2rem"},children:"Vertragsnummer"}),e.jsx("div",{style:{fontSize:"0.95rem",color:"#fff",fontWeight:"500"},children:_t.vertragsnummer||`VTR-${_t.id}`})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"0.2rem"},children:"Mitglieds-ID"}),e.jsx("div",{style:{fontSize:"0.95rem",color:"#fff",fontWeight:"500"},children:_t.mitglied_id})]}),_t.dojo_id&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"0.2rem"},children:"Dojo"}),e.jsx("div",{style:{fontSize:"0.95rem",color:"#fff",fontWeight:"500"},children:w(_t.dojo_id)})]})]})]}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"12px",padding:"1.5rem",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",color:"#FFD700",display:"flex",alignItems:"center",gap:"0.5rem"},children:"ğŸ“… Laufzeit"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"0.2rem"},children:"Vertragsbeginn"}),e.jsx("div",{style:{fontSize:"0.95rem",color:"#fff",fontWeight:"500"},children:_t.vertragsbeginn?new Date(_t.vertragsbeginn).toLocaleDateString("de-DE"):"Nicht angegeben"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"0.2rem"},children:"Vertragsende"}),e.jsx("div",{style:{fontSize:"0.95rem",color:"#fff",fontWeight:"500"},children:_t.vertragsende?new Date(_t.vertragsende).toLocaleDateString("de-DE"):"Unbefristet"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"0.2rem"},children:"Mindestlaufzeit"}),e.jsx("div",{style:{fontSize:"0.95rem",color:"#fff",fontWeight:"500"},children:_t.mindestlaufzeit_monate?`${_t.mindestlaufzeit_monate} Monate`:"Keine Mindestlaufzeit"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"0.2rem"},children:"KÃ¼ndigungsfrist"}),e.jsx("div",{style:{fontSize:"0.95rem",color:"#fff",fontWeight:"500"},children:_t.kuendigungsfrist_monate?`${_t.kuendigungsfrist_monate} Monate`:"Keine Angabe"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"0.2rem"},children:"Automatische VerlÃ¤ngerung"}),e.jsx("div",{style:{fontSize:"0.95rem",color:"#fff",fontWeight:"500"},children:_t.automatische_verlaengerung?"âœ… Ja":"âŒ Nein"})]})]})]}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"12px",padding:"1.5rem",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",color:"#FFD700",display:"flex",alignItems:"center",gap:"0.5rem"},children:"ğŸ’° Zahlung"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"0.2rem"},children:"Tarif"}),e.jsx("div",{style:{fontSize:"0.95rem",color:"#fff",fontWeight:"500"},children:(null==(f=fr.find(e=>e.id===_t.tarif_id))?void 0:f.name)||"Kein Tarif"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"0.2rem"},children:"Beitrag"}),e.jsx("div",{style:{fontSize:"0.95rem",color:"#4caf50",fontWeight:"600"},children:_t.monatsbeitrag?`${parseFloat(_t.monatsbeitrag).toFixed(2)} â‚¬`:"Nicht festgelegt"})]}),_t.aufnahmegebuehr_cents&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"0.2rem"},children:"AufnahmegebÃ¼hr"}),e.jsxs("div",{style:{fontSize:"0.95rem",color:"#ff9800",fontWeight:"600"},children:[(_t.aufnahmegebuehr_cents/100).toFixed(2)," â‚¬"]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"0.2rem"},children:"Zahlungsrhythmus"}),e.jsx("div",{style:{fontSize:"0.95rem",color:"#fff",fontWeight:"500"},children:_t.billing_cycle?xe(_t.billing_cycle):"Nicht angegeben"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"0.2rem"},children:"Zahlungsart"}),e.jsx("div",{style:{fontSize:"0.95rem",color:"#fff",fontWeight:"500"},children:"direct_debit"===_t.payment_method?"ğŸ¦ Lastschrift":"bank_transfer"===_t.payment_method?"ğŸ’³ Ãœberweisung":"cash"===_t.payment_method?"ğŸ’µ Bar":_t.payment_method||"Nicht angegeben"})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"0.2rem"},children:"Lastschrift-Status"}),e.jsx("div",{style:{fontSize:"0.95rem",color:"#fff",fontWeight:"500"},children:"aktiv"===_t.lastschrift_status?"âœ… Aktiv":"ausstehend"===_t.lastschrift_status?"â³ Ausstehend":"fehlgeschlagen"===_t.lastschrift_status?"âŒ Fehlgeschlagen":_t.lastschrift_status||"Keine Angabe"})]})]})]})]}),"ruhepause"===_t.status&&_t.ruhepause_von&&e.jsxs("div",{style:{background:"rgba(33, 150, 243, 0.1)",border:"1px solid rgba(33, 150, 243, 0.3)",borderRadius:"12px",padding:"1.5rem",marginBottom:"2rem"},children:[e.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",color:"#2196F3",display:"flex",alignItems:"center",gap:"0.5rem"},children:"â¸ï¸ Ruhepause"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.6)",marginBottom:"0.2rem"},children:"Von"}),e.jsx("div",{style:{fontSize:"0.95rem",color:"#fff",fontWeight:"500"},children:new Date(_t.ruhepause_von).toLocaleDateString("de-DE")})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.6)",marginBottom:"0.2rem"},children:"Bis"}),e.jsx("div",{style:{fontSize:"0.95rem",color:"#fff",fontWeight:"500"},children:_t.ruhepause_bis?new Date(_t.ruhepause_bis).toLocaleDateString("de-DE"):"Nicht festgelegt"})]})]})]}),"gekuendigt"===_t.status&&_t.kuendigung_eingegangen&&e.jsxs("div",{style:{background:"rgba(255, 152, 0, 0.1)",border:"1px solid rgba(255, 152, 0, 0.3)",borderRadius:"12px",padding:"1.5rem",marginBottom:"2rem"},children:[e.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",color:"#ff9800",display:"flex",alignItems:"center",gap:"0.5rem"},children:"âš ï¸ KÃ¼ndigung"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.6)",marginBottom:"0.2rem"},children:"KÃ¼ndigung eingegangen"}),e.jsx("div",{style:{fontSize:"0.95rem",color:"#fff",fontWeight:"500"},children:new Date(_t.kuendigung_eingegangen).toLocaleDateString("de-DE")})]}),_t.kuendigungsgrund&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.6)",marginBottom:"0.2rem"},children:"KÃ¼ndigungsgrund"}),e.jsx("div",{style:{fontSize:"0.95rem",color:"#fff",fontWeight:"500"},children:_t.kuendigungsgrund})]})]}),e.jsx("div",{style:{marginTop:"1rem",display:"flex",gap:"0.5rem"},children:e.jsx("button",{onClick:()=>{window.open(`${g.apiBaseUrl}/vertraege/${_t.id}/kuendigungsbestaetigung`,"_blank")},style:{padding:"0.5rem 1rem",background:"rgba(255, 152, 0, 0.2)",border:"1px solid rgba(255, 152, 0, 0.4)",borderRadius:"6px",color:"#ff9800",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.85rem",fontWeight:"500",transition:"all 0.2s ease"},onMouseOver:e=>e.currentTarget.style.background="rgba(255, 152, 0, 0.3)",onMouseOut:e=>e.currentTarget.style.background="rgba(255, 152, 0, 0.2)",children:"ğŸ“„ KÃ¼ndigungsbestÃ¤tigung herunterladen"})})]}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"12px",padding:"1.5rem",border:"1px solid rgba(255, 255, 255, 0.1)",marginBottom:"2rem"},children:[e.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",color:"#FFD700",display:"flex",alignItems:"center",gap:"0.5rem"},children:"ğŸ“ Rechtliche Dokumente"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:"0.75rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("span",{style:{fontSize:"1.2rem"},children:_t.agb_akzeptiert_am?"âœ…":"âŒ"}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.9rem",color:"#fff"},children:"AGB"}),_t.agb_akzeptiert_am&&e.jsx("div",{style:{fontSize:"0.75rem",color:"rgba(255, 255, 255, 0.5)"},children:new Date(_t.agb_akzeptiert_am).toLocaleDateString("de-DE")})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("span",{style:{fontSize:"1.2rem"},children:_t.datenschutz_akzeptiert_am?"âœ…":"âŒ"}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.9rem",color:"#fff"},children:"Datenschutz"}),_t.datenschutz_akzeptiert_am&&e.jsx("div",{style:{fontSize:"0.75rem",color:"rgba(255, 255, 255, 0.5)"},children:new Date(_t.datenschutz_akzeptiert_am).toLocaleDateString("de-DE")})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("span",{style:{fontSize:"1.2rem"},children:_t.hausordnung_akzeptiert_am?"âœ…":"âŒ"}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.9rem",color:"#fff"},children:"Hausordnung"}),_t.hausordnung_akzeptiert_am&&e.jsx("div",{style:{fontSize:"0.75rem",color:"rgba(255, 255, 255, 0.5)"},children:new Date(_t.hausordnung_akzeptiert_am).toLocaleDateString("de-DE")})]})]})]})]}),e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsx("h2",{style:{margin:"0 0 1.5rem 0",fontSize:"1.3rem",fontWeight:"700",color:"#FFD700",textAlign:"center",borderBottom:"2px solid rgba(255, 215, 0, 0.3)",paddingBottom:"1rem"},children:"ğŸ“Š Weitere Vertragsdetails"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem"},children:[(_t.vertragsdauer_monate||_t.verlaengerung_monate||_t.probezeit_tage)&&e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"12px",padding:"1.5rem",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",color:"#FFD700",display:"flex",alignItems:"center",gap:"0.5rem"},children:"â±ï¸ Erweiterte Laufzeit"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[_t.vertragsdauer_monate&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"0.2rem"},children:"Vertragsdauer"}),e.jsxs("div",{style:{fontSize:"0.95rem",color:"#fff",fontWeight:"500"},children:[_t.vertragsdauer_monate," Monate"]})]}),_t.verlaengerung_monate&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"0.2rem"},children:"VerlÃ¤ngerung um"}),e.jsxs("div",{style:{fontSize:"0.95rem",color:"#fff",fontWeight:"500"},children:[_t.verlaengerung_monate," Monate"]})]}),_t.probezeit_tage&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"0.2rem"},children:"Probezeit"}),e.jsxs("div",{style:{fontSize:"0.95rem",color:"#fff",fontWeight:"500"},children:[_t.probezeit_tage," Tage"]})]})]})]}),(_t.rabatt_prozent||_t.rabatt_betrag)&&e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"12px",padding:"1.5rem",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",color:"#FFD700",display:"flex",alignItems:"center",gap:"0.5rem"},children:"ğŸ Rabatte"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[_t.rabatt_prozent&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"0.2rem"},children:"Rabatt (%)"}),e.jsxs("div",{style:{fontSize:"0.95rem",color:"#4caf50",fontWeight:"600"},children:[_t.rabatt_prozent,"%"]})]}),_t.rabatt_betrag&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"0.2rem"},children:"Rabatt (Betrag)"}),e.jsxs("div",{style:{fontSize:"0.95rem",color:"#4caf50",fontWeight:"600"},children:[_t.rabatt_betrag," â‚¬"]})]})]})]}),_t.sepa_mandats_id&&e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"12px",padding:"1.5rem",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",color:"#FFD700",display:"flex",alignItems:"center",gap:"0.5rem"},children:"ğŸ¦ SEPA-Mandat"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"0.2rem"},children:"Mandatsreferenz"}),e.jsx("div",{style:{fontSize:"0.95rem",color:"#fff",fontWeight:"500",wordBreak:"break-all"},children:_t.sepa_mandats_id})]})})]}),_t.gekuendigt_von&&e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"12px",padding:"1.5rem",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",color:"#FFD700",display:"flex",alignItems:"center",gap:"0.5rem"},children:"ğŸ“ KÃ¼ndigungsinfo"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"0.2rem"},children:"GekÃ¼ndigt von"}),e.jsx("div",{style:{fontSize:"0.95rem",color:"#fff",fontWeight:"500"},children:_t.gekuendigt_von})]})})]}),_t.ruhepause_grund&&e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"12px",padding:"1.5rem",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",color:"#FFD700",display:"flex",alignItems:"center",gap:"0.5rem"},children:"â¸ï¸ Ruhepause-Details"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"0.2rem"},children:"Grund"}),e.jsx("div",{style:{fontSize:"0.95rem",color:"#fff",fontWeight:"500"},children:_t.ruhepause_grund})]})})]}),(_t.unterschrift_datum||_t.dokument_pfad)&&e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"12px",padding:"1.5rem",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",color:"#FFD700",display:"flex",alignItems:"center",gap:"0.5rem"},children:"ğŸ“„ Dokumente"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[_t.unterschrift_datum&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"0.2rem"},children:"Unterschriftsdatum"}),e.jsx("div",{style:{fontSize:"0.95rem",color:"#fff",fontWeight:"500"},children:new Date(_t.unterschrift_datum).toLocaleDateString("de-DE")})]}),_t.dokument_pfad&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"0.2rem"},children:"Dokument-Pfad"}),e.jsx("div",{style:{fontSize:"0.85rem",color:"#3b82f6",fontWeight:"500",wordBreak:"break-all"},children:_t.dokument_pfad})]})]})]}),(_t.notizen||_t.bemerkung)&&e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"12px",padding:"1.5rem",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",color:"#FFD700",display:"flex",alignItems:"center",gap:"0.5rem"},children:"ğŸ“ Notizen"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[_t.notizen&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"0.2rem"},children:"Notizen"}),e.jsx("div",{style:{fontSize:"0.9rem",color:"#fff",fontWeight:"400",lineHeight:"1.5"},children:_t.notizen})]}),_t.bemerkung&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"0.2rem"},children:"Bemerkung"}),e.jsx("div",{style:{fontSize:"0.9rem",color:"#fff",fontWeight:"400",lineHeight:"1.5"},children:_t.bemerkung})]})]})]}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"12px",padding:"1.5rem",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",color:"#FFD700",display:"flex",alignItems:"center",gap:"0.5rem"},children:"ğŸ”§ Technische Daten"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"0.2rem"},children:"Vertrags-ID"}),e.jsx("div",{style:{fontSize:"0.95rem",color:"#fff",fontWeight:"500"},children:_t.id})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"0.2rem"},children:"PersÃ¶nliche Vertragsnummer"}),e.jsxs("div",{style:{fontSize:"0.95rem",color:"#fff",fontWeight:"500"},children:["#",_t.personenVertragNr]})]}),_t.magicline_contract_id&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"0.2rem"},children:"Magicline Vertrags-ID"}),e.jsx("div",{style:{fontSize:"0.95rem",color:"#9ca3af",fontWeight:"500"},children:_t.magicline_contract_id})]}),void 0!==_t.geloescht&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"rgba(255, 255, 255, 0.5)",marginBottom:"0.2rem"},children:"Status"}),e.jsx("div",{style:{fontSize:"0.95rem",color:_t.geloescht?"#ef4444":"#4caf50",fontWeight:"600"},children:_t.geloescht?"ğŸ—‘ï¸ GelÃ¶scht":"âœ… Aktiv"})]})]})]})]})]}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.03)",borderRadius:"8px",padding:"1rem",fontSize:"0.85rem",color:"rgba(255, 255, 255, 0.5)",display:"flex",justifyContent:"space-between",flexWrap:"wrap",gap:"0.5rem"},children:[e.jsxs("div",{children:["Erstellt: ",_t.erstellt_am?new Date(_t.erstellt_am).toLocaleString("de-DE"):"Unbekannt"]}),_t.aktualisiert_am&&e.jsxs("div",{children:["Aktualisiert: ",new Date(_t.aktualisiert_am).toLocaleString("de-DE")]})]}),e.jsx("div",{style:{marginTop:"2rem",display:"flex",justifyContent:"center"},children:e.jsx("button",{onClick:()=>wt(!1),style:{padding:"0.75rem 2rem",background:"linear-gradient(135deg, #FFD700 0%, #FFA500 100%)",color:"#1a1a2e",border:"none",borderRadius:"8px",fontSize:"1rem",fontWeight:"600",cursor:"pointer",boxShadow:"0 4px 12px rgba(255, 215, 0, 0.3)",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 16px rgba(255, 215, 0, 0.4)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 12px rgba(255, 215, 0, 0.3)"},children:"SchlieÃŸen"})})]})]})}),Ft&&e.jsx("div",{onClick:()=>Bt(!1),style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:9999,padding:"20px"},children:e.jsxs("div",{onClick:e=>e.stopPropagation(),style:{background:"linear-gradient(135deg, rgba(30, 30, 40, 0.98) 0%, rgba(20, 20, 30, 0.98) 100%)",borderRadius:"16px",padding:"2rem",maxWidth:"500px",width:"100%",border:"1px solid rgba(231, 76, 60, 0.3)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)"},children:[e.jsx("h2",{style:{color:"#e74c3c",marginBottom:"1.5rem",fontSize:"1.5rem"},children:"ğŸ—‘ï¸ Mitglied archivieren"}),e.jsxs("div",{style:{marginBottom:"1.5rem",color:"rgba(255, 255, 255, 0.9)"},children:[e.jsxs("p",{children:["MÃ¶chten Sie ",e.jsxs("strong",{style:{color:"#FFD700"},children:[R.vorname," ",R.nachname]})," wirklich archivieren?"]}),e.jsx("p",{style:{fontSize:"0.9rem",color:"rgba(255, 255, 255, 0.6)",marginTop:"1rem"},children:"Das Mitglied wird aus der aktiven Liste entfernt und mit allen Daten ins Archiv verschoben. Diese Aktion kann nicht rÃ¼ckgÃ¤ngig gemacht werden."})]}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"rgba(255, 255, 255, 0.9)"},children:"Grund (optional):"}),e.jsx("textarea",{value:Tt,onChange:e=>At(e.target.value),placeholder:"z.B. Austritt, Umzug, KÃ¼ndigung...",rows:3,style:{width:"100%",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 215, 0, 0.2)",borderRadius:"8px",padding:"12px",color:"#fff",fontSize:"0.95rem",resize:"vertical",fontFamily:"inherit"}})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>{Bt(!1),At("")},style:{padding:"0.75rem 1.5rem",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",color:"#fff",cursor:"pointer",fontSize:"0.95rem",fontWeight:"600",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.15)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.1)"},children:"Abbrechen"}),e.jsx("button",{onClick:async()=>{var e,t;try{(await l.post(`/mitglieder/${D}/archivieren`,{grund:Tt||"Mitglied archiviert",archiviert_von:(null==S?void 0:S.id)||null})).data.success&&(Bt(!1),alert(`âœ… ${R.vorname} ${R.nachname} wurde erfolgreich archiviert.`),window.location.href="/dashboard/mitglieder")}catch(r){console.error("Fehler beim Archivieren:",r),alert("âŒ Fehler beim Archivieren: "+((null==(t=null==(e=r.response)?void 0:e.data)?void 0:t.error)||r.message))}},style:{padding:"0.75rem 1.5rem",background:"linear-gradient(135deg, #e74c3c 0%, #c0392b 100%)",border:"none",borderRadius:"8px",color:"#fff",cursor:"pointer",fontSize:"0.95rem",fontWeight:"600",boxShadow:"0 4px 12px rgba(231, 76, 60, 0.3)",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 16px rgba(231, 76, 60, 0.4)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 12px rgba(231, 76, 60, 0.3)"},children:"ğŸ—‘ï¸ Jetzt archivieren"})]})]})}),$t&&Vt&&e.jsx("div",{className:"modal-overlay",onClick:()=>{Pt(!1),Kt(null)},style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,padding:"2rem"},children:e.jsxs("div",{onClick:e=>e.stopPropagation(),style:{background:"linear-gradient(135deg, rgba(30, 30, 40, 0.98) 0%, rgba(20, 20, 30, 0.98) 100%)",borderRadius:"16px",padding:"2rem",maxWidth:"500px",width:"100%",border:"1px solid rgba(255, 193, 7, 0.3)",boxShadow:"none"},children:[e.jsx("div",{style:{display:"flex",justifyContent:"center",marginBottom:"1.5rem",fontSize:"4rem"},children:"âš ï¸"}),e.jsx("h2",{style:{color:"#ffc107",marginBottom:"1.5rem",fontSize:"1.3rem",textAlign:"center",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.5px"},children:"ACHTUNG: VERTRAG IST NOCH AKTIV!"}),e.jsxs("div",{style:{marginBottom:"1.5rem",color:"rgba(255, 255, 255, 0.9)"},children:[e.jsxs("p",{style:{textAlign:"left"},children:["Vertrag ",e.jsxs("strong",{style:{color:"#FFD700"},children:["#",Vt.personenVertragNr]})," ist noch aktiv!"]}),e.jsx("p",{style:{fontSize:"0.9rem",color:"rgba(255, 255, 255, 0.9)",marginTop:"1rem",textAlign:"left"},children:"MÃ¶chten Sie den Vertrag trotzdem kÃ¼ndigen?"}),e.jsxs("p",{style:{fontSize:"0.9rem",color:"rgba(255, 255, 255, 0.9)",marginTop:"0.5rem",textAlign:"left"},children:["Bei ",e.jsx("strong",{style:{color:"#FFD700"},children:'"Ja"'})," wird der Vertrag gekÃ¼ndigt und in die Archivierten/Ehemaligen verschoben."]}),e.jsxs("p",{style:{fontSize:"0.9rem",color:"rgba(255, 255, 255, 0.9)",marginTop:"0.5rem",textAlign:"left"},children:["Bei ",e.jsx("strong",{style:{color:"#FFD700"},children:'"Nein"'})," wird die Aktion abgebrochen."]})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>{Pt(!1),Kt(null)},style:{padding:"0.75rem 1.5rem",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",color:"#fff",cursor:"pointer",fontSize:"0.95rem",fontWeight:"600",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.15)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.1)"},children:"Nein"}),e.jsx("button",{onClick:async()=>{if(Vt)try{await l.put(`/vertraege/${Vt.id}/kuendigen`,{kuendigungsdatum:(new Date).toISOString().split("T")[0],kuendigung_eingegangen:(new Date).toISOString().split("T")[0],status:"gekuendigt"}),alert("âœ… Vertrag wurde erfolgreich gekÃ¼ndigt und archiviert."),Pt(!1),Kt(null),await on()}catch(e){console.error("Fehler beim KÃ¼ndigen des Vertrags:",e),alert("Fehler beim KÃ¼ndigen des Vertrags. Bitte versuchen Sie es erneut.")}},style:{padding:"0.75rem 1.5rem",background:"linear-gradient(135deg, #ffc107 0%, #ff9800 100%)",border:"none",borderRadius:"8px",color:"#fff",cursor:"pointer",fontSize:"0.95rem",fontWeight:"600",transition:"all 0.3s ease",boxShadow:"0 4px 12px rgba(255, 193, 7, 0.3)"},onMouseEnter:e=>{e.currentTarget.style.background="linear-gradient(135deg, #ff9800 0%, #ffc107 100%)",e.currentTarget.style.boxShadow="0 6px 16px rgba(255, 193, 7, 0.4)"},onMouseLeave:e=>{e.currentTarget.style.background="linear-gradient(135deg, #ffc107 0%, #ff9800 100%)",e.currentTarget.style.boxShadow="0 4px 12px rgba(255, 193, 7, 0.3)"},children:"Ja"})]})]})})]})};export{fe as default};
